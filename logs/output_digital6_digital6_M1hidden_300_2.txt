Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=294, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=8627169, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
97e90f29-ec26-4663-ae87-20a573bb9353
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 147, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 374, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 213, in forward
    gates = quant_pass(pact_a_bmm( quant_pass(pact_a_bmm(part1, self.a12), self.abMVM, self.a12) + quant_pass(pact_a_bmm(part2, self.a13), self.abMVM, self.a13), self.a14), self.abNM, self.a14)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 124, in pact_a_bmm
    return torch.sign(x) * .5 * (torch.abs(x) - torch.abs(torch.abs(x) - a) + a)
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 10.76 GiB total capacity; 9.63 GiB already allocated; 17.12 MiB free; 9.79 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=294, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=8627169, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
bfb0834d-54f0-461d-8ed4-2c2407af74ae
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     3.5232      0.1200     0.0871     15.9971
00100     1.9574      0.3600     0.0908     58.7619
00200     1.3209      0.6000     0.0908     59.4772
00300     1.2978      0.5700     0.0908     58.1987
00400     1.0062      0.6300     0.0908     57.6288
00500     1.0675      0.6800     0.0972     58.9303
00600     0.8505      0.7200     0.0982     62.2208
00700     0.6449      0.7700     0.0982     58.1190
00800     0.7216      0.7800     0.0982     58.7581
00900     0.7526      0.7500     0.1003     59.3114
01000     0.8139      0.6900     0.1003     60.9766
01100     0.6724      0.7700     0.1003     62.7200
01200     0.6039      0.7900     0.1053     64.5507
01300     0.6061      0.7600     0.1073     57.6128
01400     0.4553      0.8600     0.1073     58.9425
01500     0.4549      0.8400     0.1074     62.1566
01600     0.7275      0.7900     0.1074     59.6311
01700     0.5241      0.8300     0.1074     58.5602
01800     0.5355      0.8600     0.1074     59.2806
01900     0.5055      0.8100     0.1134     59.6227
02000     0.3224      0.8700     0.1158     59.8372
02100     0.4499      0.8800     0.1204     57.3454
02200     0.3634      0.8800     0.1204     59.0726
02300     0.4100      0.8600     0.1204     63.1284
02400     0.5564      0.8400     0.1213     64.0777
02500     0.3373      0.9000     0.1222     65.0405
02600     0.3621      0.8700     0.1222     62.1953
02700     0.3539      0.9000     0.1222     63.2045
02800     0.2328      0.9200     0.1222     64.7194
02900     0.4790      0.8400     0.1223     60.7924
03000     0.3875      0.8800     0.1223     59.1632
03100     0.4200      0.8500     0.1348     59.0147
03200     0.3442      0.8700     0.1348     62.4296
03300     0.2785      0.9000     0.1348     62.2575
03400     0.4298      0.8300     0.1348     58.4735
03500     0.3060      0.9000     0.1438     60.7745
03600     0.2494      0.9000     0.1438     60.4720
03700     0.2824      0.9100     0.1438     61.2491
03800     0.3647      0.8800     0.1438     58.4086
03900     0.2644      0.9300     0.1438     60.4531
04000     0.3925      0.8600     0.1438     61.2332
04100     0.4363      0.8300     0.1544     57.8854
04200     0.3788      0.8600     0.1544     59.2779
04300     0.3630      0.8900     0.1601     61.0887
04400     0.3425      0.8900     0.1657     59.3574
04500     0.3943      0.8800     0.1657     58.6376
04600     0.3421      0.8600     0.1657     59.3817
04700     0.3563      0.9100     0.1657     58.6032
04800     0.3605      0.8900     0.1657     58.6147
04900     0.3260      0.8900     0.1657     64.0540
05000     0.2588      0.9100     0.1657     61.9751
05100     0.2458      0.8800     0.1657     59.2115
05200     0.3326      0.8900     0.1657     61.8556
05300     0.4349      0.8500     0.1657     58.2804
05400     0.2326      0.9400     0.1759     59.2227
05500     0.4323      0.8800     0.1759     57.3044
05600     0.2980      0.8800     0.1759     61.6614
05700     0.5132      0.8200     0.1759     58.6706
05800     0.2294      0.9300     0.1823     61.5398
05900     0.4639      0.8400     0.1823     63.1110
06000     0.3847      0.8900     0.1946     63.6048
06100     0.4675      0.8500     0.2095     61.6182
06200     0.2107      0.9000     0.2095     63.9012
06300     0.2545      0.9100     0.2095     58.3006
06400     0.2639      0.9300     0.2095     63.1361
06500     0.3667      0.9100     0.2095     59.7924
06600     0.3468      0.8900     0.2095     57.2950
06700     0.2188      0.9400     0.2095     58.1183
06800     0.4184      0.8700     0.2095     57.4760
06900     0.1838      0.9500     0.2106     58.1677
07000     0.2795      0.9300     0.2286     63.0387
07100     0.3500      0.9000     0.2286     61.4438
07200     0.1823      0.9200     0.2288     61.0965
07300     0.5012      0.8400     0.2288     62.6858
07400     0.4021      0.9000     0.2391     59.5911
07500     0.3142      0.8700     0.2391     62.5601
07600     0.2502      0.8900     0.2391     59.5588
07700     0.4009      0.8800     0.2391     59.7236
07800     0.3213      0.9100     0.2505     61.0786
07900     0.2608      0.9200     0.2505     58.1485
08000     0.3058      0.9100     0.2505     63.3247
08100     0.0819      0.9800     0.2523     62.6747
08200     0.2155      0.9100     0.2684     60.3469
08300     0.2354      0.9300     0.2684     60.9827
08400     0.2425      0.9200     0.2684     60.6357
08500     0.4069      0.8700     0.2684     59.8504
08600     0.2510      0.9100     0.2684     59.2501
08700     0.2217      0.9400     0.2720     63.4254
08800     0.2870      0.8900     0.2720     58.3247
08900     0.2394      0.9000     0.2720     57.7174
09000     0.2537      0.9400     0.2720     62.1124
09100     0.2764      0.9200     0.2819     62.3988
09200     0.2276      0.9200     0.2819     59.4864
09300     0.1937      0.9300     0.2819     60.0835
09400     0.2258      0.9200     0.2998     64.2411
09500     0.3215      0.9000     0.2998     58.0031
09600     0.3563      0.9000     0.3080     59.3287
09700     0.2933      0.8700     0.3080     57.6125
09800     0.2964      0.9400     0.3080     59.4152
09900     0.1957      0.9400     0.3080     58.4764
10000     0.2751      0.9000     0.3080     58.1380
10100     0.1704      0.9500     0.3080     58.6565
10200     0.2488      0.9200     0.3080     63.9357
10300     0.1921      0.9400     0.3080     63.3987
10400     0.2251      0.9200     0.3086     61.7498
10500     0.2921      0.9100     0.3086     60.7548
10600     0.3319      0.9400     0.3086     58.8364
10700     0.1843      0.9200     0.3086     61.3691
10800     0.2495      0.9200     0.3138     63.7673
10900     0.2120      0.9200     0.3138     60.2121
11000     0.2774      0.9100     0.3138     60.4361
11100     0.1243      0.9600     0.3138     62.0254
11200     0.1290      0.9400     0.3138     63.5730
11300     0.2193      0.9300     0.3193     58.9529
11400     0.1777      0.9300     0.3193     57.7817
11500     0.2135      0.9200     0.3193     59.6900
11600     0.1834      0.9400     0.3193     59.1175
11700     0.0815      0.9700     0.3193     61.8823
11800     0.1793      0.9400     0.3193     60.5612
11900     0.3145      0.9000     0.3193     62.7155
12000     0.2664      0.9100     0.3249     64.9456
12100     0.2979      0.9200     0.3249     58.3353
12200     0.1597      0.9700     0.3249     58.8413
12300     0.1761      0.9400     0.3249     60.2159
12400     0.2229      0.9300     0.3249     63.0783
12500     0.4295      0.8300     0.3249     58.7638
12600     0.1437      0.9500     0.3249     62.1165
12700     0.2842      0.9200     0.3249     58.1130
12800     0.1187      0.9600     0.3249     57.3771
12900     0.2555      0.9200     0.3249     58.9711
13000     0.1833      0.9400     0.3249     66.2121
13100     0.1634      0.9500     0.3249     61.0462
13200     0.1617      0.9400     0.3249     58.0278
13300     0.2442      0.9600     0.3249     61.0521
13400     0.1424      0.9500     0.3249     61.4359
13500     0.1503      0.9500     0.3249     60.9001
13600     0.2468      0.9100     0.3249     60.8369
13700     0.2211      0.8900     0.3249     58.7529
13800     0.1786      0.9400     0.3249     60.3287
13900     0.2151      0.9200     0.3249     65.4845
14000     0.2336      0.9500     0.3249     59.3004
14100     0.1081      0.9600     0.3249     63.5907
14200     0.2749      0.9200     0.3249     64.4485
14300     0.1908      0.9500     0.3249     58.0045
14400     0.1443      0.9700     0.3249     61.6425
14500     0.1964      0.9500     0.3249     65.9042
14600     0.0759      0.9800     0.3249     58.8344
14700     0.1074      0.9600     0.3249     59.6712
14800     0.1625      0.9400     0.3249     59.1011
14900     0.2223      0.9300     0.3249     58.0044
15000     0.1000      0.9700     0.3249     61.1045
15100     0.1537      0.9400     0.3249     60.0598
15200     0.1458      0.9400     0.3249     63.0255
15300     0.1859      0.9400     0.3249     63.7153
15400     0.1912      0.9300     0.3249     61.0974
15500     0.1497      0.9300     0.3249     65.3110
15600     0.2193      0.9300     0.3249     60.5070
15700     0.1935      0.9500     0.3249     58.1713
15800     0.0924      0.9600     0.3249     61.5952
15900     0.1579      0.9500     0.3249     58.4467
16000     0.2528      0.9400     0.3249     57.8800
16100     0.0972      0.9600     0.3249     61.6297
16200     0.1539      0.9700     0.3249     60.8439
16300     0.1701      0.9600     0.3249     58.0177
16400     0.1727      0.9500     0.3249     57.2756
16500     0.1430      0.9600     0.3249     59.8736
16600     0.1720      0.9500     0.3249     62.3370
16700     0.1597      0.9600     0.3249     60.5992
16800     0.1384      0.9500     0.3249     61.7132
16900     0.2084      0.9500     0.3249     63.7605
17000     0.1220      0.9700     0.3249     60.9040
17100     0.0808      0.9800     0.3249     61.8789
17200     0.2455      0.9300     0.3249     59.6497
17300     0.2143      0.9300     0.3249     61.7795
17400     0.1202      0.9500     0.3249     59.4221
17500     0.2132      0.9100     0.3249     61.4115
17600     0.1189      0.9800     0.3249     62.0674
17700     0.2137      0.9400     0.3249     62.6255
17800     0.1766      0.9400     0.3249     58.0417
17900     0.2651      0.9400     0.3249     58.9543
18000     0.2494      0.9100     0.3249     58.3100
18100     0.1645      0.9600     0.3249     58.8566
18200     0.1394      0.9300     0.3249     60.1722
18300     0.1668      0.9600     0.3249     57.6600
18400     0.1957      0.9400     0.3249     62.7184
18500     0.1660      0.9400     0.3249     62.9028
18600     0.1731      0.9400     0.3249     62.5973
18700     0.1011      0.9700     0.3249     59.0303
18800     0.2164      0.9600     0.3249     62.3060
18900     0.2324      0.9300     0.3249     59.9124
19000     0.2054      0.9400     0.3249     65.4545
19100     0.1128      0.9700     0.3249     61.8472
19200     0.1851      0.9700     0.3249     62.5999
19300     0.0702      0.9900     0.3249     59.4558
19400     0.1747      0.9300     0.3249     60.8303
19500     0.0990      0.9700     0.3249     58.0173
19600     0.1147      0.9700     0.3249     63.2904
19700     0.1326      0.9600     0.3249     61.1366
19800     0.0930      0.9700     0.3249     57.8092
19900     0.0384      1.0000     0.3249     59.3295
20000     0.1585      0.9500     0.3249     57.5983
20100     0.2189      0.9500     0.3249     60.5979
20199     0.0899      0.9700     0.3249     57.3088
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     3.4186      0.3800     0.3208     14.8948
00100     2.2137      0.5200     0.5199     59.6861
00200     1.9207      0.6100     0.5942     62.0971
00300     1.4521      0.6600     0.6299     57.8769
00400     1.9147      0.5800     0.6541     57.7345
00500     1.0208      0.7500     0.6779     61.9235
00600     0.9022      0.7100     0.6990     57.8184
00700     1.5030      0.6300     0.6990     57.1619
00800     1.4121      0.6600     0.7099     58.1167
00900     1.3438      0.6600     0.7343     58.1767
01000     0.9938      0.7400     0.7343     59.8199
01100     0.9202      0.7600     0.7343     57.8282
01200     0.9663      0.7600     0.7343     60.1179
01300     0.7895      0.8200     0.7526     57.9107
01400     0.8923      0.7700     0.7526     62.2856
01500     1.2396      0.7000     0.7526     58.6804
01600     1.4335      0.6500     0.7649     59.2281
01700     0.9355      0.8000     0.7649     61.3829
01800     0.6833      0.7400     0.7649     58.8133
01900     0.6256      0.8300     0.7649     59.8392
02000     1.1583      0.7300     0.7706     63.4950
02100     0.6676      0.8600     0.7706     57.7675
02200     0.8315      0.7700     0.7706     59.2567
02300     0.8896      0.7800     0.7706     61.7254
02400     0.8092      0.8300     0.7722     59.4391
02500     0.6252      0.7800     0.7762     60.7503
02600     0.6943      0.8000     0.7762     57.4870
02700     1.1268      0.7900     0.7805     61.4641
02800     0.7800      0.8000     0.7860     63.4898
02900     0.9109      0.8000     0.7874     64.9396
03000     0.7420      0.8100     0.7874     59.8427
03100     1.1353      0.7700     0.7971     59.4307
03200     0.8839      0.7500     0.7971     57.4583
03300     0.4697      0.8600     0.7971     59.2162
03400     0.6884      0.7400     0.7971     58.9772
03500     0.4183      0.8600     0.7971     59.5216
03600     0.8707      0.7400     0.8003     61.8710
03700     1.1867      0.7500     0.8003     61.1045
03800     0.7772      0.8100     0.8003     59.7664
03900     0.6864      0.8100     0.8003     58.4880
04000     0.8447      0.7900     0.8003     61.1130
04100     1.2408      0.7600     0.8003     62.1827
04200     0.7625      0.7900     0.8003     58.6021
04300     0.5985      0.7900     0.8081     59.5727
04400     0.9507      0.7400     0.8081     59.6736
04500     0.9286      0.7400     0.8081     58.7249
04600     0.7790      0.7900     0.8081     57.8966
04700     0.7160      0.8100     0.8081     59.2678
04800     0.7032      0.7800     0.8081     62.0885
04900     0.6986      0.8500     0.8081     58.6004
05000     0.4502      0.8800     0.8134     62.7366
05100     0.8342      0.7700     0.8185     57.7454
05200     0.8899      0.8100     0.8185     61.2083
05300     0.7637      0.8300     0.8185     59.0914
05400     1.1022      0.7400     0.8185     61.6955
05500     0.8093      0.8100     0.8185     63.0403
05600     0.7417      0.8000     0.8185     59.4635
05700     0.7713      0.7600     0.8185     57.7568
05800     0.4510      0.8500     0.8219     58.8969
05900     0.8430      0.7500     0.8219     59.3149
06000     0.7659      0.7900     0.8219     57.6765
06100     0.6339      0.8300     0.8219     59.1802
06200     0.8886      0.8300     0.8219     62.3116
06300     0.7769      0.8400     0.8219     61.0125
06400     0.7837      0.8400     0.8219     60.8079
06500     1.0503      0.7900     0.8219     60.7293
06600     0.8338      0.8200     0.8219     60.0923
06700     1.1739      0.6900     0.8233     61.7091
06800     0.8007      0.7600     0.8233     59.2028
06900     0.6627      0.8200     0.8233     58.3265
07000     0.5075      0.8600     0.8233     59.1108
07100     0.5202      0.9100     0.8233     63.7445
07200     0.5791      0.8500     0.8233     60.9658
07300     1.1634      0.7100     0.8318     59.3069
07400     0.7255      0.7800     0.8318     58.8406
07500     0.7473      0.8400     0.8318     57.3715
07600     0.6672      0.8400     0.8318     58.2747
07700     0.6013      0.8200     0.8318     64.7097
07800     0.8714      0.7900     0.8318     62.6121
07900     0.4721      0.8600     0.8318     59.9669
08000     0.6318      0.8300     0.8318     61.2732
08100     0.8490      0.7800     0.8318     59.8328
08200     0.7073      0.7700     0.8318     58.4377
08300     0.7971      0.8100     0.8318     60.5821
08400     0.5532      0.8600     0.8318     59.7643
08500     1.2141      0.8100     0.8318     59.7475
08600     0.8494      0.7900     0.8318     60.2262
08700     0.5944      0.8200     0.8329     59.7331
08800     0.5473      0.8400     0.8329     63.7779
08900     0.7469      0.8600     0.8329     60.4492
09000     0.2932      0.9100     0.8329     59.9186
09100     0.7388      0.7900     0.8329     60.0276
09200     0.5702      0.8600     0.8329     61.2658
09300     0.8563      0.8400     0.8329     59.3136
09400     0.4862      0.8600     0.8329     62.4821
09500     0.5465      0.8300     0.8329     61.8079
09600     0.5456      0.8000     0.8329     61.7862
09700     0.6840      0.8500     0.8329     60.7951
09800     0.7077      0.8100     0.8329     61.6230
09900     0.7826      0.8000     0.8329     64.8465
Start testing:
Test Accuracy: 0.8871
