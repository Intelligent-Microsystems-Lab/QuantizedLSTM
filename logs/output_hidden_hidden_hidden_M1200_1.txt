Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=194, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=235899598, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
b46c19b7-afd3-4644-a83a-9c0bb43422d4
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 167, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 374, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 210, in forward
    part1 = CustomMM_bmm.apply(quant_pass(pact_a_bmm(input.repeat(self.n_blocks, 1, 1), self.a1), self.ib, self.a1), self.weight_ih, self.bias_ih, self.noise_level, self.wb, self.bias_r)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 150, in forward
    output = input.bmm(wq + noise_w) + bq + bias_w
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 10.76 GiB total capacity; 9.63 GiB already allocated; 3.12 MiB free; 9.80 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=194, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=235899598, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
61ffdafa-ac49-422c-805e-014a9f07a7c9
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     3.0805      0.1200     0.1166     14.5795
00100     1.5591      0.4800     0.4383     55.4949
00200     1.4629      0.4800     0.5802     55.3114
00300     1.0904      0.6100     0.6258     55.1691
00400     1.1826      0.6300     0.6839     56.0800
00500     0.8127      0.7500     0.7312     55.6043
00600     0.8552      0.7300     0.7312     55.5590
00700     0.9080      0.7200     0.7484     55.9690
00800     1.2558      0.5800     0.7573     55.6762
00900     0.9200      0.6700     0.7595     55.6730
01000     0.9082      0.7100     0.7595     56.0700
01100     0.9249      0.6900     0.7742     56.7659
01200     0.8409      0.7300     0.7742     55.6181
01300     0.7724      0.7600     0.7742     56.1510
01400     0.7751      0.7400     0.7902     56.3596
01500     0.6862      0.8100     0.7902     55.7543
01600     0.7113      0.7500     0.8037     56.1672
01700     0.8634      0.7300     0.8037     56.7245
01800     0.8312      0.7300     0.8037     56.0689
01900     0.8725      0.7400     0.8037     56.9502
02000     0.6931      0.7800     0.8037     56.0769
02100     0.7467      0.7500     0.8037     56.0752
02200     0.5706      0.7800     0.8037     56.1363
02300     0.7234      0.7600     0.8191     56.0060
02400     0.7415      0.7200     0.8191     55.6761
02500     0.6361      0.7700     0.8191     56.1504
02600     0.6883      0.7900     0.8191     55.3468
02700     0.6047      0.8400     0.8191     55.7059
02800     0.7793      0.7300     0.8191     56.9512
02900     0.6492      0.7500     0.8297     58.1571
03000     0.6058      0.8100     0.8297     57.9388
03100     0.5612      0.8200     0.8297     56.8866
03200     0.6751      0.7900     0.8297     56.7357
03300     0.6808      0.7900     0.8297     57.1902
03400     0.5590      0.8200     0.8297     57.1595
03500     0.6667      0.8100     0.8297     57.2263
03600     0.5018      0.8500     0.8318     57.3149
03700     0.6559      0.8000     0.8350     58.0569
03800     0.7402      0.7600     0.8350     58.3798
03900     0.5992      0.8600     0.8350     57.8844
04000     0.6529      0.7500     0.8402     58.0105
04100     0.7401      0.7400     0.8402     58.7579
04200     0.5428      0.8400     0.8402     58.1380
04300     0.6439      0.7700     0.8402     58.2920
04400     0.6645      0.7700     0.8402     57.4622
04500     0.5818      0.8000     0.8402     57.5361
04600     0.7681      0.7000     0.8464     56.5741
04700     0.4580      0.8500     0.8464     56.6511
04800     0.5592      0.8600     0.8464     56.0118
04900     0.4799      0.8100     0.8464     56.3759
05000     0.6741      0.7700     0.8482     56.2014
05100     0.4819      0.8400     0.8482     55.8698
05200     0.7905      0.7500     0.8482     55.7035
05300     0.8164      0.7500     0.8482     55.9116
05400     0.7390      0.7700     0.8482     56.6966
05500     0.6284      0.8100     0.8482     57.1501
05600     0.8709      0.7500     0.8482     58.0944
05700     0.5360      0.8300     0.8482     57.6449
05800     0.6425      0.7900     0.8547     57.2854
05900     0.5395      0.8500     0.8547     57.9710
06000     0.4970      0.8500     0.8547     56.8483
06100     0.5153      0.8200     0.8547     56.0651
06200     0.5674      0.8200     0.8547     57.9192
06300     0.4453      0.8600     0.8547     57.0998
06400     0.5004      0.8500     0.8547     56.8904
06500     0.5633      0.7900     0.8547     56.9938
06600     0.3713      0.9100     0.8591     58.4611
06700     0.5851      0.7900     0.8591     57.6958
06800     0.6596      0.8200     0.8591     57.0269
06900     0.6192      0.7800     0.8591     58.2040
07000     0.6207      0.8200     0.8591     58.2931
07100     0.3833      0.8900     0.8591     57.9367
07200     0.7114      0.7600     0.8591     58.7254
07300     0.3542      0.9000     0.8591     57.3417
07400     0.7380      0.7600     0.8591     57.4867
07500     0.5194      0.7900     0.8591     56.5150
07600     0.5415      0.8300     0.8591     55.5209
07700     0.6045      0.7700     0.8591     56.2007
07800     0.3929      0.8600     0.8591     55.7968
07900     0.3919      0.8800     0.8591     56.0331
08000     0.5421      0.8200     0.8591     56.3094
08100     0.6998      0.7900     0.8591     55.6676
08200     0.4688      0.8900     0.8591     56.4070
08300     0.4636      0.8300     0.8591     56.2107
08400     0.4887      0.8100     0.8591     56.2468
08500     0.5666      0.8200     0.8591     56.8487
08600     0.6673      0.8000     0.8591     56.7066
08700     0.6021      0.8100     0.8591     57.3385
08800     0.5413      0.8400     0.8591     59.0796
08900     0.6556      0.7900     0.8591     56.7565
09000     0.5113      0.8800     0.8591     58.0056
09100     0.5408      0.8000     0.8591     56.6726
09200     0.6189      0.8200     0.8608     57.2657
09300     0.5303      0.7800     0.8612     58.4757
09400     0.4826      0.8200     0.8612     57.7082
09500     0.4951      0.8400     0.8612     58.0905
09600     0.6774      0.7800     0.8612     57.9122
09700     0.7947      0.7500     0.8612     57.6918
09800     0.3806      0.8900     0.8612     57.2430
09900     0.5541      0.8500     0.8612     57.0105
10000     0.7711      0.8000     0.8612     56.4023
10100     0.4393      0.8500     0.8716     59.1606
10200     0.4566      0.8400     0.8718     57.9206
10300     0.5924      0.8000     0.8718     56.7309
10400     0.5882      0.8400     0.8718     56.3760
10500     0.4291      0.8500     0.8718     55.6486
10600     0.4532      0.8700     0.8784     56.1457
10700     0.4282      0.8600     0.8784     56.5253
10800     0.4879      0.8500     0.8784     57.0547
10900     0.3415      0.8900     0.8784     57.2611
11000     0.3279      0.9200     0.8784     56.6852
11100     0.5907      0.7700     0.8784     58.4761
11200     0.3242      0.8600     0.8784     55.7223
11300     0.4472      0.8600     0.8784     58.1619
11400     0.3801      0.8800     0.8784     58.5853
11500     0.3655      0.9200     0.8784     56.5254
11600     0.5883      0.7900     0.8784     57.4872
11700     0.4392      0.8700     0.8784     56.1281
11800     0.4333      0.8200     0.8784     56.3715
11900     0.6313      0.7900     0.8784     56.1081
12000     0.3909      0.8400     0.8784     56.0096
12100     0.2871      0.9200     0.8784     56.3166
12200     0.4982      0.8300     0.8784     56.0017
12300     0.5069      0.8100     0.8784     56.7238
12400     0.4452      0.8600     0.8784     55.9552
12500     0.4572      0.8400     0.8784     55.7133
12600     0.3396      0.8700     0.8784     56.5733
12700     0.4801      0.8600     0.8784     56.7762
12800     0.3479      0.8600     0.8784     56.6525
12900     0.5100      0.8500     0.8784     57.0794
13000     0.6482      0.7600     0.8784     56.8419
13100     0.3830      0.8700     0.8784     56.5706
13200     0.4483      0.8600     0.8784     56.5561
13300     0.3899      0.8700     0.8784     58.4344
13400     0.4683      0.8600     0.8784     57.8676
13500     0.5113      0.8800     0.8784     59.9576
13600     0.5428      0.8100     0.8784     57.4904
13700     0.4393      0.8600     0.8784     57.7223
13800     0.4580      0.8500     0.8784     57.6666
13900     0.5965      0.8100     0.8784     57.3468
14000     0.4512      0.8500     0.8784     57.6164
14100     0.3216      0.9300     0.8784     56.4348
14200     0.3708      0.9300     0.8784     56.2712
14300     0.3845      0.8800     0.8784     55.8174
14400     0.5361      0.8800     0.8784     55.8636
14500     0.4701      0.8300     0.8784     55.4119
14600     0.4756      0.8800     0.8784     57.2672
14700     0.4388      0.8700     0.8784     56.7477
14800     0.3308      0.9100     0.8784     58.3926
14900     0.3718      0.8700     0.8784     56.7896
15000     0.4598      0.8800     0.8784     57.2242
15100     0.4889      0.8900     0.8784     57.4349
15200     0.5027      0.8200     0.8784     57.0640
15300     0.3882      0.8600     0.8784     55.9514
15400     0.5232      0.8100     0.8784     57.3863
15500     0.4023      0.8700     0.8784     56.4109
15600     0.3554      0.9000     0.8784     58.3116
15700     0.4258      0.8600     0.8784     57.6508
15800     0.5323      0.8300     0.8784     58.1227
15900     0.4902      0.8500     0.8784     57.9028
16000     0.4141      0.8600     0.8784     56.9202
16100     0.2949      0.9000     0.8784     57.3411
16200     0.4106      0.8600     0.8784     57.1255
16300     0.4808      0.8500     0.8784     58.8400
16400     0.3278      0.8900     0.8784     58.3631
16500     0.4093      0.8600     0.8784     57.3130
16600     0.4668      0.8700     0.8784     57.9194
16700     0.4264      0.8800     0.8784     57.7538
16800     0.3281      0.8800     0.8784     57.2427
16900     0.4585      0.8500     0.8784     56.9292
17000     0.4154      0.9000     0.8784     58.7923
17100     0.3696      0.8900     0.8784     57.3557
17200     0.1912      0.9800     0.8784     56.5907
17300     0.5594      0.8400     0.8784     56.4387
17400     0.3637      0.8900     0.8784     56.4417
17500     0.4293      0.8500     0.8784     55.9585
17600     0.2895      0.8900     0.8784     55.9505
17700     0.4532      0.8500     0.8784     56.6262
17800     0.3916      0.9100     0.8784     56.2047
17900     0.3758      0.8900     0.8784     55.8957
18000     0.3657      0.8700     0.8784     56.6654
18100     0.2602      0.9200     0.8784     56.0157
18200     0.3317      0.9100     0.8784     56.2512
18300     0.3986      0.8600     0.8784     55.2378
18400     0.4117      0.9000     0.8784     56.2924
18500     0.5351      0.8500     0.8784     56.8310
18600     0.4982      0.8600     0.8784     55.6857
18700     0.3092      0.9100     0.8784     56.0202
18800     0.4181      0.8900     0.8784     55.8641
18900     0.3676      0.9100     0.8784     57.1849
19000     0.4495      0.8600     0.8784     57.1274
19100     0.3628      0.8700     0.8784     58.4551
19200     0.3573      0.8800     0.8784     56.5619
19300     0.3364      0.8800     0.8784     57.1692
19400     0.4744      0.8600     0.8784     58.4904
19500     0.3999      0.8700     0.8784     57.5728
19600     0.3894      0.8500     0.8784     58.4778
19700     0.3736      0.8700     0.8784     57.2257
19800     0.3439      0.9100     0.8784     56.0047
19900     0.4425      0.8500     0.8784     56.0493
20000     0.2443      0.9200     0.8784     56.0087
20100     0.4639      0.8800     0.8784     55.6390
20199     0.4615      0.8400     0.8784     55.8837
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     0.7694      0.7800     0.7799     14.0853
00100     0.4608      0.8500     0.8934     56.0098
00200     0.4343      0.8600     0.8934     55.5790
00300     0.3249      0.9000     0.8934     55.9581
00400     0.3118      0.9200     0.8977     55.6803
00500     0.4079      0.8600     0.8977     56.8511
00600     0.3219      0.9000     0.8977     56.1485
00700     0.4287      0.8800     0.8977     55.8295
00800     0.3935      0.8600     0.8986     57.5131
00900     0.4876      0.8500     0.8986     55.8884
01000     0.3357      0.8600     0.8986     56.6485
01100     0.6484      0.8100     0.8986     56.6928
01200     0.4971      0.8100     0.8986     57.0134
01300     0.4751      0.8500     0.8986     56.7733
01400     0.4772      0.8600     0.8986     56.7239
01500     0.4595      0.8300     0.8986     56.3626
01600     0.5177      0.8700     0.8986     56.9068
01700     0.4448      0.8400     0.8986     55.8545
01800     0.4452      0.9000     0.8986     56.7480
01900     0.3781      0.8900     0.8986     56.1633
02000     0.2828      0.9000     0.8986     56.4985
02100     0.4200      0.8600     0.8986     56.1263
02200     0.2614      0.9300     0.8986     55.5822
02300     0.4026      0.8600     0.8986     56.0212
02400     0.3059      0.9000     0.8986     55.6884
02500     0.3532      0.8900     0.8986     57.2744
02600     0.5815      0.8400     0.8990     58.6649
02700     0.3619      0.9000     0.8995     56.4605
02800     0.4784      0.8600     0.8995     55.9209
02900     0.3469      0.9000     0.8995     55.7506
03000     0.4708      0.8700     0.8995     55.9314
03100     0.5418      0.8400     0.8995     56.4598
03200     0.3114      0.9200     0.8995     55.8278
03300     0.3162      0.9200     0.8995     55.6182
03400     0.3187      0.9000     0.8995     55.8297
03500     0.4782      0.8300     0.8996     56.3083
03600     0.3409      0.8800     0.8996     55.8469
03700     0.3929      0.8600     0.8996     55.8613
03800     0.3754      0.8800     0.8996     55.8987
03900     0.3072      0.9000     0.8996     56.5217
04000     0.5149      0.8300     0.8996     59.0005
04100     0.4527      0.8300     0.9015     56.7628
04200     0.3006      0.9000     0.9030     58.1327
04300     0.3810      0.8700     0.9030     57.7300
04400     0.5116      0.8800     0.9030     57.1939
04500     0.2264      0.9300     0.9030     57.1733
04600     0.4423      0.8700     0.9030     57.1221
04700     0.3561      0.8700     0.9030     57.1031
04800     0.3641      0.9000     0.9030     59.6053
04900     0.4712      0.8800     0.9030     57.1108
05000     0.3632      0.8900     0.9030     57.0833
05100     0.2978      0.9100     0.9030     56.5773
05200     0.3006      0.9000     0.9030     58.2654
05300     0.5129      0.8100     0.9030     57.4272
05400     0.2003      0.9700     0.9030     56.9837
05500     0.3153      0.8900     0.9030     57.0033
05600     0.2439      0.9200     0.9030     56.3233
05700     0.4051      0.8500     0.9030     57.4646
05800     0.4497      0.8500     0.9030     57.7456
05900     0.3616      0.8700     0.9030     57.8702
06000     0.3396      0.8900     0.9030     56.7092
06100     0.2357      0.9400     0.9030     57.2685
06200     0.3378      0.9000     0.9030     56.2560
06300     0.4376      0.8700     0.9030     55.8638
06400     0.3036      0.9100     0.9030     56.3543
06500     0.4072      0.8800     0.9030     56.0307
06600     0.3543      0.8600     0.9043     56.0092
06700     0.3715      0.8800     0.9043     56.3690
06800     0.3201      0.9000     0.9043     58.8496
06900     0.4029      0.9000     0.9043     57.4286
07000     0.2829      0.9200     0.9043     57.4047
07100     0.4795      0.8600     0.9043     58.1863
07200     0.4002      0.8900     0.9043     57.0586
07300     0.5203      0.8400     0.9043     57.5807
07400     0.3795      0.8800     0.9043     59.0358
07500     0.3966      0.8700     0.9043     57.9801
07600     0.3661      0.8800     0.9043     58.5077
07700     0.4122      0.8400     0.9043     60.0972
07800     0.2954      0.9000     0.9043     57.5383
07900     0.3795      0.8800     0.9043     57.4814
08000     0.3322      0.9100     0.9043     57.3137
08100     0.4841      0.8500     0.9043     55.8701
08200     0.3654      0.8600     0.9043     55.3589
08300     0.5610      0.7800     0.9043     56.2236
08400     0.3425      0.8400     0.9043     55.0936
08500     0.4180      0.8700     0.9043     56.0815
08600     0.4842      0.8800     0.9043     55.7470
08700     0.2953      0.9200     0.9043     56.7031
08800     0.2362      0.9300     0.9043     55.9002
08900     0.4511      0.8600     0.9043     55.5409
09000     0.3825      0.9000     0.9043     55.7159
09100     0.3602      0.8700     0.9043     56.0462
09200     0.3828      0.8700     0.9043     56.4396
09300     0.4073      0.8400     0.9043     57.9052
09400     0.3763      0.8700     0.9043     57.6088
09500     0.3193      0.9000     0.9043     58.2923
09600     0.3183      0.8800     0.9043     56.3305
09700     0.3287      0.9000     0.9043     57.7334
09800     0.3190      0.9100     0.9043     63.7000
09900     0.3660      0.8900     0.9043     61.9994
Start testing:
Test Accuracy: 0.8930
