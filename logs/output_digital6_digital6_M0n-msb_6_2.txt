Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=108, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=0, n_mfcc=40, n_msb=6, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=8627169, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
decb1573-668d-4c21-aebc-db0ee66aae9e
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 167, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 290, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 213, in forward
    gates = quant_pass(pact_a_bmm( quant_pass(pact_a_bmm(part1, self.a12), self.abMVM, self.a12) + quant_pass(pact_a_bmm(part2, self.a13), self.abMVM, self.a13), self.a14), self.abNM, self.a14)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 89, in forward
    x01q =  torch.round(x01 * step_d ) / step_d
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 10.76 GiB total capacity; 9.70 GiB already allocated; 13.12 MiB free; 9.79 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=108, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=0, n_mfcc=40, n_msb=6, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=8627169, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
f1b40f1b-aa1e-4768-a6c6-2ab2294cd745
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     2.8740      0.0759     0.0895     10.0576
00100     1.5130      0.5021     0.0909     52.9319
00200     0.8829      0.7215     0.0909     52.7803
00300     0.7350      0.7700     0.1015     53.1698
00400     0.7382      0.7489     0.1081     52.9571
00500     0.6437      0.7911     0.1153     53.4815
00600     0.5491      0.8186     0.1153     53.2088
00700     0.6057      0.8038     0.1153     52.6467
00800     0.3897      0.8903     0.1153     53.0188
00900     0.4708      0.8502     0.1168     52.6356
01000     0.4692      0.8608     0.1321     52.8666
01100     0.4962      0.8544     0.1321     53.3300
01200     0.4120      0.8734     0.1321     54.0809
01300     0.4259      0.8882     0.1321     53.8579
01400     0.3350      0.9030     0.1321     54.0987
01500     0.3894      0.8713     0.1321     53.9451
01600     0.3810      0.8903     0.1321     54.0742
01700     0.4328      0.8776     0.1321     53.4864
01800     0.3335      0.9030     0.1321     53.9945
01900     0.2946      0.9177     0.1321     54.2470
02000     0.2476      0.9198     0.1321     53.7533
02100     0.3144      0.9093     0.1321     53.7565
02200     0.3181      0.9093     0.1321     53.5738
02300     0.3225      0.9030     0.1321     53.1605
02400     0.3600      0.8924     0.1321     53.8493
02500     0.3705      0.8840     0.1321     53.8011
02600     0.3174      0.9093     0.1321     53.7704
02700     0.2343      0.9388     0.1321     54.3678
02800     0.3232      0.9093     0.1321     53.5773
02900     0.3000      0.9072     0.1328     53.1158
03000     0.2332      0.9325     0.1342     53.7478
03100     0.2122      0.9494     0.1361     54.0881
03200     0.3020      0.9072     0.1361     54.1201
03300     0.3138      0.8924     0.1361     54.2106
03400     0.2323      0.9241     0.1361     53.7165
03500     0.2891      0.9093     0.1361     55.0485
03600     0.2648      0.9346     0.1413     53.8156
03700     0.2556      0.9262     0.1461     53.9118
03800     0.2393      0.9367     0.1488     53.7239
03900     0.2892      0.9219     0.1488     53.4383
04000     0.2236      0.9346     0.1572     53.9975
04100     0.2686      0.9135     0.1574     53.7314
04200     0.2333      0.9177     0.1574     54.2379
04300     0.2186      0.9473     0.1630     53.8973
04400     0.2202      0.9388     0.1638     53.8461
04500     0.2072      0.9409     0.1638     53.5669
04600     0.2579      0.9283     0.1638     53.9845
04700     0.2316      0.9367     0.1638     53.3440
04800     0.2231      0.9325     0.1638     54.2323
04900     0.2930      0.9114     0.1638     54.3386
05000     0.1970      0.9430     0.1713     54.3257
05100     0.1877      0.9367     0.1713     54.2748
05200     0.2797      0.9135     0.1713     53.8626
05300     0.2267      0.9430     0.1713     53.8169
05400     0.2047      0.9409     0.1795     53.8142
05500     0.2148      0.9367     0.1795     53.1550
05600     0.1720      0.9388     0.1858     54.1971
05700     0.2050      0.9409     0.1858     53.6585
05800     0.2394      0.9304     0.1858     53.3854
05900     0.1762      0.9620     0.1858     53.8666
06000     0.2159      0.9388     0.1858     53.2706
06100     0.2109      0.9325     0.1869     53.4661
06200     0.2145      0.9367     0.1869     54.1686
06300     0.2314      0.9283     0.1949     53.4215
06400     0.2441      0.9262     0.1949     53.9351
06500     0.2756      0.9283     0.1949     53.6754
06600     0.2267      0.9430     0.1949     53.4108
06700     0.2256      0.9430     0.1949     54.0903
06800     0.1600      0.9578     0.1949     53.6706
06900     0.1508      0.9557     0.1972     53.6445
07000     0.2681      0.9241     0.1972     54.1068
07100     0.2148      0.9262     0.2172     54.0281
07200     0.2474      0.9325     0.2172     54.2997
07300     0.2079      0.9409     0.2226     53.9469
07400     0.1740      0.9578     0.2226     53.2994
07500     0.2316      0.9325     0.2226     54.1289
07600     0.2104      0.9304     0.2324     53.7777
07700     0.2123      0.9346     0.2324     53.7721
07800     0.2256      0.9346     0.2324     54.4075
07900     0.2259      0.9494     0.2324     53.9828
08000     0.2136      0.9367     0.2324     54.3267
08100     0.2687      0.9283     0.2324     53.6562
08200     0.2071      0.9367     0.2335     53.3860
08300     0.2051      0.9388     0.2335     53.4859
08400     0.1852      0.9473     0.2335     54.1365
08500     0.2018      0.9451     0.2597     53.8398
08600     0.1233      0.9747     0.2597     54.0927
08700     0.2000      0.9473     0.2597     53.5738
08800     0.2052      0.9388     0.2597     53.9482
08900     0.1871      0.9557     0.2597     53.8714
09000     0.1978      0.9494     0.2597     53.4192
09100     0.2728      0.9093     0.2597     54.0015
09200     0.2129      0.9325     0.2597     54.0406
09300     0.2464      0.9304     0.2597     53.4868
09400     0.2138      0.9367     0.2627     54.4877
09500     0.1861      0.9409     0.2627     53.5383
09600     0.2332      0.9409     0.2627     54.5929
09700     0.2156      0.9304     0.2627     53.9432
09800     0.2004      0.9367     0.2627     53.9251
09900     0.1490      0.9578     0.2645     53.8230
10000     0.1754      0.9599     0.2645     53.6009
10100     0.2047      0.9494     0.2771     54.0019
10200     0.1598      0.9578     0.2771     53.9449
10300     0.1753      0.9409     0.2771     53.9287
10400     0.1601      0.9473     0.2771     54.2300
10500     0.1629      0.9515     0.2771     53.5663
10600     0.1769      0.9557     0.2771     54.0687
10700     0.1787      0.9473     0.2771     53.7967
10800     0.1494      0.9641     0.2771     53.6257
10900     0.1646      0.9536     0.2771     53.9740
11000     0.1421      0.9641     0.2771     54.1821
11100     0.1624      0.9536     0.2771     53.4909
11200     0.1369      0.9578     0.2771     54.7276
11300     0.1322      0.9662     0.2771     53.7875
11400     0.2020      0.9494     0.2771     53.9190
11500     0.1406      0.9599     0.2771     54.1386
11600     0.1554      0.9662     0.2771     53.8337
11700     0.1307      0.9578     0.2771     53.7237
11800     0.1544      0.9620     0.2771     53.9806
11900     0.1656      0.9494     0.2771     53.3576
12000     0.1854      0.9515     0.2771     54.0499
12100     0.1526      0.9557     0.2771     53.9398
12200     0.1740      0.9684     0.2771     53.5651
12300     0.1561      0.9515     0.2771     53.9700
12400     0.1476      0.9557     0.2771     53.8920
12500     0.1653      0.9599     0.2785     53.7937
12600     0.1567      0.9557     0.2785     54.3540
12700     0.1536      0.9641     0.2785     53.3620
12800     0.1842      0.9473     0.2818     53.9510
12900     0.2083      0.9451     0.2818     53.3484
13000     0.1362      0.9684     0.2818     53.5611
13100     0.1300      0.9599     0.2818     54.0292
13200     0.1433      0.9662     0.2818     53.7415
13300     0.1374      0.9620     0.2818     54.1033
13400     0.1100      0.9726     0.2818     53.4998
13500     0.1305      0.9620     0.2818     53.0533
13600     0.1660      0.9515     0.2818     54.1239
13700     0.1056      0.9789     0.2818     53.2599
13800     0.1453      0.9705     0.2818     54.1203
13900     0.1178      0.9705     0.2818     54.0278
14000     0.1520      0.9620     0.2818     53.5559
14100     0.1647      0.9557     0.2818     53.8184
14200     0.1215      0.9705     0.2818     53.7944
14300     0.1266      0.9620     0.2818     53.7375
14400     0.1281      0.9599     0.2818     54.1215
14500     0.1236      0.9641     0.2818     53.6639
14600     0.1294      0.9726     0.2818     53.7590
14700     0.1264      0.9620     0.2818     53.9838
14800     0.0934      0.9831     0.2818     53.3606
14900     0.1544      0.9620     0.2818     54.1877
15000     0.1344      0.9662     0.2818     54.4711
15100     0.1365      0.9599     0.2818     53.8444
15200     0.1439      0.9620     0.2818     53.8122
15300     0.1168      0.9726     0.2818     53.7127
15400     0.1844      0.9473     0.2818     53.4690
15500     0.1543      0.9620     0.2818     54.2567
15600     0.1400      0.9641     0.2818     53.3231
15700     0.1478      0.9578     0.2818     54.1475
15800     0.1559      0.9599     0.2818     54.1369
15900     0.1372      0.9536     0.2818     53.7105
16000     0.1563      0.9515     0.2818     54.5764
16100     0.1220      0.9662     0.2818     53.2314
16200     0.1273      0.9641     0.2818     54.3457
16300     0.2014      0.9451     0.2818     54.1431
16400     0.1851      0.9578     0.2818     53.9014
16500     0.1100      0.9726     0.2818     53.6320
16600     0.1259      0.9641     0.2818     54.0630
16700     0.1266      0.9620     0.2818     53.4384
16800     0.1438      0.9620     0.2818     54.1488
16900     0.1157      0.9684     0.2818     53.3742
17000     0.1285      0.9705     0.2818     53.7943
17100     0.1162      0.9726     0.2818     54.7630
17200     0.1718      0.9536     0.2818     53.3215
17300     0.0931      0.9873     0.2818     53.9235
17400     0.1421      0.9578     0.2818     54.1070
17500     0.1178      0.9747     0.2818     54.0972
17600     0.1390      0.9641     0.2818     54.3079
17700     0.1953      0.9473     0.2818     53.7977
17800     0.1414      0.9620     0.2818     53.2224
17900     0.1070      0.9684     0.2818     54.3829
18000     0.0985      0.9747     0.2818     54.1733
18100     0.1566      0.9578     0.2818     53.7253
18200     0.1507      0.9557     0.2818     54.5546
18300     0.1252      0.9620     0.2818     54.2553
18400     0.1115      0.9726     0.2818     54.2458
18500     0.1424      0.9620     0.2818     53.1118
18600     0.1645      0.9578     0.2818     53.5334
18700     0.1522      0.9599     0.2818     54.1290
18800     0.1379      0.9578     0.2818     53.7308
18900     0.1624      0.9536     0.2818     53.7394
19000     0.1531      0.9599     0.2818     54.4250
19100     0.1126      0.9726     0.2818     53.7542
19200     0.1668      0.9451     0.2818     53.9561
19300     0.1188      0.9726     0.2818     53.9815
19400     0.1627      0.9684     0.2818     53.5582
19500     0.1449      0.9494     0.2818     54.2173
19600     0.1898      0.9409     0.2818     53.9224
19700     0.1570      0.9620     0.2818     53.9614
19800     0.1041      0.9747     0.2818     54.3914
19900     0.0989      0.9789     0.2818     53.8148
20000     0.1651      0.9578     0.2818     54.3396
20100     0.1215      0.9684     0.2818     53.6484
20199     0.1343      0.9620     0.2818     52.8737
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     3.4004      0.2932     0.2727     8.6457
00100     2.1047      0.5443     0.4953     54.7401
00200     1.7783      0.5422     0.5867     53.7255
00300     1.4623      0.6076     0.6037     54.2356
00400     1.1618      0.6646     0.6679     53.6923
00500     1.2027      0.6561     0.6679     54.0761
00600     1.0182      0.7236     0.6790     54.1995
00700     1.3292      0.6287     0.6938     54.0714
00800     0.8615      0.7785     0.7072     53.6131
00900     1.1128      0.7152     0.7130     54.3356
01000     1.0405      0.6920     0.7130     53.7543
01100     0.8903      0.7574     0.7324     54.3472
01200     1.0003      0.7089     0.7324     53.1225
01300     0.9343      0.7489     0.7436     53.4360
01400     0.8348      0.7553     0.7545     54.2530
01500     0.9248      0.7679     0.7597     53.8404
01600     0.8848      0.7595     0.7597     53.9411
01700     0.8051      0.7743     0.7597     54.1864
01800     0.9061      0.7278     0.7608     54.1340
01900     0.7047      0.7848     0.7749     53.9734
02000     0.7881      0.7764     0.7749     53.2390
02100     0.8170      0.7932     0.7749     53.9024
02200     0.8606      0.7764     0.7749     54.3281
02300     0.7324      0.7932     0.7797     54.0555
02400     0.7190      0.7975     0.7797     53.2356
02500     0.7665      0.8080     0.7826     53.5258
02600     0.7092      0.8059     0.7826     53.6052
02700     0.8001      0.7700     0.7829     54.1710
02800     0.7182      0.7954     0.7880     53.2433
02900     0.7314      0.7932     0.7880     54.3660
03000     0.6130      0.8291     0.7880     54.2193
03100     0.7858      0.7975     0.8016     53.9697
03200     0.7642      0.7806     0.8016     53.3901
03300     0.7146      0.8038     0.8016     53.8968
03400     0.7199      0.7764     0.8016     53.0856
03500     0.6680      0.8038     0.8016     54.0507
03600     0.7710      0.7911     0.8016     54.1400
03700     0.9001      0.7468     0.8016     53.1629
03800     0.6187      0.8270     0.8016     53.8571
03900     0.7113      0.7890     0.8055     53.8136
04000     0.7871      0.7996     0.8055     53.7112
04100     0.6206      0.8186     0.8062     54.4604
04200     0.6743      0.8207     0.8062     54.9768
04300     0.7085      0.7785     0.8062     54.0868
04400     0.6916      0.8122     0.8101     53.6019
04500     0.6714      0.8143     0.8143     53.6539
04600     0.6564      0.8122     0.8143     54.4092
04700     0.6630      0.8038     0.8143     53.6531
04800     0.6285      0.8101     0.8143     53.4761
04900     0.7158      0.7827     0.8143     54.1705
05000     0.7666      0.7890     0.8143     53.2728
05100     0.6134      0.8059     0.8143     53.4321
05200     0.6398      0.8017     0.8143     53.5524
05300     0.6100      0.8143     0.8143     53.9147
05400     0.6605      0.8038     0.8143     54.1432
05500     0.6173      0.8333     0.8143     53.9419
05600     0.4997      0.8481     0.8143     53.2614
05700     0.7054      0.8080     0.8204     54.5773
05800     0.6105      0.8544     0.8204     53.6167
05900     0.6716      0.7954     0.8204     53.4918
06000     0.6070      0.8249     0.8204     53.4665
06100     0.5919      0.8207     0.8228     53.4190
06200     0.7146      0.7975     0.8228     53.8143
06300     0.7187      0.7785     0.8228     53.7351
06400     0.6126      0.8354     0.8228     53.2258
06500     0.5409      0.8481     0.8228     53.8133
06600     0.7187      0.8101     0.8283     53.7470
06700     0.6042      0.8270     0.8283     54.5523
06800     0.5093      0.8481     0.8283     53.3037
06900     0.6604      0.8017     0.8283     54.1999
07000     0.6341      0.8228     0.8283     54.4754
07100     0.6916      0.8080     0.8283     53.4342
07200     0.5453      0.8270     0.8283     53.3065
07300     0.6539      0.8080     0.8283     53.8251
07400     0.6229      0.8228     0.8283     53.3499
07500     0.4549      0.8586     0.8283     54.2396
07600     0.5814      0.8270     0.8362     53.9265
07700     0.6458      0.8143     0.8362     54.1901
07800     0.5226      0.8397     0.8362     53.9864
07900     0.5526      0.8122     0.8362     53.8801
08000     0.4711      0.8671     0.8362     53.9786
08100     0.5618      0.8418     0.8362     54.5949
08200     0.6702      0.8038     0.8362     53.4239
08300     0.6627      0.8228     0.8362     53.6695
08400     0.5859      0.8523     0.8362     53.2667
08500     0.5761      0.8481     0.8362     53.6832
08600     0.6964      0.8080     0.8362     54.0134
08700     0.5328      0.8418     0.8362     53.1461
08800     0.5483      0.8502     0.8362     53.3161
08900     0.6439      0.8165     0.8362     54.9238
09000     0.5612      0.8439     0.8362     54.0014
09100     0.5401      0.8312     0.8362     54.3270
09200     0.5511      0.8228     0.8362     54.1573
09300     0.5627      0.8481     0.8362     54.1368
09400     0.5061      0.8502     0.8362     54.7831
09500     0.6086      0.8312     0.8362     53.9973
09600     0.5324      0.8418     0.8362     53.9558
09700     0.4995      0.8523     0.8380     54.4413
09800     0.4815      0.8608     0.8380     53.8445
09900     0.5954      0.8270     0.8380     53.9332
Start testing:
Test Accuracy: 0.8698
