Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=108, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=1, n_mfcc=40, n_msb=6, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=235899598, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
f055348e-9638-4b59-bea6-4104ef080e76
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 167, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 374, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 213, in forward
    gates = quant_pass(pact_a_bmm( quant_pass(pact_a_bmm(part1, self.a12), self.abMVM, self.a12) + quant_pass(pact_a_bmm(part2, self.a13), self.abMVM, self.a13), self.a14), self.abNM, self.a14)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 89, in forward
    x01q =  torch.round(x01 * step_d ) / step_d
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 10.76 GiB total capacity; 9.70 GiB already allocated; 11.12 MiB free; 9.79 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=108, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=1, n_mfcc=40, n_msb=6, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=235899598, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
750153c7-f1f4-47b3-afde-9395fabd831b
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     4.9715      0.0992     0.0755     10.4483
00100     1.8417      0.3207     0.0859     58.4187
00200     1.4724      0.4599     0.0880     58.8191
00300     1.1295      0.5865     0.0961     57.2950
00400     0.9071      0.6857     0.0961     55.7096
00500     0.7297      0.7489     0.0961     55.7564
00600     0.8823      0.7025     0.0961     56.3311
00700     0.6188      0.7785     0.0961     55.8255
00800     0.6454      0.7764     0.1106     56.4309
00900     0.5898      0.7911     0.1106     56.1403
01000     0.5207      0.7911     0.1106     55.8113
01100     0.5125      0.8143     0.1106     56.5215
01200     0.5885      0.8101     0.1106     56.4990
01300     0.4068      0.8692     0.1106     58.2944
01400     0.4777      0.8629     0.1106     57.5658
01500     0.5750      0.8165     0.1130     56.5464
01600     0.4341      0.8207     0.1130     56.3216
01700     0.5803      0.7975     0.1130     57.2651
01800     0.5188      0.8565     0.1130     55.3943
01900     0.4017      0.8734     0.1130     55.1424
02000     0.3416      0.8629     0.1130     54.7565
02100     0.3509      0.8945     0.1130     58.0024
02200     0.4024      0.8776     0.1182     56.0927
02300     0.4079      0.8629     0.1182     55.1639
02400     0.4061      0.8776     0.1182     58.6465
02500     0.4649      0.8333     0.1182     57.8077
02600     0.3857      0.8586     0.1182     55.5841
02700     0.2909      0.8987     0.1182     56.9465
02800     0.3376      0.8776     0.1182     56.6338
02900     0.3798      0.8734     0.1182     54.8129
03000     0.4068      0.8629     0.1182     55.0001
03100     0.3254      0.8987     0.1182     54.9493
03200     0.2623      0.9198     0.1182     55.7882
03300     0.2752      0.8903     0.1182     55.8409
03400     0.3417      0.8987     0.1182     55.7890
03500     0.3146      0.8903     0.1193     55.3627
03600     0.3452      0.8819     0.1193     55.9554
03700     0.2575      0.9114     0.1206     55.5717
03800     0.2620      0.9219     0.1206     55.5379
03900     0.2981      0.9093     0.1206     55.5506
04000     0.3213      0.8861     0.1345     55.5425
04100     0.2446      0.9135     0.1345     55.0160
04200     0.3649      0.8882     0.1345     55.5346
04300     0.3053      0.9114     0.1345     57.2151
04400     0.3290      0.9093     0.1345     55.2498
04500     0.3452      0.9030     0.1345     57.4198
04600     0.2891      0.9072     0.1345     55.5718
04700     0.2408      0.9156     0.1345     55.6928
04800     0.3080      0.8924     0.1464     55.3316
04900     0.2645      0.9156     0.1464     54.4682
05000     0.3203      0.8924     0.1464     57.3485
05100     0.3140      0.8882     0.1464     55.9543
05200     0.2516      0.9219     0.1464     57.7291
05300     0.2454      0.9283     0.1464     56.9351
05400     0.3034      0.8966     0.1464     56.6156
05500     0.2757      0.9198     0.1464     55.4023
05600     0.2408      0.9114     0.1464     56.0105
05700     0.2692      0.9008     0.1464     55.7872
05800     0.2750      0.9198     0.1464     56.1320
05900     0.2707      0.8882     0.1541     57.0455
06000     0.2602      0.9093     0.1541     55.4085
06100     0.2578      0.9093     0.1541     55.7962
06200     0.2740      0.9177     0.1637     56.3934
06300     0.1789      0.9451     0.1637     55.8728
06400     0.3042      0.8840     0.1639     56.1381
06500     0.3035      0.9051     0.1648     56.0812
06600     0.2432      0.9008     0.1648     56.0101
06700     0.2116      0.9283     0.1648     57.9655
06800     0.2865      0.9177     0.1648     55.5665
06900     0.2131      0.9241     0.1696     55.8578
07000     0.1677      0.9451     0.1798     56.9876
07100     0.2942      0.9114     0.1798     55.9561
07200     0.2313      0.9283     0.1798     56.9997
07300     0.2365      0.9241     0.1862     57.0968
07400     0.2214      0.9283     0.1862     55.6243
07500     0.2082      0.9241     0.1862     56.1747
07600     0.2383      0.9219     0.1862     55.4264
07700     0.2335      0.9283     0.1862     55.1999
07800     0.2219      0.9283     0.1862     57.4341
07900     0.2104      0.9367     0.1862     57.2851
08000     0.2749      0.9198     0.1862     56.0043
08100     0.2337      0.9177     0.1862     56.5158
08200     0.2393      0.9219     0.1870     55.9591
08300     0.1990      0.9473     0.1870     56.3286
08400     0.2102      0.9346     0.1938     55.7783
08500     0.1842      0.9388     0.1938     56.3088
08600     0.2429      0.9283     0.2002     57.1006
08700     0.2203      0.9283     0.2002     55.5776
08800     0.2630      0.9156     0.2002     56.7367
08900     0.1979      0.9262     0.2019     56.1492
09000     0.2574      0.9241     0.2019     55.6295
09100     0.1499      0.9451     0.2019     57.6773
09200     0.2526      0.9135     0.2040     56.4527
09300     0.2236      0.9283     0.2040     55.6421
09400     0.2413      0.9262     0.2040     56.8729
09500     0.1811      0.9515     0.2040     56.2495
09600     0.1918      0.9198     0.2112     57.2124
09700     0.1872      0.9367     0.2160     57.0384
09800     0.1374      0.9409     0.2181     56.5465
09900     0.2048      0.9219     0.2492     56.2147
10000     0.2744      0.9135     0.2492     56.0411
10100     0.2177      0.9283     0.2492     56.2005
10200     0.2009      0.9388     0.2492     57.0088
10300     0.2284      0.9283     0.2492     57.1074
10400     0.1716      0.9430     0.2492     55.7721
10500     0.2276      0.9198     0.2492     56.1012
10600     0.2356      0.9262     0.2492     56.6504
10700     0.1706      0.9388     0.2492     56.5887
10800     0.1769      0.9198     0.2492     55.9334
10900     0.1651      0.9451     0.2492     55.2969
11000     0.1836      0.9430     0.2492     55.8319
11100     0.1539      0.9430     0.2492     55.5587
11200     0.1801      0.9578     0.2492     56.0061
11300     0.1245      0.9515     0.2492     55.6241
11400     0.2057      0.9283     0.2492     55.7989
11500     0.1645      0.9388     0.2492     56.7271
11600     0.2196      0.9262     0.2492     55.9343
11700     0.1969      0.9367     0.2492     56.1597
11800     0.2068      0.9114     0.2492     56.7052
11900     0.1384      0.9641     0.2492     56.4602
12000     0.1861      0.9409     0.2492     57.9074
12100     0.1469      0.9494     0.2492     55.7975
12200     0.1617      0.9304     0.2492     55.8965
12300     0.1560      0.9494     0.2492     55.6948
12400     0.1535      0.9515     0.2492     57.8703
12500     0.2096      0.9325     0.2492     56.3520
12600     0.1878      0.9430     0.2492     55.6299
12700     0.2222      0.9241     0.2492     55.8060
12800     0.2258      0.9325     0.2492     56.4324
12900     0.1485      0.9473     0.2492     56.1249
13000     0.1823      0.9451     0.2492     56.7745
13100     0.1535      0.9494     0.2492     57.1815
13200     0.1720      0.9262     0.2492     56.5714
13300     0.1704      0.9346     0.2492     56.0812
13400     0.2148      0.9430     0.2492     56.3504
13500     0.1148      0.9620     0.2492     55.9957
13600     0.1688      0.9557     0.2492     57.2232
13700     0.1765      0.9430     0.2492     55.7661
13800     0.2068      0.9283     0.2492     56.2853
13900     0.1785      0.9367     0.2492     56.9188
14000     0.1459      0.9557     0.2492     56.9473
14100     0.1478      0.9388     0.2492     55.3257
14200     0.1602      0.9494     0.2492     57.5197
14300     0.1599      0.9494     0.2492     55.8521
14400     0.1707      0.9367     0.2492     56.9044
14500     0.1658      0.9346     0.2492     56.0182
14600     0.1201      0.9662     0.2492     55.5555
14700     0.1694      0.9451     0.2492     56.9879
14800     0.1598      0.9451     0.2492     55.5859
14900     0.1762      0.9367     0.2492     56.8086
15000     0.1271      0.9684     0.2492     55.8674
15100     0.1612      0.9536     0.2492     56.0010
15200     0.1764      0.9409     0.2492     55.9103
15300     0.2021      0.9283     0.2492     54.9524
15400     0.1518      0.9430     0.2492     56.5107
15500     0.1530      0.9557     0.2492     57.6326
15600     0.1561      0.9430     0.2492     55.9333
15700     0.1804      0.9494     0.2492     55.1791
15800     0.1398      0.9515     0.2492     55.7230
15900     0.2002      0.9388     0.2492     55.2414
16000     0.1828      0.9494     0.2492     55.8828
16100     0.1419      0.9430     0.2492     56.8377
16200     0.1626      0.9473     0.2492     55.7499
16300     0.1493      0.9494     0.2492     56.5431
16400     0.1707      0.9515     0.2492     55.5859
16500     0.1220      0.9620     0.2492     54.9405
16600     0.1442      0.9557     0.2492     57.6232
16700     0.2504      0.9262     0.2492     56.9203
16800     0.1542      0.9409     0.2492     56.7279
16900     0.1272      0.9684     0.2492     56.0869
17000     0.1416      0.9451     0.2492     55.5687
17100     0.1305      0.9620     0.2492     58.1765
17200     0.1585      0.9536     0.2492     56.4330
17300     0.1416      0.9367     0.2492     56.1847
17400     0.1427      0.9599     0.2492     57.2977
17500     0.1851      0.9515     0.2492     55.4227
17600     0.1317      0.9557     0.2492     55.9633
17700     0.1181      0.9557     0.2492     56.3797
17800     0.1812      0.9325     0.2492     55.9559
17900     0.1078      0.9599     0.2492     56.7493
18000     0.1073      0.9599     0.2492     56.1965
18100     0.1414      0.9494     0.2492     57.1213
18200     0.1231      0.9620     0.2492     56.4382
18300     0.1500      0.9494     0.2492     56.6636
18400     0.1921      0.9494     0.2492     56.6854
18500     0.1769      0.9515     0.2492     58.4115
18600     0.1687      0.9409     0.2492     56.3066
18700     0.2237      0.9304     0.2492     56.5642
18800     0.1778      0.9388     0.2492     56.5074
18900     0.1667      0.9578     0.2492     57.0475
19000     0.1418      0.9536     0.2492     57.5101
19100     0.1808      0.9346     0.2492     55.8257
19200     0.1132      0.9662     0.2492     56.0148
19300     0.1372      0.9536     0.2492     55.6548
19400     0.1709      0.9409     0.2492     55.9950
19500     0.1479      0.9494     0.2492     55.6970
19600     0.1441      0.9451     0.2492     56.4108
19700     0.1403      0.9388     0.2492     56.0043
19800     0.1223      0.9536     0.2492     55.9403
19900     0.0874      0.9768     0.2492     55.7160
20000     0.1297      0.9662     0.2492     55.6983
20100     0.0920      0.9726     0.2492     56.6122
20199     0.1225      0.9641     0.2492     56.8365
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     5.5167      0.2300     0.2296     9.8917
00100     2.8543      0.3987     0.3859     56.2823
00200     2.9032      0.4241     0.4386     56.9778
00300     1.5927      0.5928     0.5071     57.5126
00400     1.9007      0.5232     0.5801     55.7977
00500     1.9647      0.5654     0.6085     55.3064
00600     1.6878      0.6139     0.6085     55.9853
00700     1.1235      0.7025     0.6234     56.6822
00800     1.5330      0.6435     0.6503     56.2411
00900     1.5787      0.6688     0.6628     57.6671
01000     1.8001      0.6287     0.6628     55.0903
01100     1.4848      0.6561     0.6628     56.2301
01200     1.4357      0.6857     0.6628     56.3072
01300     1.3430      0.6793     0.6732     56.8849
01400     1.1313      0.7236     0.6773     56.8973
01500     1.2046      0.6857     0.6773     56.2789
01600     1.1143      0.7363     0.7112     56.0305
01700     1.2375      0.7004     0.7112     55.5988
01800     1.0243      0.7321     0.7112     55.3086
01900     1.2267      0.6920     0.7112     57.1751
02000     1.0973      0.7152     0.7112     55.5066
02100     1.3539      0.7046     0.7312     55.3247
02200     1.5144      0.7152     0.7312     56.1069
02300     1.0270      0.7257     0.7312     56.8201
02400     1.2670      0.7215     0.7312     56.4864
02500     1.1282      0.7110     0.7312     56.0242
02600     0.9947      0.7489     0.7364     55.0620
02700     1.3530      0.6835     0.7364     56.3733
02800     1.2648      0.6730     0.7364     55.2343
02900     0.9912      0.7321     0.7387     55.9702
03000     1.0290      0.7532     0.7387     55.6460
03100     1.1234      0.7173     0.7436     56.1735
03200     1.0509      0.7426     0.7506     56.5969
03300     1.2259      0.6519     0.7506     57.3156
03400     0.9037      0.7511     0.7506     56.3771
03500     1.0156      0.7426     0.7506     56.8709
03600     1.1246      0.7046     0.7506     55.3547
03700     0.9255      0.7764     0.7506     55.9981
03800     1.0469      0.7405     0.7658     56.2486
03900     1.2141      0.6878     0.7658     56.1903
04000     0.9990      0.7658     0.7658     56.6598
04100     0.9753      0.7764     0.7658     57.5494
04200     1.0031      0.7658     0.7658     55.9642
04300     1.1216      0.7489     0.7658     57.0629
04400     0.7609      0.7954     0.7672     56.9109
04500     1.1002      0.7384     0.7672     56.2577
04600     0.9239      0.7679     0.7672     56.9448
04700     1.0119      0.7511     0.7672     55.2460
04800     1.0335      0.7004     0.7672     55.9869
04900     0.9767      0.7426     0.7689     56.3438
05000     1.0986      0.7532     0.7700     55.9749
05100     0.9742      0.7532     0.7700     55.6013
05200     0.7915      0.7954     0.7854     56.2361
05300     0.8409      0.8038     0.7854     55.3969
05400     0.7795      0.7996     0.7854     56.8249
05500     0.9263      0.7468     0.7854     55.7173
05600     1.0064      0.7827     0.7854     56.9447
05700     0.9217      0.7363     0.7854     55.8085
05800     0.9165      0.7384     0.7854     55.0632
05900     0.8617      0.7553     0.7854     56.1711
06000     1.2244      0.7257     0.7854     55.1528
06100     1.1195      0.7300     0.7854     55.8677
06200     1.0233      0.7236     0.7971     56.6024
06300     1.0834      0.7426     0.7971     55.9940
06400     0.9651      0.7827     0.7971     56.1138
06500     0.9540      0.7785     0.7971     56.0932
06600     1.4119      0.7110     0.7971     55.8969
06700     0.8974      0.7679     0.7971     56.3655
06800     0.9109      0.7574     0.7971     56.5367
06900     0.8969      0.8038     0.7971     56.1973
07000     0.8805      0.8017     0.7971     56.4131
07100     0.8997      0.7827     0.7971     56.5781
07200     0.9606      0.7574     0.7971     56.1527
07300     0.7919      0.7996     0.7971     56.8811
07400     1.3447      0.7089     0.7971     56.1527
07500     0.9477      0.7722     0.7971     56.4122
07600     0.8630      0.7932     0.7971     55.8772
07700     0.6855      0.8059     0.7994     55.3214
07800     0.8292      0.7975     0.7994     57.2628
07900     0.9125      0.7827     0.7994     55.4935
08000     0.8116      0.8122     0.7994     55.9956
08100     0.7505      0.7764     0.7994     56.2035
08200     0.8093      0.8143     0.7994     55.6471
08300     0.9504      0.7764     0.7994     56.7657
08400     0.7614      0.7911     0.7994     55.5329
08500     0.8009      0.7932     0.7994     55.7391
08600     0.7646      0.8059     0.8068     57.0564
08700     0.7659      0.7954     0.8068     55.9018
08800     0.6430      0.7827     0.8068     56.0287
08900     0.8941      0.7764     0.8068     56.9346
09000     0.8697      0.7890     0.8068     57.4763
09100     0.6131      0.8354     0.8091     56.4687
09200     0.8239      0.7700     0.8091     55.4946
09300     0.7729      0.8017     0.8091     56.1187
09400     1.1317      0.7679     0.8091     56.0861
09500     0.8658      0.7932     0.8091     56.4128
09600     0.9372      0.7700     0.8091     56.8007
09700     0.7316      0.8059     0.8091     58.2153
09800     0.6624      0.8249     0.8091     54.9088
09900     0.7835      0.7975     0.8091     57.8883
Start testing:
Test Accuracy: 0.8612
