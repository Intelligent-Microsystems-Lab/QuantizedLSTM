Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=494, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=235899598, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
0acd4bf9-5814-4ac0-b5cb-335c7d21c76d
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 147, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 374, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 211, in forward
    part2 = CustomMM_bmm.apply(quant_pass(pact_a_bmm(hx, self.a11), self.ib, self.a11), self.weight_hh * w_mask, self.bias_hh, self.noise_level, self.wb, self.bias_r)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 141, in forward
    noise_w = torch.randn(weight.shape, device = input.device) * max_w * nl
RuntimeError: CUDA out of memory. Tried to allocate 16.00 MiB (GPU 0; 11.78 GiB total capacity; 9.52 GiB already allocated; 17.38 MiB free; 10.60 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=494, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=235899598, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
ad221000-42d3-4d22-93e6-ac7c337376be
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     3.8457      0.0900     0.0959     17.3968
00100     1.7311      0.4100     0.5087     58.8073
00200     1.2241      0.6400     0.6442     58.0307
00300     0.9611      0.6400     0.7004     58.1116
00400     0.8967      0.7300     0.7458     60.0049
00500     1.0266      0.7000     0.7521     58.6980
00600     0.7802      0.7200     0.7521     57.8668
00700     0.8150      0.7500     0.7602     59.3562
00800     0.9396      0.7100     0.7808     58.4555
00900     0.7605      0.7700     0.7952     58.7398
01000     0.7387      0.7300     0.8030     58.4970
01100     1.0061      0.7300     0.8030     58.0875
01200     1.0331      0.6400     0.8030     57.8653
01300     0.6848      0.7600     0.8209     59.3598
01400     0.7091      0.7900     0.8241     58.4537
01500     0.5481      0.8300     0.8241     57.8193
01600     0.4999      0.8400     0.8241     57.8518
01700     0.5989      0.7700     0.8241     58.4984
01800     0.6764      0.7500     0.8343     59.5646
01900     0.8299      0.7600     0.8343     59.3788
02000     0.6934      0.8200     0.8343     57.8272
02100     0.8770      0.7100     0.8468     58.6847
02200     0.6232      0.7700     0.8468     57.7983
02300     0.7436      0.8100     0.8468     58.9447
02400     0.6215      0.7800     0.8515     59.6345
02500     0.5472      0.8200     0.8515     57.7716
02600     0.6277      0.8300     0.8515     58.4877
02700     0.4104      0.8600     0.8515     59.3811
02800     0.4396      0.8300     0.8515     58.8292
02900     0.6251      0.8100     0.8515     58.1729
03000     0.7800      0.6900     0.8593     58.0335
03100     0.4740      0.8400     0.8593     58.3868
03200     0.6255      0.7800     0.8623     58.2911
03300     0.6285      0.8000     0.8623     58.4371
03400     0.4007      0.9000     0.8623     59.4472
03500     0.5538      0.8300     0.8623     58.1696
03600     0.5647      0.8500     0.8623     59.0816
03700     0.6462      0.8200     0.8623     57.9904
03800     0.6733      0.7500     0.8623     58.4618
03900     0.5460      0.8600     0.8623     57.0730
04000     0.6208      0.8100     0.8623     58.2179
04100     0.3804      0.9100     0.8682     58.6533
04200     0.5783      0.7800     0.8682     58.5294
04300     0.5108      0.8400     0.8682     58.9653
04400     0.5550      0.7800     0.8682     57.8704
04500     0.7396      0.7800     0.8682     58.0435
04600     0.5170      0.8300     0.8757     58.8443
04700     0.4418      0.8700     0.8757     59.0818
04800     0.4284      0.8800     0.8774     59.8655
04900     0.4760      0.8100     0.8774     60.0034
05000     0.7176      0.7800     0.8774     58.1984
05100     0.5003      0.8200     0.8774     58.8386
05200     0.4185      0.8600     0.8774     59.8376
05300     0.6810      0.7600     0.8774     57.8452
05400     0.4179      0.8900     0.8774     58.8987
05500     0.4076      0.8800     0.8774     58.1827
05600     0.6157      0.8000     0.8774     58.3436
05700     0.5268      0.8600     0.8774     58.2848
05800     0.5598      0.8100     0.8774     57.7310
05900     0.4444      0.8700     0.8774     59.1653
06000     0.5274      0.8300     0.8774     57.8443
06100     0.4185      0.9000     0.8774     58.2369
06200     0.5477      0.8200     0.8807     58.1840
06300     0.4834      0.8500     0.8807     58.6412
06400     0.4561      0.8500     0.8808     59.1354
06500     0.5459      0.8300     0.8813     59.2633
06600     0.5192      0.8100     0.8813     59.4857
06700     0.5542      0.8000     0.8813     58.2526
06800     0.4735      0.8600     0.8813     58.9986
06900     0.3646      0.8800     0.8813     57.6535
07000     0.6638      0.7900     0.8813     58.1117
07100     0.6178      0.7800     0.8813     57.9647
07200     0.3119      0.8700     0.8847     58.5212
07300     0.4586      0.8500     0.8847     60.8921
07400     0.6805      0.8000     0.8847     58.6297
07500     0.3506      0.8700     0.8847     61.4425
07600     0.2838      0.9100     0.8847     59.7547
07700     0.3743      0.8600     0.8847     59.9414
07800     0.4726      0.8800     0.8847     58.9429
07900     0.5132      0.8700     0.8847     59.7214
08000     0.4405      0.8500     0.8847     58.7800
08100     0.4242      0.8600     0.8847     59.7130
08200     0.5138      0.8200     0.8847     60.3792
08300     0.3033      0.9100     0.8847     59.1961
08400     0.5842      0.8200     0.8847     59.6979
08500     0.1944      0.9700     0.8863     60.7565
08600     0.6654      0.7700     0.8863     59.5094
08700     0.4750      0.8300     0.8923     59.1465
08800     0.2987      0.9000     0.8923     57.4081
08900     0.4063      0.8800     0.8923     59.4317
09000     0.4336      0.8700     0.8923     59.2014
09100     0.4140      0.8600     0.8923     59.0356
09200     0.3720      0.8700     0.8923     59.1255
09300     0.2814      0.9300     0.8923     59.5473
09400     0.6058      0.8300     0.8923     58.0866
09500     0.3141      0.9000     0.8923     58.1138
09600     0.5644      0.7700     0.8939     59.1248
09700     0.4165      0.8700     0.8939     58.2994
09800     0.3171      0.8500     0.8939     57.3960
09900     0.4138      0.8700     0.8939     59.7227
10000     0.4676      0.8200     0.8939     58.7740
10100     0.2645      0.9100     0.8939     58.9225
10200     0.3655      0.8900     0.8939     58.7172
10300     0.3885      0.8500     0.8988     59.9471
10400     0.4086      0.8800     0.8988     58.9670
10500     0.4097      0.8600     0.8988     58.6341
10600     0.2648      0.8900     0.8988     59.7031
10700     0.3840      0.8900     0.8988     60.0840
10800     0.1850      0.9400     0.8988     58.6016
10900     0.2941      0.9100     0.8988     58.8284
11000     0.4029      0.8700     0.8988     59.4288
11100     0.3322      0.8900     0.8988     59.8186
11200     0.2568      0.9300     0.8988     61.0734
11300     0.2834      0.9200     0.8988     59.4509
11400     0.3354      0.9100     0.8988     59.3086
11500     0.2702      0.9000     0.8988     60.2738
11600     0.4305      0.8600     0.8988     59.2796
11700     0.3494      0.9000     0.8988     59.1132
11800     0.5694      0.8200     0.8988     58.0288
11900     0.3552      0.8500     0.8988     59.3138
12000     0.2897      0.9200     0.9086     61.1146
12100     0.3122      0.9000     0.9086     58.4458
12200     0.4644      0.8600     0.9086     59.0835
12300     0.3666      0.8700     0.9086     58.8898
12400     0.4242      0.8200     0.9086     60.0656
12500     0.2577      0.9000     0.9086     58.9704
12600     0.4323      0.8700     0.9086     59.3791
12700     0.4150      0.8400     0.9086     60.4859
12800     0.3738      0.8600     0.9086     58.6225
12900     0.2830      0.9300     0.9086     57.7327
13000     0.2428      0.9300     0.9086     58.2612
13100     0.3084      0.9000     0.9086     59.3388
13200     0.2208      0.9100     0.9086     58.0306
13300     0.3530      0.8800     0.9086     59.0162
13400     0.2748      0.9200     0.9086     58.2365
13500     0.3843      0.8500     0.9086     59.9952
13600     0.3959      0.8600     0.9086     59.4991
13700     0.3328      0.9000     0.9086     57.6436
13800     0.3093      0.9300     0.9086     57.5063
13900     0.3065      0.8900     0.9086     60.7322
14000     0.3073      0.9000     0.9086     58.2461
14100     0.4567      0.8300     0.9086     60.3861
14200     0.4139      0.8800     0.9086     60.1852
14300     0.2586      0.8900     0.9086     61.4069
14400     0.3155      0.9000     0.9086     58.6870
14500     0.3530      0.9000     0.9086     58.9852
14600     0.3471      0.8400     0.9086     57.9056
14700     0.4372      0.8600     0.9092     58.8672
14800     0.2780      0.9300     0.9092     58.7554
14900     0.1284      0.9700     0.9092     58.4903
15000     0.2713      0.9400     0.9092     59.5482
15100     0.2857      0.8800     0.9092     58.0090
15200     0.3420      0.9000     0.9092     58.0876
15300     0.2881      0.9300     0.9092     59.1260
15400     0.3621      0.8900     0.9092     59.4124
15500     0.1855      0.9400     0.9092     59.6106
15600     0.2295      0.9600     0.9092     60.9313
15700     0.2176      0.9500     0.9092     59.0653
15800     0.3245      0.8900     0.9092     59.4959
15900     0.2834      0.9100     0.9092     57.9986
16000     0.4476      0.8500     0.9092     57.0928
16100     0.3353      0.9000     0.9092     58.9298
16200     0.3053      0.9100     0.9092     59.3328
16300     0.3932      0.9100     0.9092     59.2404
16400     0.3284      0.9000     0.9092     57.4172
16500     0.3280      0.8700     0.9092     59.5579
16600     0.2542      0.9100     0.9092     57.5812
16700     0.3362      0.8700     0.9092     59.3607
16800     0.3154      0.8900     0.9092     58.1896
16900     0.2435      0.9200     0.9092     59.0327
17000     0.3200      0.8900     0.9092     58.2478
17100     0.3709      0.9000     0.9092     59.1783
17200     0.2504      0.9300     0.9092     58.8631
17300     0.3023      0.8900     0.9092     57.7327
17400     0.4870      0.8700     0.9092     59.1158
17500     0.2795      0.9400     0.9092     59.1214
17600     0.2727      0.9500     0.9092     60.7257
17700     0.2255      0.9300     0.9092     59.9535
17800     0.2861      0.9200     0.9092     59.7600
17900     0.4240      0.8800     0.9092     59.2581
18000     0.1375      0.9700     0.9092     58.8956
18100     0.3462      0.8700     0.9092     59.0919
18200     0.3317      0.9100     0.9092     57.9645
18300     0.2368      0.9100     0.9092     57.6567
18400     0.1959      0.9400     0.9092     58.1927
18500     0.3091      0.9000     0.9092     58.0219
18600     0.3950      0.8600     0.9092     61.4859
18700     0.2739      0.9000     0.9092     60.0916
18800     0.3421      0.8900     0.9092     58.0843
18900     0.3488      0.8900     0.9092     58.2164
19000     0.2297      0.9300     0.9092     58.7552
19100     0.3447      0.8900     0.9092     59.0227
19200     0.2380      0.9200     0.9092     59.0592
19300     0.3005      0.9300     0.9092     58.2745
19400     0.3803      0.8500     0.9092     57.8017
19500     0.3056      0.9100     0.9092     58.4986
19600     0.2064      0.9500     0.9092     57.9282
19700     0.2307      0.9300     0.9092     59.0603
19800     0.2026      0.9400     0.9092     58.8989
19900     0.3553      0.8900     0.9092     58.8541
20000     0.1921      0.9400     0.9092     58.5705
20100     0.3009      0.9100     0.9092     59.5771
20199     0.3211      0.8900     0.9092     58.1835
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     0.4336      0.9000     0.8428     15.3520
00100     0.4003      0.8900     0.9088     59.1464
00200     0.1753      0.9400     0.9100     59.0886
00300     0.3801      0.8500     0.9126     59.2245
00400     0.3865      0.8600     0.9126     58.3523
00500     0.3174      0.9100     0.9126     59.0489
00600     0.2637      0.9200     0.9126     57.2282
00700     0.3430      0.8800     0.9126     58.9597
00800     0.4431      0.8400     0.9126     57.4116
00900     0.1571      0.9700     0.9126     57.3589
01000     0.3188      0.8900     0.9126     58.9801
01100     0.1975      0.9300     0.9126     58.4246
01200     0.3005      0.9200     0.9126     58.8114
01300     0.4411      0.8500     0.9126     59.1101
01400     0.3478      0.8800     0.9126     60.5801
01500     0.3414      0.8800     0.9133     58.2119
01600     0.2160      0.9100     0.9133     58.3408
01700     0.3607      0.9200     0.9133     57.4168
01800     0.1757      0.9500     0.9136     58.1695
01900     0.3016      0.9000     0.9138     59.0489
02000     0.2787      0.9000     0.9152     59.3638
02100     0.2327      0.9100     0.9152     59.0187
02200     0.3017      0.8900     0.9152     59.1177
02300     0.2477      0.9100     0.9152     59.6118
02400     0.2818      0.9200     0.9152     59.0668
02500     0.3003      0.8800     0.9155     59.2653
02600     0.3461      0.8800     0.9155     58.4766
02700     0.3179      0.9300     0.9155     58.9464
02800     0.2142      0.9400     0.9155     59.3707
02900     0.3558      0.8800     0.9155     58.4791
03000     0.3269      0.8900     0.9155     60.0198
03100     0.2398      0.9400     0.9155     58.9803
03200     0.2906      0.9300     0.9155     60.7007
03300     0.3140      0.8900     0.9155     58.4555
03400     0.2213      0.9400     0.9155     60.8347
03500     0.3387      0.9000     0.9172     59.7506
03600     0.3413      0.9200     0.9172     59.0731
03700     0.3622      0.8500     0.9172     57.6682
03800     0.1767      0.9400     0.9172     61.8182
03900     0.2192      0.9400     0.9172     59.1157
04000     0.2320      0.9000     0.9172     61.5832
04100     0.2260      0.8900     0.9172     57.9880
04200     0.3367      0.8700     0.9172     59.3577
04300     0.3442      0.9000     0.9172     59.0808
04400     0.2364      0.9200     0.9172     59.6362
04500     0.2489      0.9200     0.9172     58.2634
04600     0.2761      0.8900     0.9172     61.5035
04700     0.3954      0.8600     0.9172     61.6980
04800     0.3096      0.8900     0.9172     58.7103
04900     0.1968      0.9400     0.9172     58.6720
05000     0.2147      0.9400     0.9172     59.4403
05100     0.2586      0.9300     0.9172     61.3144
05200     0.2949      0.8900     0.9172     59.0094
05300     0.2337      0.9000     0.9172     57.5756
05400     0.2435      0.9200     0.9172     58.3704
05500     0.2576      0.9000     0.9172     59.2376
05600     0.2932      0.8900     0.9172     59.9559
05700     0.2706      0.9000     0.9172     58.3233
05800     0.2489      0.9300     0.9172     59.5299
05900     0.3137      0.8900     0.9172     59.1847
06000     0.2047      0.9200     0.9172     58.4134
06100     0.4013      0.8600     0.9172     58.2402
06200     0.3112      0.9000     0.9172     60.5375
06300     0.3904      0.8800     0.9172     58.7149
06400     0.2367      0.9300     0.9172     59.2001
06500     0.2615      0.9100     0.9172     58.4957
06600     0.3555      0.8500     0.9172     58.2290
06700     0.2232      0.9300     0.9172     58.8296
06800     0.2591      0.9100     0.9172     58.9926
06900     0.3197      0.9000     0.9172     60.0984
07000     0.2231      0.9300     0.9172     58.5209
07100     0.2584      0.9500     0.9172     58.0147
07200     0.2065      0.9200     0.9172     58.0689
07300     0.1626      0.9400     0.9172     57.5917
07400     0.1864      0.9200     0.9172     59.3681
07500     0.2463      0.9200     0.9172     61.3213
07600     0.3226      0.8700     0.9172     60.9514
07700     0.2434      0.9100     0.9172     59.6474
07800     0.2501      0.9200     0.9172     58.4379
07900     0.3372      0.8700     0.9172     57.3215
08000     0.2643      0.9100     0.9172     58.4702
08100     0.3261      0.8800     0.9172     59.8178
08200     0.2642      0.9100     0.9172     60.3746
08300     0.1788      0.9500     0.9172     58.8295
08400     0.1367      0.9400     0.9172     58.8638
08500     0.1670      0.9400     0.9172     58.3888
08600     0.2686      0.9200     0.9172     64.2914
08700     0.2788      0.8900     0.9172     63.5332
08800     0.2411      0.9100     0.9172     65.0964
08900     0.3464      0.9100     0.9172     59.0121
09000     0.2771      0.8800     0.9172     56.7351
09100     0.1470      0.9700     0.9172     55.6351
09200     0.2756      0.9100     0.9172     55.4419
09300     0.2724      0.8900     0.9172     54.9486
09400     0.2215      0.9200     0.9172     54.9188
09500     0.2765      0.8900     0.9172     56.0955
09600     0.2366      0.9100     0.9172     55.2633
09700     0.2583      0.9200     0.9172     61.5942
09800     0.2487      0.9100     0.9172     62.0877
09900     0.2319      0.9400     0.9172     59.5597
Start testing:
Test Accuracy: 0.9042
