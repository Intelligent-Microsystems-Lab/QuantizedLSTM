Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=494, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=193012823, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
8faa29dc-ab5e-4712-9ccf-8a8b8f9669fd
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 167, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 290, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 229, in forward
    activated_input = quant_pass(pact_a_bmm(input_gate_out * activation_out, self.a8), self.abNM, self.a8)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 89, in forward
    x01q =  torch.round(x01 * step_d ) / step_d
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 22.17 GiB total capacity; 19.10 GiB already allocated; 14.50 MiB free; 21.18 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=494, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=193012823, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
7822e7e8-0d6f-4850-952c-ff274fdb8880
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     3.0116      0.0700     0.0847     17.8467
00100     1.4853      0.5700     0.5607     57.9116
00200     1.1295      0.5800     0.6937     57.6277
00300     1.0575      0.6400     0.7348     56.8120
00400     0.8203      0.7300     0.7497     57.4819
00500     0.7608      0.7600     0.7733     56.9958
00600     0.7642      0.8000     0.7963     57.0476
00700     0.7610      0.7800     0.7963     56.6397
00800     0.6677      0.7800     0.8051     57.0798
00900     0.7213      0.7700     0.8184     58.0101
01000     0.7737      0.7800     0.8184     57.2239
01100     0.7564      0.7500     0.8184     56.3784
01200     0.7464      0.7600     0.8184     57.4220
01300     0.7397      0.7400     0.8199     58.5548
01400     0.6140      0.8200     0.8199     57.7364
01500     0.5477      0.8300     0.8349     57.5678
01600     0.9848      0.7500     0.8349     56.6070
01700     0.6304      0.8200     0.8349     56.8667
01800     0.4697      0.8700     0.8426     57.1050
01900     0.8136      0.7400     0.8426     56.7686
02000     0.6318      0.8200     0.8426     57.1876
02100     0.6506      0.7900     0.8426     57.2634
02200     0.6016      0.7800     0.8426     57.3544
02300     0.6411      0.8100     0.8426     57.8649
02400     0.6367      0.8000     0.8426     58.3118
02500     0.6084      0.8400     0.8479     57.8465
02600     0.3636      0.9000     0.8479     56.3436
02700     0.5809      0.8300     0.8494     57.0220
02800     0.4955      0.8500     0.8494     57.3408
02900     0.7284      0.7700     0.8494     56.8253
03000     0.6902      0.7900     0.8494     56.9613
03100     0.8469      0.7000     0.8494     56.7950
03200     0.6757      0.7800     0.8514     59.3026
03300     0.4889      0.8400     0.8514     56.9513
03400     0.4781      0.8700     0.8514     56.5181
03500     0.6384      0.8100     0.8514     56.7987
03600     0.5585      0.8200     0.8514     57.1610
03700     0.5016      0.8300     0.8514     56.4630
03800     0.5626      0.8400     0.8545     57.8199
03900     0.5942      0.8300     0.8545     58.4683
04000     0.6129      0.7600     0.8545     57.1878
04100     0.4872      0.8800     0.8545     57.7059
04200     0.3626      0.9100     0.8584     60.2458
04300     0.4816      0.8500     0.8584     59.3376
04400     0.5055      0.8200     0.8584     59.2211
04500     0.5150      0.8400     0.8606     59.9592
04600     0.4340      0.8400     0.8660     58.1645
04700     0.7547      0.7800     0.8660     57.0709
04800     0.5759      0.8400     0.8660     56.6732
04900     0.5376      0.8200     0.8660     56.2618
05000     0.5296      0.8200     0.8729     57.8268
05100     0.4568      0.8400     0.8729     56.9900
05200     0.5261      0.8500     0.8729     57.2349
05300     0.5467      0.8100     0.8729     57.9800
05400     0.6784      0.7700     0.8729     57.4138
05500     0.6390      0.8000     0.8729     57.8701
05600     0.5190      0.8100     0.8729     57.3406
05700     0.5290      0.8000     0.8729     58.3693
05800     0.5255      0.8700     0.8729     57.3278
05900     0.4589      0.8700     0.8729     56.6507
06000     0.5610      0.8300     0.8729     57.3516
06100     0.7206      0.7700     0.8729     57.1953
06200     0.5283      0.8100     0.8729     56.9878
06300     0.6397      0.7900     0.8729     56.4445
06400     0.4683      0.9000     0.8729     57.0824
06500     0.5653      0.8600     0.8729     58.1701
06600     0.5496      0.8100     0.8729     56.3822
06700     0.5856      0.8300     0.8729     56.4020
06800     0.4401      0.8300     0.8729     57.0239
06900     0.6208      0.8200     0.8729     57.5501
07000     0.7158      0.7700     0.8729     59.8388
07100     0.4499      0.8500     0.8729     59.1903
07200     0.5497      0.8400     0.8729     57.9090
07300     0.5530      0.8300     0.8729     57.3742
07400     0.5386      0.8500     0.8838     57.6740
07500     0.3023      0.9100     0.8838     58.8926
07600     0.5628      0.8400     0.8838     57.9723
07700     0.4909      0.8700     0.8838     57.9805
07800     0.5381      0.8600     0.8838     58.0334
07900     0.5185      0.8200     0.8838     59.3778
08000     0.5870      0.7900     0.8838     57.1425
08100     0.4425      0.9000     0.8838     57.5276
08200     0.2954      0.9200     0.8838     57.6658
08300     0.7127      0.7700     0.8838     57.2119
08400     0.4904      0.8100     0.8838     58.5093
08500     0.6001      0.8300     0.8838     56.9003
08600     0.5519      0.8400     0.8838     57.5030
08700     0.5402      0.8400     0.8838     57.2679
08800     0.5492      0.8200     0.8838     56.5870
08900     0.4358      0.8600     0.8838     59.0067
09000     0.3856      0.9000     0.8838     59.7309
09100     0.5943      0.8100     0.8852     57.6483
09200     0.4662      0.8500     0.8852     57.7759
09300     0.4311      0.8900     0.8852     56.5144
09400     0.4630      0.8900     0.8852     57.8388
09500     0.4367      0.8500     0.8852     57.5670
09600     0.3634      0.8800     0.8852     56.7120
09700     0.6170      0.8100     0.8852     57.3147
09800     0.3679      0.9000     0.8852     58.2182
09900     0.3817      0.8900     0.8852     57.2307
10000     0.3262      0.9300     0.8852     57.2417
10100     0.3313      0.9100     0.8852     57.4667
10200     0.4551      0.8800     0.8852     56.5911
10300     0.5225      0.8100     0.8852     56.9387
10400     0.3998      0.9000     0.8852     56.9154
10500     0.4313      0.8400     0.8852     58.1292
10600     0.3335      0.8700     0.8852     57.1280
10700     0.4904      0.8700     0.8852     56.6624
10800     0.3787      0.8900     0.8852     57.2613
10900     0.3457      0.9000     0.8852     57.9727
11000     0.3299      0.9200     0.8852     57.7255
11100     0.3715      0.8900     0.8858     58.6059
11200     0.3657      0.9300     0.8912     58.7845
11300     0.4498      0.8900     0.8912     56.7653
11400     0.2935      0.9100     0.8912     57.5486
11500     0.4415      0.8500     0.8912     57.4872
11600     0.3311      0.9400     0.8912     57.2728
11700     0.3626      0.9000     0.8912     56.2077
11800     0.3155      0.9100     0.8912     56.6604
11900     0.4293      0.8500     0.8912     57.3499
12000     0.4532      0.8400     0.8912     57.1491
12100     0.4826      0.8400     0.8912     57.1189
12200     0.3139      0.9100     0.8912     57.5417
12300     0.3429      0.9100     0.8912     58.5009
12400     0.4122      0.8700     0.8912     56.9497
12500     0.3126      0.9000     0.8912     56.8597
12600     0.4598      0.8700     0.8912     56.6972
12700     0.2768      0.9300     0.8912     57.1767
12800     0.3203      0.9100     0.8912     58.0514
12900     0.4801      0.8600     0.8912     57.8236
13000     0.3349      0.8900     0.8912     57.5216
13100     0.5731      0.8100     0.8912     56.2557
13200     0.2583      0.9400     0.8912     56.3749
13300     0.4473      0.8700     0.8912     57.1045
13400     0.3935      0.8500     0.8912     57.6638
13500     0.2374      0.9500     0.8912     56.3297
13600     0.3457      0.8700     0.8934     57.0310
13700     0.2769      0.9000     0.8951     57.9513
13800     0.3218      0.9100     0.8978     58.5522
13900     0.3562      0.9000     0.8978     56.6044
14000     0.3325      0.9000     0.8978     56.7824
14100     0.5409      0.8200     0.8978     56.8278
14200     0.2139      0.9400     0.8978     57.1607
14300     0.4213      0.8700     0.8978     56.7870
14400     0.3577      0.8700     0.8978     57.1116
14500     0.4267      0.8900     0.8978     56.9093
14600     0.4229      0.8700     0.8978     57.4445
14700     0.3008      0.9000     0.8978     57.7660
14800     0.4529      0.8800     0.8978     57.9010
14900     0.3316      0.8900     0.8978     57.0078
15000     0.2200      0.9500     0.9022     58.8005
15100     0.3643      0.8900     0.9022     57.8630
15200     0.3839      0.8500     0.9022     57.5396
15300     0.3574      0.8700     0.9022     56.6202
15400     0.3755      0.9200     0.9022     56.3633
15500     0.5848      0.8300     0.9022     57.0588
15600     0.3792      0.9000     0.9022     56.6170
15700     0.3305      0.8900     0.9022     57.0864
15800     0.2030      0.9300     0.9036     58.5771
15900     0.3206      0.9000     0.9036     56.6772
16000     0.3799      0.9000     0.9036     57.5670
16100     0.2833      0.9300     0.9036     58.3915
16200     0.5597      0.8300     0.9036     57.1041
16300     0.2445      0.9400     0.9036     58.5915
16400     0.3118      0.8900     0.9036     57.2996
16500     0.3634      0.8800     0.9036     57.5045
16600     0.3679      0.9100     0.9036     56.9129
16700     0.4073      0.8700     0.9036     57.6261
16800     0.3949      0.8900     0.9036     56.6837
16900     0.3217      0.8800     0.9036     57.8970
17000     0.4245      0.8400     0.9036     57.5161
17100     0.4209      0.8700     0.9036     57.5296
17200     0.3638      0.8900     0.9036     56.8864
17300     0.4177      0.8600     0.9036     56.6949
17400     0.3185      0.9100     0.9036     57.3344
17500     0.3445      0.9100     0.9036     58.0837
17600     0.2874      0.9100     0.9036     57.1076
17700     0.3851      0.8600     0.9036     56.5728
17800     0.4365      0.9000     0.9036     57.3242
17900     0.3005      0.9100     0.9036     56.8616
18000     0.2824      0.9200     0.9036     57.0674
18100     0.4201      0.9000     0.9036     57.2717
18200     0.3033      0.9200     0.9036     57.9052
18300     0.3775      0.9000     0.9036     56.7935
18400     0.4069      0.8700     0.9036     58.1374
18500     0.2469      0.9300     0.9036     57.6690
18600     0.2485      0.9100     0.9036     57.1522
18700     0.3234      0.8900     0.9036     56.8226
18800     0.2893      0.9000     0.9036     56.4836
18900     0.2780      0.9300     0.9036     57.9084
19000     0.2796      0.9100     0.9036     57.1816
19100     0.3108      0.9100     0.9036     57.0016
19200     0.2412      0.9200     0.9036     57.0879
19300     0.4571      0.8200     0.9036     56.7976
19400     0.5342      0.8600     0.9036     56.4028
19500     0.3986      0.8900     0.9036     56.4563
19600     0.3007      0.9200     0.9036     56.8906
19700     0.1743      0.9500     0.9036     57.6629
19800     0.4165      0.8900     0.9036     56.9062
19900     0.3478      0.8900     0.9036     56.9362
20000     0.3418      0.8900     0.9036     56.9383
20100     0.3245      0.9000     0.9036     57.6651
20199     0.4602      0.8600     0.9036     57.4593
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     0.6028      0.8200     0.8765     15.2499
00100     0.3529      0.9000     0.8990     58.2745
00200     0.3845      0.9100     0.8990     56.8455
00300     0.4619      0.8700     0.9020     57.6564
00400     0.3013      0.9200     0.9020     57.7000
00500     0.4340      0.8700     0.9048     57.3065
00600     0.3483      0.9000     0.9048     57.8814
00700     0.2033      0.9600     0.9048     56.9331
00800     0.2641      0.9100     0.9048     56.6777
00900     0.2791      0.9400     0.9048     56.2692
01000     0.2149      0.9200     0.9048     56.6562
01100     0.3886      0.9000     0.9048     56.1481
01200     0.3340      0.9000     0.9048     56.9729
01300     0.2618      0.9300     0.9053     58.1502
01400     0.3379      0.9100     0.9053     57.6908
01500     0.2122      0.9200     0.9056     57.6420
01600     0.2395      0.9300     0.9056     57.3370
01700     0.3734      0.8600     0.9056     56.8252
01800     0.3198      0.9000     0.9056     56.8790
01900     0.3148      0.9200     0.9056     57.6499
02000     0.3516      0.9000     0.9056     57.5172
02100     0.4209      0.8600     0.9056     57.0933
02200     0.3547      0.9000     0.9058     57.2840
02300     0.3109      0.9200     0.9058     57.1721
02400     0.2765      0.9200     0.9058     57.3704
02500     0.1946      0.9700     0.9058     56.9520
02600     0.1618      0.9600     0.9058     56.9700
02700     0.2999      0.9100     0.9058     57.8544
02800     0.3103      0.8900     0.9058     57.2749
02900     0.2704      0.9100     0.9058     57.4996
03000     0.2690      0.9100     0.9058     56.5083
03100     0.4460      0.8900     0.9058     57.0182
03200     0.3046      0.9000     0.9058     56.9829
03300     0.3202      0.8800     0.9058     57.5681
03400     0.2619      0.9200     0.9058     56.9805
03500     0.3406      0.8700     0.9058     57.5208
03600     0.2540      0.9100     0.9058     57.5275
03700     0.3379      0.9000     0.9058     57.3162
03800     0.3873      0.8800     0.9058     56.6310
03900     0.3607      0.9300     0.9058     57.3654
04000     0.3247      0.9200     0.9058     56.9617
04100     0.2611      0.9200     0.9058     57.2983
04200     0.3557      0.8700     0.9058     56.5687
04300     0.3357      0.9000     0.9058     57.7044
04400     0.3927      0.9000     0.9058     57.0515
04500     0.2188      0.9400     0.9058     56.8212
04600     0.2920      0.9300     0.9058     56.6783
04700     0.3841      0.8800     0.9058     57.4111
04800     0.2248      0.9200     0.9058     57.2638
04900     0.3079      0.9100     0.9058     56.8508
05000     0.4343      0.8600     0.9058     57.2516
05100     0.2353      0.9300     0.9058     57.1655
05200     0.2507      0.9400     0.9058     56.3127
05300     0.2934      0.9300     0.9058     57.0935
05400     0.3464      0.9100     0.9058     56.6246
05500     0.3082      0.9200     0.9058     57.7719
05600     0.3705      0.8800     0.9058     57.7541
05700     0.2777      0.9100     0.9058     57.7024
05800     0.3237      0.9100     0.9058     56.5996
05900     0.2432      0.9200     0.9058     57.3123
06000     0.2754      0.9100     0.9070     57.7259
06100     0.1974      0.9500     0.9070     56.8355
06200     0.2736      0.9500     0.9070     56.5639
06300     0.2251      0.9500     0.9070     57.4911
06400     0.2410      0.9300     0.9070     56.6447
06500     0.3088      0.9200     0.9070     57.0461
06600     0.3461      0.8900     0.9070     58.2199
06700     0.2873      0.9100     0.9070     57.3561
06800     0.3937      0.8900     0.9070     57.1915
06900     0.2015      0.9400     0.9070     58.0260
07000     0.4292      0.8600     0.9070     57.5727
07100     0.2460      0.9000     0.9070     58.5293
07200     0.5471      0.8500     0.9070     57.9698
07300     0.3555      0.9000     0.9070     56.5960
07400     0.2505      0.9300     0.9070     57.8531
07500     0.3175      0.9100     0.9070     56.9625
07600     0.3221      0.9100     0.9070     58.4949
07700     0.2945      0.9400     0.9070     57.5915
07800     0.2505      0.9300     0.9070     57.6260
07900     0.2667      0.9300     0.9070     56.3818
08000     0.3183      0.9000     0.9070     57.1171
08100     0.2633      0.9100     0.9070     56.7777
08200     0.2245      0.9400     0.9070     57.6860
08300     0.4419      0.8600     0.9070     58.4619
08400     0.2935      0.9300     0.9070     58.8770
08500     0.3928      0.8900     0.9070     57.2344
08600     0.3788      0.8800     0.9070     57.2606
08700     0.3144      0.9200     0.9070     57.2923
08800     0.2819      0.9100     0.9070     57.1690
08900     0.3125      0.9100     0.9070     59.2253
09000     0.3560      0.8700     0.9070     58.0646
09100     0.2091      0.9500     0.9070     56.7738
09200     0.3039      0.9200     0.9070     57.6311
09300     0.3491      0.8900     0.9070     58.5652
09400     0.2639      0.9000     0.9070     57.3384
09500     0.2807      0.9100     0.9070     56.9404
09600     0.3162      0.9300     0.9070     57.3280
09700     0.2057      0.9400     0.9070     56.2136
09800     0.2616      0.9200     0.9070     57.8519
09900     0.3220      0.9100     0.9070     57.7766
Start testing:
Test Accuracy: 0.9065
