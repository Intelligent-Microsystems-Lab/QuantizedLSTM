Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=14, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.0, noise_injectionT=0.0, pact_a=True, quant_actMVM=8, quant_actNM=8, quant_inp=8, quant_w=8, random_seed=235899598, rows_bias=100, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
0f51bebd-7fff-4e9d-bc45-35fa5dcdf902
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 147, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 289, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 209, in forward
    part1 = CustomMM_bmm.apply(quant_pass(pact_a_bmm(input.repeat(self.n_blocks, 1, 1), self.a1), self.ib, self.a1), self.weight_ih, self.bias_ih, self.noise_level, self.wb, self.bias_r)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 145, in forward
    wq = quant_pass(weight, wb, 1.)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 82, in forward
    if len(x_range) > 1:
TypeError: object of type 'float' has no len()
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=14, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.0, noise_injectionT=0.0, pact_a=True, quant_actMVM=8, quant_actNM=8, quant_inp=8, quant_w=8, random_seed=235899598, rows_bias=100, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
61d0cd7c-1aad-42d4-ab74-7faac2e281dd
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 147, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 289, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 209, in forward
    part1 = CustomMM_bmm.apply(quant_pass(pact_a_bmm(input.repeat(self.n_blocks, 1, 1), self.a1), self.ib, self.a1), self.weight_ih, self.bias_ih, self.noise_level, self.wb, self.bias_r)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 145, in forward
    wq = quant_pass(weight, wb, torch.tensor([1.]))
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 94, in forward
    x_scaled = x/x_range
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=14, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.0, noise_injectionT=0.0, pact_a=True, quant_actMVM=8, quant_actNM=8, quant_inp=8, quant_w=8, random_seed=235899598, rows_bias=100, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
a93a25fe-7e65-4393-9be8-1b637e80778e
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     2.7125      0.0865     0.0729     10.6030
00100     2.2309      0.2764     0.2581     55.1518
00200     1.7906      0.4156     0.4396     52.8296
00300     1.3971      0.5527     0.5679     54.3525
00400     1.3889      0.5738     0.6106     53.5413
00500     1.1784      0.6519     0.6614     53.3610
00600     1.1195      0.6519     0.6769     54.3292
00700     0.8999      0.7532     0.7020     53.2725
00800     1.0184      0.7215     0.7213     53.6914
00900     0.8187      0.7553     0.7398     53.7497
01000     0.9429      0.7215     0.7533     55.0529
01100     0.8898      0.7405     0.7533     54.6720
01200     0.8871      0.7468     0.7615     53.9413
01300     0.7578      0.7700     0.7678     53.8938
01400     0.8365      0.7574     0.7678     54.5177
01500     0.7398      0.7806     0.7678     53.8135
01600     0.8448      0.7173     0.7808     54.5304
01700     0.8624      0.7426     0.7808     54.2239
01800     0.8008      0.7700     0.7808     54.0018
01900     0.7500      0.7679     0.7808     53.8277
02000     0.7453      0.7722     0.7809     54.1736
02100     0.8081      0.7785     0.7928     54.2414
02200     0.7046      0.7658     0.7928     54.3541
02300     0.7311      0.7848     0.7928     54.0220
02400     0.7742      0.7637     0.7928     54.9520
02500     0.7552      0.7764     0.7928     54.1005
02600     0.7000      0.7932     0.8024     53.7368
02700     0.7438      0.7574     0.8024     53.6457
02800     0.6421      0.8059     0.8024     53.6764
02900     0.6820      0.7827     0.8024     53.5031
03000     0.7572      0.7637     0.8044     53.9722
03100     0.7430      0.7764     0.8044     53.8991
03200     0.6691      0.8122     0.8044     54.0450
03300     0.6511      0.7975     0.8044     53.3121
03400     0.7263      0.7911     0.8080     54.2601
03500     0.7941      0.7700     0.8080     53.8426
03600     0.6399      0.7996     0.8080     53.7093
03700     0.7389      0.7764     0.8080     53.0102
03800     0.6982      0.8017     0.8137     54.3860
03900     0.6785      0.7869     0.8137     53.9930
04000     0.6526      0.8165     0.8158     53.8415
04100     0.7363      0.7954     0.8158     53.5760
04200     0.7003      0.7975     0.8158     54.2381
04300     0.7529      0.7869     0.8158     54.1507
04400     0.6084      0.8017     0.8158     53.1468
04500     0.7380      0.7764     0.8158     53.2312
04600     0.6679      0.7954     0.8158     53.7213
04700     0.7266      0.7764     0.8158     53.8249
04800     0.7622      0.7553     0.8158     54.4592
04900     0.7096      0.7827     0.8158     53.4669
05000     0.6742      0.8101     0.8158     53.6292
05100     0.7010      0.7975     0.8158     54.1329
05200     0.6685      0.7954     0.8158     53.1787
05300     0.6933      0.7954     0.8158     53.7646
05400     0.6642      0.7827     0.8158     53.9476
05500     0.7326      0.7932     0.8158     53.5922
05600     0.6706      0.8017     0.8158     54.6239
05700     0.6165      0.8080     0.8158     53.4169
05800     0.5992      0.8122     0.8185     53.7429
05900     0.6562      0.8038     0.8185     54.3880
06000     0.6589      0.7996     0.8185     53.5640
06100     0.6563      0.8017     0.8185     54.0914
06200     0.6408      0.7932     0.8185     54.5187
06300     0.6182      0.8165     0.8185     53.9005
06400     0.5355      0.8418     0.8185     54.2518
06500     0.6769      0.8122     0.8185     53.7832
06600     0.6140      0.8207     0.8185     54.4223
06700     0.6368      0.8038     0.8185     54.2181
06800     0.8208      0.7574     0.8185     54.1022
06900     0.6277      0.8059     0.8185     53.9199
07000     0.6544      0.7954     0.8185     54.2053
07100     0.6081      0.8165     0.8197     53.7377
07200     0.5682      0.8312     0.8197     54.1708
07300     0.5584      0.8312     0.8197     53.4201
07400     0.6834      0.7911     0.8197     53.8540
07500     0.6147      0.8249     0.8197     53.9971
07600     0.6580      0.8059     0.8197     54.1773
07700     0.5612      0.8165     0.8197     53.7065
07800     0.6546      0.8207     0.8197     53.9798
07900     0.6041      0.8270     0.8197     53.7113
08000     0.5942      0.8207     0.8197     53.9588
08100     0.6086      0.8207     0.8204     54.2196
08200     0.5972      0.8207     0.8204     54.3215
08300     0.5620      0.8565     0.8251     54.4484
08400     0.6231      0.8165     0.8251     53.5284
08500     0.6523      0.8122     0.8255     53.6859
08600     0.6000      0.8186     0.8255     54.0686
08700     0.6323      0.7932     0.8255     53.3027
08800     0.5248      0.8460     0.8255     54.8529
08900     0.5836      0.8165     0.8255     53.4788
09000     0.6486      0.8186     0.8255     54.2662
09100     0.6147      0.8228     0.8255     54.4835
09200     0.5758      0.8333     0.8255     53.9413
09300     0.5691      0.8376     0.8255     53.4756
09400     0.6003      0.8207     0.8255     54.4346
09500     0.5808      0.8354     0.8255     53.8984
09600     0.6167      0.8186     0.8255     54.2178
09700     0.6457      0.8080     0.8255     53.5351
09800     0.6399      0.8207     0.8255     53.7068
09900     0.6116      0.8101     0.8257     54.2167
10000     0.6085      0.8101     0.8257     53.8804
10100     0.6131      0.8207     0.8257     53.8033
10200     0.6159      0.8228     0.8257     54.7201
10300     0.7001      0.7700     0.8257     54.2231
10400     0.5885      0.8228     0.8273     54.5490
10500     0.5608      0.8333     0.8273     53.8220
10600     0.5224      0.8502     0.8273     53.2351
10700     0.6703      0.8059     0.8273     54.1585
10800     0.6114      0.8143     0.8273     53.6488
10900     0.5954      0.8228     0.8297     53.7096
11000     0.5657      0.8312     0.8297     54.0430
11100     0.6051      0.8186     0.8297     53.9644
11200     0.6107      0.8143     0.8297     54.1548
11300     0.6033      0.8101     0.8297     53.8225
11400     0.5611      0.8418     0.8297     53.4085
11500     0.5653      0.8122     0.8297     54.6745
11600     0.5073      0.8544     0.8297     53.7171
11700     0.5114      0.8650     0.8297     53.4894
11800     0.5344      0.8397     0.8297     54.5279
11900     0.6818      0.7911     0.8297     53.4717
12000     0.5783      0.8312     0.8297     54.1592
12100     0.5460      0.8354     0.8297     53.7956
12200     0.6379      0.8059     0.8297     53.5600
12300     0.6113      0.8080     0.8297     54.0834
12400     0.5101      0.8586     0.8297     53.2479
12500     0.6020      0.8017     0.8297     53.4328
12600     0.5497      0.8312     0.8297     53.6769
12700     0.6310      0.7996     0.8297     53.9481
12800     0.6233      0.8354     0.8297     53.9372
12900     0.6063      0.8312     0.8297     53.8986
13000     0.6127      0.8143     0.8297     54.2662
13100     0.6214      0.8312     0.8297     54.7690
13200     0.6071      0.7954     0.8317     53.1843
13300     0.5896      0.8354     0.8317     53.6048
13400     0.6484      0.8059     0.8317     53.9161
13500     0.5454      0.8270     0.8317     54.1935
13600     0.5285      0.8397     0.8317     54.3448
13700     0.6050      0.8101     0.8317     54.3626
13800     0.5393      0.8376     0.8317     54.0207
13900     0.6367      0.8143     0.8319     54.1804
14000     0.5019      0.8629     0.8319     53.4002
14100     0.5580      0.8397     0.8319     54.1509
14200     0.5587      0.8333     0.8337     54.5966
14300     0.5595      0.8439     0.8337     54.6966
14400     0.5054      0.8523     0.8337     54.9904
14500     0.5728      0.8270     0.8337     54.5565
14600     0.5564      0.8376     0.8337     53.6728
14700     0.6013      0.8312     0.8362     53.9228
14800     0.5047      0.8418     0.8362     53.3578
14900     0.5924      0.8186     0.8362     54.1027
15000     0.6328      0.8038     0.8362     54.6588
15100     0.5960      0.8186     0.8362     53.9857
15200     0.5299      0.8502     0.8362     54.5421
15300     0.6001      0.8270     0.8362     53.7120
15400     0.6058      0.8207     0.8362     54.0231
15500     0.4914      0.8565     0.8362     54.2253
15600     0.5741      0.8270     0.8362     54.2498
15700     0.5319      0.8481     0.8362     54.1946
15800     0.5369      0.8460     0.8362     54.2784
15900     0.5449      0.8376     0.8362     54.3075
16000     0.5606      0.8333     0.8362     54.3550
16100     0.6193      0.8122     0.8362     54.0893
16200     0.5654      0.8249     0.8362     54.1010
16300     0.6393      0.7848     0.8362     54.5328
16400     0.5762      0.8291     0.8362     53.7345
16500     0.6737      0.7954     0.8362     53.7437
16600     0.5409      0.8502     0.8362     53.9454
16700     0.5279      0.8439     0.8362     53.7061
16800     0.5149      0.8376     0.8362     54.7077
16900     0.6399      0.8207     0.8362     53.2754
17000     0.5301      0.8565     0.8362     53.8722
17100     0.6423      0.8059     0.8362     53.9260
17200     0.5599      0.8460     0.8362     53.9126
17300     0.6072      0.8059     0.8362     54.0706
17400     0.6475      0.8228     0.8362     54.3351
17500     0.5100      0.8376     0.8375     53.7122
17600     0.5850      0.8312     0.8375     54.1885
17700     0.5740      0.8186     0.8375     53.7247
17800     0.5628      0.8354     0.8375     54.1398
17900     0.5541      0.8270     0.8375     54.2707
18000     0.6047      0.8270     0.8375     53.5239
18100     0.5628      0.8249     0.8375     54.1586
18200     0.5727      0.8270     0.8375     54.6021
18300     0.5794      0.8291     0.8375     54.2420
18400     0.5932      0.8101     0.8375     54.5786
18500     0.5777      0.8397     0.8375     54.3235
18600     0.5446      0.8333     0.8375     53.6129
18700     0.5727      0.8312     0.8375     54.1684
18800     0.5976      0.8122     0.8375     53.3380
18900     0.5957      0.8165     0.8375     54.4692
19000     0.5247      0.8418     0.8375     54.5021
19100     0.5593      0.8354     0.8380     53.9343
19200     0.5431      0.8249     0.8380     54.5366
19300     0.5071      0.8586     0.8380     53.6902
19400     0.5471      0.8418     0.8380     54.2486
19500     0.5252      0.8333     0.8380     54.0362
19600     0.5734      0.8333     0.8380     53.1992
19700     0.5714      0.8291     0.8380     54.4962
19800     0.5267      0.8439     0.8380     54.0484
19900     0.6035      0.8207     0.8380     53.9590
20000     0.6410      0.8165     0.8380     54.5543
20100     0.5571      0.8207     0.8380     53.7546
20199     0.5848      0.8101     0.8380     53.8489
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     0.5476      0.8249     0.8305     9.3083
00100     0.5087      0.8460     0.8356     54.5631
00200     0.5000      0.8586     0.8373     54.3792
00300     0.4754      0.8608     0.8404     54.6619
00400     0.4965      0.8502     0.8404     54.2841
00500     0.4619      0.8734     0.8404     53.6222
00600     0.5139      0.8502     0.8419     53.8209
00700     0.5221      0.8291     0.8419     53.6121
00800     0.4796      0.8692     0.8419     53.2394
00900     0.3788      0.8945     0.8419     54.2683
01000     0.4489      0.8713     0.8419     53.9468
01100     0.5936      0.8143     0.8419     53.9976
01200     0.5013      0.8523     0.8419     53.0778
01300     0.4415      0.8692     0.8419     53.9645
01400     0.4694      0.8797     0.8419     54.2343
01500     0.5378      0.8376     0.8419     53.2360
01600     0.5183      0.8565     0.8419     53.3287
01700     0.4516      0.8671     0.8426     53.7243
01800     0.4647      0.8608     0.8426     53.4066
01900     0.5092      0.8713     0.8429     53.4596
02000     0.4873      0.8481     0.8429     53.3160
02100     0.4585      0.8650     0.8429     53.8613
02200     0.5586      0.8418     0.8429     54.1223
02300     0.5918      0.8143     0.8429     53.4643
02400     0.4925      0.8460     0.8429     53.3710
02500     0.5648      0.8312     0.8429     53.6251
02600     0.4358      0.8797     0.8429     53.2500
02700     0.4515      0.8671     0.8429     53.3512
02800     0.4520      0.8692     0.8429     53.4485
02900     0.4731      0.8629     0.8429     53.2092
03000     0.4924      0.8523     0.8429     53.6883
03100     0.4723      0.8650     0.8429     53.6237
03200     0.3804      0.8924     0.8429     53.4551
03300     0.4497      0.8692     0.8429     54.0252
03400     0.4622      0.8608     0.8429     53.1546
03500     0.4600      0.8629     0.8429     54.2395
03600     0.5068      0.8502     0.8429     53.6117
03700     0.4141      0.8734     0.8429     53.3779
03800     0.4797      0.8608     0.8429     54.0642
03900     0.5733      0.8249     0.8429     53.7870
04000     0.4659      0.8565     0.8429     53.9420
04100     0.4154      0.8755     0.8429     53.8825
04200     0.4220      0.8734     0.8429     53.3812
04300     0.4224      0.8840     0.8429     53.8565
04400     0.4761      0.8586     0.8429     53.3771
04500     0.5103      0.8523     0.8429     53.3698
04600     0.4672      0.8481     0.8440     53.5394
04700     0.4782      0.8692     0.8440     53.5064
04800     0.4818      0.8523     0.8440     53.6634
04900     0.4765      0.8565     0.8440     54.4069
05000     0.5098      0.8523     0.8440     53.6737
05100     0.5096      0.8586     0.8440     54.6172
05200     0.5086      0.8333     0.8440     54.0618
05300     0.5001      0.8460     0.8440     53.7391
05400     0.4856      0.8439     0.8440     54.9680
05500     0.3921      0.9030     0.8440     53.6471
05600     0.4878      0.8397     0.8440     53.9335
05700     0.5436      0.8249     0.8440     54.8237
05800     0.5467      0.8207     0.8440     54.1570
05900     0.5122      0.8354     0.8447     54.3355
06000     0.4400      0.8797     0.8447     53.8385
06100     0.4769      0.8565     0.8447     53.6315
06200     0.5133      0.8502     0.8447     54.8641
06300     0.3673      0.8966     0.8447     54.3590
06400     0.4839      0.8586     0.8447     53.6944
06500     0.5427      0.8228     0.8465     53.9424
06600     0.5045      0.8354     0.8465     54.1955
06700     0.4338      0.8713     0.8465     53.8267
06800     0.5076      0.8397     0.8465     53.8574
06900     0.4772      0.8333     0.8465     54.5777
07000     0.4593      0.8586     0.8465     54.5362
07100     0.4524      0.8692     0.8465     54.3495
07200     0.5181      0.8376     0.8465     54.1279
07300     0.4382      0.8840     0.8465     54.9391
07400     0.4830      0.8586     0.8465     54.5253
07500     0.4658      0.8650     0.8465     55.4336
07600     0.5080      0.8460     0.8465     54.2597
07700     0.4450      0.8608     0.8465     54.1204
07800     0.4777      0.8734     0.8465     54.6993
07900     0.4790      0.8523     0.8485     54.5862
08000     0.5304      0.8502     0.8485     56.7638
08100     0.4282      0.8629     0.8485     54.7829
08200     0.4593      0.8776     0.8486     54.9660
08300     0.4134      0.8692     0.8486     57.2725
08400     0.4187      0.8861     0.8486     56.2979
08500     0.5345      0.8418     0.8486     55.4074
08600     0.5591      0.8376     0.8486     55.9860
08700     0.4195      0.8840     0.8486     55.7060
08800     0.4983      0.8671     0.8486     57.0738
08900     0.4160      0.8861     0.8486     57.0804
09000     0.4927      0.8354     0.8486     55.1751
09100     0.4525      0.8650     0.8486     56.3385
09200     0.4402      0.8755     0.8486     55.5108
09300     0.5136      0.8502     0.8486     54.4423
09400     0.5039      0.8418     0.8486     55.8001
09500     0.4941      0.8502     0.8486     54.2107
09600     0.4302      0.8840     0.8486     54.2066
09700     0.4359      0.8797     0.8486     54.3641
09800     0.4321      0.8671     0.8486     53.5786
09900     0.4938      0.8629     0.8486     54.5990
Start testing:
Test Accuracy: 0.8288
