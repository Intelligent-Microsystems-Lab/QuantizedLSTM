Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=512, canonical_testing=False, cs=0.5, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, hidden=107, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=235899598, rows_bias=7, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=640, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
6902f9b4-f775-498c-bcc0-ddcaf5aa9992
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 161, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 289, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 221, in forward
    forget_gate_out = quant_pass(pact_a_bmm(torch.sigmoid(f), self.a3), self.abNM, self.a3)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 89, in forward
    x01q =  torch.round(x01 * step_d ) / step_d
RuntimeError: CUDA out of memory. Tried to allocate 2.00 MiB (GPU 0; 10.76 GiB total capacity; 8.38 GiB already allocated; 3.12 MiB free; 9.80 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=512, canonical_testing=False, cs=0.5, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, hidden=107, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=235899598, rows_bias=7, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=640, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
3c999307-8220-47fd-befd-2a3a90846476
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     2.5757      0.0703     0.1117     10.2733
00100     1.5190      0.5117     0.5352     54.3111
00200     1.2327      0.6074     0.6475     55.5173
00300     1.0531      0.6953     0.7169     54.1232
00400     0.9975      0.6895     0.7477     54.3710
00500     0.9143      0.6973     0.7679     53.3816
00600     0.8771      0.7227     0.7927     55.7973
00700     0.8344      0.7383     0.8005     54.1115
00800     0.8817      0.7207     0.8005     54.7946
00900     0.7853      0.7676     0.8005     53.7542
01000     0.7243      0.7617     0.8141     54.8192
01100     0.7089      0.7637     0.8191     55.5103
01200     0.8861      0.7109     0.8191     54.2620
01300     0.6910      0.8047     0.8191     54.0140
01400     0.6641      0.8008     0.8191     54.7532
01500     0.7861      0.7500     0.8191     55.7139
01600     0.7371      0.7676     0.8191     54.4358
01700     0.7131      0.7812     0.8214     53.8135
01800     0.6732      0.7910     0.8214     54.1848
01900     0.7182      0.7871     0.8214     54.4364
02000     0.7298      0.7715     0.8214     53.2379
02100     0.6468      0.8027     0.8214     54.6778
02200     0.6424      0.7930     0.8214     53.8524
02300     0.7567      0.7812     0.8214     54.4234
02400     0.6470      0.8086     0.8258     55.2467
02500     0.6612      0.7910     0.8258     54.7130
02600     0.6696      0.7949     0.8258     54.6500
02700     0.6092      0.7930     0.8258     54.4801
02800     0.6810      0.7891     0.8314     54.2816
02900     0.6012      0.8203     0.8314     55.1447
03000     0.6650      0.8047     0.8314     54.2565
03100     0.5710      0.8281     0.8314     53.9252
03200     0.6094      0.8145     0.8314     54.5966
03300     0.6672      0.7910     0.8314     55.1470
03400     0.6548      0.7910     0.8314     55.3457
03500     0.6995      0.7852     0.8314     55.2240
03600     0.6610      0.8125     0.8314     54.8636
03700     0.6823      0.7969     0.8314     56.0742
03800     0.6413      0.8027     0.8314     53.5399
03900     0.6212      0.7969     0.8468     54.2124
04000     0.6969      0.7832     0.8468     53.6157
04100     0.6435      0.8145     0.8468     54.5562
04200     0.7056      0.7949     0.8468     54.4997
04300     0.5722      0.8301     0.8468     54.5368
04400     0.5748      0.8359     0.8514     56.7311
04500     0.5881      0.8320     0.8514     54.5022
04600     0.7666      0.7793     0.8514     53.8160
04700     0.6012      0.8398     0.8514     54.4604
04800     0.5139      0.8418     0.8514     55.5870
04900     0.6476      0.7988     0.8514     53.2856
05000     0.6117      0.8047     0.8514     54.8710
05100     0.6381      0.8164     0.8514     54.0635
05200     0.6266      0.8105     0.8514     55.3023
05300     0.6052      0.8145     0.8514     54.6662
05400     0.6084      0.8027     0.8514     55.1110
05500     0.6033      0.8203     0.8514     53.7939
05600     0.6103      0.8047     0.8514     55.6217
05700     0.5559      0.8418     0.8514     53.7532
05800     0.5972      0.8125     0.8514     54.6313
05900     0.5880      0.8203     0.8514     54.6154
06000     0.5447      0.8340     0.8514     56.2536
06100     0.5782      0.8281     0.8626     54.1786
06200     0.5519      0.8379     0.8626     54.0856
06300     0.6321      0.8145     0.8626     54.7218
06400     0.5705      0.8301     0.8626     54.3702
06500     0.5445      0.8516     0.8626     54.0897
06600     0.5112      0.8516     0.8626     55.2835
06700     0.6048      0.8203     0.8626     54.0115
06800     0.5770      0.8301     0.8626     54.3742
06900     0.5741      0.8301     0.8626     55.8453
07000     0.6031      0.8281     0.8626     54.3689
07100     0.5209      0.8438     0.8626     54.3863
07200     0.5531      0.8164     0.8626     54.3065
07300     0.5400      0.8320     0.8626     55.5475
07400     0.5024      0.8691     0.8626     53.8798
07500     0.5786      0.8379     0.8626     53.8736
07600     0.5109      0.8496     0.8626     55.6118
07700     0.5640      0.8301     0.8626     53.7839
07800     0.4820      0.8477     0.8626     55.4258
07900     0.5987      0.8086     0.8626     54.4622
08000     0.5863      0.8086     0.8626     54.3847
08100     0.4998      0.8535     0.8626     54.3356
08200     0.4070      0.8887     0.8626     56.2739
08300     0.5058      0.8574     0.8626     55.1588
08400     0.5364      0.8535     0.8626     54.8236
08500     0.6181      0.8145     0.8626     54.2545
08600     0.5529      0.8320     0.8626     54.3644
08700     0.4430      0.8789     0.8626     54.4331
08800     0.6212      0.8145     0.8626     54.6452
08900     0.5273      0.8320     0.8626     55.1718
09000     0.5518      0.8477     0.8626     53.8340
09100     0.4651      0.8555     0.8626     53.3145
09200     0.4915      0.8477     0.8626     55.8271
09300     0.5110      0.8516     0.8626     55.9170
09400     0.5895      0.8223     0.8626     54.4877
09500     0.5160      0.8477     0.8626     54.2074
09600     0.6047      0.8184     0.8626     53.9708
09700     0.4846      0.8574     0.8626     54.5446
09800     0.5637      0.8359     0.8626     54.7139
09900     0.4212      0.8750     0.8626     54.6562
10000     0.5756      0.8262     0.8626     55.3666
10100     0.4979      0.8516     0.8626     55.4179
10200     0.4840      0.8496     0.8626     53.9026
10300     0.5008      0.8594     0.8626     54.3484
10400     0.4845      0.8574     0.8626     53.4930
10500     0.4469      0.8711     0.8626     55.4909
10600     0.4714      0.8594     0.8626     53.7776
10700     0.4299      0.8711     0.8626     54.3439
10800     0.4962      0.8477     0.8626     54.7232
10900     0.5229      0.8320     0.8626     55.0697
11000     0.5487      0.8320     0.8626     54.4626
11100     0.4926      0.8457     0.8626     54.1206
11200     0.4790      0.8574     0.8626     54.3040
11300     0.4631      0.8652     0.8626     54.9401
11400     0.4855      0.8555     0.8626     55.0982
11500     0.4860      0.8496     0.8626     55.6314
11600     0.4989      0.8535     0.8626     54.5518
11700     0.5636      0.8320     0.8626     55.7332
11800     0.4543      0.8770     0.8626     54.7882
11900     0.5264      0.8320     0.8626     53.7881
12000     0.4808      0.8594     0.8626     54.1890
12100     0.4607      0.8574     0.8626     54.8034
12200     0.4546      0.8594     0.8626     53.6775
12300     0.4752      0.8613     0.8626     54.4691
12400     0.3954      0.8730     0.8626     54.7943
12500     0.4608      0.8672     0.8626     54.1107
12600     0.4312      0.8770     0.8626     54.9375
12700     0.4852      0.8555     0.8626     54.7059
12800     0.5123      0.8535     0.8626     55.3165
12900     0.4593      0.8613     0.8626     54.9838
13000     0.4733      0.8633     0.8626     54.3601
13100     0.4832      0.8613     0.8626     55.8533
13200     0.4336      0.8711     0.8626     55.8766
13300     0.4407      0.8574     0.8626     54.6783
13400     0.4117      0.8984     0.8626     54.2107
13500     0.4416      0.8867     0.8626     55.0485
13600     0.3981      0.8887     0.8626     54.6429
13700     0.4180      0.8809     0.8626     54.8186
13800     0.4137      0.8711     0.8626     55.3228
13900     0.4240      0.8828     0.8626     55.1540
14000     0.4634      0.8496     0.8626     54.9193
14100     0.4310      0.8633     0.8626     54.7098
14200     0.4248      0.8730     0.8626     54.8240
14300     0.4080      0.8887     0.8626     55.4315
14400     0.4834      0.8633     0.8626     53.9235
14500     0.4469      0.8730     0.8626     54.7410
14600     0.4302      0.8730     0.8626     54.0722
14700     0.4122      0.8770     0.8626     53.7783
14800     0.4175      0.8770     0.8626     54.0727
14900     0.4496      0.8535     0.8626     54.5403
15000     0.4525      0.8535     0.8626     54.4253
15100     0.3801      0.8945     0.8626     55.9105
15200     0.4262      0.8633     0.8626     53.9891
15300     0.4925      0.8477     0.8626     54.6172
15400     0.4611      0.8613     0.8626     54.5457
15500     0.4771      0.8613     0.8626     53.8666
15600     0.4442      0.8750     0.8626     54.2288
15700     0.4793      0.8477     0.8626     54.3677
15800     0.4504      0.8652     0.8626     54.7602
15900     0.5049      0.8594     0.8626     54.8704
16000     0.4345      0.8828     0.8626     53.7720
16100     0.4663      0.8555     0.8626     54.9435
16200     0.4402      0.8730     0.8626     54.2055
16300     0.4329      0.8691     0.8626     54.7825
16400     0.4514      0.8691     0.8626     55.6411
16500     0.4419      0.8711     0.8626     55.4608
16600     0.4229      0.8906     0.8626     55.6553
16700     0.3877      0.8906     0.8626     53.7642
16800     0.4344      0.8672     0.8626     55.5097
16900     0.3979      0.8965     0.8626     55.1314
17000     0.4593      0.8613     0.8626     54.7959
17100     0.4681      0.8691     0.8626     54.2840
17200     0.4751      0.8535     0.8626     55.3806
17300     0.4349      0.8574     0.8626     54.2474
17400     0.4603      0.8594     0.8626     54.3896
17500     0.4330      0.8828     0.8626     53.7326
17600     0.4721      0.8672     0.8626     53.9571
17700     0.4343      0.8652     0.8626     54.5331
17800     0.4390      0.8828     0.8626     54.2539
17900     0.4259      0.8770     0.8626     54.1875
18000     0.4480      0.8770     0.8626     55.0492
18100     0.3643      0.8984     0.8626     54.2495
18200     0.4981      0.8633     0.8626     55.4668
18300     0.4667      0.8691     0.8626     54.2932
18400     0.4471      0.8750     0.8736     54.9175
18500     0.4828      0.8652     0.8736     55.3184
18600     0.3743      0.8867     0.8736     53.8678
18700     0.4456      0.8750     0.8736     54.6786
18800     0.4244      0.8750     0.8736     54.5582
18900     0.4469      0.8613     0.8736     54.0458
19000     0.4216      0.8809     0.8736     55.3169
19100     0.4647      0.8477     0.8736     54.1513
19200     0.4630      0.8633     0.8736     54.3691
19300     0.4542      0.8711     0.8736     54.7207
19400     0.4439      0.8770     0.8736     54.3862
19500     0.4488      0.8672     0.8736     53.4516
19600     0.4515      0.8691     0.8736     55.0409
19700     0.4449      0.8828     0.8736     54.7927
19800     0.4979      0.8516     0.8736     55.0756
19900     0.5013      0.8438     0.8736     54.9943
20000     0.3871      0.8848     0.8736     53.7524
20100     0.4925      0.8613     0.8736     55.9635
20199     0.3912      0.8887     0.8736     54.1854
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     0.6541      0.7949     0.8110     8.9538
00100     0.4529      0.8613     0.8810     54.8391
00200     0.4398      0.8730     0.8883     55.8696
00300     0.4029      0.8809     0.8883     53.8897
00400     0.4202      0.8867     0.8883     55.1631
00500     0.3967      0.8984     0.8883     53.6340
00600     0.4438      0.8730     0.8936     54.5728
00700     0.4724      0.8496     0.8936     54.6746
00800     0.4668      0.8477     0.8936     55.3719
00900     0.4811      0.8574     0.8936     54.7900
01000     0.4507      0.8457     0.8936     54.1889
01100     0.4484      0.8652     0.8936     54.5681
01200     0.4774      0.8574     0.8936     56.0550
01300     0.4325      0.8711     0.8936     53.6271
01400     0.4286      0.8789     0.8969     53.8929
01500     0.4522      0.8594     0.8969     54.2207
01600     0.4361      0.8555     0.8969     54.2919
01700     0.4243      0.8809     0.8969     55.5562
01800     0.4443      0.8809     0.8969     54.3465
01900     0.4372      0.8789     0.8969     53.9690
02000     0.4386      0.8828     0.8969     54.7889
02100     0.4376      0.8652     0.8969     53.7978
02200     0.4331      0.8691     0.8969     53.9870
02300     0.4471      0.8652     0.8969     55.5242
02400     0.5156      0.8398     0.8969     53.9671
02500     0.5416      0.8359     0.8969     54.1381
02600     0.4118      0.8848     0.8969     55.0831
02700     0.3976      0.8887     0.8969     54.7443
02800     0.4849      0.8457     0.8969     54.2539
02900     0.4233      0.8789     0.8969     54.3194
03000     0.4723      0.8730     0.8969     54.3798
03100     0.4290      0.8848     0.8969     53.4209
03200     0.4751      0.8496     0.8979     54.1334
03300     0.4490      0.8750     0.8980     55.0977
03400     0.3440      0.9160     0.8980     54.1427
03500     0.4115      0.8828     0.8980     54.5566
03600     0.4462      0.8672     0.8980     54.4324
03700     0.4345      0.8672     0.8980     53.9290
03800     0.4750      0.8457     0.8980     54.3643
03900     0.4515      0.8594     0.8980     54.1258
04000     0.4494      0.8555     0.8980     53.8654
04100     0.4062      0.8926     0.8980     53.3937
04200     0.4157      0.8887     0.8980     54.4966
04300     0.4072      0.8828     0.8980     54.6729
04400     0.4517      0.8652     0.8980     54.6087
04500     0.4620      0.8574     0.8980     54.6710
04600     0.5284      0.8398     0.8980     53.9718
04700     0.4318      0.8555     0.8980     53.4612
04800     0.3514      0.9062     0.8980     54.6955
04900     0.4118      0.8867     0.8980     56.4257
05000     0.4733      0.8535     0.8980     54.2333
05100     0.3985      0.8711     0.8980     54.8087
05200     0.3987      0.8730     0.8980     54.3227
05300     0.4426      0.8770     0.8980     54.1380
05400     0.4886      0.8633     0.8980     54.4530
05500     0.3847      0.8945     0.8980     54.0667
05600     0.4438      0.8848     0.8980     54.5167
05700     0.4349      0.8848     0.8980     54.7496
05800     0.4041      0.8828     0.8980     52.9568
05900     0.4085      0.8789     0.8980     53.9752
06000     0.4199      0.8672     0.8980     54.4250
06100     0.4237      0.8633     0.8980     55.2062
06200     0.5033      0.8379     0.8980     54.1210
06300     0.3939      0.8848     0.8980     54.7384
06400     0.4644      0.8535     0.8980     54.0513
06500     0.4502      0.8613     0.8980     53.4095
06600     0.4190      0.8711     0.8980     55.0526
06700     0.4468      0.8535     0.8980     53.2921
06800     0.4652      0.8633     0.8980     53.7476
06900     0.4398      0.8691     0.8980     54.6043
07000     0.3948      0.8945     0.8980     53.8622
07100     0.3417      0.9023     0.8980     53.8221
07200     0.4931      0.8555     0.8980     55.4095
07300     0.4432      0.8633     0.8980     53.9259
07400     0.4558      0.8691     0.8980     54.0242
07500     0.3565      0.8926     0.8980     53.8825
07600     0.4107      0.8828     0.8980     54.8824
07700     0.4786      0.8672     0.8980     54.4434
07800     0.3885      0.8926     0.8982     54.4924
07900     0.4617      0.8594     0.8982     53.9880
08000     0.4024      0.8809     0.8982     54.3343
08100     0.4646      0.8652     0.8982     53.8018
08200     0.3869      0.8984     0.8982     54.1603
08300     0.4150      0.8848     0.8982     53.9954
08400     0.4229      0.8672     0.8982     53.2972
08500     0.4649      0.8633     0.8982     54.5973
08600     0.4918      0.8496     0.8982     53.3976
08700     0.4255      0.8711     0.8982     54.5257
08800     0.4603      0.8672     0.8982     52.9644
08900     0.4460      0.8691     0.8982     52.9906
09000     0.3761      0.8906     0.8982     54.6083
09100     0.4134      0.8789     0.8982     53.0820
09200     0.4710      0.8730     0.8982     53.2923
09300     0.4034      0.8984     0.8982     53.9776
09400     0.4382      0.8672     0.8982     52.5020
09500     0.4857      0.8535     0.8982     53.7545
09600     0.4836      0.8477     0.8982     54.3132
09700     0.4734      0.8594     0.8988     53.8377
09800     0.4225      0.8867     0.8988     54.9077
09900     0.4024      0.8789     0.8988     53.3853
Start testing:
Test Accuracy: 0.8784
