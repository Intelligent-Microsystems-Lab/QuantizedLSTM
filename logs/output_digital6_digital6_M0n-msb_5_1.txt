Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=108, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=0, n_mfcc=40, n_msb=5, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=235899598, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
9d2de710-99d4-430a-8de8-be7936b3b188
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 167, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 290, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 213, in forward
    gates = quant_pass(pact_a_bmm( quant_pass(pact_a_bmm(part1, self.a12), self.abMVM, self.a12) + quant_pass(pact_a_bmm(part2, self.a13), self.abMVM, self.a13), self.a14), self.abNM, self.a14)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 87, in forward
    x01 = torch.clamp(x_scaled,-1+(1./step_d),1-(1./step_d))
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 10.76 GiB total capacity; 9.60 GiB already allocated; 3.12 MiB free; 9.80 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=108, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=0, n_mfcc=40, n_msb=5, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=235899598, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
af30618e-c486-4c60-a7b0-feb7d3dcf4e2
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     2.9240      0.1160     0.0832     10.9872
00100     1.5457      0.4810     0.1121     55.5784
00200     1.0498      0.6751     0.1121     53.9027
00300     0.8053      0.7489     0.1121     55.1344
00400     0.6671      0.8038     0.1121     55.8873
00500     0.5585      0.8080     0.1121     55.1679
00600     0.5635      0.8143     0.1121     54.7387
00700     0.4273      0.8734     0.1121     53.9792
00800     0.4856      0.8418     0.1121     54.4785
00900     0.4637      0.8586     0.1121     55.0743
01000     0.5280      0.8418     0.1121     54.3341
01100     0.3943      0.8861     0.1121     53.7942
01200     0.4032      0.8776     0.1174     55.5691
01300     0.2897      0.9241     0.1174     54.4815
01400     0.3870      0.8966     0.1174     55.8613
01500     0.4197      0.8776     0.1174     53.7646
01600     0.3278      0.9051     0.1174     55.0332
01700     0.3801      0.8840     0.1174     54.7691
01800     0.3387      0.8924     0.1208     54.1193
01900     0.3363      0.9072     0.1219     53.7197
02000     0.2938      0.9093     0.1231     53.7414
02100     0.3711      0.9093     0.1338     54.5774
02200     0.3309      0.8903     0.1338     55.9773
02300     0.3815      0.8755     0.1338     54.9523
02400     0.3011      0.9219     0.1338     54.4104
02500     0.3661      0.8945     0.1338     53.4759
02600     0.2792      0.9219     0.1338     54.5223
02700     0.3404      0.9072     0.1338     56.2627
02800     0.2815      0.9135     0.1338     55.4795
02900     0.3395      0.9051     0.1338     53.7587
03000     0.2689      0.9241     0.1338     54.1634
03100     0.2523      0.9304     0.1338     54.1554
03200     0.2375      0.9283     0.1397     55.1386
03300     0.2989      0.9093     0.1397     54.0796
03400     0.2863      0.9198     0.1397     53.6444
03500     0.3105      0.9198     0.1397     54.0415
03600     0.2404      0.9325     0.1397     54.1409
03700     0.2588      0.9325     0.1441     54.3779
03800     0.3491      0.9008     0.1441     54.2637
03900     0.3206      0.9093     0.1446     54.8233
04000     0.2593      0.9241     0.1504     54.6211
04100     0.2117      0.9473     0.1504     53.6691
04200     0.2629      0.9241     0.1504     54.0723
04300     0.2345      0.9346     0.1530     55.5803
04400     0.2164      0.9451     0.1530     54.6290
04500     0.2592      0.9325     0.1625     54.6273
04600     0.2369      0.9283     0.1625     54.0200
04700     0.2477      0.9283     0.1625     55.6469
04800     0.2175      0.9325     0.1625     54.7773
04900     0.2622      0.9262     0.1625     53.9318
05000     0.2734      0.9346     0.1687     54.4255
05100     0.2423      0.9262     0.1687     56.5829
05200     0.2450      0.9325     0.1707     53.9188
05300     0.2273      0.9367     0.1707     55.4362
05400     0.2670      0.9241     0.1707     54.9907
05500     0.2719      0.9262     0.1707     55.3862
05600     0.2199      0.9388     0.1714     54.0070
05700     0.2192      0.9304     0.1719     54.9268
05800     0.2431      0.9367     0.1719     53.7166
05900     0.2517      0.9283     0.1743     55.5511
06000     0.1892      0.9473     0.1743     54.8767
06100     0.2044      0.9430     0.1771     54.1615
06200     0.2722      0.9262     0.1771     56.8042
06300     0.1888      0.9367     0.1771     53.6421
06400     0.2773      0.9219     0.1977     57.3150
06500     0.2278      0.9451     0.1977     55.1290
06600     0.1536      0.9620     0.1977     56.4253
06700     0.1719      0.9515     0.1977     54.9941
06800     0.2632      0.9325     0.1977     54.3604
06900     0.2956      0.9283     0.1977     54.4110
07000     0.2490      0.9388     0.1977     56.1127
07100     0.3178      0.9135     0.2073     54.4198
07200     0.1942      0.9409     0.2073     54.8265
07300     0.2117      0.9409     0.2073     55.5294
07400     0.2600      0.9262     0.2073     54.2861
07500     0.1908      0.9578     0.2073     56.5702
07600     0.2558      0.9283     0.2132     53.6936
07700     0.2156      0.9346     0.2132     54.9980
07800     0.2162      0.9262     0.2132     56.2378
07900     0.2398      0.9283     0.2132     56.9806
08000     0.2397      0.9451     0.2132     54.0102
08100     0.1847      0.9515     0.2224     55.3463
08200     0.2221      0.9346     0.2289     53.9420
08300     0.1910      0.9451     0.2313     56.1057
08400     0.2180      0.9409     0.2313     54.7116
08500     0.1901      0.9388     0.2351     54.8967
08600     0.1750      0.9494     0.2351     55.9893
08700     0.2015      0.9409     0.2351     54.2830
08800     0.2158      0.9473     0.2351     55.4862
08900     0.2110      0.9473     0.2351     57.7488
09000     0.2219      0.9346     0.2428     56.7707
09100     0.2024      0.9451     0.2428     54.1739
09200     0.1955      0.9388     0.2443     54.7304
09300     0.1810      0.9473     0.2511     53.9282
09400     0.2069      0.9409     0.2511     55.2731
09500     0.1846      0.9473     0.2511     54.0903
09600     0.1994      0.9409     0.2673     56.5478
09700     0.1556      0.9536     0.2787     56.8344
09800     0.1496      0.9599     0.2787     54.0519
09900     0.1316      0.9684     0.2787     54.9840
10000     0.1556      0.9662     0.2858     54.5443
10100     0.2392      0.9346     0.2858     54.9536
10200     0.1725      0.9515     0.2858     55.6098
10300     0.1608      0.9620     0.2858     54.7378
10400     0.2302      0.9388     0.2858     54.6270
10500     0.1997      0.9430     0.2858     56.0008
10600     0.1746      0.9494     0.2858     53.7493
10700     0.1667      0.9641     0.2858     55.9648
10800     0.1375      0.9684     0.2858     54.4652
10900     0.1237      0.9705     0.2858     54.3862
11000     0.1864      0.9494     0.2858     55.9799
11100     0.1788      0.9515     0.2858     54.2832
11200     0.1446      0.9620     0.2858     54.3735
11300     0.1599      0.9515     0.2858     53.9866
11400     0.1358      0.9705     0.2858     54.2056
11500     0.1931      0.9515     0.2858     57.2075
11600     0.1451      0.9641     0.2858     54.0973
11700     0.1477      0.9578     0.2858     53.8246
11800     0.1782      0.9515     0.2858     55.2253
11900     0.1639      0.9641     0.2858     53.6076
12000     0.1542      0.9578     0.2858     53.9770
12100     0.1636      0.9494     0.2858     53.3868
12200     0.1798      0.9515     0.2858     53.3901
12300     0.1776      0.9515     0.2858     55.3879
12400     0.1494      0.9557     0.2858     55.7751
12500     0.1735      0.9578     0.2858     54.8309
12600     0.1360      0.9599     0.2858     58.3212
12700     0.1283      0.9705     0.2858     54.8517
12800     0.1376      0.9620     0.2858     55.5455
12900     0.1501      0.9578     0.2858     55.1293
13000     0.1543      0.9641     0.2858     53.5250
13100     0.2547      0.9346     0.2858     54.8935
13200     0.1620      0.9557     0.2858     54.8853
13300     0.1291      0.9641     0.2858     54.3558
13400     0.1703      0.9451     0.2858     57.1691
13500     0.1134      0.9747     0.2858     54.4192
13600     0.1209      0.9705     0.2858     54.9079
13700     0.1547      0.9641     0.2858     57.9859
13800     0.1507      0.9515     0.2858     54.1356
13900     0.1264      0.9641     0.2858     55.9477
14000     0.1129      0.9705     0.2858     54.0044
14100     0.1609      0.9536     0.2858     54.6664
14200     0.1739      0.9557     0.2858     54.8245
14300     0.1284      0.9768     0.2858     56.5602
14400     0.2255      0.9388     0.2858     54.4855
14500     0.1360      0.9578     0.2858     54.5892
14600     0.1656      0.9536     0.2858     53.2408
14700     0.1682      0.9620     0.2858     53.9662
14800     0.1259      0.9620     0.2858     53.8538
14900     0.1383      0.9705     0.2858     53.8362
15000     0.1428      0.9684     0.2858     57.3149
15100     0.1587      0.9620     0.2858     54.3485
15200     0.1340      0.9726     0.2858     56.7763
15300     0.1764      0.9557     0.2858     54.7572
15400     0.1490      0.9557     0.2858     56.4637
15500     0.1626      0.9578     0.2858     56.4241
15600     0.1688      0.9536     0.2858     54.9844
15700     0.1830      0.9494     0.2858     54.9121
15800     0.1889      0.9494     0.2858     56.3516
15900     0.1837      0.9557     0.2858     56.0108
16000     0.1490      0.9620     0.2858     54.9411
16100     0.1542      0.9536     0.2858     53.9583
16200     0.1672      0.9599     0.2858     54.1463
16300     0.1374      0.9620     0.2858     55.3178
16400     0.1154      0.9705     0.2858     53.7083
16500     0.1558      0.9662     0.2858     54.4544
16600     0.1241      0.9641     0.2858     56.2765
16700     0.1330      0.9684     0.2858     53.8329
16800     0.1730      0.9515     0.2858     53.6339
16900     0.1543      0.9599     0.2858     54.8492
17000     0.1681      0.9494     0.2858     53.7894
17100     0.1556      0.9620     0.2858     53.8092
17200     0.1624      0.9473     0.2858     54.7732
17300     0.1284      0.9705     0.2858     53.5475
17400     0.1680      0.9599     0.2858     54.7681
17500     0.1044      0.9789     0.2858     53.9713
17600     0.1375      0.9620     0.2858     56.6049
17700     0.1741      0.9536     0.2858     55.0726
17800     0.1735      0.9578     0.2858     53.2675
17900     0.1301      0.9641     0.2858     54.0408
18000     0.1573      0.9599     0.2858     55.5313
18100     0.1317      0.9641     0.2858     53.7758
18200     0.1289      0.9768     0.2858     56.1809
18300     0.1609      0.9599     0.2858     55.6665
18400     0.1165      0.9662     0.2858     55.4582
18500     0.1203      0.9789     0.2858     53.5963
18600     0.1585      0.9557     0.2858     54.4708
18700     0.1644      0.9515     0.2858     55.2021
18800     0.1569      0.9578     0.2858     54.8227
18900     0.0999      0.9768     0.2858     57.6960
19000     0.1088      0.9768     0.2858     54.5835
19100     0.1607      0.9620     0.2858     57.2730
19200     0.1245      0.9747     0.2858     54.1409
19300     0.1854      0.9494     0.2858     55.3466
19400     0.1093      0.9768     0.2858     56.2944
19500     0.1437      0.9620     0.2858     54.1429
19600     0.1352      0.9684     0.2858     53.9527
19700     0.1039      0.9747     0.2858     54.5764
19800     0.1245      0.9747     0.2858     56.4293
19900     0.1582      0.9620     0.2858     54.1169
20000     0.1341      0.9599     0.2858     55.5707
20100     0.1660      0.9578     0.2858     56.1223
20199     0.0940      0.9852     0.2858     53.7947
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     3.3440      0.2806     0.2650     8.5297
00100     1.8489      0.4895     0.4853     53.8769
00200     1.7059      0.5253     0.5712     54.7202
00300     1.4817      0.6203     0.6226     54.3353
00400     1.2807      0.6519     0.6643     55.0268
00500     1.2980      0.6371     0.6909     54.2716
00600     1.2832      0.6603     0.6909     54.3295
00700     0.9328      0.7447     0.7000     54.3186
00800     1.0861      0.6962     0.7000     53.2554
00900     0.9974      0.7173     0.7222     54.0139
01000     1.1463      0.7131     0.7282     54.3207
01100     0.9857      0.7236     0.7294     55.2115
01200     0.9951      0.7363     0.7294     54.3521
01300     0.9468      0.7215     0.7397     54.1047
01400     1.0901      0.7215     0.7412     54.9494
01500     0.8876      0.7616     0.7619     54.2020
01600     0.9287      0.7426     0.7619     55.3854
01700     0.7980      0.8038     0.7619     53.6087
01800     0.7993      0.7806     0.7619     53.0453
01900     0.9095      0.7468     0.7619     54.7237
02000     0.8659      0.7447     0.7619     54.5738
02100     0.8355      0.7468     0.7644     53.3341
02200     0.7738      0.7911     0.7718     53.9458
02300     0.9514      0.7511     0.7718     54.7513
02400     0.8679      0.7553     0.7718     54.9137
02500     0.9568      0.7215     0.7779     54.7402
02600     0.7914      0.7658     0.7779     53.7908
02700     0.8301      0.7890     0.7779     56.0002
02800     0.7450      0.7975     0.7779     55.1052
02900     0.6931      0.7911     0.7779     54.9379
03000     0.6832      0.8017     0.7840     54.9184
03100     0.7772      0.7700     0.7864     54.4235
03200     0.8133      0.7827     0.7864     53.7035
03300     0.7072      0.8165     0.7904     54.3959
03400     0.7010      0.7890     0.7904     54.9071
03500     0.8048      0.7806     0.7904     54.1779
03600     0.9011      0.7215     0.7904     54.3272
03700     0.7286      0.7869     0.7953     53.8146
03800     0.6457      0.7996     0.7953     54.9124
03900     0.6929      0.7932     0.7953     54.2398
04000     0.6784      0.7848     0.7953     54.8282
04100     0.7288      0.8038     0.8044     54.5192
04200     0.8421      0.7595     0.8044     54.7835
04300     0.7158      0.7932     0.8044     54.9519
04400     0.7172      0.7869     0.8044     55.2371
04500     0.5844      0.8122     0.8073     54.4714
04600     0.6670      0.8376     0.8073     55.0547
04700     0.9685      0.7595     0.8073     53.7775
04800     0.7120      0.8143     0.8073     53.3682
04900     0.5917      0.8249     0.8073     55.1117
05000     0.8006      0.7743     0.8073     54.3372
05100     0.6152      0.8038     0.8073     56.9823
05200     0.6297      0.8291     0.8105     54.2151
05300     0.6030      0.8228     0.8105     54.8476
05400     0.6396      0.7996     0.8105     56.4127
05500     0.6652      0.8143     0.8110     54.9334
05600     0.5863      0.8059     0.8110     55.2899
05700     0.6538      0.8080     0.8135     58.1819
05800     0.7116      0.7932     0.8135     54.4963
05900     0.6801      0.7932     0.8163     54.7896
06000     0.7240      0.8101     0.8163     54.5136
06100     0.6460      0.8122     0.8163     55.1642
06200     0.6902      0.8101     0.8163     54.6840
06300     0.6131      0.8080     0.8186     54.1519
06400     0.6478      0.8186     0.8186     55.8546
06500     0.5355      0.8460     0.8186     54.4552
06600     0.6332      0.8038     0.8186     54.7014
06700     0.6026      0.8481     0.8218     54.3741
06800     0.6710      0.8165     0.8237     54.2373
06900     0.6181      0.8312     0.8237     54.5334
07000     0.5997      0.8186     0.8237     54.9623
07100     0.5533      0.8376     0.8237     53.8992
07200     0.5261      0.8586     0.8256     55.2153
07300     0.7019      0.7932     0.8256     55.3773
07400     0.6081      0.8354     0.8256     54.4235
07500     0.6558      0.8228     0.8266     54.5975
07600     0.5918      0.8143     0.8266     54.7217
07700     0.6955      0.8249     0.8303     55.2282
07800     0.4829      0.8692     0.8303     55.3235
07900     0.6023      0.8038     0.8303     55.8590
08000     0.6471      0.8228     0.8303     56.5256
08100     0.6050      0.8165     0.8303     55.9291
08200     0.6184      0.8038     0.8303     55.7468
08300     0.6033      0.8312     0.8303     54.3537
08400     0.5618      0.8523     0.8303     56.1076
08500     0.6612      0.7869     0.8323     53.5344
08600     0.7122      0.7954     0.8323     56.0429
08700     0.5404      0.8376     0.8345     56.0591
08800     0.5729      0.8143     0.8345     54.0874
08900     0.5715      0.8186     0.8345     54.0061
09000     0.6397      0.8186     0.8345     54.6842
09100     0.6257      0.8122     0.8348     55.7312
09200     0.6101      0.8122     0.8348     54.0850
09300     0.5979      0.8312     0.8391     55.0194
09400     0.5754      0.8333     0.8391     53.9135
09500     0.4357      0.8671     0.8391     53.5033
09600     0.5645      0.8333     0.8391     54.1260
09700     0.5991      0.8186     0.8391     55.1594
09800     0.5972      0.8186     0.8391     54.2720
09900     0.5775      0.8270     0.8391     55.2326
Start testing:
Test Accuracy: 0.8778
