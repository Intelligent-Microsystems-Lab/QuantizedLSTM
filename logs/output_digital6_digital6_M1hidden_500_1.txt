Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=494, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=235899598, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
496c9a55-0097-42b2-9880-25031c60cd50
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 147, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 374, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 211, in forward
    part2 = CustomMM_bmm.apply(quant_pass(pact_a_bmm(hx, self.a11), self.ib, self.a11), self.weight_hh * w_mask, self.bias_hh, self.noise_level, self.wb, self.bias_r)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 141, in forward
    noise_w = torch.randn(weight.shape, device = input.device) * max_w * nl
RuntimeError: CUDA out of memory. Tried to allocate 16.00 MiB (GPU 0; 11.78 GiB total capacity; 9.52 GiB already allocated; 17.38 MiB free; 10.60 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=494, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=235899598, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
aaa07b54-a82d-4662-bbf2-07994f0297fc
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     3.8109      0.0500     0.0832     17.3906
00100     1.8405      0.3700     0.0895     62.2367
00200     1.0683      0.6500     0.0905     62.4202
00300     0.9840      0.6700     0.0956     63.3354
00400     0.7687      0.7300     0.0956     61.7766
00500     0.6958      0.7600     0.0956     63.0672
00600     0.5747      0.8200     0.0991     66.1149
00700     0.6952      0.8000     0.0991     61.6679
00800     0.7280      0.7200     0.1045     62.5369
00900     0.6208      0.8000     0.1045     63.7509
01000     0.4242      0.8800     0.1045     64.3594
01100     0.6410      0.7700     0.1055     64.0262
01200     0.5565      0.7900     0.1055     62.1584
01300     0.4354      0.8600     0.1055     64.0876
01400     0.3956      0.8800     0.1055     67.9862
01500     0.4648      0.8500     0.1143     65.7737
01600     0.4840      0.8500     0.1143     65.1317
01700     0.4396      0.8400     0.1143     62.0747
01800     0.5413      0.8100     0.1143     62.5171
01900     0.5114      0.8500     0.1149     63.1176
02000     0.5434      0.8500     0.1149     64.4217
02100     0.6693      0.8500     0.1184     65.7691
02200     0.4127      0.8700     0.1184     61.8139
02300     0.3409      0.8800     0.1233     66.0944
02400     0.5047      0.8600     0.1233     62.3498
02500     0.3275      0.9000     0.1233     63.3003
02600     0.2953      0.9300     0.1233     63.5493
02700     0.2837      0.9100     0.1233     61.6693
02800     0.3452      0.8500     0.1264     63.0202
02900     0.3065      0.9100     0.1321     62.2251
03000     0.5639      0.8500     0.1321     65.2860
03100     0.3385      0.8900     0.1340     66.4733
03200     0.3858      0.9100     0.1449     62.8970
03300     0.2720      0.9100     0.1449     61.9750
03400     0.2903      0.9300     0.1449     62.0953
03500     0.2193      0.9300     0.1449     62.7724
03600     0.4005      0.9000     0.1449     61.7305
03700     0.4838      0.8400     0.1688     63.4129
03800     0.3515      0.9100     0.1688     61.5165
03900     0.4430      0.8800     0.1688     63.4499
04000     0.4419      0.8600     0.1688     61.8885
04100     0.2974      0.8900     0.1688     62.3512
04200     0.2451      0.8800     0.1688     61.4522
04300     0.2529      0.8800     0.1688     61.8429
04400     0.3111      0.8900     0.1729     65.5032
04500     0.2873      0.8800     0.1729     62.4491
04600     0.2763      0.8800     0.1729     62.5070
04700     0.2162      0.9600     0.1854     62.3298
04800     0.2280      0.9400     0.1943     66.0970
04900     0.2317      0.9100     0.1943     64.9602
05000     0.5421      0.8700     0.1943     65.8381
05100     0.2421      0.9300     0.1943     62.9481
05200     0.3019      0.8900     0.1943     62.7203
05300     0.3631      0.8600     0.1947     62.1158
05400     0.1991      0.9200     0.2000     66.0542
05500     0.3445      0.8900     0.2000     62.6406
05600     0.3411      0.8800     0.2005     67.7755
05700     0.3171      0.8800     0.2118     62.8832
05800     0.1560      0.9600     0.2218     62.4607
05900     0.2290      0.9200     0.2342     62.0064
06000     0.3097      0.9100     0.2342     63.4015
06100     0.2967      0.9000     0.2342     61.7840
06200     0.3070      0.9200     0.2348     65.8514
06300     0.2928      0.9300     0.2348     65.5346
06400     0.2376      0.9000     0.2348     64.2999
06500     0.3174      0.9000     0.2348     61.9073
06600     0.2231      0.9600     0.2348     66.6183
06700     0.1914      0.9200     0.2348     62.4252
06800     0.3525      0.8900     0.2348     62.7538
06900     0.2442      0.9400     0.2666     66.2468
07000     0.3550      0.9000     0.2666     65.1332
07100     0.2282      0.9400     0.2666     61.9805
07200     0.1566      0.9400     0.2666     62.3399
07300     0.2827      0.9300     0.2666     62.6756
07400     0.5294      0.8500     0.2666     61.7986
07500     0.1625      0.9600     0.2666     64.5203
07600     0.1704      0.9400     0.2790     66.8891
07700     0.2211      0.9400     0.2790     64.9031
07800     0.4286      0.8800     0.2965     61.9079
07900     0.2636      0.9200     0.2965     61.2539
08000     0.2800      0.9200     0.2965     61.3373
08100     0.3086      0.9100     0.2978     66.8348
08200     0.2845      0.8900     0.3046     62.9389
08300     0.1329      0.9600     0.3105     62.4210
08400     0.3371      0.8900     0.3116     65.2566
08500     0.1707      0.9300     0.3116     68.1337
08600     0.4814      0.8300     0.3116     63.3324
08700     0.2122      0.9200     0.3116     62.9911
08800     0.3009      0.9300     0.3116     62.0059
08900     0.1562      0.9400     0.3116     63.9439
09000     0.3640      0.9000     0.3504     63.7553
09100     0.4210      0.8900     0.3504     66.7653
09200     0.3142      0.8900     0.3504     65.9962
09300     0.2092      0.9600     0.3504     63.0245
09400     0.2539      0.9500     0.3580     62.6589
09500     0.3358      0.8900     0.3580     61.9049
09600     0.4703      0.8300     0.3840     61.9111
09700     0.2295      0.9100     0.3840     64.3568
09800     0.1498      0.9600     0.4013     62.5462
09900     0.3531      0.8700     0.4013     61.8870
10000     0.2121      0.9000     0.4013     62.8866
10100     0.1563      0.9400     0.4013     62.7895
10200     0.2777      0.9200     0.4013     65.5283
10300     0.3925      0.9100     0.4013     65.7349
10400     0.3242      0.8800     0.4013     61.6661
10500     0.1955      0.9700     0.4013     65.7598
10600     0.1508      0.9400     0.4013     62.3841
10700     0.2011      0.9000     0.4013     62.0880
10800     0.1756      0.9500     0.4013     61.3229
10900     0.1306      0.9600     0.4013     62.1500
11000     0.1522      0.9500     0.4013     63.0691
11100     0.1382      0.9300     0.4013     63.2238
11200     0.1622      0.9700     0.4013     63.3174
11300     0.1310      0.9600     0.4013     63.0137
11400     0.1420      0.9600     0.4013     61.8815
11500     0.1171      0.9600     0.4013     61.4418
11600     0.2100      0.9600     0.4013     62.5185
11700     0.1858      0.9300     0.4013     63.7225
11800     0.3948      0.8600     0.4013     64.9935
11900     0.1767      0.9300     0.4013     62.7751
12000     0.1217      0.9500     0.4013     62.1424
12100     0.1539      0.9300     0.4013     64.6257
12200     0.2494      0.9100     0.4013     62.0397
12300     0.1894      0.9600     0.4013     66.1463
12400     0.3702      0.8800     0.4013     64.6851
12500     0.2932      0.9100     0.4013     63.0444
12600     0.1584      0.9500     0.4013     61.4821
12700     0.1769      0.9600     0.4013     64.2533
12800     0.1483      0.9500     0.4013     65.1223
12900     0.0982      0.9600     0.4013     62.3196
13000     0.1940      0.9400     0.4013     62.8694
13100     0.1486      0.9600     0.4013     65.8516
13200     0.2109      0.9100     0.4013     63.2623
13300     0.2037      0.9300     0.4013     64.3341
13400     0.1323      0.9500     0.4013     62.6732
13500     0.1961      0.9300     0.4013     63.1045
13600     0.1009      0.9700     0.4013     61.6807
13700     0.1406      0.9500     0.4013     64.3555
13800     0.1817      0.9400     0.4013     61.5762
13900     0.1366      0.9600     0.4013     63.9212
14000     0.0939      0.9700     0.4013     64.4651
14100     0.1211      0.9400     0.4013     66.2757
14200     0.1807      0.9500     0.4013     65.3782
14300     0.1255      0.9800     0.4013     63.9879
14400     0.1400      0.9400     0.4013     62.6431
14500     0.1965      0.9100     0.4013     62.2559
14600     0.1313      0.9600     0.4013     62.5906
14700     0.1936      0.9300     0.4013     62.3308
14800     0.2818      0.9300     0.4013     62.4063
14900     0.0617      1.0000     0.4013     61.9378
15000     0.1282      0.9500     0.4013     62.5675
15100     0.0602      0.9700     0.4013     63.2643
15200     0.1405      0.9500     0.4013     63.6020
15300     0.1659      0.9600     0.4013     62.9991
15400     0.1250      0.9500     0.4013     67.5821
15500     0.0659      0.9900     0.4013     61.8548
15600     0.1002      0.9800     0.4013     63.8009
15700     0.1545      0.9400     0.4013     61.6431
15800     0.2022      0.9300     0.4013     62.1461
15900     0.1604      0.9300     0.4013     62.5465
16000     0.1949      0.9400     0.4013     61.4188
16100     0.1272      0.9700     0.4013     66.6186
16200     0.1616      0.9400     0.4013     61.8636
16300     0.2348      0.9400     0.4013     62.0512
16400     0.1598      0.9300     0.4013     65.8481
16500     0.0801      0.9800     0.4013     67.2908
16600     0.1226      0.9700     0.4013     63.0065
16700     0.1403      0.9400     0.4013     63.1761
16800     0.1765      0.9500     0.4013     62.7229
16900     0.2097      0.9200     0.4013     61.8256
17000     0.0954      0.9700     0.4013     63.0069
17100     0.1090      0.9600     0.4013     62.2024
17200     0.1010      0.9600     0.4013     62.5241
17300     0.1387      0.9700     0.4013     65.1112
17400     0.2028      0.9400     0.4013     67.7365
17500     0.2006      0.9600     0.4013     62.0250
17600     0.1810      0.9600     0.4013     66.0206
17700     0.1821      0.9300     0.4013     61.9551
17800     0.1407      0.9500     0.4013     64.4702
17900     0.2295      0.9100     0.4013     62.9340
18000     0.0892      0.9800     0.4013     62.6143
18100     0.1255      0.9500     0.4013     61.5972
18200     0.1425      0.9400     0.4013     64.8661
18300     0.1634      0.9500     0.4013     65.6817
18400     0.0937      0.9500     0.4013     62.1621
18500     0.1979      0.9600     0.4013     63.5936
18600     0.2582      0.9300     0.4013     62.7646
18700     0.1232      0.9700     0.4013     63.2075
18800     0.1047      0.9600     0.4013     62.3499
18900     0.1691      0.9300     0.4013     62.9177
19000     0.1343      0.9600     0.4013     62.0595
19100     0.1469      0.9200     0.4013     62.3539
19200     0.1614      0.9400     0.4013     62.9461
19300     0.1120      0.9400     0.4015     62.5738
19400     0.0883      0.9700     0.4015     63.5930
19500     0.1276      0.9500     0.4071     62.8598
19600     0.1493      0.9400     0.4071     61.5444
19700     0.2158      0.9500     0.4071     62.3715
19800     0.1115      0.9600     0.4071     65.0928
19900     0.1429      0.9500     0.4071     62.1117
20000     0.0584      0.9800     0.4071     65.3606
20100     0.0917      0.9700     0.4071     63.7905
20199     0.1396      0.9600     0.4071     63.1152
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     3.9460      0.4100     0.3808     16.4326
00100     1.6229      0.6000     0.5802     64.5793
00200     1.2085      0.6200     0.6802     63.4087
00300     1.2826      0.7500     0.7110     62.8509
00400     1.0856      0.7400     0.7360     63.1438
00500     0.9244      0.7400     0.7507     66.2388
00600     1.2278      0.6400     0.7648     64.8789
00700     0.9722      0.7500     0.7768     62.7045
00800     1.0541      0.7700     0.7768     62.9812
00900     0.7250      0.8100     0.7851     62.2264
01000     0.8207      0.8000     0.7917     67.6666
01100     0.6581      0.8500     0.7917     63.2148
01200     1.0892      0.7200     0.8030     63.2563
01300     1.1172      0.7800     0.8030     62.4813
01400     0.6480      0.8400     0.8034     65.5225
01500     0.8003      0.8000     0.8034     64.0256
01600     0.6049      0.8600     0.8035     67.2469
01700     0.6755      0.8100     0.8035     62.2264
01800     0.7226      0.8000     0.8174     62.4968
01900     0.4123      0.8700     0.8174     62.0561
02000     0.4701      0.8800     0.8174     62.0982
02100     0.4258      0.8900     0.8174     64.9207
02200     0.5722      0.8300     0.8191     63.4310
02300     0.5354      0.8500     0.8191     63.3462
02400     0.5840      0.8500     0.8257     64.3206
02500     0.5277      0.8800     0.8257     62.9555
02600     1.0492      0.7700     0.8311     66.4214
02700     0.4527      0.8800     0.8311     62.3496
02800     0.8028      0.8300     0.8311     62.7029
02900     0.5863      0.8500     0.8311     62.5476
03000     0.5164      0.8700     0.8323     63.0980
03100     0.6612      0.8300     0.8323     66.2010
03200     0.8113      0.8000     0.8334     64.0513
03300     1.1148      0.7900     0.8334     64.8068
03400     0.6364      0.8600     0.8347     62.0369
03500     0.6913      0.8100     0.8347     61.4402
03600     0.7474      0.7700     0.8347     64.3766
03700     1.3151      0.7100     0.8347     65.0169
03800     0.3678      0.9000     0.8402     64.0513
03900     0.5535      0.8600     0.8402     61.4124
04000     0.8797      0.8200     0.8402     62.5408
04100     0.3790      0.8900     0.8402     62.4999
04200     0.5316      0.8200     0.8402     62.4075
04300     0.7738      0.8100     0.8417     62.9796
04400     0.4394      0.8800     0.8417     62.3242
04500     0.4207      0.8600     0.8417     61.4476
04600     0.5427      0.8500     0.8437     64.1377
04700     1.0328      0.7600     0.8437     61.7848
04800     0.6434      0.7800     0.8437     65.0569
04900     0.6252      0.8400     0.8437     62.6080
05000     0.4845      0.8400     0.8437     66.0250
05100     0.6495      0.8500     0.8437     63.9592
05200     0.7188      0.8600     0.8437     62.9574
05300     0.6245      0.8300     0.8457     62.7585
05400     0.6680      0.7700     0.8457     62.9644
05500     0.4786      0.8400     0.8457     62.1132
05600     0.4587      0.8400     0.8457     61.9746
05700     0.5671      0.8000     0.8457     63.4610
05800     0.4477      0.8600     0.8457     61.8856
05900     0.5848      0.8200     0.8484     62.9094
06000     0.5260      0.8600     0.8484     61.9323
06100     0.7494      0.7900     0.8484     61.6119
06200     0.8715      0.8400     0.8484     61.7453
06300     0.6609      0.8700     0.8484     62.7216
06400     0.6295      0.8600     0.8492     62.6043
06500     0.7482      0.8500     0.8492     62.8052
06600     0.8518      0.8400     0.8544     67.3563
06700     0.5162      0.8500     0.8544     64.0635
06800     0.5828      0.8200     0.8544     63.1450
06900     0.3747      0.9000     0.8544     61.8035
07000     0.4801      0.8800     0.8544     65.8345
07100     0.7223      0.8100     0.8544     61.5189
07200     0.5615      0.8500     0.8544     64.3022
07300     0.7249      0.8300     0.8574     63.0559
07400     0.5116      0.8500     0.8584     63.1772
07500     0.4852      0.8200     0.8584     64.4928
07600     0.5387      0.8800     0.8584     62.2464
07700     0.6174      0.8300     0.8584     62.2642
07800     0.5028      0.8300     0.8584     62.2149
07900     0.5057      0.8200     0.8584     65.0268
08000     0.7324      0.8600     0.8584     62.7385
08100     0.5805      0.8400     0.8584     66.6192
08200     0.5934      0.8100     0.8584     62.4250
08300     0.7066      0.8300     0.8641     65.3846
08400     0.3544      0.9000     0.8641     64.1298
08500     0.4327      0.8800     0.8641     63.2801
08600     0.2444      0.9200     0.8641     63.6605
08700     0.5900      0.7900     0.8641     66.0788
08800     0.4077      0.9100     0.8641     66.9797
08900     0.6851      0.7900     0.8641     66.6938
09000     0.9609      0.7200     0.8641     64.7966
09100     0.4662      0.8900     0.8641     63.8650
09200     0.4942      0.8600     0.8641     63.1028
09300     0.6997      0.8500     0.8641     62.9253
09400     0.4672      0.8900     0.8668     64.4812
09500     0.3065      0.8900     0.8668     62.7520
09600     0.6730      0.8300     0.8668     63.4476
09700     0.3811      0.8900     0.8668     63.0262
09800     0.6454      0.8300     0.8668     64.7960
09900     0.4766      0.8600     0.8668     64.3736
Start testing:
Test Accuracy: 0.8985
