Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=294, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=193012823, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
8a866509-47ea-40e7-85e8-e80019d833b6
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 147, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 290, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 213, in forward
    gates = quant_pass(pact_a_bmm( quant_pass(pact_a_bmm(part1, self.a12), self.abMVM, self.a12) + quant_pass(pact_a_bmm(part2, self.a13), self.abMVM, self.a13), self.a14), self.abNM, self.a14)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 89, in forward
    x01q =  torch.round(x01 * step_d ) / step_d
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 10.76 GiB total capacity; 9.66 GiB already allocated; 17.12 MiB free; 9.79 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=294, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=193012823, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
bf2ed8db-191a-4f75-94aa-e3e855af74dc
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     2.6510      0.0800     0.0998     18.0876
00100     1.5710      0.4800     0.5040     70.9459
00200     1.2926      0.5300     0.6628     69.7481
00300     1.1642      0.6400     0.7178     70.4845
00400     1.0056      0.6900     0.7380     69.7646
00500     0.8099      0.7200     0.7585     69.3409
00600     0.7287      0.7200     0.7735     69.4629
00700     1.0457      0.6900     0.7864     69.7388
00800     0.9754      0.6800     0.7864     69.1971
00900     0.6610      0.8100     0.7864     69.1362
01000     0.7850      0.7300     0.7948     70.7267
01100     0.7257      0.7600     0.7948     69.2488
01200     0.6665      0.7800     0.7948     69.8352
01300     0.7411      0.7700     0.8086     69.7734
01400     0.5825      0.8100     0.8206     70.2255
01500     0.7612      0.7900     0.8206     69.8380
01600     0.7818      0.7800     0.8206     69.3802
01700     0.6267      0.8000     0.8264     69.5179
01800     0.7865      0.7700     0.8264     68.6173
01900     0.5847      0.8000     0.8305     72.2951
02000     0.8058      0.7500     0.8305     70.8278
02100     0.7395      0.7900     0.8305     68.1375
02200     0.8924      0.7100     0.8481     69.7075
02300     0.7770      0.7400     0.8481     69.7677
02400     0.8983      0.7100     0.8481     69.0900
02500     0.8646      0.7600     0.8481     69.2898
02600     0.6701      0.7600     0.8481     68.7017
02700     0.9368      0.7300     0.8481     68.8308
02800     0.7078      0.7100     0.8481     69.3097
02900     0.5811      0.8100     0.8481     69.8791
03000     0.6832      0.8200     0.8481     70.1825
03100     0.6562      0.7800     0.8481     69.9104
03200     0.7546      0.7600     0.8481     69.5557
03300     0.5971      0.7800     0.8481     69.1561
03400     0.6226      0.8200     0.8481     68.9969
03500     0.5369      0.8300     0.8481     69.1592
03600     0.5262      0.8200     0.8481     69.5125
03700     0.5648      0.8000     0.8481     69.8774
03800     0.7681      0.7500     0.8481     70.3768
03900     0.5861      0.8000     0.8481     70.0470
04000     0.7957      0.7200     0.8481     69.5001
04100     0.6116      0.8200     0.8486     69.0762
04200     0.5272      0.8300     0.8486     69.5374
04300     0.5613      0.8600     0.8486     69.7122
04400     0.3952      0.8800     0.8556     68.6950
04500     0.7242      0.7900     0.8592     68.8491
04600     0.7142      0.7800     0.8592     69.0247
04700     0.5412      0.8400     0.8592     69.8990
04800     0.5972      0.7900     0.8592     68.7851
04900     0.6247      0.8200     0.8592     69.7104
05000     0.6169      0.8300     0.8592     69.1383
05100     0.5018      0.8500     0.8592     68.9507
05200     0.6580      0.8100     0.8592     68.9703
05300     0.4344      0.8800     0.8592     68.9770
05400     0.6319      0.7800     0.8592     69.9108
05500     0.4183      0.8900     0.8592     68.9238
05600     0.7656      0.7700     0.8592     70.7110
05700     0.4856      0.8500     0.8592     69.3391
05800     0.5585      0.8100     0.8592     69.7496
05900     0.6024      0.8000     0.8592     68.9541
06000     0.8198      0.7400     0.8592     69.6177
06100     0.4157      0.8800     0.8592     69.3642
06200     0.4894      0.8700     0.8592     69.3848
06300     0.5577      0.7900     0.8592     68.5220
06400     0.3755      0.8600     0.8592     69.2948
06500     0.4534      0.8400     0.8592     69.6003
06600     0.5916      0.8400     0.8592     69.9304
06700     0.4398      0.8900     0.8592     69.5533
06800     0.5339      0.8300     0.8592     68.8735
06900     0.5500      0.8300     0.8592     68.8484
07000     0.7190      0.7900     0.8592     69.5643
07100     0.6050      0.8300     0.8592     70.3425
07200     0.6097      0.8100     0.8725     69.6844
07300     0.5215      0.8500     0.8725     69.2468
07400     0.6168      0.7900     0.8725     68.3814
07500     0.3366      0.9000     0.8725     70.3974
07600     0.6523      0.8100     0.8725     69.4237
07700     0.3873      0.9000     0.8725     68.8460
07800     0.5475      0.8500     0.8725     68.9044
07900     0.4258      0.8900     0.8725     70.6387
08000     0.5871      0.8300     0.8725     70.2909
08100     0.4324      0.8800     0.8725     69.7329
08200     0.6555      0.8300     0.8725     69.1482
08300     0.3412      0.9200     0.8725     69.5751
08400     0.4631      0.8800     0.8725     70.1349
08500     0.5476      0.8300     0.8725     68.4117
08600     0.4156      0.8500     0.8725     69.7207
08700     0.5574      0.8200     0.8725     70.2339
08800     0.6284      0.7800     0.8725     69.5673
08900     0.2526      0.9600     0.8725     69.9286
09000     0.6140      0.8200     0.8725     70.2972
09100     0.5353      0.8300     0.8725     69.1971
09200     0.3969      0.8800     0.8725     70.5872
09300     0.4894      0.8400     0.8725     69.1829
09400     0.4380      0.8800     0.8725     68.5671
09500     0.6096      0.7900     0.8725     69.0386
09600     0.4130      0.8800     0.8725     69.5523
09700     0.6020      0.8200     0.8747     69.7391
09800     0.6205      0.8100     0.8747     68.6410
09900     0.6333      0.8300     0.8747     69.6808
10000     0.3859      0.9000     0.8747     68.8261
10100     0.4499      0.8900     0.8747     69.1179
10200     0.5122      0.8600     0.8747     68.8170
10300     0.3649      0.9100     0.8747     68.9972
10400     0.5108      0.8400     0.8747     69.1728
10500     0.3492      0.9000     0.8747     69.1220
10600     0.5271      0.8400     0.8747     69.4885
10700     0.4908      0.8700     0.8747     69.3147
10800     0.3620      0.8900     0.8747     69.9178
10900     0.3222      0.9200     0.8747     68.9686
11000     0.3409      0.8600     0.8747     69.0236
11100     0.3477      0.9000     0.8815     70.3445
11200     0.5260      0.8500     0.8815     70.3063
11300     0.5066      0.8200     0.8815     69.0479
11400     0.3081      0.9000     0.8815     69.3344
11500     0.4953      0.8500     0.8815     69.7878
11600     0.4734      0.8700     0.8815     69.6564
11700     0.6032      0.8300     0.8815     70.1264
11800     0.3750      0.8800     0.8815     69.2628
11900     0.5339      0.8400     0.8815     68.6779
12000     0.4751      0.8500     0.8815     68.6652
12100     0.4056      0.8600     0.8815     69.4051
12200     0.3662      0.9200     0.8815     68.3062
12300     0.5102      0.8500     0.8815     69.7618
12400     0.4878      0.8600     0.8815     69.2187
12500     0.2095      0.9600     0.8815     68.5582
12600     0.3499      0.8900     0.8815     68.5791
12700     0.4875      0.8500     0.8815     69.2184
12800     0.3502      0.9100     0.8815     69.6563
12900     0.4215      0.8700     0.8815     69.1798
13000     0.5887      0.8100     0.8815     69.8008
13100     0.4466      0.8700     0.8815     69.7230
13200     0.5004      0.8500     0.8815     69.6996
13300     0.3381      0.9000     0.8815     69.5161
13400     0.3681      0.8900     0.8815     68.8929
13500     0.4166      0.8800     0.8815     69.0863
13600     0.3787      0.8900     0.8815     69.2433
13700     0.4390      0.8600     0.8815     69.0439
13800     0.4221      0.8600     0.8815     69.4256
13900     0.3821      0.8900     0.8815     69.4898
14000     0.3039      0.9000     0.8815     69.2424
14100     0.4110      0.8700     0.8815     69.5863
14200     0.4420      0.8700     0.8815     68.9702
14300     0.4032      0.8400     0.8815     69.2190
14400     0.3738      0.9200     0.8815     69.4806
14500     0.3866      0.9000     0.8815     68.7437
14600     0.4672      0.8300     0.8815     69.9278
14700     0.5101      0.8800     0.8836     69.3796
14800     0.3803      0.8700     0.8836     69.7903
14900     0.4068      0.9100     0.8836     70.0356
15000     0.2005      0.9600     0.8836     69.3608
15100     0.4304      0.8800     0.8836     69.9848
15200     0.4500      0.8400     0.8836     70.1908
15300     0.4528      0.8300     0.8836     69.5843
15400     0.4034      0.8900     0.8836     69.3671
15500     0.3556      0.8900     0.8836     68.5358
15600     0.3921      0.8800     0.8836     69.3353
15700     0.3864      0.8800     0.8836     69.7970
15800     0.3914      0.9000     0.8836     69.4393
15900     0.4041      0.8900     0.8836     68.5288
16000     0.3112      0.9300     0.8836     69.9467
16100     0.4307      0.8800     0.8836     69.8169
16200     0.3617      0.8900     0.8836     70.0244
16300     0.3278      0.9100     0.8836     69.5034
16400     0.3747      0.8900     0.8836     68.8063
16500     0.2905      0.9200     0.8836     69.6159
16600     0.4167      0.8500     0.8836     69.5401
16700     0.3614      0.8900     0.8836     70.2053
16800     0.3800      0.8700     0.8836     69.7485
16900     0.4224      0.8600     0.8842     69.6652
17000     0.4133      0.8700     0.8842     68.6989
17100     0.3553      0.8600     0.8842     69.1267
17200     0.2729      0.8900     0.8842     69.1080
17300     0.4299      0.8600     0.8842     70.3612
17400     0.3069      0.8900     0.8842     69.7613
17500     0.3901      0.8700     0.8842     69.3052
17600     0.2379      0.9500     0.8842     68.5439
17700     0.3312      0.9100     0.8842     69.3869
17800     0.4559      0.8800     0.8842     69.4495
17900     0.3996      0.8500     0.8842     69.1962
18000     0.3625      0.8700     0.8842     69.9438
18100     0.3165      0.8800     0.8842     69.1854
18200     0.3973      0.8400     0.8842     69.1420
18300     0.4545      0.8600     0.8842     69.5640
18400     0.4279      0.8400     0.8842     68.8674
18500     0.4098      0.8700     0.8842     68.7783
18600     0.6277      0.8400     0.8842     69.9497
18700     0.2287      0.9500     0.8842     69.6537
18800     0.3896      0.9000     0.8842     69.9356
18900     0.3782      0.8800     0.8942     69.0996
19000     0.3955      0.8900     0.8942     69.2286
19100     0.2656      0.9300     0.8942     69.4638
19200     0.3280      0.9000     0.8942     69.6222
19300     0.2823      0.9500     0.8942     69.9867
19400     0.2806      0.9300     0.8942     69.4166
19500     0.2710      0.9200     0.8942     68.8682
19600     0.3620      0.9300     0.8942     68.4393
19700     0.5913      0.8300     0.8942     70.0873
19800     0.2997      0.9300     0.8942     68.7791
19900     0.4132      0.9100     0.8942     69.4481
20000     0.3111      0.9100     0.8942     69.6228
20100     0.4613      0.8800     0.8942     70.4188
20199     0.6292      0.8100     0.8942     68.9901
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     0.6633      0.8100     0.8323     17.0011
00100     0.4048      0.8600     0.8901     69.5313
00200     0.4402      0.8400     0.8924     69.6612
00300     0.4065      0.8700     0.8924     69.5272
00400     0.4242      0.8900     0.8976     69.3323
00500     0.2690      0.9000     0.8976     70.0706
00600     0.4620      0.8600     0.8976     69.5242
00700     0.5211      0.8500     0.8976     69.6928
00800     0.2816      0.9200     0.8976     69.4879
00900     0.3728      0.8600     0.8976     69.0980
01000     0.3783      0.8700     0.8976     68.9886
01100     0.4593      0.8600     0.8976     69.3282
01200     0.3198      0.9200     0.9016     70.6262
01300     0.3732      0.8900     0.9016     68.7227
01400     0.3171      0.9200     0.9016     69.9366
01500     0.4104      0.8700     0.9016     68.4773
01600     0.4169      0.8800     0.9016     69.1816
01700     0.3539      0.8900     0.9016     68.7508
01800     0.4420      0.8800     0.9016     69.6729
01900     0.4147      0.9000     0.9016     69.1689
02000     0.4486      0.8600     0.9016     69.6454
02100     0.4230      0.8700     0.9016     68.7695
02200     0.2456      0.9300     0.9016     68.6011
02300     0.3702      0.9100     0.9016     69.3944
02400     0.5815      0.8200     0.9016     69.9619
02500     0.3889      0.8800     0.9016     69.2844
02600     0.3307      0.9000     0.9016     69.2331
02700     0.4313      0.8500     0.9016     70.1191
02800     0.4249      0.9000     0.9016     69.6461
02900     0.4567      0.8700     0.9016     69.2397
03000     0.3636      0.9000     0.9016     69.7253
03100     0.4431      0.8900     0.9016     69.7356
03200     0.3795      0.8800     0.9016     69.0467
03300     0.3368      0.9000     0.9016     69.1042
03400     0.4472      0.8800     0.9016     70.2201
03500     0.3591      0.8600     0.9016     69.9453
03600     0.4065      0.8900     0.9016     69.5810
03700     0.4989      0.8400     0.9016     69.7018
03800     0.3444      0.9000     0.9016     69.6013
03900     0.2073      0.9500     0.9017     69.2618
04000     0.4138      0.8900     0.9017     69.2160
04100     0.3089      0.9100     0.9017     69.6148
04200     0.2619      0.9000     0.9017     68.8802
04300     0.4267      0.8700     0.9017     69.3485
04400     0.3813      0.9000     0.9017     69.7815
04500     0.3693      0.8900     0.9017     70.0454
04600     0.3529      0.9000     0.9017     69.7713
04700     0.4300      0.9000     0.9017     69.2155
04800     0.2569      0.9400     0.9017     69.5444
04900     0.2832      0.9000     0.9017     69.9024
05000     0.4651      0.8100     0.9029     69.9895
05100     0.2939      0.9100     0.9029     68.7038
05200     0.3449      0.8800     0.9029     70.2108
05300     0.3535      0.9100     0.9029     69.0859
05400     0.2587      0.9300     0.9029     69.5099
05500     0.4303      0.8900     0.9029     69.6850
05600     0.4370      0.8800     0.9029     69.8518
05700     0.4900      0.8200     0.9029     69.2209
05800     0.4728      0.8600     0.9029     68.7146
05900     0.3371      0.8600     0.9029     69.1308
06000     0.2819      0.9100     0.9029     69.4374
06100     0.4469      0.8800     0.9029     68.7197
06200     0.2482      0.9400     0.9029     69.4074
06300     0.3504      0.9100     0.9029     69.8503
06400     0.3433      0.9100     0.9029     69.6033
06500     0.3226      0.9200     0.9029     69.4108
06600     0.3902      0.8800     0.9029     68.4964
06700     0.3637      0.9000     0.9029     69.6720
06800     0.2484      0.9400     0.9029     69.6809
06900     0.3400      0.9200     0.9029     68.9762
07000     0.2929      0.9100     0.9029     69.5705
07100     0.3109      0.9100     0.9029     69.2839
07200     0.3718      0.8900     0.9046     69.8377
07300     0.1543      0.9700     0.9046     69.3677
07400     0.3674      0.8700     0.9046     69.7714
07500     0.3123      0.9300     0.9046     69.8673
07600     0.3435      0.9100     0.9046     70.4995
07700     0.3324      0.9000     0.9046     69.3047
07800     0.4809      0.8400     0.9046     69.4567
07900     0.4458      0.8500     0.9046     71.1355
08000     0.3924      0.8800     0.9046     70.0122
08100     0.5236      0.8700     0.9046     69.1639
08200     0.3879      0.8500     0.9046     68.5330
08300     0.4019      0.9100     0.9046     68.6977
08400     0.2788      0.9200     0.9046     69.1407
08500     0.4998      0.8500     0.9046     69.0455
08600     0.4545      0.8900     0.9046     69.5834
08700     0.3186      0.9100     0.9046     70.3159
08800     0.4155      0.8600     0.9046     69.0770
08900     0.3163      0.9000     0.9046     69.3856
09000     0.3895      0.8600     0.9046     69.1170
09100     0.4032      0.9000     0.9046     69.2233
09200     0.3694      0.9000     0.9046     69.2856
09300     0.3362      0.9300     0.9046     69.3293
09400     0.3725      0.8700     0.9046     68.7703
09500     0.3754      0.8700     0.9046     69.6089
09600     0.3170      0.9000     0.9046     70.1557
09700     0.3988      0.8500     0.9046     69.3085
09800     0.2667      0.9100     0.9046     69.2160
09900     0.2835      0.9300     0.9046     69.9991
Start testing:
Test Accuracy: 0.8993
