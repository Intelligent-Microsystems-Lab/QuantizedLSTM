Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=14, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.0, noise_injectionT=0.0, pact_a=True, quant_actMVM=5, quant_actNM=5, quant_inp=5, quant_w=5, random_seed=8627169, rows_bias=100, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
bc7c9e44-7b46-45a8-bb68-0d57469ed0e5
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 147, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 373, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 209, in forward
    part1 = CustomMM_bmm.apply(quant_pass(pact_a_bmm(input.repeat(self.n_blocks, 1, 1), self.a1), self.ib, self.a1), self.weight_ih, self.bias_ih, self.noise_level, self.wb, self.bias_r)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 145, in forward
    wq = quant_pass(weight, wb, 1.)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 82, in forward
    if len(x_range) > 1:
TypeError: object of type 'float' has no len()
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=14, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.0, noise_injectionT=0.0, pact_a=True, quant_actMVM=5, quant_actNM=5, quant_inp=5, quant_w=5, random_seed=8627169, rows_bias=100, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
3fd11a34-6aa8-4279-94a9-e7600016455b
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 147, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 373, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 209, in forward
    part1 = CustomMM_bmm.apply(quant_pass(pact_a_bmm(input.repeat(self.n_blocks, 1, 1), self.a1), self.ib, self.a1), self.weight_ih, self.bias_ih, self.noise_level, self.wb, self.bias_r)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 145, in forward
    wq = quant_pass(weight, wb, torch.tensor([1.]).device(input.device))
TypeError: 'torch.device' object is not callable
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=14, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.0, noise_injectionT=0.0, pact_a=True, quant_actMVM=5, quant_actNM=5, quant_inp=5, quant_w=5, random_seed=8627169, rows_bias=100, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
0017a7de-72bf-4a61-a094-710b6a0a0ba6
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     3.3224      0.0485     0.0704     11.4333
00100     2.6152      0.1181     0.1090     72.3446
00200     2.4222      0.2553     0.2087     74.2817
00300     2.2394      0.2764     0.3296     72.7035
00400     2.2836      0.3143     0.3673     74.2933
00500     2.2024      0.3523     0.3845     73.1579
00600     2.0179      0.3903     0.4102     72.7692
00700     2.1309      0.3671     0.4102     73.6198
00800     1.7543      0.4051     0.4224     74.2646
00900     1.9256      0.3840     0.4374     72.6571
01000     1.7630      0.4304     0.4374     73.4090
01100     1.7235      0.4177     0.4495     74.5103
01200     1.8320      0.4177     0.4495     72.7595
01300     1.6675      0.4198     0.4800     72.7333
01400     1.6568      0.4515     0.4901     72.6126
01500     1.6241      0.4726     0.5110     73.5071
01600     1.4983      0.4747     0.5110     74.5182
01700     1.5956      0.5000     0.5512     73.6951
01800     1.3780      0.5443     0.5512     75.2658
01900     1.4244      0.4662     0.5512     74.1125
02000     1.5307      0.5000     0.5670     72.8368
02100     1.4478      0.4958     0.5670     74.0612
02200     1.6091      0.4262     0.5670     73.2947
02300     1.3990      0.4958     0.5722     73.4941
02400     1.3783      0.5359     0.5722     73.1042
02500     1.3948      0.5295     0.5869     73.1535
02600     1.3914      0.5295     0.5869     73.0188
02700     1.4357      0.5422     0.5869     75.5792
02800     1.3420      0.5211     0.5869     72.9977
02900     1.2392      0.5675     0.5869     73.2538
03000     1.3996      0.5485     0.5869     74.2991
03100     1.3404      0.5464     0.5869     72.5672
03200     1.4354      0.5422     0.5869     72.7338
03300     1.5595      0.4662     0.5869     72.7056
03400     1.3121      0.6076     0.5969     73.5356
03500     1.3677      0.5422     0.6004     73.9515
03600     1.3759      0.5127     0.6084     75.6591
03700     1.3080      0.5485     0.6143     72.6233
03800     1.3242      0.5696     0.6224     75.4000
03900     1.3484      0.5169     0.6224     74.5961
04000     1.3864      0.5000     0.6224     76.2275
04100     1.3053      0.5148     0.6224     74.0126
04200     1.3792      0.5148     0.6268     72.8907
04300     1.1950      0.5949     0.6268     73.6342
04400     1.3170      0.4979     0.6268     72.3766
04500     1.3285      0.5717     0.6268     73.3771
04600     1.2724      0.5844     0.6268     73.9595
04700     1.2646      0.5506     0.6278     73.8015
04800     1.1323      0.6055     0.6324     73.9058
04900     1.2718      0.5928     0.6324     73.8365
05000     1.2474      0.5886     0.6324     75.3109
05100     1.2870      0.5886     0.6345     74.6776
05200     1.2131      0.6160     0.6345     74.8895
05300     1.3500      0.5591     0.6345     78.0901
05400     1.3045      0.5506     0.6345     76.5929
05500     1.3081      0.5570     0.6345     75.1414
05600     1.3264      0.5549     0.6483     76.6047
05700     1.1859      0.5844     0.6483     73.0373
05800     1.3155      0.5865     0.6483     74.9357
05900     1.3553      0.5232     0.6483     75.2082
06000     1.3005      0.5549     0.6526     73.5282
06100     1.1796      0.5633     0.6526     72.9920
06200     1.2675      0.5527     0.6526     74.5358
06300     1.1795      0.6350     0.6526     75.5650
06400     1.2889      0.5823     0.6526     76.6549
06500     1.3738      0.5148     0.6526     74.5655
06600     1.1936      0.6055     0.6526     74.9965
06700     1.2152      0.5654     0.6526     75.5859
06800     1.2572      0.5506     0.6526     74.3000
06900     1.1985      0.6097     0.6526     74.9909
07000     1.2493      0.6160     0.6526     73.7122
07100     1.2694      0.5781     0.6526     74.4543
07200     1.3727      0.5464     0.6526     74.9520
07300     1.3223      0.5696     0.6526     73.3155
07400     1.2157      0.6076     0.6526     75.0359
07500     1.0890      0.6266     0.6572     74.6725
07600     1.2961      0.5401     0.6572     74.4360
07700     1.2003      0.5928     0.6572     75.0295
07800     1.0419      0.6076     0.6572     74.6926
07900     1.1472      0.6139     0.6572     73.6861
08000     1.3722      0.5549     0.6572     76.7005
08100     1.0593      0.6308     0.6572     74.2355
08200     1.1489      0.5886     0.6572     76.3023
08300     1.1510      0.6245     0.6572     70.8170
08400     1.2196      0.6034     0.6572     73.0611
08500     1.2027      0.5992     0.6572     73.6653
08600     1.2295      0.5970     0.6572     74.1713
08700     1.0897      0.5907     0.6572     75.0989
08800     1.2523      0.5675     0.6581     73.5910
08900     1.0159      0.5970     0.6581     72.7955
09000     1.2479      0.6013     0.6581     74.5313
09100     1.2451      0.5886     0.6581     73.9859
09200     1.2414      0.5717     0.6702     74.0076
09300     1.1849      0.6245     0.6702     72.7995
09400     1.3014      0.5738     0.6702     72.9015
09500     1.2324      0.6139     0.6702     72.9350
09600     1.0048      0.6667     0.6702     73.7056
09700     1.1204      0.6181     0.6702     74.2996
09800     1.2345      0.5612     0.6702     72.6580
09900     1.1870      0.5654     0.6702     74.4702
10000     1.2840      0.5970     0.6702     75.6071
10100     1.2558      0.5949     0.6702     72.8127
10200     1.1961      0.5802     0.6702     74.1805
10300     1.0204      0.6371     0.6702     75.2073
10400     1.1038      0.6245     0.6702     76.5813
10500     1.2088      0.5759     0.6702     73.5166
10600     1.1329      0.5970     0.6702     75.6092
10700     1.0864      0.6519     0.6734     76.1666
10800     1.1874      0.5928     0.6734     75.4179
10900     1.2531      0.5696     0.6738     73.8813
11000     1.2765      0.6076     0.6738     73.3481
11100     1.2670      0.6034     0.6738     75.1657
11200     1.2098      0.6139     0.6738     75.6978
11300     1.2112      0.6160     0.6738     74.1368
11400     1.0014      0.6709     0.6738     73.5589
11500     1.0342      0.6181     0.6738     74.5595
11600     1.2355      0.5823     0.6738     74.1990
11700     1.2028      0.5675     0.6738     73.1061
11800     1.2659      0.5781     0.6738     74.6795
11900     1.0459      0.6308     0.6738     72.8855
12000     1.1435      0.5949     0.6738     76.1846
12100     1.3205      0.5886     0.6738     74.6629
12200     1.1927      0.6181     0.6738     75.3132
12300     1.1106      0.6371     0.6738     73.4777
12400     1.1172      0.6181     0.6738     74.8988
12500     1.0681      0.6561     0.6738     74.4627
12600     1.2347      0.5696     0.6738     74.3171
12700     1.1509      0.6181     0.6738     74.1834
12800     1.0924      0.6245     0.6738     75.5072
12900     1.1436      0.6287     0.6738     73.3034
13000     1.1223      0.6266     0.6738     73.6929
13100     1.2782      0.5907     0.6738     74.6173
13200     1.2141      0.6118     0.6738     75.4307
13300     1.1363      0.5717     0.6738     73.4190
13400     1.1036      0.5928     0.6738     74.3599
13500     1.2590      0.5759     0.6738     72.3598
13600     1.2773      0.5992     0.6738     73.5333
13700     1.1464      0.6160     0.6738     73.8840
13800     1.1198      0.5928     0.6738     75.6412
13900     1.0576      0.6245     0.6750     73.4939
14000     1.0672      0.6350     0.6750     74.0712
14100     1.1160      0.6414     0.6750     72.9395
14200     1.1262      0.5949     0.6750     74.8765
14300     1.2008      0.6013     0.6750     73.9171
14400     1.1456      0.5823     0.6750     73.2854
14500     1.1225      0.6055     0.6750     72.2000
14600     1.2440      0.5675     0.6750     73.9083
14700     1.1380      0.6118     0.6750     75.7249
14800     1.1568      0.5591     0.6750     74.6075
14900     1.1258      0.6245     0.6750     73.2468
15000     1.1768      0.5928     0.6750     74.1806
15100     1.1439      0.5759     0.6750     73.1576
15200     1.2177      0.5970     0.6750     74.7904
15300     1.2092      0.6055     0.6750     73.9147
15400     1.2544      0.5549     0.6750     73.8512
15500     1.1303      0.6435     0.6750     73.1321
15600     1.0993      0.6076     0.6750     72.6805
15700     1.0557      0.6414     0.6750     73.3895
15800     1.1273      0.6245     0.6750     74.0133
15900     1.1054      0.6013     0.6750     74.2106
16000     1.2331      0.5633     0.6750     75.0976
16100     1.1186      0.5886     0.6750     76.3186
16200     1.0552      0.6540     0.6750     74.4471
16300     1.1792      0.5886     0.6750     73.8183
16400     1.2919      0.5865     0.6750     74.4407
16500     1.0571      0.6498     0.6750     72.7427
16600     1.1651      0.6203     0.6750     76.0357
16700     1.0870      0.6076     0.6750     73.0488
16800     1.1529      0.5928     0.6750     73.5725
16900     1.2574      0.5886     0.6750     76.6823
17000     1.1213      0.6076     0.6750     73.7507
17100     1.1901      0.5844     0.6812     72.9428
17200     1.1591      0.6181     0.6812     74.0050
17300     1.1900      0.5907     0.6812     73.8636
17400     1.1740      0.6181     0.6812     74.6742
17500     1.2185      0.5886     0.6812     74.2421
17600     1.1144      0.6308     0.6812     73.8075
17700     1.1803      0.6160     0.6812     74.5457
17800     1.3244      0.5633     0.6812     73.3066
17900     1.2575      0.5970     0.6812     75.3337
18000     1.1678      0.5823     0.6812     74.1714
18100     1.2677      0.5527     0.6812     73.8876
18200     1.1827      0.6203     0.6812     74.9517
18300     1.2474      0.5802     0.6812     73.3907
18400     1.0183      0.6561     0.6812     74.2833
18500     1.2675      0.5844     0.6812     73.9979
18600     1.0788      0.6329     0.6812     75.4620
18700     1.1506      0.6414     0.6812     73.7760
18800     1.0900      0.5591     0.6812     74.5833
18900     1.2592      0.5422     0.6812     72.8961
19000     1.2207      0.5970     0.6812     73.7368
19100     1.2143      0.5717     0.6812     74.8759
19200     1.2818      0.6013     0.6812     75.1607
19300     1.1781      0.6203     0.6812     74.7734
19400     1.2102      0.5992     0.6812     73.0320
19500     1.1764      0.5886     0.6812     74.2522
19600     1.0599      0.6203     0.6812     75.4442
19700     1.2843      0.5802     0.6812     75.7814
19800     1.3286      0.5823     0.6812     74.1138
19900     1.1041      0.6097     0.6905     74.4904
20000     1.2656      0.5928     0.6905     73.9387
20100     1.2866      0.5422     0.6905     76.6895
20199     1.2839      0.5802     0.6905     73.5364
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     1.2194      0.6139     0.6691     10.4623
00100     1.0158      0.6498     0.6691     74.0623
00200     1.0573      0.6414     0.6691     73.7736
00300     1.0955      0.6329     0.6787     72.8974
00400     1.0592      0.6287     0.6787     73.6909
00500     1.0844      0.6097     0.6788     72.9522
00600     1.1560      0.6181     0.6788     72.6507
00700     1.1541      0.6392     0.6804     75.8976
00800     1.1277      0.5886     0.6804     73.5895
00900     1.0570      0.6498     0.6804     74.4858
01000     1.0646      0.6350     0.6804     73.2790
01100     1.0873      0.6371     0.6804     72.6947
01200     1.1622      0.6245     0.6804     73.4438
01300     1.0216      0.6308     0.6804     73.4997
01400     1.1135      0.6287     0.6804     74.4144
01500     1.0112      0.6224     0.6804     71.6765
01600     1.0319      0.6435     0.6804     74.9718
01700     1.0314      0.6519     0.6804     73.1059
01800     1.1365      0.6456     0.6804     74.3161
01900     0.9623      0.6561     0.6804     73.7900
02000     1.1149      0.6224     0.6804     73.3630
02100     1.1150      0.6076     0.6804     72.9331
02200     1.0008      0.6414     0.6804     73.7565
02300     1.1169      0.5949     0.6804     73.1011
02400     1.0588      0.6308     0.6804     73.0088
02500     1.1262      0.5886     0.6804     72.7379
02600     1.0193      0.6603     0.6804     74.1035
02700     1.0826      0.6414     0.6804     75.1815
02800     1.1508      0.6118     0.6804     73.2486
02900     1.0324      0.6582     0.6804     75.2315
03000     1.1493      0.5844     0.6804     74.6026
03100     1.0993      0.6371     0.6804     73.4863
03200     1.0575      0.6456     0.6804     74.3746
03300     1.1132      0.6561     0.6811     75.1036
03400     1.1551      0.6118     0.6811     74.7026
03500     1.0501      0.5992     0.6811     74.5225
03600     1.1300      0.6329     0.6811     74.6464
03700     1.0654      0.6097     0.6811     73.4417
03800     1.1059      0.5970     0.6811     74.6944
03900     0.9613      0.6582     0.6811     76.3569
04000     1.0445      0.6245     0.6811     76.3218
04100     0.9678      0.6519     0.6811     73.0472
04200     1.0435      0.6308     0.6855     73.2970
04300     1.1073      0.6181     0.6855     73.8198
04400     1.0330      0.6371     0.6855     73.5130
04500     1.1601      0.5970     0.6855     75.1263
04600     1.1534      0.6266     0.6855     72.6537
04700     1.1201      0.6203     0.6855     74.7250
04800     1.1095      0.6160     0.6855     75.2987
04900     1.0532      0.6308     0.6855     76.3799
05000     1.0595      0.6371     0.6855     74.6075
05100     1.1282      0.6034     0.6855     74.5747
05200     0.9951      0.6329     0.6855     72.9616
05300     1.0211      0.6414     0.6855     74.2927
05400     1.1752      0.6118     0.6855     74.3362
05500     1.1818      0.6414     0.6855     74.1352
05600     1.0651      0.6730     0.6855     74.2066
05700     0.9671      0.6519     0.6855     76.6535
05800     1.1041      0.6414     0.6855     74.7481
05900     1.0917      0.6329     0.6855     74.7597
06000     0.9247      0.6266     0.6855     74.5096
06100     0.9834      0.6456     0.6855     75.1967
06200     1.0483      0.6498     0.6855     74.5869
06300     1.1195      0.6371     0.6855     74.0607
06400     1.0964      0.6456     0.6855     74.5851
06500     1.0904      0.6266     0.6855     76.4830
06600     1.1669      0.5907     0.6855     74.1498
06700     1.1280      0.6181     0.6855     73.5675
06800     1.0276      0.6329     0.6855     73.2362
06900     1.0709      0.6287     0.6855     73.4979
07000     1.0511      0.6287     0.6855     75.0904
07100     1.0219      0.6477     0.6855     76.3862
07200     1.1489      0.5928     0.6855     73.8696
07300     1.0150      0.6224     0.6855     74.9315
07400     1.0480      0.6371     0.6855     76.0751
07500     0.9774      0.6224     0.6855     75.0612
07600     1.0553      0.6329     0.6855     74.1302
07700     1.0611      0.6371     0.6855     73.2101
07800     1.1740      0.6371     0.6855     74.0349
07900     1.2332      0.6034     0.6855     77.3118
08000     1.1762      0.5717     0.6855     73.6986
08100     0.9760      0.6392     0.6855     75.5087
08200     0.9670      0.6646     0.6855     75.6602
08300     0.9994      0.6329     0.6855     74.9781
08400     1.1316      0.5781     0.6855     74.2377
08500     1.0912      0.6181     0.6855     73.4165
08600     0.9986      0.6181     0.6855     74.0095
08700     1.0858      0.6266     0.6855     74.3695
08800     1.0334      0.6540     0.6855     74.4779
08900     1.0378      0.6203     0.6855     73.0100
09000     1.1133      0.5992     0.6855     74.0067
09100     1.0340      0.6308     0.6855     74.8743
09200     1.0172      0.6371     0.6855     74.4759
09300     1.0598      0.6561     0.6855     72.7313
09400     1.0546      0.6435     0.6855     74.2761
09500     1.0387      0.6224     0.6855     76.1386
09600     1.0842      0.6624     0.6855     73.7602
09700     1.0914      0.6245     0.6855     74.8412
09800     1.1792      0.6055     0.6855     74.3207
09900     1.0115      0.6477     0.6855     74.8917
Start testing:
Test Accuracy: 0.6671
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
