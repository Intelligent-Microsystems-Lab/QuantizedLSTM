Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=108, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=1, n_mfcc=40, n_msb=6, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=193012823, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
4cd01a81-c01f-415d-888d-e4dcba4f1431
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 167, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 373, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 212, in forward
    gates = quant_pass(pact_a_bmm( quant_pass(pact_a_bmm(part1, self.a12), self.abMVM, self.a12) + quant_pass(pact_a_bmm(part2, self.a13), self.abMVM, self.a13), self.a14), self.abNM, self.a14)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 89, in forward
    x01q =  torch.round(x01 * step_d ) / step_d
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 10.76 GiB total capacity; 9.70 GiB already allocated; 11.12 MiB free; 9.79 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=108, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=1, n_mfcc=40, n_msb=6, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=193012823, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
87ecc710-47cd-46bc-b59e-26f3c6d17f5a
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     3.1870      0.0907     0.0741     11.1419
00100     1.6182      0.4641     0.4750     58.0150
00200     1.1877      0.6118     0.6230     57.5101
00300     1.1063      0.6371     0.6874     58.4883
00400     0.9743      0.6624     0.7183     56.9611
00500     0.9032      0.7068     0.7439     57.3143
00600     0.8383      0.6962     0.7654     59.1414
00700     0.7814      0.7511     0.7806     58.0729
00800     0.7374      0.7700     0.7849     58.9454
00900     0.8659      0.7553     0.7869     57.9382
01000     0.7530      0.7363     0.7869     58.1921
01100     0.7966      0.7447     0.8052     58.2058
01200     0.6810      0.7848     0.8052     57.4938
01300     0.7875      0.7342     0.8107     58.2894
01400     0.6763      0.7616     0.8107     58.3382
01500     0.7831      0.7405     0.8107     58.1039
01600     0.7908      0.7616     0.8281     58.7262
01700     0.7269      0.7468     0.8281     57.7735
01800     0.7531      0.7616     0.8281     57.6509
01900     0.6224      0.8122     0.8281     58.7994
02000     0.6580      0.8017     0.8281     57.5628
02100     0.6029      0.7911     0.8281     57.9990
02200     0.6409      0.7890     0.8281     58.2107
02300     0.5926      0.7975     0.8281     57.7496
02400     0.5895      0.8080     0.8382     58.8021
02500     0.6583      0.7827     0.8382     58.1707
02600     0.6194      0.8101     0.8382     57.9200
02700     0.6502      0.8038     0.8382     58.3203
02800     0.6337      0.8017     0.8382     57.7678
02900     0.6371      0.7827     0.8382     58.2014
03000     0.6780      0.7743     0.8382     58.6896
03100     0.6133      0.7890     0.8382     58.8900
03200     0.5663      0.8165     0.8382     58.3817
03300     0.6685      0.7996     0.8408     57.7099
03400     0.5647      0.8165     0.8408     58.5831
03500     0.5383      0.8333     0.8408     58.2853
03600     0.5199      0.8333     0.8408     57.9306
03700     0.6424      0.7954     0.8408     57.9915
03800     0.5034      0.8249     0.8408     58.2078
03900     0.5308      0.8376     0.8408     58.2209
04000     0.5342      0.8080     0.8408     58.8845
04100     0.6366      0.7848     0.8421     57.9701
04200     0.5442      0.8333     0.8421     58.1114
04300     0.5985      0.8101     0.8421     58.9817
04400     0.5325      0.8143     0.8421     58.1988
04500     0.5871      0.8080     0.8421     57.9041
04600     0.5643      0.8291     0.8421     58.9802
04700     0.5654      0.8165     0.8421     58.7094
04800     0.5178      0.8207     0.8421     59.2460
04900     0.5057      0.8333     0.8421     58.0335
05000     0.5261      0.8460     0.8421     59.0490
05100     0.5015      0.8397     0.8421     58.4739
05200     0.4555      0.8460     0.8543     57.3139
05300     0.5280      0.8122     0.8543     57.2238
05400     0.5102      0.8523     0.8543     59.3104
05500     0.5672      0.8080     0.8543     58.6209
05600     0.4880      0.8460     0.8543     58.4182
05700     0.5311      0.8249     0.8543     58.3129
05800     0.4978      0.8312     0.8543     58.8986
05900     0.4825      0.8586     0.8543     59.0649
06000     0.4784      0.8376     0.8543     58.7372
06100     0.4687      0.8544     0.8584     58.2227
06200     0.4286      0.8755     0.8584     58.2630
06300     0.5027      0.8481     0.8584     58.6210
06400     0.4710      0.8397     0.8584     58.9943
06500     0.4698      0.8397     0.8584     57.7486
06600     0.5130      0.8439     0.8584     57.6471
06700     0.5179      0.8354     0.8584     58.1092
06800     0.5135      0.8333     0.8584     58.1998
06900     0.5913      0.8059     0.8584     58.4469
07000     0.5113      0.8249     0.8584     58.2955
07100     0.5135      0.8354     0.8584     58.1774
07200     0.4587      0.8523     0.8584     57.9487
07300     0.4576      0.8671     0.8584     57.6709
07400     0.5744      0.7996     0.8584     57.9081
07500     0.5145      0.8376     0.8584     58.1053
07600     0.4554      0.8397     0.8584     57.9643
07700     0.3705      0.8629     0.8584     58.2831
07800     0.4117      0.8565     0.8584     58.4111
07900     0.4129      0.8755     0.8584     57.2269
08000     0.5674      0.8080     0.8584     58.7645
08100     0.4256      0.8523     0.8584     58.5566
08200     0.5275      0.8333     0.8584     58.4629
08300     0.4758      0.8460     0.8584     59.1551
08400     0.5291      0.8186     0.8584     58.2783
08500     0.5102      0.8523     0.8584     58.0370
08600     0.4865      0.8481     0.8610     59.6189
08700     0.4217      0.8671     0.8610     58.8497
08800     0.4739      0.8418     0.8610     59.1564
08900     0.4700      0.8291     0.8610     58.7589
09000     0.4674      0.8397     0.8610     58.3547
09100     0.4458      0.8608     0.8610     58.7296
09200     0.4612      0.8502     0.8610     57.4383
09300     0.5655      0.8249     0.8610     58.2310
09400     0.5083      0.8333     0.8610     57.9893
09500     0.5062      0.8544     0.8610     57.6477
09600     0.4508      0.8650     0.8610     57.7537
09700     0.5096      0.8439     0.8610     57.8009
09800     0.4918      0.8270     0.8689     57.7717
09900     0.4814      0.8291     0.8689     58.8071
10000     0.4876      0.8544     0.8689     58.8839
10100     0.4434      0.8439     0.8689     58.7063
10200     0.4634      0.8481     0.8689     58.7181
10300     0.4251      0.8481     0.8689     58.3730
10400     0.4462      0.8544     0.8689     59.3466
10500     0.4162      0.8692     0.8689     58.6034
10600     0.3604      0.8924     0.8689     58.6956
10700     0.3986      0.8734     0.8689     58.9405
10800     0.4287      0.8629     0.8689     58.5040
10900     0.3579      0.9008     0.8689     58.1504
11000     0.3625      0.8840     0.8689     58.2024
11100     0.3604      0.8945     0.8689     58.0297
11200     0.4560      0.8376     0.8689     58.5402
11300     0.3654      0.8797     0.8689     57.2495
11400     0.3564      0.8924     0.8689     58.3080
11500     0.4137      0.8734     0.8689     58.7688
11600     0.3366      0.8987     0.8689     58.1415
11700     0.4647      0.8523     0.8689     58.1521
11800     0.3656      0.8840     0.8689     58.0774
11900     0.4308      0.8629     0.8689     57.7595
12000     0.5026      0.8544     0.8689     58.8986
12100     0.3771      0.8734     0.8689     57.7490
12200     0.4312      0.8776     0.8689     57.9246
12300     0.4619      0.8671     0.8689     59.4707
12400     0.3693      0.8861     0.8689     58.9371
12500     0.3855      0.8903     0.8689     58.3081
12600     0.4225      0.8755     0.8689     58.8044
12700     0.3175      0.9072     0.8689     57.6788
12800     0.3513      0.9008     0.8689     59.1704
12900     0.4173      0.8692     0.8689     58.3181
13000     0.4256      0.8544     0.8689     59.0176
13100     0.3686      0.8776     0.8689     58.6706
13200     0.4484      0.8713     0.8689     57.8511
13300     0.3325      0.8945     0.8689     58.0732
13400     0.3366      0.8819     0.8689     57.9766
13500     0.3705      0.8797     0.8689     58.2771
13600     0.3290      0.8966     0.8689     58.5370
13700     0.4143      0.8734     0.8689     59.1398
13800     0.3553      0.8882     0.8689     57.9221
13900     0.3053      0.9072     0.8689     58.4514
14000     0.4205      0.8692     0.8689     58.5203
14100     0.3469      0.8903     0.8689     57.9824
14200     0.3815      0.8797     0.8689     58.3978
14300     0.4626      0.8502     0.8689     58.2707
14400     0.3824      0.8819     0.8689     58.7746
14500     0.4272      0.8608     0.8689     57.5758
14600     0.3573      0.8776     0.8689     58.0562
14700     0.3912      0.8734     0.8689     58.7947
14800     0.4142      0.8734     0.8689     58.5879
14900     0.2972      0.9156     0.8689     58.3238
15000     0.3976      0.8797     0.8689     58.3804
15100     0.3596      0.8987     0.8689     58.0782
15200     0.3833      0.8734     0.8689     59.3030
15300     0.4252      0.8502     0.8689     58.3633
15400     0.4225      0.8692     0.8689     58.2348
15500     0.3893      0.8713     0.8689     59.1571
15600     0.4053      0.8797     0.8689     58.5653
15700     0.3594      0.8819     0.8689     59.4672
15800     0.3246      0.8987     0.8689     58.8374
15900     0.3473      0.8734     0.8689     57.3862
16000     0.3865      0.8776     0.8689     58.0809
16100     0.4395      0.8608     0.8689     58.9713
16200     0.4211      0.8734     0.8689     58.0506
16300     0.4210      0.8523     0.8689     59.4830
16400     0.4103      0.8671     0.8689     57.6054
16500     0.3884      0.8439     0.8689     58.3783
16600     0.3516      0.8840     0.8689     58.3878
16700     0.4628      0.8460     0.8689     58.7401
16800     0.3391      0.8903     0.8689     58.8803
16900     0.3460      0.8945     0.8689     58.1677
17000     0.4010      0.8819     0.8689     58.8814
17100     0.3479      0.8840     0.8689     58.7588
17200     0.3832      0.8608     0.8689     58.5545
17300     0.3497      0.8924     0.8689     58.6202
17400     0.4177      0.8608     0.8689     60.5425
17500     0.4010      0.8608     0.8689     57.9770
17600     0.4325      0.8586     0.8689     59.2187
17700     0.3963      0.8608     0.8689     58.3326
17800     0.3725      0.9008     0.8689     58.5206
17900     0.3961      0.8882     0.8689     58.5673
18000     0.3699      0.8629     0.8689     58.6159
18100     0.3475      0.8945     0.8689     58.2376
18200     0.3734      0.8776     0.8689     57.9345
18300     0.3756      0.8840     0.8689     57.5685
18400     0.4843      0.8565     0.8689     58.5928
18500     0.3805      0.8797     0.8689     57.7039
18600     0.3733      0.8924     0.8689     58.4076
18700     0.4238      0.8797     0.8689     58.1161
18800     0.3605      0.8840     0.8689     57.6136
18900     0.3408      0.8903     0.8689     57.7411
19000     0.3938      0.8692     0.8689     59.1680
19100     0.4012      0.8776     0.8689     58.4572
19200     0.3493      0.8840     0.8689     59.9387
19300     0.3493      0.8819     0.8689     58.3670
19400     0.3615      0.8819     0.8689     58.8842
19500     0.3742      0.8819     0.8689     59.2230
19600     0.3543      0.8903     0.8689     58.5514
19700     0.3584      0.8924     0.8689     57.6250
19800     0.4207      0.8629     0.8689     59.2063
19900     0.3525      0.9030     0.8689     58.6216
20000     0.4004      0.8840     0.8689     59.7668
20100     0.3400      0.9051     0.8689     58.4950
20199     0.3879      0.8755     0.8689     57.8575
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     0.6819      0.7890     0.7801     9.9100
00100     0.4010      0.8692     0.8769     58.5706
00200     0.3838      0.8776     0.8814     57.7429
00300     0.3782      0.8692     0.8814     59.0326
00400     0.4185      0.8671     0.8814     57.9387
00500     0.4158      0.8650     0.8814     58.5750
00600     0.4172      0.8650     0.8821     59.4762
00700     0.3181      0.8840     0.8821     58.0778
00800     0.3562      0.8797     0.8821     58.1012
00900     0.4421      0.8460     0.8821     58.5127
01000     0.4268      0.8586     0.8821     58.1096
01100     0.3757      0.8882     0.8821     58.8086
01200     0.3557      0.8924     0.8821     59.0596
01300     0.3747      0.8861     0.8821     60.8232
01400     0.4502      0.8502     0.8821     60.6884
01500     0.4108      0.8650     0.8821     57.9497
01600     0.3711      0.8861     0.8846     58.7465
01700     0.3432      0.8840     0.8846     59.1974
01800     0.4122      0.8692     0.8853     58.5397
01900     0.3420      0.8861     0.8853     59.5308
02000     0.3682      0.8819     0.8853     58.4956
02100     0.3193      0.8840     0.8853     58.9458
02200     0.4514      0.8586     0.8853     58.9687
02300     0.3758      0.8755     0.8853     58.1929
02400     0.3335      0.8861     0.8853     57.9104
02500     0.3204      0.8861     0.8853     58.3580
02600     0.3916      0.8692     0.8853     57.7738
02700     0.3135      0.8924     0.8853     58.7968
02800     0.4431      0.8544     0.8853     57.7401
02900     0.4100      0.8819     0.8853     58.5557
03000     0.3452      0.8797     0.8853     59.0018
03100     0.3946      0.8861     0.8853     57.7205
03200     0.3677      0.8987     0.8853     57.9848
03300     0.3538      0.8776     0.8853     58.6874
03400     0.4106      0.8650     0.8853     57.7583
03500     0.3989      0.8671     0.8853     59.1540
03600     0.3427      0.8861     0.8853     58.6196
03700     0.3874      0.8734     0.8853     58.5781
03800     0.4341      0.8502     0.8853     58.8803
03900     0.4195      0.8755     0.8853     57.4453
04000     0.3461      0.8861     0.8853     58.0385
04100     0.3619      0.8819     0.8853     58.4193
04200     0.3552      0.8861     0.8853     57.9667
04300     0.4192      0.8755     0.8853     58.1199
04400     0.4255      0.8776     0.8853     58.8337
04500     0.3151      0.9008     0.8853     59.3625
04600     0.4017      0.8755     0.8853     60.1343
04700     0.3772      0.8755     0.8853     58.6795
04800     0.3579      0.8924     0.8853     59.0509
04900     0.3306      0.8840     0.8853     61.4844
05000     0.3682      0.8755     0.8853     58.5237
05100     0.5133      0.8439     0.8853     58.6666
05200     0.3833      0.8797     0.8853     60.4904
05300     0.3530      0.8903     0.8853     59.3154
05400     0.3918      0.8692     0.8853     57.4339
05500     0.4057      0.8692     0.8853     56.4768
05600     0.4031      0.8713     0.8853     56.0568
05700     0.3138      0.8987     0.8853     59.6117
05800     0.3639      0.8840     0.8853     60.9082
05900     0.2774      0.9135     0.8853     61.4004
06000     0.4120      0.8671     0.8853     57.5262
06100     0.3975      0.8713     0.8853     56.6995
06200     0.3785      0.8903     0.8853     56.0834
06300     0.3782      0.8861     0.8853     56.6538
06400     0.4132      0.8776     0.8853     55.8750
06500     0.3931      0.8819     0.8853     55.8391
06600     0.4162      0.8734     0.8853     56.3492
06700     0.4416      0.8544     0.8853     57.4938
06800     0.3250      0.9008     0.8853     57.9963
06900     0.3529      0.8945     0.8853     56.4215
07000     0.3503      0.8840     0.8853     57.3890
07100     0.3535      0.8776     0.8853     58.5003
07200     0.4118      0.8650     0.8853     57.8748
07300     0.3486      0.8861     0.8853     56.8012
07400     0.3761      0.8797     0.8853     58.6581
07500     0.3936      0.8692     0.8853     56.2368
07600     0.3379      0.8882     0.8853     56.6057
07700     0.4060      0.8776     0.8853     56.8922
07800     0.3445      0.8882     0.8853     57.3059
07900     0.3098      0.9093     0.8853     56.4344
08000     0.4048      0.8861     0.8853     56.6025
08100     0.3730      0.8650     0.8853     57.0114
08200     0.3578      0.8882     0.8853     58.7626
08300     0.3946      0.8861     0.8853     57.9142
08400     0.3499      0.8734     0.8853     55.5341
08500     0.3292      0.9051     0.8853     56.6469
08600     0.4347      0.8608     0.8853     58.0783
08700     0.3350      0.8819     0.8853     55.8583
08800     0.4243      0.8713     0.8853     56.4698
08900     0.4021      0.8565     0.8853     56.0138
09000     0.3887      0.8755     0.8853     58.1512
09100     0.3908      0.8650     0.8853     56.9288
09200     0.4459      0.8502     0.8853     61.6695
09300     0.3975      0.8713     0.8853     60.1922
09400     0.3964      0.8713     0.8853     61.1613
09500     0.3616      0.8755     0.8867     60.9328
09600     0.3837      0.8903     0.8867     61.2684
09700     0.3974      0.8692     0.8867     61.1934
09800     0.4092      0.8713     0.8867     60.7468
09900     0.3384      0.9008     0.8867     60.4265
Start testing:
Test Accuracy: 0.8918
