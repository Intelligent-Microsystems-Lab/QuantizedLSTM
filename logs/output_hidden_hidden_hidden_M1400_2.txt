Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=394, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=8627169, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
2b582ea8-d237-41cd-932a-c9c3f06e2bf7
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 147, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 374, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 213, in forward
    gates = quant_pass(pact_a_bmm( quant_pass(pact_a_bmm(part1, self.a12), self.abMVM, self.a12) + quant_pass(pact_a_bmm(part2, self.a13), self.abMVM, self.a13), self.a14), self.abNM, self.a14)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 89, in forward
    x01q =  torch.round(x01 * step_d ) / step_d
RuntimeError: CUDA out of memory. Tried to allocate 12.00 MiB (GPU 0; 10.76 GiB total capacity; 9.69 GiB already allocated; 9.12 MiB free; 9.80 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=394, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=8627169, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
a7d5e9a6-5a09-4ad9-85ea-dafa5e5ac739
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     3.4206      0.0700     0.1063     18.5445
00100     1.7277      0.4300     0.4647     70.6029
00200     1.2134      0.6300     0.6152     70.5761
00300     1.1143      0.6400     0.6669     70.9834
00400     1.0836      0.6600     0.7085     71.9515
00500     1.0540      0.6700     0.7262     71.1321
00600     1.0899      0.6200     0.7650     71.9536
00700     1.0373      0.6700     0.7650     71.3414
00800     0.9108      0.7000     0.7650     70.3246
00900     0.9039      0.7100     0.7841     71.1560
01000     0.7276      0.7300     0.7841     67.6794
01100     0.8294      0.7400     0.7966     69.0127
01200     0.9273      0.7500     0.7966     68.1606
01300     0.7618      0.7500     0.8082     69.7930
01400     1.0070      0.6900     0.8110     69.2504
01500     0.9476      0.6500     0.8110     67.4058
01600     0.7295      0.7400     0.8190     70.2324
01700     0.6736      0.8100     0.8190     68.0297
01800     1.0238      0.6700     0.8200     69.9360
01900     0.5953      0.8100     0.8200     69.6012
02000     0.8025      0.7400     0.8308     73.4543
02100     0.7008      0.8000     0.8308     67.9466
02200     0.6341      0.8200     0.8343     69.2259
02300     0.8367      0.7300     0.8343     70.0632
02400     0.6581      0.7900     0.8343     69.7886
02500     0.4999      0.8400     0.8478     70.8885
02600     0.6086      0.7700     0.8478     72.0404
02700     0.6051      0.7900     0.8478     72.6933
02800     0.5718      0.7900     0.8478     73.6126
02900     0.6780      0.7500     0.8478     73.4754
03000     0.8099      0.7300     0.8478     69.5166
03100     0.3162      0.9300     0.8576     69.7880
03200     0.7626      0.7400     0.8576     72.9574
03300     0.6965      0.7900     0.8576     76.9195
03400     0.6358      0.7700     0.8576     70.4273
03500     0.6117      0.8500     0.8576     71.9286
03600     0.6813      0.7600     0.8576     69.6345
03700     0.8579      0.7400     0.8576     72.4529
03800     0.4859      0.8600     0.8576     67.7588
03900     0.5488      0.8200     0.8576     70.1596
04000     0.7291      0.7200     0.8576     75.7068
04100     0.4971      0.8200     0.8598     77.4002
04200     0.7304      0.8000     0.8598     75.2978
04300     0.4671      0.8600     0.8630     75.2585
04400     0.5062      0.8200     0.8630     75.3834
04500     0.4279      0.8900     0.8630     78.7743
04600     0.5111      0.8400     0.8630     76.5514
04700     0.6237      0.8100     0.8630     78.3224
04800     0.5210      0.8200     0.8630     71.7343
04900     0.4143      0.8600     0.8630     72.4086
05000     0.5478      0.8300     0.8630     70.1625
05100     0.6234      0.8000     0.8630     70.0079
05200     0.6184      0.8100     0.8630     67.3172
05300     0.5583      0.8200     0.8630     68.5104
05400     0.4861      0.8200     0.8630     69.2433
05500     0.5037      0.7800     0.8630     69.0541
05600     0.4820      0.8500     0.8630     68.2205
05700     0.5567      0.8200     0.8630     68.8771
05800     0.3518      0.8700     0.8646     71.8969
05900     0.6464      0.8100     0.8653     67.8692
06000     0.6102      0.8200     0.8741     68.9084
06100     0.4273      0.8200     0.8741     70.1351
06200     0.5428      0.8500     0.8741     70.2042
06300     0.5091      0.8300     0.8741     75.0935
06400     0.6687      0.8100     0.8741     75.6587
06500     0.6358      0.7800     0.8741     68.2812
06600     0.5036      0.8500     0.8741     72.3965
06700     0.4241      0.8900     0.8741     68.7039
06800     0.5601      0.8200     0.8741     70.8972
06900     0.5741      0.8500     0.8741     68.6593
07000     0.3964      0.8600     0.8741     71.2968
07100     0.5566      0.8400     0.8741     74.6472
07200     0.5158      0.8700     0.8741     71.0302
07300     0.5278      0.8200     0.8741     72.3798
07400     0.5626      0.8100     0.8741     75.4892
07500     0.3568      0.9200     0.8772     77.8077
07600     0.3851      0.8900     0.8772     69.9629
07700     0.5113      0.8300     0.8842     72.4768
07800     0.4450      0.8400     0.8842     75.7768
07900     0.3844      0.8700     0.8842     72.9175
08000     0.4915      0.8900     0.8842     69.4806
08100     0.5880      0.7900     0.8842     67.4385
08200     0.3432      0.8500     0.8842     67.6922
08300     0.4448      0.8900     0.8842     71.4287
08400     0.4372      0.8600     0.8842     67.4983
08500     0.6094      0.8300     0.8842     68.0603
08600     0.4368      0.8600     0.8842     76.7499
08700     0.5905      0.8000     0.8842     77.3982
08800     0.6453      0.8300     0.8842     68.2833
08900     0.5069      0.8500     0.8842     68.7357
09000     0.4465      0.8800     0.8842     67.9056
09100     0.3901      0.8900     0.8842     69.0951
09200     0.3953      0.8800     0.8842     71.6748
09300     0.7097      0.7500     0.8842     67.8164
09400     0.3011      0.8900     0.8842     66.5798
09500     0.4319      0.8500     0.8842     70.0612
09600     0.4884      0.8500     0.8842     71.9710
09700     0.4467      0.8300     0.8842     76.4840
09800     0.6394      0.7900     0.8842     76.1658
09900     0.5239      0.8600     0.8842     73.6090
10000     0.4394      0.8600     0.8842     71.5759
10100     0.3471      0.9000     0.8842     71.4039
10200     0.6028      0.8300     0.8842     68.9747
10300     0.3049      0.8900     0.8864     67.9657
10400     0.3761      0.8900     0.8864     68.2671
10500     0.3987      0.8800     0.8864     69.5719
10600     0.3584      0.8700     0.8864     70.8164
10700     0.3830      0.9300     0.8864     66.9568
10800     0.3474      0.8900     0.8864     68.5012
10900     0.3318      0.9100     0.8864     74.6080
11000     0.3708      0.8900     0.8864     73.7834
11100     0.4384      0.8300     0.8864     70.5798
11200     0.4197      0.8700     0.8864     76.2444
11300     0.5040      0.8400     0.8864     72.7913
11400     0.2835      0.9400     0.8864     70.5316
11500     0.4666      0.8600     0.8864     73.7954
11600     0.3033      0.9100     0.8864     67.7624
11700     0.4444      0.8900     0.8864     69.9171
11800     0.3735      0.8600     0.8864     68.1301
11900     0.4410      0.8800     0.8864     68.8679
12000     0.3910      0.9100     0.8864     66.7073
12100     0.4306      0.8700     0.8864     69.2750
12200     0.3445      0.9000     0.8864     67.6402
12300     0.4572      0.8600     0.8864     68.5014
12400     0.3810      0.9100     0.8864     75.9156
12500     0.3802      0.8900     0.8864     76.6069
12600     0.4954      0.8600     0.8864     76.0970
12700     0.4241      0.8900     0.8864     75.9556
12800     0.2745      0.9200     0.8864     75.0385
12900     0.3506      0.9000     0.8864     68.0259
13000     0.4526      0.8700     0.8864     66.5139
13100     0.3611      0.9100     0.8864     66.1974
13200     0.3067      0.9100     0.8864     66.8810
13300     0.3275      0.9000     0.8864     74.9516
13400     0.3404      0.9000     0.8864     74.4691
13500     0.3312      0.9000     0.8864     69.5548
13600     0.2443      0.9100     0.8905     73.7198
13700     0.3027      0.9100     0.8905     75.7459
13800     0.3828      0.8900     0.8905     72.3306
13900     0.3541      0.8900     0.8905     67.0767
14000     0.4557      0.8500     0.8905     67.6885
14100     0.3785      0.8900     0.8905     68.3405
14200     0.4651      0.7700     0.8905     70.4061
14300     0.3061      0.9300     0.8905     67.7840
14400     0.4419      0.8400     0.8905     68.0182
14500     0.3118      0.9000     0.8905     69.6312
14600     0.5860      0.8000     0.8905     68.7329
14700     0.4333      0.9000     0.8905     70.6737
14800     0.3111      0.9000     0.8905     71.5904
14900     0.3204      0.8700     0.8905     72.2031
15000     0.3904      0.8600     0.8905     71.6351
15100     0.5624      0.8500     0.8905     69.7431
15200     0.4252      0.8500     0.8905     69.8738
15300     0.2281      0.9400     0.8905     69.1566
15400     0.4886      0.8600     0.8905     69.6920
15500     0.2200      0.9400     0.8905     70.1713
15600     0.1954      0.9500     0.8905     66.6556
15700     0.4080      0.8700     0.8905     68.0607
15800     0.2642      0.9400     0.8905     73.0120
15900     0.3517      0.8900     0.8905     74.6875
16000     0.3518      0.8900     0.8905     74.6987
16100     0.4169      0.8700     0.8905     73.9270
16200     0.3619      0.8800     0.8905     72.4866
16300     0.4702      0.8400     0.8905     71.4747
16400     0.3762      0.8700     0.8905     75.8389
16500     0.4009      0.8600     0.8905     73.7633
16600     0.2219      0.9300     0.8905     73.4912
16700     0.4899      0.8500     0.8905     67.2374
16800     0.3633      0.8800     0.8905     74.0620
16900     0.1882      0.9600     0.8905     74.1764
17000     0.3493      0.9200     0.8905     70.2716
17100     0.3073      0.8600     0.8905     72.4789
17200     0.5852      0.8400     0.8905     70.8589
17300     0.3673      0.8700     0.8905     69.5756
17400     0.4182      0.8600     0.8905     67.1682
17500     0.2310      0.9400     0.8905     67.3219
17600     0.2658      0.9300     0.8905     71.8906
17700     0.3377      0.8600     0.8905     67.3724
17800     0.3237      0.8800     0.8905     68.1046
17900     0.1753      0.9600     0.8905     76.0318
18000     0.2637      0.9100     0.8905     75.7349
18100     0.2813      0.9100     0.8905     75.4200
18200     0.2756      0.8900     0.8905     77.5507
18300     0.4791      0.8400     0.8905     69.5648
18400     0.3545      0.9200     0.8905     67.7097
18500     0.2652      0.9200     0.8905     70.4089
18600     0.3485      0.9100     0.8905     67.8871
18700     0.5427      0.8400     0.8905     68.2433
18800     0.2287      0.9400     0.8905     67.1764
18900     0.3184      0.9100     0.8905     71.1321
19000     0.3527      0.8700     0.8905     69.1655
19100     0.2484      0.9100     0.8905     67.4058
19200     0.2423      0.9200     0.8905     67.8298
19300     0.3668      0.8800     0.8905     68.6890
19400     0.3778      0.8700     0.8905     66.4806
19500     0.3372      0.9000     0.8905     69.0851
19600     0.3849      0.9000     0.8905     69.9277
19700     0.2473      0.9400     0.8905     69.0806
19800     0.4225      0.8600     0.8905     71.2047
19900     0.4038      0.8500     0.8905     70.7242
20000     0.2439      0.9100     0.8905     69.6736
20100     0.3133      0.9200     0.8905     70.0466
20199     0.2602      0.9000     0.8905     69.3495
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     0.7485      0.8000     0.7931     19.7647
00100     0.4701      0.8800     0.9008     71.6754
00200     0.3053      0.8600     0.9008     73.4752
00300     0.4704      0.8400     0.9030     70.0899
00400     0.4272      0.8400     0.9034     69.8367
00500     0.4502      0.8300     0.9034     67.7821
00600     0.3794      0.8800     0.9052     70.1313
00700     0.3647      0.8900     0.9052     69.8870
00800     0.2472      0.9400     0.9081     72.6801
00900     0.3080      0.8900     0.9081     73.0622
01000     0.2934      0.9200     0.9082     74.4920
01100     0.2864      0.9000     0.9082     69.7001
01200     0.3476      0.8800     0.9082     70.7698
01300     0.2404      0.9200     0.9084     73.4992
01400     0.3652      0.8900     0.9084     70.9573
01500     0.3413      0.8800     0.9084     70.5635
01600     0.2928      0.9100     0.9084     68.5670
01700     0.2321      0.9500     0.9084     70.9762
01800     0.5817      0.8200     0.9085     71.6111
01900     0.2975      0.9100     0.9085     74.0420
02000     0.2520      0.9300     0.9085     73.2256
02100     0.4096      0.8800     0.9085     72.5664
02200     0.2229      0.9000     0.9085     69.0558
02300     0.3545      0.9000     0.9085     69.6129
02400     0.1812      0.9300     0.9085     67.4708
02500     0.3066      0.8900     0.9085     72.5191
02600     0.3144      0.9100     0.9085     71.0130
02700     0.2848      0.9100     0.9085     69.5429
02800     0.2440      0.9300     0.9085     66.5442
02900     0.2740      0.9400     0.9085     69.5296
03000     0.2636      0.9400     0.9085     69.1690
03100     0.3880      0.9200     0.9085     67.3772
03200     0.2733      0.8900     0.9085     69.5492
03300     0.3255      0.8800     0.9085     70.5139
03400     0.1915      0.9600     0.9085     73.2044
03500     0.2755      0.9300     0.9088     73.0878
03600     0.2856      0.9400     0.9088     70.7730
03700     0.2518      0.9200     0.9088     67.8862
03800     0.4048      0.8700     0.9088     75.7197
03900     0.2696      0.9300     0.9088     83.2083
04000     0.2737      0.9000     0.9088     82.7994
04100     0.5239      0.8400     0.9088     82.0571
04200     0.2779      0.9100     0.9088     84.1657
04300     0.3120      0.9000     0.9088     83.4834
04400     0.3332      0.8900     0.9088     86.8193
04500     0.3541      0.9000     0.9088     81.6666
04600     0.2857      0.9100     0.9088     82.7106
04700     0.2152      0.9500     0.9088     81.4674
04800     0.3432      0.9000     0.9088     83.6866
04900     0.2654      0.9000     0.9099     82.4862
05000     0.4306      0.8500     0.9099     83.1615
05100     0.2550      0.9300     0.9099     84.5203
05200     0.4636      0.8500     0.9108     83.8672
05300     0.2165      0.9100     0.9108     86.3885
05400     0.3028      0.9000     0.9108     84.5170
05500     0.4568      0.8700     0.9108     82.8398
05600     0.2945      0.8900     0.9108     83.2384
05700     0.3344      0.9200     0.9108     83.4462
05800     0.3007      0.8900     0.9108     81.7562
05900     0.2919      0.9000     0.9108     84.2069
06000     0.3165      0.9100     0.9108     84.7976
06100     0.3414      0.8900     0.9108     83.2507
06200     0.3306      0.9000     0.9108     82.8849
06300     0.2690      0.9200     0.9108     83.0355
06400     0.3064      0.9200     0.9108     82.0272
06500     0.3009      0.8800     0.9108     80.3948
06600     0.3048      0.8900     0.9108     81.3362
06700     0.3136      0.8700     0.9108     81.9002
06800     0.2172      0.9400     0.9108     82.2059
06900     0.2546      0.9000     0.9108     80.8227
07000     0.4199      0.8500     0.9108     82.6035
07100     0.2881      0.9000     0.9108     81.6460
07200     0.2225      0.9000     0.9108     83.7351
07300     0.3633      0.8800     0.9108     82.0455
07400     0.3193      0.9000     0.9108     86.6686
07500     0.2465      0.9200     0.9108     81.7849
07600     0.3281      0.9100     0.9108     82.6819
07700     0.4063      0.8800     0.9108     84.1338
07800     0.2979      0.9100     0.9108     80.8558
07900     0.2865      0.9200     0.9108     83.2652
08000     0.3251      0.8800     0.9112     81.7766
08100     0.2759      0.9300     0.9112     86.2295
08200     0.2576      0.9100     0.9112     84.7346
08300     0.2262      0.9400     0.9112     84.1153
08400     0.3303      0.9100     0.9112     83.2650
08500     0.1782      0.9400     0.9112     83.5587
08600     0.4212      0.8700     0.9112     84.8305
08700     0.1591      0.9600     0.9112     82.7485
08800     0.2324      0.9400     0.9112     87.6844
08900     0.3185      0.9000     0.9112     83.6283
09000     0.2969      0.8800     0.9112     82.6256
09100     0.2937      0.8800     0.9112     83.3254
09200     0.4399      0.8500     0.9112     82.4410
09300     0.3117      0.8800     0.9112     81.5124
09400     0.2590      0.9300     0.9112     82.0513
09500     0.3439      0.8700     0.9112     81.4103
09600     0.3475      0.8800     0.9112     83.5112
09700     0.3468      0.8900     0.9112     83.5133
09800     0.2635      0.9200     0.9112     82.8762
09900     0.1911      0.9400     0.9112     86.7415
Start testing:
Test Accuracy: 0.9006
