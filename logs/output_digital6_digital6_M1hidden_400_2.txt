Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=394, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=8627169, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
5553162a-5caf-4f9b-8e34-1998dfe7eb50
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 147, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 374, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 213, in forward
    gates = quant_pass(pact_a_bmm( quant_pass(pact_a_bmm(part1, self.a12), self.abMVM, self.a12) + quant_pass(pact_a_bmm(part2, self.a13), self.abMVM, self.a13), self.a14), self.abNM, self.a14)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 89, in forward
    x01q =  torch.round(x01 * step_d ) / step_d
RuntimeError: CUDA out of memory. Tried to allocate 12.00 MiB (GPU 0; 10.76 GiB total capacity; 9.68 GiB already allocated; 13.12 MiB free; 9.79 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=394, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=8627169, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
9c02b7ec-3b7b-4385-8a7e-6f14ab94c1ae
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     3.4137      0.0800     0.0896     17.2314
00100     1.6605      0.3600     0.0950     61.6849
00200     1.1318      0.5600     0.0998     61.9625
00300     0.9230      0.6300     0.0998     61.3193
00400     1.0349      0.6300     0.0998     61.5192
00500     0.8975      0.7000     0.1003     62.3845
00600     0.7738      0.7500     0.1003     62.8079
00700     0.8096      0.7200     0.1003     62.8574
00800     0.7841      0.7700     0.1003     62.6154
00900     0.8921      0.6900     0.1003     62.6850
01000     0.6317      0.7900     0.1054     63.0958
01100     0.6200      0.8000     0.1054     62.5835
01200     0.6756      0.8200     0.1054     62.4194
01300     0.4578      0.8400     0.1054     62.9494
01400     0.6518      0.7800     0.1085     63.0012
01500     0.6812      0.7700     0.1085     62.8212
01600     0.4495      0.8300     0.1104     62.7917
01700     0.4970      0.8500     0.1126     63.3282
01800     0.5803      0.7900     0.1126     62.5620
01900     0.3372      0.9000     0.1304     63.3870
02000     0.6077      0.8000     0.1304     62.8192
02100     0.4542      0.8700     0.1304     62.9415
02200     0.3912      0.8200     0.1304     62.6362
02300     0.4209      0.8700     0.1304     62.8465
02400     0.4396      0.8600     0.1304     62.8661
02500     0.3711      0.8500     0.1304     62.2344
02600     0.3953      0.8500     0.1304     63.3561
02700     0.5153      0.8500     0.1304     62.8214
02800     0.2914      0.9100     0.1304     62.7879
02900     0.3066      0.8900     0.1370     62.2577
03000     0.4489      0.8600     0.1385     63.0900
03100     0.1860      0.9600     0.1385     62.7840
03200     0.4240      0.8700     0.1402     63.2392
03300     0.3920      0.8500     0.1402     62.6788
03400     0.3763      0.8700     0.1402     62.2168
03500     0.2644      0.9300     0.1402     62.9184
03600     0.3059      0.9100     0.1402     62.9827
03700     0.4924      0.8500     0.1402     63.5444
03800     0.2645      0.9200     0.1413     63.9303
03900     0.2449      0.9500     0.1512     63.7902
04000     0.5488      0.8300     0.1512     61.9960
04100     0.2245      0.9100     0.1512     62.1788
04200     0.4228      0.8600     0.1545     62.6624
04300     0.5155      0.8700     0.1545     62.3544
04400     0.2677      0.9400     0.1545     61.8651
04500     0.1838      0.9300     0.1612     62.2957
04600     0.3215      0.8900     0.1612     62.0933
04700     0.4538      0.8700     0.1622     62.9213
04800     0.2860      0.8900     0.1622     61.7311
04900     0.3850      0.8800     0.1640     62.3972
05000     0.1372      0.9600     0.1640     62.0296
05100     0.4238      0.8600     0.1733     63.0149
05200     0.5052      0.8400     0.1778     62.7709
05300     0.2638      0.9100     0.1778     62.4921
05400     0.2941      0.9200     0.1778     62.7175
05500     0.1844      0.9400     0.1822     62.6669
05600     0.3009      0.9400     0.1822     61.8161
05700     0.5437      0.8500     0.1854     62.3106
05800     0.2227      0.9100     0.1877     62.4405
05900     0.3648      0.8900     0.1917     62.2014
06000     0.3632      0.8600     0.1949     62.8171
06100     0.2019      0.9400     0.2137     62.3876
06200     0.3520      0.9100     0.2137     61.8852
06300     0.3293      0.8700     0.2137     62.0981
06400     0.4495      0.8600     0.2137     62.4231
06500     0.4036      0.8900     0.2403     62.2348
06600     0.3376      0.9100     0.2403     61.7401
06700     0.1906      0.9300     0.2403     62.5297
06800     0.3296      0.8900     0.2403     62.0099
06900     0.2921      0.9000     0.2403     62.5910
07000     0.2050      0.9100     0.2403     62.0826
07100     0.3064      0.9000     0.2403     62.1017
07200     0.2670      0.8900     0.2403     61.9362
07300     0.3293      0.8800     0.2403     62.1247
07400     0.2951      0.9400     0.2403     62.0689
07500     0.1715      0.9600     0.2403     62.2807
07600     0.3901      0.8800     0.2403     62.2428
07700     0.2856      0.8700     0.2403     62.5712
07800     0.2643      0.9100     0.2403     62.5223
07900     0.2373      0.9000     0.2403     62.7116
08000     0.2647      0.9300     0.2438     62.6629
08100     0.2816      0.8800     0.2438     62.6875
08200     0.1457      0.9500     0.2487     63.3996
08300     0.2750      0.9100     0.2566     62.9340
08400     0.2008      0.9100     0.2566     62.3767
08500     0.3336      0.8900     0.2566     61.8969
08600     0.3575      0.9300     0.2566     62.3241
08700     0.2682      0.9100     0.2588     62.6443
08800     0.3054      0.9100     0.2588     62.3136
08900     0.2865      0.9300     0.2588     61.6947
09000     0.2455      0.9000     0.2588     62.1386
09100     0.2353      0.9100     0.2588     61.8719
09200     0.1848      0.9400     0.2588     61.8228
09300     0.5435      0.8600     0.2588     61.9402
09400     0.1493      0.9600     0.2651     62.7052
09500     0.2729      0.9000     0.2730     62.7687
09600     0.2412      0.9300     0.2730     61.9955
09700     0.3641      0.8800     0.2730     62.4901
09800     0.3313      0.8800     0.2736     62.7979
09900     0.1472      0.9500     0.2969     62.5742
10000     0.2317      0.9000     0.2969     61.8799
10100     0.1477      0.9600     0.2969     62.9373
10200     0.3558      0.8700     0.2969     62.3879
10300     0.1516      0.9400     0.2975     63.2438
10400     0.2510      0.9400     0.2975     62.2227
10500     0.0877      0.9800     0.2975     62.5252
10600     0.1563      0.9400     0.3020     62.5418
10700     0.2150      0.9200     0.3020     62.3289
10800     0.1750      0.9400     0.3020     61.8231
10900     0.1503      0.9500     0.3020     62.0437
11000     0.1779      0.9500     0.3020     61.8351
11100     0.2137      0.9400     0.3020     62.6094
11200     0.2568      0.9000     0.3020     62.4878
11300     0.2262      0.9000     0.3020     62.0681
11400     0.1146      0.9700     0.3020     62.0491
11500     0.2250      0.9100     0.3020     61.6492
11600     0.2281      0.9200     0.3020     61.8706
11700     0.2316      0.9300     0.3025     62.4869
11800     0.2646      0.9300     0.3025     61.9427
11900     0.2181      0.9300     0.3025     62.3039
12000     0.1084      0.9800     0.3025     62.2361
12100     0.2707      0.8900     0.3025     61.9883
12200     0.0803      0.9700     0.3025     62.2473
12300     0.1716      0.9100     0.3025     62.0193
12400     0.2673      0.9300     0.3025     62.1953
12500     0.1476      0.9100     0.3025     62.4649
12600     0.2204      0.9200     0.3025     62.1490
12700     0.1937      0.9300     0.3025     62.3878
12800     0.0585      1.0000     0.3025     62.4794
12900     0.2534      0.9100     0.3025     62.3042
13000     0.1359      0.9500     0.3025     62.0427
13100     0.1529      0.9500     0.3025     62.0248
13200     0.2144      0.9400     0.3025     61.9447
13300     0.1439      0.9500     0.3025     61.8491
13400     0.2390      0.9400     0.3025     62.1206
13500     0.1859      0.9400     0.3025     62.5789
13600     0.0608      0.9700     0.3025     62.4324
13700     0.1344      0.9700     0.3025     62.4738
13800     0.1990      0.9500     0.3025     61.9382
13900     0.1712      0.9600     0.3025     62.1010
14000     0.1638      0.9400     0.3025     61.6139
14100     0.1122      0.9500     0.3025     62.0089
14200     0.2323      0.9200     0.3025     62.2640
14300     0.1875      0.9300     0.3025     62.2740
14400     0.1899      0.9200     0.3025     62.0279
14500     0.1154      0.9700     0.3025     62.3420
14600     0.3161      0.9100     0.3025     62.3868
14700     0.1159      0.9700     0.3025     62.6125
14800     0.0996      0.9400     0.3025     62.7875
14900     0.1601      0.9500     0.3025     62.0578
15000     0.1930      0.9400     0.3025     62.1864
15100     0.2292      0.9500     0.3025     62.1895
15200     0.1894      0.9600     0.3025     62.2071
15300     0.1638      0.9600     0.3043     62.3689
15400     0.1833      0.9500     0.3043     62.6336
15500     0.1504      0.9600     0.3129     62.7758
15600     0.1105      0.9500     0.3129     62.2944
15700     0.1251      0.9400     0.3220     62.9895
15800     0.2041      0.9200     0.3220     62.3170
15900     0.0524      0.9800     0.3220     62.1843
16000     0.1276      0.9700     0.3220     62.2835
16100     0.2107      0.9200     0.3220     62.5078
16200     0.1030      0.9700     0.3220     61.8283
16300     0.1661      0.9600     0.3220     62.1996
16400     0.2597      0.9300     0.3220     62.3432
16500     0.0975      0.9400     0.3220     62.4831
16600     0.1274      0.9700     0.3220     62.1074
16700     0.1263      0.9600     0.3220     62.7197
16800     0.1324      0.9600     0.3220     61.8403
16900     0.1257      0.9500     0.3220     62.3876
17000     0.1083      0.9800     0.3220     61.7883
17100     0.1501      0.9400     0.3220     62.0402
17200     0.2681      0.9100     0.3220     62.0750
17300     0.2027      0.9400     0.3220     62.3567
17400     0.1627      0.9400     0.3220     62.6589
17500     0.0351      1.0000     0.3220     61.9860
17600     0.1158      0.9600     0.3220     62.7958
17700     0.1195      0.9600     0.3220     62.3767
17800     0.1491      0.9300     0.3220     62.1496
17900     0.1746      0.9700     0.3220     61.7999
18000     0.0406      1.0000     0.3220     62.5636
18100     0.1486      0.9400     0.3220     62.3948
18200     0.1944      0.9200     0.3220     62.4827
18300     0.1598      0.9700     0.3220     62.9639
18400     0.1219      0.9700     0.3220     63.3583
18500     0.0637      0.9800     0.3220     62.4464
18600     0.1262      0.9400     0.3220     62.6647
18700     0.2302      0.9100     0.3220     62.8304
18800     0.1643      0.9500     0.3220     62.2992
18900     0.0812      0.9600     0.3220     62.9338
19000     0.2322      0.9300     0.3220     62.4160
19100     0.1484      0.9600     0.3220     63.0766
19200     0.1136      0.9500     0.3220     62.8726
19300     0.2012      0.9400     0.3220     62.9696
19400     0.0856      0.9700     0.3220     62.9950
19500     0.0941      0.9700     0.3220     62.3460
19600     0.1989      0.9400     0.3220     62.5918
19700     0.1065      0.9600     0.3220     63.4399
19800     0.1641      0.9600     0.3220     62.7711
19900     0.2252      0.9500     0.3220     63.6036
20000     0.0738      0.9700     0.3220     63.4758
20100     0.1484      0.9400     0.3220     62.6606
20199     0.0675      0.9900     0.3220     61.8609
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     4.7916      0.3300     0.2942     16.5075
00100     1.5680      0.5200     0.4919     62.4889
00200     1.6685      0.4900     0.6145     62.6085
00300     1.2199      0.6400     0.6551     62.8940
00400     1.0560      0.6900     0.6853     63.1473
00500     1.5715      0.5900     0.6989     62.6569
00600     0.8905      0.7500     0.7256     63.0463
00700     1.1614      0.6500     0.7304     63.0351
00800     1.2979      0.7000     0.7378     63.4371
00900     0.9431      0.7700     0.7494     62.6059
01000     0.8087      0.8100     0.7494     62.0756
01100     1.0236      0.7600     0.7556     62.7281
01200     1.0021      0.7400     0.7664     62.7127
01300     0.5627      0.8500     0.7664     62.0728
01400     0.6439      0.7800     0.7664     62.4711
01500     0.9156      0.7600     0.7664     62.1227
01600     0.6770      0.7900     0.7711     63.0350
01700     0.6674      0.8000     0.7802     62.7303
01800     0.8964      0.7600     0.7891     63.1350
01900     1.0760      0.7600     0.7891     62.3608
02000     0.7471      0.8100     0.7891     62.5185
02100     0.9611      0.7400     0.7954     62.9782
02200     0.6985      0.8300     0.7954     62.7158
02300     1.0424      0.7300     0.7954     63.0367
02400     0.6689      0.8100     0.7954     62.7191
02500     0.8996      0.7400     0.7954     62.8331
02600     0.7014      0.8100     0.7954     62.3510
02700     1.4277      0.7400     0.7954     62.0493
02800     0.7396      0.8100     0.7960     62.9546
02900     0.8419      0.8000     0.8084     63.4061
03000     0.8366      0.8100     0.8084     62.2439
03100     0.7417      0.8800     0.8084     62.6839
03200     0.7988      0.8000     0.8148     62.7883
03300     0.6924      0.8100     0.8148     62.6238
03400     0.5641      0.8500     0.8148     62.4882
03500     0.7555      0.8300     0.8148     62.6161
03600     1.0183      0.8200     0.8148     62.8929
03700     0.5713      0.8500     0.8148     61.9444
03800     0.8068      0.8200     0.8148     62.9348
03900     0.8216      0.7900     0.8148     62.1362
04000     0.5830      0.8200     0.8188     63.6190
04100     0.9301      0.8300     0.8188     63.0228
04200     0.9425      0.8000     0.8188     62.6728
04300     0.7742      0.7800     0.8188     62.7232
04400     0.4631      0.8600     0.8188     62.3967
04500     1.1424      0.7300     0.8188     62.8996
04600     0.9091      0.7700     0.8188     63.0861
04700     0.6888      0.8300     0.8202     63.4170
04800     0.6874      0.7900     0.8202     62.4496
04900     0.8585      0.7900     0.8202     62.3237
05000     0.8564      0.8200     0.8202     62.1567
05100     0.7632      0.8200     0.8202     62.1040
05200     1.0505      0.7700     0.8202     61.8953
05300     0.9354      0.7600     0.8271     63.0151
05400     0.6817      0.8200     0.8271     62.4500
05500     1.2512      0.7600     0.8271     63.3637
05600     0.8549      0.7600     0.8271     63.0038
05700     0.6940      0.8500     0.8294     63.1447
05800     0.9457      0.8100     0.8294     62.0941
05900     0.9655      0.7300     0.8294     62.3877
06000     0.9709      0.7800     0.8294     62.6931
06100     0.7089      0.7800     0.8294     62.8668
06200     0.4759      0.8500     0.8294     62.0711
06300     0.4509      0.8400     0.8299     63.3685
06400     1.1888      0.7600     0.8299     62.1726
06500     0.4660      0.9000     0.8299     62.7417
06600     0.6893      0.7600     0.8299     63.1365
06700     1.1207      0.7400     0.8299     63.1606
06800     0.4395      0.8400     0.8299     62.4047
06900     0.5448      0.8000     0.8299     62.2076
07000     0.9009      0.7900     0.8360     62.9023
07100     0.6141      0.8600     0.8360     61.9791
07200     0.7556      0.8100     0.8391     62.7023
07300     0.6268      0.8300     0.8391     62.1728
07400     1.0588      0.7700     0.8391     62.5369
07500     0.6042      0.8500     0.8391     62.1648
07600     0.6351      0.8300     0.8417     62.0447
07700     0.7058      0.8000     0.8417     61.6830
07800     0.7641      0.8100     0.8449     62.6577
07900     0.5806      0.8600     0.8449     61.4021
08000     0.5983      0.8300     0.8449     61.8367
08100     0.9666      0.8000     0.8449     61.7334
08200     0.5443      0.8300     0.8449     62.4480
08300     0.4245      0.8400     0.8449     62.0619
08400     0.7323      0.8200     0.8449     62.3163
08500     0.4329      0.8700     0.8449     61.8875
08600     0.7818      0.8300     0.8449     61.6769
08700     0.6222      0.8100     0.8449     61.3096
08800     0.3613      0.9000     0.8449     62.0401
08900     0.5526      0.8700     0.8449     61.8845
09000     0.8784      0.8500     0.8449     62.0940
09100     0.5626      0.8700     0.8449     62.8376
09200     0.9564      0.8400     0.8449     63.4317
09300     0.6451      0.8500     0.8449     63.2715
09400     0.5191      0.9000     0.8449     62.4810
09500     0.7283      0.8000     0.8449     62.0053
09600     0.5003      0.8100     0.8449     62.2754
09700     0.6883      0.8400     0.8449     62.5009
09800     0.6910      0.8200     0.8449     63.4864
09900     0.4174      0.9000     0.8454     63.3276
Start testing:
Test Accuracy: 0.8871
