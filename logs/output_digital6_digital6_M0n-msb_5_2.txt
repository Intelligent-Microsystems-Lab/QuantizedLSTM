Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=108, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=0, n_mfcc=40, n_msb=5, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=8627169, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
9ed8debf-604b-4323-b95f-6d9098c4b7fd
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 167, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 290, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 213, in forward
    gates = quant_pass(pact_a_bmm( quant_pass(pact_a_bmm(part1, self.a12), self.abMVM, self.a12) + quant_pass(pact_a_bmm(part2, self.a13), self.abMVM, self.a13), self.a14), self.abNM, self.a14)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 87, in forward
    x01 = torch.clamp(x_scaled,-1+(1./step_d),1-(1./step_d))
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 10.76 GiB total capacity; 9.60 GiB already allocated; 3.12 MiB free; 9.80 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=108, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=0, n_mfcc=40, n_msb=5, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=8627169, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
14ea9bd5-990a-4296-b4f8-181d7d6b9c77
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     3.0505      0.0591     0.0753     10.2889
00100     1.6055      0.4705     0.1201     57.2553
00200     1.0399      0.7004     0.1201     56.4772
00300     0.7245      0.7700     0.1280     58.3398
00400     0.6747      0.7827     0.1348     58.3128
00500     0.6488      0.7869     0.1348     57.5536
00600     0.5848      0.7975     0.1348     58.9303
00700     0.5677      0.8354     0.1348     57.8121
00800     0.5068      0.8397     0.1348     59.6531
00900     0.4286      0.8671     0.1348     57.4155
01000     0.3963      0.8861     0.1469     57.0379
01100     0.4097      0.8819     0.1469     58.2712
01200     0.4073      0.8713     0.1469     57.2953
01300     0.3221      0.9114     0.1469     58.8358
01400     0.4401      0.8650     0.1469     58.9583
01500     0.4210      0.8608     0.1469     57.4536
01600     0.4384      0.8713     0.1469     58.1223
01700     0.3457      0.8903     0.1469     58.5537
01800     0.3876      0.8945     0.1469     58.3490
01900     0.3202      0.9093     0.1613     59.4852
02000     0.2519      0.9346     0.1613     57.3364
02100     0.2581      0.9367     0.1613     57.5579
02200     0.2773      0.9241     0.1613     57.7517
02300     0.3572      0.8861     0.1613     57.4193
02400     0.3397      0.8882     0.1613     58.0899
02500     0.3373      0.9072     0.1613     58.2004
02600     0.2871      0.9262     0.1613     57.4158
02700     0.3048      0.9177     0.1613     56.5761
02800     0.2977      0.9135     0.1613     55.7256
02900     0.2020      0.9346     0.1613     55.5591
03000     0.3146      0.8987     0.1613     55.8075
03100     0.3112      0.9072     0.1613     55.0311
03200     0.3021      0.9219     0.1708     55.9900
03300     0.3271      0.8945     0.1708     55.6677
03400     0.2852      0.9219     0.1708     55.3550
03500     0.2774      0.9114     0.1708     55.5092
03600     0.2990      0.9051     0.1708     55.8128
03700     0.2515      0.9346     0.1708     58.8006
03800     0.2938      0.9177     0.1708     57.9544
03900     0.2747      0.9409     0.1708     56.8031
04000     0.3054      0.9093     0.1708     58.9604
04100     0.2103      0.9430     0.1708     57.2705
04200     0.2395      0.9430     0.1708     58.3999
04300     0.2082      0.9409     0.1708     57.3647
04400     0.2832      0.9177     0.1708     57.7822
04500     0.2633      0.9114     0.1708     57.5826
04600     0.2856      0.9198     0.1708     57.9823
04700     0.2250      0.9346     0.1708     58.0908
04800     0.2530      0.9262     0.1708     58.5766
04900     0.2649      0.9177     0.1708     58.2196
05000     0.2871      0.9177     0.1708     57.8522
05100     0.2466      0.9283     0.1868     58.8946
05200     0.3099      0.9114     0.1868     58.6200
05300     0.3065      0.9093     0.1924     58.0593
05400     0.2208      0.9409     0.1924     58.4551
05500     0.2182      0.9346     0.1924     58.1703
05600     0.2107      0.9409     0.2021     58.8498
05700     0.1971      0.9367     0.2021     58.1314
05800     0.2013      0.9494     0.2021     59.3733
05900     0.2423      0.9346     0.2021     59.7940
06000     0.2287      0.9346     0.2021     58.0916
06100     0.2104      0.9494     0.2021     58.2174
06200     0.2291      0.9451     0.2021     58.9399
06300     0.2078      0.9473     0.2021     58.9231
06400     0.2363      0.9304     0.2021     59.1369
06500     0.2587      0.9346     0.2062     57.9820
06600     0.1775      0.9557     0.2062     58.3186
06700     0.2300      0.9304     0.2183     58.7647
06800     0.2263      0.9325     0.2183     59.7716
06900     0.2776      0.9156     0.2183     58.2507
07000     0.1948      0.9536     0.2206     59.6312
07100     0.1548      0.9557     0.2226     58.5534
07200     0.1754      0.9494     0.2260     59.2992
07300     0.1792      0.9578     0.2265     58.5596
07400     0.2036      0.9346     0.2377     58.8561
07500     0.1956      0.9430     0.2377     59.3860
07600     0.2405      0.9198     0.2377     58.8279
07700     0.2060      0.9494     0.2377     57.9692
07800     0.2144      0.9304     0.2377     58.6267
07900     0.2081      0.9409     0.2377     57.7785
08000     0.2418      0.9262     0.2377     58.8612
08100     0.2466      0.9219     0.2498     58.5166
08200     0.3103      0.9177     0.2498     58.4840
08300     0.1689      0.9578     0.2498     58.7288
08400     0.1913      0.9430     0.2498     58.2690
08500     0.2482      0.9304     0.2498     58.4665
08600     0.2244      0.9473     0.2498     59.2499
08700     0.2121      0.9409     0.2498     58.8005
08800     0.1913      0.9536     0.2498     58.7232
08900     0.2742      0.9156     0.2498     58.6893
09000     0.2389      0.9388     0.2579     58.8566
09100     0.1850      0.9536     0.2579     58.7881
09200     0.1722      0.9557     0.2579     58.0129
09300     0.1758      0.9599     0.2579     57.8819
09400     0.2008      0.9430     0.2583     58.5701
09500     0.2035      0.9557     0.2617     58.3633
09600     0.1930      0.9409     0.2617     59.4099
09700     0.2157      0.9388     0.2617     58.6209
09800     0.2512      0.9241     0.2654     58.4694
09900     0.2221      0.9430     0.2654     58.5344
10000     0.1831      0.9367     0.2669     58.2742
10100     0.2239      0.9346     0.2669     58.4428
10200     0.1713      0.9536     0.2772     59.4580
10300     0.1716      0.9515     0.2890     58.5023
10400     0.2032      0.9451     0.2890     59.6200
10500     0.2244      0.9325     0.2890     58.3283
10600     0.1641      0.9578     0.2890     58.2811
10700     0.1953      0.9409     0.2890     58.8951
10800     0.1361      0.9662     0.2890     58.1411
10900     0.1819      0.9409     0.2915     58.8289
11000     0.1794      0.9515     0.2915     58.9103
11100     0.1895      0.9451     0.2915     58.4667
11200     0.1426      0.9620     0.2915     58.6487
11300     0.1840      0.9515     0.2915     58.2436
11400     0.1617      0.9557     0.2915     58.7300
11500     0.1399      0.9515     0.2915     58.7996
11600     0.1362      0.9641     0.2915     58.1966
11700     0.1987      0.9515     0.2915     58.5729
11800     0.1377      0.9662     0.2915     58.8707
11900     0.1329      0.9641     0.2915     57.9489
12000     0.1810      0.9578     0.2915     58.8585
12100     0.1556      0.9536     0.2915     58.6152
12200     0.1782      0.9578     0.2915     58.0690
12300     0.1533      0.9578     0.2915     58.8455
12400     0.1484      0.9620     0.2915     58.8124
12500     0.1970      0.9620     0.2915     59.6384
12600     0.1390      0.9662     0.2915     59.6548
12700     0.1381      0.9705     0.2915     58.8230
12800     0.1457      0.9599     0.2915     58.9313
12900     0.1375      0.9684     0.2915     58.7560
13000     0.1008      0.9768     0.2915     58.9243
13100     0.1257      0.9662     0.2915     58.5323
13200     0.1013      0.9768     0.2915     58.6511
13300     0.1636      0.9578     0.2915     57.8783
13400     0.1359      0.9684     0.2915     58.8963
13500     0.1592      0.9515     0.2915     59.1964
13600     0.1836      0.9430     0.2915     58.5170
13700     0.1535      0.9557     0.2915     58.5233
13800     0.1834      0.9451     0.2915     57.9693
13900     0.1113      0.9768     0.2915     59.3383
14000     0.1153      0.9768     0.2915     58.5651
14100     0.1243      0.9726     0.2915     58.8123
14200     0.2373      0.9283     0.2915     59.0843
14300     0.1103      0.9726     0.2915     58.5459
14400     0.1761      0.9578     0.2915     58.3995
14500     0.1485      0.9620     0.2915     57.7124
14600     0.1423      0.9726     0.2915     58.0066
14700     0.1047      0.9726     0.2915     59.0179
14800     0.1481      0.9641     0.2915     57.9190
14900     0.1573      0.9641     0.2915     59.5167
15000     0.1394      0.9662     0.2915     59.3391
15100     0.1815      0.9536     0.2915     57.8941
15200     0.1541      0.9620     0.2915     58.2265
15300     0.1460      0.9641     0.2915     58.1473
15400     0.1735      0.9557     0.2915     58.2727
15500     0.1977      0.9409     0.2915     59.0631
15600     0.0931      0.9789     0.2915     58.2281
15700     0.1744      0.9536     0.2915     58.6158
15800     0.1408      0.9662     0.2915     58.9293
15900     0.1933      0.9494     0.2915     58.1236
16000     0.1466      0.9599     0.2915     58.7128
16100     0.1493      0.9641     0.2915     58.3228
16200     0.1869      0.9536     0.2915     57.4340
16300     0.1243      0.9705     0.2915     58.9346
16400     0.1481      0.9662     0.2915     60.2316
16500     0.1515      0.9578     0.2915     58.1947
16600     0.1569      0.9620     0.2953     58.1751
16700     0.1428      0.9557     0.2953     57.4584
16800     0.1452      0.9578     0.2953     58.4590
16900     0.1588      0.9599     0.2953     58.7294
17000     0.1732      0.9578     0.2953     58.5944
17100     0.1355      0.9620     0.2953     58.8850
17200     0.1374      0.9726     0.2953     57.7649
17300     0.1529      0.9578     0.2953     57.6521
17400     0.1671      0.9515     0.2953     58.5362
17500     0.1503      0.9599     0.2953     57.8876
17600     0.1628      0.9599     0.2953     59.2571
17700     0.1396      0.9684     0.2953     58.1960
17800     0.1731      0.9599     0.2953     57.7163
17900     0.1191      0.9705     0.2953     58.1763
18000     0.1116      0.9662     0.2953     58.2728
18100     0.1605      0.9599     0.2953     57.7948
18200     0.1348      0.9705     0.2953     58.7189
18300     0.1716      0.9620     0.2953     59.0854
18400     0.1335      0.9662     0.2953     58.4707
18500     0.1549      0.9641     0.2953     58.2878
18600     0.1458      0.9620     0.2953     57.8503
18700     0.1657      0.9536     0.2953     58.3882
18800     0.1485      0.9641     0.2953     57.9409
18900     0.1451      0.9620     0.2953     58.0425
19000     0.1163      0.9768     0.2953     58.6753
19100     0.1489      0.9684     0.2953     58.0377
19200     0.1448      0.9557     0.2953     58.4224
19300     0.1502      0.9599     0.2953     58.5684
19400     0.1494      0.9620     0.2953     58.5148
19500     0.1436      0.9641     0.3020     58.9129
19600     0.1540      0.9599     0.3020     58.1083
19700     0.0873      0.9831     0.3020     58.5098
19800     0.1866      0.9473     0.3020     59.3010
19900     0.1260      0.9684     0.3020     58.2432
20000     0.1201      0.9705     0.3020     58.6394
20100     0.1313      0.9662     0.3020     58.2129
20199     0.1451      0.9557     0.3020     58.1505
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     3.4355      0.2595     0.2740     10.3182
00100     2.1779      0.4388     0.4519     59.8766
00200     1.6024      0.5443     0.5338     58.5208
00300     1.6319      0.5633     0.5707     59.7708
00400     1.2528      0.6477     0.5963     58.9742
00500     1.2265      0.6308     0.6492     58.9407
00600     1.0879      0.6814     0.6727     58.7788
00700     1.0311      0.7194     0.6802     58.1557
00800     0.8706      0.7658     0.7044     58.2324
00900     1.0279      0.7194     0.7141     58.4652
01000     0.8752      0.7637     0.7264     58.2896
01100     0.9674      0.7342     0.7264     58.9778
01200     1.0290      0.7236     0.7264     58.4898
01300     0.8913      0.7658     0.7501     58.1911
01400     1.0398      0.7278     0.7501     58.8621
01500     0.8585      0.7785     0.7570     57.9890
01600     0.7877      0.7764     0.7570     58.8241
01700     0.7377      0.7637     0.7570     58.9614
01800     0.9023      0.7616     0.7570     58.1355
01900     0.9113      0.7637     0.7570     58.4314
02000     0.8025      0.7743     0.7667     57.5029
02100     0.8457      0.7785     0.7667     58.1538
02200     0.8752      0.7532     0.7667     58.5976
02300     0.7099      0.7975     0.7701     57.7472
02400     0.8035      0.7890     0.7705     57.8268
02500     1.1555      0.7110     0.7705     58.5463
02600     0.9060      0.7785     0.7705     58.7643
02700     0.7733      0.7827     0.7788     58.9305
02800     0.7674      0.7827     0.7788     57.7016
02900     0.7907      0.7975     0.7788     58.2298
03000     0.8055      0.7637     0.7788     58.8731
03100     0.8238      0.7743     0.7788     57.6336
03200     0.8197      0.7511     0.7830     57.5876
03300     0.6763      0.7996     0.7933     58.3793
03400     0.8651      0.7447     0.7933     57.5114
03500     0.7757      0.7700     0.7933     58.3154
03600     0.5999      0.8207     0.7933     57.3003
03700     0.8485      0.7806     0.7933     57.6844
03800     0.5933      0.8059     0.7933     57.7156
03900     0.7596      0.7827     0.7933     57.5160
04000     0.6305      0.8186     0.7933     57.7335
04100     0.6910      0.8143     0.7942     58.7729
04200     0.7545      0.7806     0.8010     57.5685
04300     0.7556      0.7806     0.8010     58.1204
04400     0.7278      0.7890     0.8010     57.9088
04500     0.7180      0.7911     0.8157     58.3732
04600     0.6114      0.8249     0.8157     58.3136
04700     0.7348      0.7764     0.8157     57.8337
04800     0.6433      0.8017     0.8157     58.4482
04900     0.6087      0.8418     0.8157     58.2921
05000     0.6301      0.8017     0.8157     58.7827
05100     0.6869      0.8122     0.8157     58.6716
05200     0.8439      0.7743     0.8157     57.7489
05300     0.6933      0.8038     0.8157     57.5089
05400     0.6644      0.8017     0.8157     57.9162
05500     0.7913      0.7658     0.8157     57.6285
05600     0.7426      0.7806     0.8157     57.8694
05700     0.6516      0.8101     0.8157     57.8340
05800     0.6413      0.8228     0.8157     57.3691
05900     0.6519      0.8017     0.8157     58.6411
06000     0.5331      0.8270     0.8157     58.3770
06100     0.8594      0.7658     0.8157     57.5120
06200     0.6628      0.8122     0.8157     58.5061
06300     0.5663      0.8186     0.8157     58.1630
06400     0.6488      0.8038     0.8157     57.9386
06500     0.6312      0.8122     0.8157     58.8482
06600     0.5835      0.8376     0.8157     57.2868
06700     0.6458      0.8059     0.8208     58.3551
06800     0.6598      0.8143     0.8208     57.8074
06900     0.6140      0.8059     0.8208     57.5893
07000     0.6526      0.8038     0.8238     58.3052
07100     0.6367      0.8186     0.8238     58.2257
07200     0.5498      0.8439     0.8238     57.9470
07300     0.6386      0.8186     0.8238     57.9743
07400     0.6339      0.8080     0.8238     58.1161
07500     0.5427      0.8418     0.8238     58.4796
07600     0.5449      0.8333     0.8238     57.7292
07700     0.7253      0.7932     0.8238     58.6524
07800     0.6715      0.8017     0.8238     58.2476
07900     0.5764      0.8249     0.8238     58.0461
08000     0.6002      0.8270     0.8238     58.6356
08100     0.5322      0.8502     0.8271     58.7917
08200     0.5307      0.8460     0.8271     58.1085
08300     0.5900      0.8228     0.8293     58.4405
08400     0.5037      0.8418     0.8293     57.8220
08500     0.5799      0.8418     0.8293     57.4297
08600     0.5518      0.8502     0.8293     58.6845
08700     0.6124      0.8249     0.8293     57.9482
08800     0.5172      0.8544     0.8293     57.5483
08900     0.5951      0.8249     0.8293     58.5797
09000     0.5344      0.8376     0.8325     58.1356
09100     0.5542      0.8376     0.8325     58.7955
09200     0.6863      0.7827     0.8325     59.1065
09300     0.5756      0.8312     0.8325     58.0918
09400     0.6355      0.8059     0.8325     58.5369
09500     0.6640      0.8122     0.8325     59.1917
09600     0.6023      0.8249     0.8325     59.1818
09700     0.6553      0.8080     0.8325     59.6475
09800     0.6188      0.8165     0.8338     58.6358
09900     0.7369      0.8143     0.8338     58.9291
Start testing:
Test Accuracy: 0.8674
