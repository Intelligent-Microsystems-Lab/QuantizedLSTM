Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=14, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.0, noise_injectionT=0.0, pact_a=True, quant_actMVM=9, quant_actNM=9, quant_inp=9, quant_w=9, random_seed=235899598, rows_bias=100, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
6080c529-baa2-47d0-bf82-32bd5c1f9342
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 147, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 289, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 209, in forward
    part1 = CustomMM_bmm.apply(quant_pass(pact_a_bmm(input.repeat(self.n_blocks, 1, 1), self.a1), self.ib, self.a1), self.weight_ih, self.bias_ih, self.noise_level, self.wb, self.bias_r)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 145, in forward
    wq = quant_pass(weight, wb, 1.)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 82, in forward
    if len(x_range) > 1:
TypeError: object of type 'float' has no len()
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=14, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.0, noise_injectionT=0.0, pact_a=True, quant_actMVM=9, quant_actNM=9, quant_inp=9, quant_w=9, random_seed=235899598, rows_bias=100, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
7bb368b7-5311-41ca-ad4f-e93370176436
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 147, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 289, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 209, in forward
    part1 = CustomMM_bmm.apply(quant_pass(pact_a_bmm(input.repeat(self.n_blocks, 1, 1), self.a1), self.ib, self.a1), self.weight_ih, self.bias_ih, self.noise_level, self.wb, self.bias_r)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 145, in forward
    wq = quant_pass(weight, wb, torch.tensor([1.]))
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 94, in forward
    x_scaled = x/x_range
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=14, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.0, noise_injectionT=0.0, pact_a=True, quant_actMVM=9, quant_actNM=9, quant_inp=9, quant_w=9, random_seed=235899598, rows_bias=100, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
85ce0b7d-08c0-47ce-8f38-206653866e5e
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     2.6998      0.0802     0.0705     12.4710
00100     2.1606      0.2827     0.2733     71.5974
00200     1.7564      0.4135     0.4441     68.2380
00300     1.3417      0.5781     0.5698     68.2184
00400     1.3322      0.5612     0.6322     67.5840
00500     1.1117      0.6603     0.6795     67.9249
00600     1.0675      0.6772     0.7094     67.8868
00700     0.9269      0.7257     0.7222     67.4972
00800     1.0199      0.7173     0.7329     68.2453
00900     0.7686      0.7679     0.7430     68.1787
01000     0.9496      0.7089     0.7431     68.4504
01100     0.8417      0.7637     0.7500     68.0172
01200     0.8690      0.7384     0.7568     68.1852
01300     0.7051      0.7954     0.7747     67.4454
01400     0.8418      0.7489     0.7766     68.1280
01500     0.7604      0.7700     0.7804     68.0588
01600     0.8278      0.7595     0.7833     68.4069
01700     0.8111      0.7595     0.7833     66.8698
01800     0.7425      0.7869     0.7872     67.0591
01900     0.7556      0.7700     0.7872     67.0572
02000     0.7703      0.7827     0.7936     67.7285
02100     0.7336      0.7764     0.7936     67.5414
02200     0.7216      0.7827     0.7936     68.2011
02300     0.7368      0.7764     0.7969     67.9624
02400     0.7787      0.7827     0.7969     68.4147
02500     0.7157      0.7658     0.8045     67.9133
02600     0.7165      0.7785     0.8083     66.8531
02700     0.7656      0.7679     0.8083     68.4916
02800     0.6223      0.8312     0.8083     67.3184
02900     0.6659      0.7975     0.8085     67.5336
03000     0.7602      0.7658     0.8143     68.5858
03100     0.7445      0.7743     0.8143     67.7222
03200     0.6366      0.8101     0.8145     67.6306
03300     0.6562      0.8017     0.8155     67.8381
03400     0.7441      0.7975     0.8155     67.6945
03500     0.7495      0.7595     0.8155     68.2617
03600     0.6224      0.8228     0.8155     67.8308
03700     0.7310      0.7806     0.8190     67.8048
03800     0.6697      0.7975     0.8190     67.8852
03900     0.6542      0.7932     0.8190     68.2009
04000     0.7149      0.7932     0.8190     68.5594
04100     0.6350      0.8228     0.8209     68.0239
04200     0.6916      0.7827     0.8221     68.1177
04300     0.6334      0.7932     0.8221     67.3077
04400     0.5589      0.8354     0.8221     67.3401
04500     0.6754      0.8228     0.8221     67.4745
04600     0.6128      0.8333     0.8221     68.0448
04700     0.7011      0.7975     0.8221     67.7996
04800     0.7383      0.7679     0.8221     68.0053
04900     0.6315      0.8228     0.8247     67.2687
05000     0.6095      0.8397     0.8247     67.6139
05100     0.6977      0.7806     0.8247     68.0283
05200     0.6889      0.7890     0.8247     67.5513
05300     0.6903      0.7932     0.8247     67.4726
05400     0.6839      0.7658     0.8247     67.4166
05500     0.6721      0.7954     0.8247     66.7724
05600     0.7047      0.7954     0.8247     67.7866
05700     0.6131      0.7954     0.8247     67.5955
05800     0.6664      0.7827     0.8317     66.8612
05900     0.6769      0.8059     0.8317     67.7078
06000     0.6264      0.8080     0.8317     67.3903
06100     0.6031      0.8080     0.8317     67.2729
06200     0.6603      0.7827     0.8317     67.4798
06300     0.6300      0.7890     0.8317     67.1178
06400     0.6022      0.8291     0.8317     67.2227
06500     0.6138      0.8228     0.8317     67.3688
06600     0.6707      0.7890     0.8317     67.8154
06700     0.5611      0.8249     0.8317     67.5777
06800     0.6924      0.7806     0.8317     67.5902
06900     0.5730      0.8312     0.8317     67.9719
07000     0.6633      0.7996     0.8317     67.9916
07100     0.6324      0.8080     0.8317     68.1474
07200     0.5720      0.8312     0.8317     68.6813
07300     0.6131      0.8143     0.8317     67.4007
07400     0.6899      0.7616     0.8317     67.6552
07500     0.5840      0.8291     0.8317     68.5290
07600     0.6776      0.7532     0.8317     67.3518
07700     0.6035      0.8249     0.8317     67.6702
07800     0.6580      0.8038     0.8317     67.8472
07900     0.6040      0.8101     0.8317     67.5736
08000     0.6459      0.8122     0.8317     68.0376
08100     0.5593      0.8439     0.8317     67.3175
08200     0.5526      0.8312     0.8317     67.4195
08300     0.5323      0.8586     0.8318     68.6042
08400     0.6429      0.7932     0.8318     67.8030
08500     0.6075      0.8186     0.8318     67.8180
08600     0.5340      0.8439     0.8326     67.5440
08700     0.6257      0.8249     0.8326     67.0781
08800     0.5220      0.8354     0.8326     67.5984
08900     0.6069      0.8101     0.8326     67.7682
09000     0.6507      0.7996     0.8326     67.3911
09100     0.6440      0.8122     0.8326     68.0386
09200     0.5005      0.8460     0.8326     67.5853
09300     0.5472      0.8418     0.8326     67.4762
09400     0.5640      0.8333     0.8326     67.4164
09500     0.6189      0.8165     0.8326     68.0487
09600     0.5977      0.8270     0.8326     67.2680
09700     0.6257      0.8122     0.8326     68.0048
09800     0.6395      0.7932     0.8326     67.3018
09900     0.5959      0.8228     0.8326     67.9554
10000     0.6023      0.8165     0.8326     67.1266
10100     0.6052      0.8270     0.8326     67.5370
10200     0.5541      0.8354     0.8353     66.9134
10300     0.6605      0.8080     0.8353     67.2827
10400     0.6200      0.7954     0.8353     68.1998
10500     0.5177      0.8460     0.8353     67.2623
10600     0.5245      0.8439     0.8353     67.1277
10700     0.5803      0.8249     0.8353     67.0636
10800     0.6051      0.8165     0.8353     67.7294
10900     0.5999      0.8312     0.8353     67.5860
11000     0.5336      0.8460     0.8353     67.3033
11100     0.6000      0.8143     0.8353     66.9683
11200     0.6323      0.8122     0.8353     67.4984
11300     0.6382      0.8270     0.8371     67.9211
11400     0.5763      0.8397     0.8371     67.0633
11500     0.5873      0.8397     0.8371     67.5989
11600     0.4810      0.8608     0.8371     66.8034
11700     0.4841      0.8650     0.8371     67.7088
11800     0.5607      0.8376     0.8371     67.6561
11900     0.6086      0.8143     0.8371     67.3686
12000     0.6474      0.7996     0.8371     68.2679
12100     0.5447      0.8312     0.8371     67.6133
12200     0.6330      0.7890     0.8371     68.4907
12300     0.5967      0.8122     0.8371     68.0324
12400     0.5180      0.8460     0.8371     67.6441
12500     0.5431      0.8460     0.8371     67.4827
12600     0.5705      0.8312     0.8371     66.9132
12700     0.5764      0.8270     0.8393     67.8165
12800     0.5710      0.8312     0.8393     67.8930
12900     0.5945      0.8249     0.8393     67.4682
13000     0.5598      0.8270     0.8393     68.0755
13100     0.6094      0.8207     0.8393     67.5030
13200     0.6048      0.8186     0.8393     67.8986
13300     0.5171      0.8502     0.8393     67.6950
13400     0.5924      0.8207     0.8393     66.8514
13500     0.5461      0.8249     0.8393     67.6675
13600     0.5030      0.8586     0.8393     67.6505
13700     0.5671      0.8291     0.8393     67.0088
13800     0.5738      0.8249     0.8393     67.4220
13900     0.6349      0.8143     0.8393     67.8159
14000     0.5053      0.8608     0.8397     67.2582
14100     0.6033      0.8186     0.8397     67.5766
14200     0.5191      0.8586     0.8397     67.5779
14300     0.5665      0.8376     0.8437     67.5172
14400     0.5293      0.8586     0.8437     67.3740
14500     0.5614      0.8312     0.8437     66.8732
14600     0.4840      0.8650     0.8437     67.3342
14700     0.5630      0.8418     0.8437     68.1291
14800     0.5182      0.8523     0.8437     67.4692
14900     0.5800      0.8439     0.8437     67.6703
15000     0.5943      0.8228     0.8437     67.1573
15100     0.6318      0.8122     0.8437     67.1736
15200     0.5221      0.8207     0.8437     67.9056
15300     0.5487      0.8397     0.8437     67.7484
15400     0.6437      0.8165     0.8437     67.5419
15500     0.5072      0.8354     0.8437     68.6436
15600     0.5988      0.8059     0.8437     67.0393
15700     0.5177      0.8481     0.8437     68.4494
15800     0.5560      0.8122     0.8437     67.5837
15900     0.5079      0.8565     0.8437     67.5739
16000     0.5434      0.8397     0.8437     67.3346
16100     0.5858      0.8122     0.8437     67.3285
16200     0.5351      0.8523     0.8437     67.7797
16300     0.6042      0.8249     0.8437     68.6837
16400     0.5954      0.8165     0.8437     67.5857
16500     0.5810      0.8376     0.8437     67.8454
16600     0.5684      0.8228     0.8437     67.3316
16700     0.5042      0.8544     0.8437     67.3843
16800     0.5448      0.8565     0.8437     67.4619
16900     0.5712      0.8143     0.8437     67.0990
17000     0.5246      0.8397     0.8437     66.6984
17100     0.6325      0.8101     0.8437     67.0687
17200     0.5487      0.8460     0.8437     67.6518
17300     0.6271      0.8080     0.8437     67.0970
17400     0.6084      0.8143     0.8437     67.5035
17500     0.5474      0.8270     0.8437     67.6735
17600     0.5974      0.7932     0.8437     67.7433
17700     0.5079      0.8481     0.8437     67.1882
17800     0.5458      0.8397     0.8437     67.0925
17900     0.5274      0.8354     0.8437     67.6632
18000     0.5587      0.8291     0.8437     67.6990
18100     0.5463      0.8376     0.8437     68.2530
18200     0.6093      0.8186     0.8437     67.1650
18300     0.5317      0.8608     0.8437     66.9672
18400     0.5595      0.8207     0.8437     67.3250
18500     0.5526      0.8291     0.8437     67.1824
18600     0.5302      0.8418     0.8437     68.3341
18700     0.5794      0.8122     0.8437     68.6789
18800     0.5658      0.8270     0.8437     67.6838
18900     0.5669      0.8397     0.8437     67.9804
19000     0.5502      0.8523     0.8437     67.1784
19100     0.4907      0.8523     0.8437     67.5815
19200     0.5395      0.8481     0.8437     67.9527
19300     0.4929      0.8502     0.8437     67.1422
19400     0.5260      0.8376     0.8437     67.3877
19500     0.5984      0.8228     0.8437     67.3699
19600     0.5644      0.8333     0.8437     67.6880
19700     0.5625      0.8270     0.8437     67.2605
19800     0.5147      0.8650     0.8437     67.2404
19900     0.5958      0.8228     0.8441     67.5972
20000     0.5689      0.8207     0.8441     68.4466
20100     0.5541      0.8270     0.8441     67.6063
20199     0.5762      0.8228     0.8441     67.0462
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     0.4882      0.8629     0.8387     9.8893
00100     0.4579      0.8586     0.8413     67.5536
00200     0.4816      0.8565     0.8428     69.0288
00300     0.4601      0.8776     0.8439     68.5463
00400     0.5027      0.8439     0.8456     68.2966
00500     0.4775      0.8586     0.8456     68.1444
00600     0.5193      0.8502     0.8456     68.1129
00700     0.5327      0.8502     0.8456     66.9786
00800     0.4644      0.8586     0.8456     68.0901
00900     0.3539      0.8987     0.8456     68.1375
01000     0.4187      0.8629     0.8456     67.5644
01100     0.5408      0.8523     0.8456     68.3409
01200     0.5177      0.8397     0.8456     68.1716
01300     0.4719      0.8776     0.8456     67.8015
01400     0.4909      0.8629     0.8456     68.0873
01500     0.4390      0.8797     0.8456     67.6849
01600     0.5043      0.8671     0.8456     67.5739
01700     0.4191      0.8797     0.8456     67.5069
01800     0.4705      0.8586     0.8456     67.9985
01900     0.4776      0.8734     0.8456     68.1649
02000     0.4472      0.8713     0.8456     67.7251
02100     0.4898      0.8608     0.8456     68.0776
02200     0.5255      0.8460     0.8456     67.9894
02300     0.5482      0.8502     0.8458     67.3142
02400     0.5183      0.8354     0.8458     68.7072
02500     0.5093      0.8481     0.8458     67.2111
02600     0.3991      0.8924     0.8458     67.6784
02700     0.4974      0.8608     0.8458     68.1937
02800     0.4432      0.8713     0.8458     67.3601
02900     0.5052      0.8502     0.8458     69.0113
03000     0.4556      0.8481     0.8458     68.3308
03100     0.4753      0.8586     0.8458     68.3930
03200     0.4233      0.8755     0.8468     68.6136
03300     0.4024      0.8903     0.8468     67.8246
03400     0.4032      0.8861     0.8468     68.4719
03500     0.4255      0.8776     0.8468     68.4356
03600     0.4820      0.8797     0.8468     67.5955
03700     0.4211      0.8755     0.8468     67.1113
03800     0.4276      0.8797     0.8468     68.0866
03900     0.5425      0.8502     0.8468     67.8437
04000     0.4756      0.8650     0.8468     67.9446
04100     0.4130      0.8671     0.8468     67.2338
04200     0.4444      0.8671     0.8468     67.2208
04300     0.4594      0.8608     0.8468     68.2539
04400     0.4642      0.8629     0.8468     67.9992
04500     0.4604      0.8544     0.8468     67.1688
04600     0.4491      0.8608     0.8468     68.0202
04700     0.4488      0.8734     0.8468     67.3469
04800     0.4432      0.8608     0.8468     67.5947
04900     0.4359      0.8840     0.8468     67.3833
05000     0.4532      0.8776     0.8468     67.4862
05100     0.4545      0.8650     0.8468     67.8023
05200     0.5149      0.8397     0.8468     67.7203
05300     0.4578      0.8755     0.8468     67.7255
05400     0.4784      0.8629     0.8468     68.2574
05500     0.4005      0.8819     0.8468     67.8544
05600     0.4370      0.8797     0.8468     67.1375
05700     0.5166      0.8291     0.8468     68.2371
05800     0.5813      0.8312     0.8468     68.1685
05900     0.5338      0.8376     0.8468     67.5924
06000     0.4459      0.8692     0.8468     67.4951
06100     0.5127      0.8608     0.8468     68.3059
06200     0.4788      0.8502     0.8468     68.3644
06300     0.3635      0.8966     0.8468     68.1430
06400     0.4298      0.8734     0.8468     67.6563
06500     0.5281      0.8418     0.8468     67.3076
06600     0.4906      0.8481     0.8468     67.7447
06700     0.4156      0.8650     0.8468     67.1634
06800     0.5290      0.8376     0.8468     67.5307
06900     0.4346      0.8713     0.8468     67.6500
07000     0.4990      0.8481     0.8468     67.9667
07100     0.4645      0.8671     0.8468     68.2742
07200     0.4535      0.8544     0.8468     68.4571
07300     0.4474      0.8608     0.8468     67.8527
07400     0.4881      0.8565     0.8468     68.3231
07500     0.4794      0.8608     0.8468     68.6342
07600     0.5019      0.8502     0.8468     67.1664
07700     0.4401      0.8713     0.8468     67.3241
07800     0.4683      0.8629     0.8468     68.2060
07900     0.4545      0.8671     0.8468     67.5287
08000     0.5015      0.8544     0.8473     68.2927
08100     0.4332      0.8734     0.8473     67.0694
08200     0.4457      0.8755     0.8479     68.1745
08300     0.3645      0.8945     0.8479     68.2331
08400     0.4165      0.8882     0.8479     67.8553
08500     0.4945      0.8586     0.8479     68.4286
08600     0.4913      0.8481     0.8479     68.9340
08700     0.4351      0.8776     0.8479     67.7544
08800     0.4637      0.8671     0.8479     67.6784
08900     0.4422      0.8755     0.8479     67.9579
09000     0.4264      0.8776     0.8479     68.5968
09100     0.4237      0.8650     0.8479     68.1325
09200     0.4573      0.8734     0.8488     67.5780
09300     0.4949      0.8418     0.8488     67.6781
09400     0.4430      0.8713     0.8502     67.3611
09500     0.4236      0.8840     0.8502     67.6454
09600     0.4312      0.8861     0.8502     67.6399
09700     0.4292      0.8671     0.8502     67.7564
09800     0.4147      0.8734     0.8502     67.9558
09900     0.4709      0.8460     0.8502     67.5504
Start testing:
Test Accuracy: 0.8256
