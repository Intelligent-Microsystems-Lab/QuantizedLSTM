Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=108, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=1, n_mfcc=40, n_msb=5, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=235899598, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
ae1752af-551a-4af6-9180-ac15d0fb7bf4
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 167, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 374, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 213, in forward
    gates = quant_pass(pact_a_bmm( quant_pass(pact_a_bmm(part1, self.a12), self.abMVM, self.a12) + quant_pass(pact_a_bmm(part2, self.a13), self.abMVM, self.a13), self.a14), self.abNM, self.a14)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 87, in forward
    x01 = torch.clamp(x_scaled,-1+(1./step_d),1-(1./step_d))
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 10.76 GiB total capacity; 9.60 GiB already allocated; 3.12 MiB free; 9.80 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=108, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=1, n_mfcc=40, n_msb=5, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=235899598, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
ea61c4f4-6083-4450-a9bf-e85ea6e7ba93
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     3.7164      0.0865     0.0866     11.2480
00100     1.7565      0.3987     0.0866     62.5110
00200     1.3097      0.5591     0.0866     61.9898
00300     1.0087      0.6350     0.0866     62.9288
00400     0.9568      0.6667     0.0894     61.9219
00500     0.8230      0.7342     0.0946     61.5946
00600     0.6476      0.7890     0.0946     62.5833
00700     0.6879      0.7806     0.0946     62.2277
00800     0.5205      0.8312     0.0951     62.1292
00900     0.5984      0.7764     0.0951     59.8511
01000     0.5114      0.8080     0.0983     59.2563
01100     0.5803      0.8143     0.0983     60.1474
01200     0.4950      0.8481     0.0983     59.0225
01300     0.4794      0.8270     0.0989     59.5478
01400     0.5767      0.8101     0.0989     59.2830
01500     0.5153      0.8418     0.0989     59.7882
01600     0.4804      0.8165     0.0989     59.9618
01700     0.4371      0.8376     0.0989     58.6577
01800     0.4687      0.8397     0.0989     58.8394
01900     0.4000      0.8523     0.1113     60.1787
02000     0.4695      0.8312     0.1113     59.7024
02100     0.4933      0.8502     0.1113     59.9854
02200     0.3545      0.8544     0.1113     60.1629
02300     0.3714      0.8797     0.1113     59.0490
02400     0.4433      0.8608     0.1113     59.7087
02500     0.3265      0.9051     0.1113     58.6575
02600     0.3167      0.8734     0.1113     59.1607
02700     0.3314      0.8840     0.1113     59.1950
02800     0.4349      0.8376     0.1113     59.1398
02900     0.3553      0.8650     0.1113     59.2482
03000     0.4216      0.8650     0.1161     59.5315
03100     0.3488      0.8840     0.1161     59.0823
03200     0.3713      0.8819     0.1161     59.5593
03300     0.3016      0.8945     0.1161     58.8857
03400     0.4198      0.8629     0.1161     58.8820
03500     0.3431      0.8966     0.1161     59.5889
03600     0.3371      0.8776     0.1161     59.2814
03700     0.3458      0.8713     0.1195     58.9496
03800     0.2851      0.9072     0.1195     59.6073
03900     0.3563      0.8755     0.1195     59.2835
04000     0.3513      0.8755     0.1195     60.4000
04100     0.2986      0.8924     0.1195     58.8675
04200     0.2781      0.8882     0.1290     59.4870
04300     0.2449      0.9177     0.1290     59.3192
04400     0.2581      0.9135     0.1290     59.2549
04500     0.2510      0.9262     0.1290     59.3828
04600     0.2971      0.9051     0.1290     59.6664
04700     0.3165      0.9030     0.1290     58.5275
04800     0.2790      0.9072     0.1325     59.8199
04900     0.2793      0.8987     0.1325     58.8146
05000     0.2421      0.9219     0.1367     60.2365
05100     0.2882      0.9135     0.1367     59.4623
05200     0.3203      0.8945     0.1373     59.2707
05300     0.2507      0.9030     0.1373     59.3469
05400     0.2605      0.9325     0.1420     59.4713
05500     0.2887      0.9072     0.1427     58.9617
05600     0.2560      0.9156     0.1427     59.6805
05700     0.2014      0.9283     0.1427     59.1334
05800     0.2194      0.9219     0.1427     59.5241
05900     0.2350      0.9093     0.1427     59.5762
06000     0.2722      0.9114     0.1432     59.4865
06100     0.2370      0.9219     0.1432     59.3404
06200     0.2344      0.9093     0.1552     60.3208
06300     0.3040      0.9008     0.1552     59.1251
06400     0.1889      0.9283     0.1552     59.9008
06500     0.2217      0.9367     0.1572     59.9623
06600     0.2211      0.9304     0.1572     59.3251
06700     0.2568      0.9114     0.1572     59.5736
06800     0.2522      0.9177     0.1572     58.6241
06900     0.2411      0.9304     0.1598     59.4413
07000     0.2596      0.9114     0.1602     59.8575
07100     0.2853      0.9198     0.1602     59.1862
07200     0.2977      0.9093     0.1719     59.8218
07300     0.2460      0.9177     0.1719     59.0281
07400     0.2161      0.9346     0.1746     59.5417
07500     0.2736      0.9135     0.1746     59.3869
07600     0.2404      0.9219     0.1746     59.9803
07700     0.2756      0.9030     0.1746     59.8332
07800     0.1875      0.9473     0.1746     59.1677
07900     0.2508      0.9177     0.1746     59.0451
08000     0.2612      0.9219     0.1746     60.1436
08100     0.2190      0.9241     0.1750     59.9667
08200     0.2485      0.9093     0.1828     59.6631
08300     0.2728      0.9030     0.1869     59.5899
08400     0.1472      0.9388     0.1869     59.9577
08500     0.2276      0.9114     0.1869     59.7233
08600     0.2257      0.9283     0.1928     59.2307
08700     0.2373      0.9367     0.2035     59.0435
08800     0.2363      0.9219     0.2035     60.3851
08900     0.3089      0.8945     0.2035     59.3374
09000     0.2163      0.9241     0.2035     59.3943
09100     0.2158      0.9241     0.2035     59.9590
09200     0.2302      0.9241     0.2035     58.9552
09300     0.2110      0.9262     0.2035     58.8840
09400     0.2132      0.9451     0.2035     59.6030
09500     0.2314      0.9156     0.2035     58.7695
09600     0.1356      0.9662     0.2035     59.9487
09700     0.2310      0.9283     0.2035     59.8736
09800     0.1714      0.9515     0.2035     59.1988
09900     0.1766      0.9494     0.2035     59.1033
10000     0.2713      0.9241     0.2035     58.9970
10100     0.1958      0.9367     0.2105     59.3437
10200     0.1957      0.9409     0.2105     59.6984
10300     0.1963      0.9409     0.2105     59.2879
10400     0.1712      0.9367     0.2105     59.1437
10500     0.2089      0.9325     0.2105     59.1521
10600     0.2572      0.9156     0.2105     59.1300
10700     0.1968      0.9367     0.2105     59.4087
10800     0.1740      0.9557     0.2105     59.0831
10900     0.1706      0.9515     0.2105     59.0722
11000     0.1663      0.9557     0.2105     59.4030
11100     0.1737      0.9557     0.2105     59.1772
11200     0.2012      0.9367     0.2105     60.0970
11300     0.1979      0.9451     0.2105     59.4441
11400     0.1472      0.9494     0.2105     59.4883
11500     0.1338      0.9473     0.2105     59.3981
11600     0.1697      0.9473     0.2105     59.5093
11700     0.1920      0.9388     0.2212     59.1317
11800     0.1768      0.9451     0.2212     59.2693
11900     0.1370      0.9578     0.2212     59.4299
12000     0.1754      0.9557     0.2212     59.7197
12100     0.1363      0.9515     0.2212     58.7500
12200     0.1563      0.9515     0.2212     58.4894
12300     0.2126      0.9262     0.2212     59.9772
12400     0.1323      0.9620     0.2212     58.8907
12500     0.1858      0.9536     0.2212     59.0283
12600     0.1107      0.9620     0.2212     60.3205
12700     0.1595      0.9515     0.2212     59.7118
12800     0.1949      0.9283     0.2212     59.8756
12900     0.1154      0.9578     0.2212     58.5012
13000     0.1513      0.9430     0.2212     59.1306
13100     0.1393      0.9473     0.2212     60.1264
13200     0.1386      0.9473     0.2212     59.1130
13300     0.1743      0.9409     0.2212     59.2984
13400     0.2181      0.9304     0.2212     59.5107
13500     0.1816      0.9409     0.2212     59.5249
13600     0.1736      0.9494     0.2212     59.7899
13700     0.1191      0.9557     0.2212     59.2220
13800     0.1492      0.9515     0.2212     59.1114
13900     0.1899      0.9388     0.2212     59.4067
14000     0.1465      0.9515     0.2212     59.2036
14100     0.1621      0.9409     0.2212     59.4855
14200     0.1446      0.9557     0.2212     59.7678
14300     0.1550      0.9494     0.2212     59.3848
14400     0.1804      0.9409     0.2212     59.7978
14500     0.1432      0.9494     0.2212     59.4590
14600     0.1840      0.9451     0.2212     59.5363
14700     0.1855      0.9304     0.2212     60.6608
14800     0.1716      0.9409     0.2212     59.3862
14900     0.1949      0.9388     0.2212     59.1640
15000     0.1566      0.9557     0.2212     59.9537
15100     0.1459      0.9494     0.2212     59.4507
15200     0.1923      0.9451     0.2212     59.4149
15300     0.1587      0.9430     0.2212     59.4171
15400     0.1753      0.9346     0.2212     60.4138
15500     0.1248      0.9641     0.2212     62.9941
15600     0.1120      0.9705     0.2212     59.8911
15700     0.2030      0.9241     0.2212     59.0958
15800     0.1031      0.9641     0.2212     60.0552
15900     0.1916      0.9388     0.2212     59.2806
16000     0.1427      0.9599     0.2212     59.8713
16100     0.1605      0.9430     0.2212     59.2723
16200     0.1631      0.9473     0.2212     59.0774
16300     0.1501      0.9451     0.2212     59.4842
16400     0.1460      0.9599     0.2212     58.8677
16500     0.1470      0.9473     0.2212     59.2248
16600     0.1385      0.9536     0.2212     59.5986
16700     0.1656      0.9536     0.2212     59.2782
16800     0.1569      0.9536     0.2212     60.2976
16900     0.1666      0.9536     0.2212     60.0855
17000     0.1609      0.9451     0.2212     59.2948
17100     0.1695      0.9451     0.2212     59.4888
17200     0.1465      0.9494     0.2212     59.1008
17300     0.1314      0.9557     0.2212     58.7657
17400     0.1666      0.9388     0.2212     59.5197
17500     0.0823      0.9641     0.2212     58.5765
17600     0.1836      0.9430     0.2212     60.1362
17700     0.1681      0.9388     0.2212     59.8488
17800     0.2084      0.9198     0.2212     59.1293
17900     0.1212      0.9536     0.2212     60.7395
18000     0.1652      0.9494     0.2212     59.9724
18100     0.1827      0.9346     0.2212     59.0133
18200     0.1412      0.9473     0.2212     59.4704
18300     0.1455      0.9494     0.2212     58.4540
18400     0.1435      0.9536     0.2212     59.0894
18500     0.2017      0.9473     0.2212     58.9453
18600     0.1327      0.9557     0.2212     58.7157
18700     0.1827      0.9536     0.2212     60.1534
18800     0.1615      0.9494     0.2212     58.9468
18900     0.1422      0.9536     0.2212     59.7578
19000     0.1349      0.9536     0.2212     59.6256
19100     0.1412      0.9494     0.2212     58.6984
19200     0.1719      0.9346     0.2212     59.6631
19300     0.1844      0.9304     0.2212     58.7197
19400     0.1294      0.9641     0.2212     59.1844
19500     0.1896      0.9409     0.2212     59.0692
19600     0.1840      0.9367     0.2212     59.1843
19700     0.2031      0.9346     0.2212     59.3429
19800     0.1194      0.9557     0.2212     59.3342
19900     0.1692      0.9409     0.2212     58.9401
20000     0.1443      0.9578     0.2212     59.6399
20100     0.1740      0.9473     0.2212     58.7556
20199     0.1174      0.9494     0.2212     58.4596
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     6.2346      0.1878     0.2009     9.8387
00100     2.6108      0.3460     0.3366     59.5616
00200     1.9318      0.4768     0.3988     59.0227
00300     1.8124      0.5274     0.4854     60.0234
00400     2.0697      0.5506     0.5278     59.2747
00500     1.6180      0.5844     0.5619     59.3844
00600     1.4941      0.5970     0.5835     59.7506
00700     1.6879      0.6287     0.6057     58.7476
00800     1.4480      0.6498     0.6057     59.0686
00900     1.4624      0.6350     0.6409     59.0253
01000     1.5750      0.6371     0.6561     58.6105
01100     1.0834      0.7384     0.6561     59.1007
01200     1.4510      0.6519     0.6561     59.1988
01300     1.2860      0.7278     0.6675     58.7674
01400     1.2519      0.6814     0.6766     59.2208
01500     1.2025      0.6814     0.6854     59.0072
01600     1.4924      0.6308     0.6854     59.1667
01700     1.1525      0.6857     0.6867     59.5406
01800     1.2927      0.6624     0.7110     58.9406
01900     1.2619      0.6857     0.7110     59.3816
02000     1.3108      0.6878     0.7110     58.6354
02100     1.3191      0.7025     0.7110     58.8535
02200     0.9588      0.7468     0.7110     59.6172
02300     1.2813      0.6983     0.7110     58.7341
02400     0.9067      0.7384     0.7110     59.4240
02500     0.9821      0.7637     0.7110     60.6275
02600     1.3791      0.6941     0.7145     59.5735
02700     1.1442      0.7110     0.7145     59.5782
02800     1.2974      0.6751     0.7209     59.3227
02900     0.9901      0.7468     0.7209     59.5958
03000     1.3621      0.7110     0.7209     59.4883
03100     1.2423      0.7025     0.7209     59.3804
03200     1.0144      0.7236     0.7209     59.3035
03300     0.9353      0.7700     0.7301     59.7203
03400     0.9841      0.7511     0.7301     58.7211
03500     1.3583      0.6709     0.7410     59.6606
03600     0.8830      0.7785     0.7467     59.5681
03700     1.2476      0.7236     0.7468     58.7440
03800     1.1404      0.7426     0.7468     59.5261
03900     0.9412      0.7468     0.7509     59.1317
04000     1.1491      0.7068     0.7603     58.5871
04100     1.0377      0.7616     0.7603     59.1335
04200     1.0625      0.7637     0.7603     59.1923
04300     1.4678      0.6561     0.7603     59.8073
04400     0.6894      0.7954     0.7603     59.3112
04500     0.8994      0.7658     0.7603     59.5537
04600     1.0765      0.7405     0.7603     59.5428
04700     0.9948      0.7384     0.7603     59.0869
04800     1.2929      0.6878     0.7653     59.4853
04900     0.9032      0.7637     0.7653     59.8490
05000     1.0436      0.7616     0.7653     59.5467
05100     1.1794      0.6878     0.7653     62.0009
05200     0.8321      0.7890     0.7653     59.4024
05300     0.9395      0.7046     0.7653     59.7405
05400     1.2282      0.6920     0.7653     59.8412
05500     1.1391      0.7405     0.7678     60.4607
05600     0.7814      0.7954     0.7678     59.1319
05700     0.8893      0.7743     0.7697     59.5834
05800     0.9756      0.7785     0.7793     59.2916
05900     0.9834      0.7447     0.7793     60.2226
06000     0.8905      0.7975     0.7793     59.3456
06100     1.0531      0.7595     0.7821     59.9741
06200     1.1315      0.7257     0.7821     58.9884
06300     0.9410      0.7722     0.7821     57.3119
06400     1.0063      0.7637     0.7821     57.4448
06500     0.8019      0.8017     0.7821     57.5740
06600     0.9528      0.7827     0.7821     57.7580
06700     0.9094      0.7700     0.7821     58.0786
06800     0.8611      0.7616     0.7839     57.2461
06900     0.8658      0.7595     0.7890     57.2968
07000     0.8243      0.7679     0.7890     58.1118
07100     0.7822      0.7827     0.7890     57.6010
07200     0.7288      0.8038     0.7890     57.9211
07300     1.0277      0.7511     0.7890     58.2756
07400     0.6683      0.7932     0.7895     57.8509
07500     0.8886      0.7700     0.7943     59.0231
07600     0.7738      0.7827     0.7943     59.5044
07700     0.8778      0.7869     0.7943     58.2077
07800     0.6726      0.8101     0.7943     58.9495
07900     0.9284      0.7616     0.8024     58.3341
08000     0.9325      0.7532     0.8024     58.0364
08100     0.7371      0.7764     0.8024     58.9875
08200     0.6007      0.8165     0.8024     57.3576
08300     0.8331      0.7932     0.8024     59.0606
08400     0.9214      0.8165     0.8024     58.6731
08500     0.8203      0.8038     0.8024     58.6419
08600     1.0295      0.7300     0.8024     59.6950
08700     0.9650      0.7658     0.8024     58.8177
08800     0.9458      0.7975     0.8024     58.6959
08900     0.7459      0.7954     0.8024     59.4780
09000     0.7906      0.7890     0.8024     58.3572
09100     0.7542      0.7890     0.8024     58.6693
09200     0.9018      0.7806     0.8024     59.3166
09300     0.8045      0.7848     0.8024     59.2851
09400     0.9691      0.7595     0.8024     58.7293
09500     0.7210      0.8038     0.8024     57.9440
09600     1.1668      0.6793     0.8045     58.8017
09700     0.9841      0.7574     0.8063     58.3115
09800     0.8624      0.7637     0.8106     57.5291
09900     0.8711      0.7806     0.8126     59.9873
Start testing:
Test Accuracy: 0.8661
