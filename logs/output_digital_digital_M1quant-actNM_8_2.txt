Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=14, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.0, noise_injectionT=0.0, pact_a=True, quant_actMVM=8, quant_actNM=8, quant_inp=8, quant_w=8, random_seed=8627169, rows_bias=100, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
b69682ac-a6db-4958-9a92-3e7b752e7cb0
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 147, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 373, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 209, in forward
    part1 = CustomMM_bmm.apply(quant_pass(pact_a_bmm(input.repeat(self.n_blocks, 1, 1), self.a1), self.ib, self.a1), self.weight_ih, self.bias_ih, self.noise_level, self.wb, self.bias_r)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 145, in forward
    wq = quant_pass(weight, wb, 1.)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 82, in forward
    if len(x_range) > 1:
TypeError: object of type 'float' has no len()
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=14, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.0, noise_injectionT=0.0, pact_a=True, quant_actMVM=8, quant_actNM=8, quant_inp=8, quant_w=8, random_seed=8627169, rows_bias=100, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
eb861bdc-afc5-46f6-9adb-3a2ea63aae87
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 147, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 373, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 209, in forward
    part1 = CustomMM_bmm.apply(quant_pass(pact_a_bmm(input.repeat(self.n_blocks, 1, 1), self.a1), self.ib, self.a1), self.weight_ih, self.bias_ih, self.noise_level, self.wb, self.bias_r)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 145, in forward
    wq = quant_pass(weight, wb, torch.tensor([1.]).device(input.device))
TypeError: 'torch.device' object is not callable
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=14, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.0, noise_injectionT=0.0, pact_a=True, quant_actMVM=8, quant_actNM=8, quant_inp=8, quant_w=8, random_seed=8627169, rows_bias=100, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
3f8dd286-6f75-4cb4-a39c-746fb807e5d3
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     3.5522      0.0633     0.0665     9.6349
00100     2.1308      0.3101     0.3020     55.6441
00200     1.6370      0.4641     0.4869     55.3033
00300     1.3835      0.5485     0.5493     55.2959
00400     1.2612      0.6118     0.6224     54.9653
00500     1.2261      0.5717     0.6536     54.7059
00600     0.9748      0.6962     0.6777     55.5809
00700     1.0107      0.6878     0.7077     55.2803
00800     0.9476      0.6814     0.7213     57.0753
00900     0.9699      0.6793     0.7382     57.0751
01000     0.7804      0.7679     0.7382     57.4954
01100     0.9434      0.6941     0.7427     56.8106
01200     0.8827      0.7025     0.7496     55.4095
01300     0.8469      0.7321     0.7661     55.4563
01400     0.8387      0.7236     0.7699     55.3453
01500     0.8436      0.7532     0.7718     56.2511
01600     0.8153      0.7553     0.7831     58.2933
01700     0.7426      0.7679     0.7894     55.4678
01800     0.6613      0.8017     0.7894     55.6460
01900     0.7156      0.7637     0.7894     55.5275
02000     0.7570      0.7574     0.7930     55.1994
02100     0.6839      0.7785     0.7930     54.5916
02200     0.7793      0.7468     0.8008     56.1088
02300     0.7097      0.7700     0.8008     54.9376
02400     0.6575      0.7996     0.8008     56.8822
02500     0.6776      0.7911     0.8040     56.3131
02600     0.6830      0.7996     0.8129     55.4855
02700     0.6767      0.7911     0.8137     55.6887
02800     0.6562      0.7954     0.8175     55.9872
02900     0.5955      0.8270     0.8184     55.9781
03000     0.6177      0.7827     0.8184     56.2108
03100     0.6398      0.7890     0.8184     56.1327
03200     0.6923      0.7722     0.8184     55.3718
03300     0.7219      0.7722     0.8184     55.5992
03400     0.6454      0.7806     0.8235     55.0417
03500     0.7484      0.7595     0.8235     55.3450
03600     0.6381      0.7996     0.8235     55.4814
03700     0.6440      0.8017     0.8235     54.1834
03800     0.6027      0.8143     0.8263     56.3779
03900     0.5685      0.8333     0.8263     54.6615
04000     0.7201      0.7700     0.8313     55.3185
04100     0.6794      0.7806     0.8313     55.2355
04200     0.6590      0.7637     0.8313     54.8677
04300     0.6087      0.8165     0.8313     57.5977
04400     0.7076      0.7722     0.8313     56.2549
04500     0.7252      0.7511     0.8313     55.0584
04600     0.5517      0.8249     0.8313     55.0991
04700     0.5900      0.8038     0.8313     55.6702
04800     0.5734      0.8249     0.8313     56.1428
04900     0.6364      0.7996     0.8313     57.4809
05000     0.6479      0.7954     0.8337     55.9895
05100     0.5854      0.8059     0.8337     55.8974
05200     0.6009      0.8249     0.8350     56.7258
05300     0.5202      0.8481     0.8350     55.3988
05400     0.6063      0.8122     0.8350     55.3723
05500     0.6572      0.7848     0.8350     54.7330
05600     0.6271      0.7911     0.8350     54.7204
05700     0.6152      0.7975     0.8350     55.2612
05800     0.5426      0.8270     0.8350     54.6917
05900     0.6067      0.8186     0.8350     56.5092
06000     0.5675      0.8186     0.8360     55.1546
06100     0.6024      0.8038     0.8360     54.1682
06200     0.6001      0.7890     0.8360     56.0424
06300     0.5294      0.8270     0.8360     56.0041
06400     0.6623      0.7890     0.8360     55.1925
06500     0.5856      0.8165     0.8360     54.8431
06600     0.5828      0.8165     0.8373     55.1302
06700     0.5488      0.8207     0.8373     55.2352
06800     0.6266      0.7869     0.8373     55.5362
06900     0.5388      0.8249     0.8373     56.0426
07000     0.6407      0.8017     0.8373     55.6181
07100     0.5947      0.8038     0.8373     54.5832
07200     0.6048      0.8165     0.8373     56.2952
07300     0.6473      0.7996     0.8373     56.0785
07400     0.5407      0.8333     0.8373     55.5095
07500     0.4520      0.8481     0.8373     56.7168
07600     0.5864      0.8439     0.8373     55.9304
07700     0.5604      0.8228     0.8373     54.7428
07800     0.5777      0.8143     0.8373     55.8875
07900     0.5111      0.8418     0.8373     55.0755
08000     0.5577      0.8291     0.8379     56.3262
08100     0.5077      0.8376     0.8379     56.3581
08200     0.5423      0.8207     0.8379     54.6997
08300     0.5408      0.8207     0.8404     55.6073
08400     0.5765      0.8207     0.8404     56.1375
08500     0.5749      0.8059     0.8404     54.9110
08600     0.5622      0.8143     0.8404     55.1130
08700     0.5161      0.8397     0.8404     56.2876
08800     0.6713      0.8059     0.8404     56.5275
08900     0.4750      0.8671     0.8428     54.9071
09000     0.5335      0.8270     0.8428     54.6675
09100     0.5335      0.8502     0.8428     57.1074
09200     0.5715      0.8207     0.8454     56.6166
09300     0.5685      0.8354     0.8454     54.2974
09400     0.6348      0.8080     0.8454     55.3464
09500     0.5243      0.8291     0.8454     56.0538
09600     0.5237      0.8291     0.8454     55.9549
09700     0.4651      0.8586     0.8454     55.4942
09800     0.5922      0.8101     0.8454     55.0173
09900     0.5193      0.8418     0.8454     55.4989
10000     0.5574      0.8312     0.8454     54.6748
10100     0.5705      0.8122     0.8454     55.8895
10200     0.4846      0.8418     0.8454     54.6064
10300     0.5115      0.8291     0.8454     55.7606
10400     0.4872      0.8565     0.8454     56.6730
10500     0.5106      0.8186     0.8455     55.9730
10600     0.4730      0.8502     0.8463     55.9334
10700     0.4961      0.8502     0.8463     55.6573
10800     0.5487      0.8270     0.8463     55.1610
10900     0.5627      0.8143     0.8463     54.6650
11000     0.4926      0.8460     0.8463     56.3598
11100     0.5865      0.8186     0.8463     55.3006
11200     0.4819      0.8481     0.8468     55.8341
11300     0.4992      0.8460     0.8468     55.2586
11400     0.4949      0.8418     0.8468     54.2751
11500     0.4165      0.8692     0.8468     55.9426
11600     0.5408      0.8207     0.8468     55.7232
11700     0.5228      0.8228     0.8468     56.1683
11800     0.5958      0.7911     0.8468     55.2192
11900     0.5391      0.8523     0.8500     54.8245
12000     0.5310      0.8143     0.8500     54.7469
12100     0.5373      0.8291     0.8500     54.7839
12200     0.5021      0.8249     0.8500     55.2529
12300     0.4723      0.8502     0.8500     56.1242
12400     0.4970      0.8439     0.8500     54.5710
12500     0.4865      0.8523     0.8500     54.6337
12600     0.5136      0.8544     0.8500     54.9764
12700     0.4323      0.8629     0.8500     55.1855
12800     0.5479      0.8207     0.8500     55.3316
12900     0.5085      0.8418     0.8500     55.0014
13000     0.4751      0.8481     0.8500     54.6132
13100     0.5641      0.8291     0.8500     55.5820
13200     0.4354      0.8502     0.8500     55.0800
13300     0.5564      0.8165     0.8500     56.0856
13400     0.4970      0.8544     0.8500     56.3586
13500     0.5416      0.8249     0.8500     55.3940
13600     0.4864      0.8502     0.8500     56.2923
13700     0.5014      0.8481     0.8500     56.3841
13800     0.5550      0.8143     0.8500     54.7341
13900     0.4133      0.8797     0.8500     55.8004
14000     0.4931      0.8418     0.8500     55.0595
14100     0.5206      0.8481     0.8500     57.5656
14200     0.5673      0.8186     0.8500     56.8684
14300     0.4430      0.8523     0.8500     55.2575
14400     0.5232      0.8397     0.8500     55.7186
14500     0.4715      0.8565     0.8500     55.4483
14600     0.5163      0.8312     0.8500     55.1517
14700     0.4717      0.8523     0.8500     57.6321
14800     0.4838      0.8439     0.8500     55.6061
14900     0.4842      0.8460     0.8500     55.2015
15000     0.5177      0.8376     0.8500     55.6746
15100     0.4819      0.8439     0.8500     55.9921
15200     0.5612      0.8397     0.8500     57.0796
15300     0.5115      0.8228     0.8558     55.3065
15400     0.5020      0.8354     0.8558     55.3868
15500     0.4712      0.8523     0.8558     56.4897
15600     0.4978      0.8586     0.8558     55.2912
15700     0.4807      0.8502     0.8558     55.4341
15800     0.4696      0.8460     0.8558     55.7008
15900     0.4446      0.8629     0.8558     54.4787
16000     0.4992      0.8376     0.8558     54.5715
16100     0.4847      0.8354     0.8558     55.0867
16200     0.5143      0.8291     0.8558     52.8883
16300     0.5496      0.8122     0.8558     54.3666
16400     0.5696      0.8354     0.8558     54.2925
16500     0.3878      0.8861     0.8558     54.2281
16600     0.4322      0.8608     0.8558     54.7061
16700     0.4780      0.8460     0.8558     54.5435
16800     0.4919      0.8270     0.8558     54.8754
16900     0.5247      0.8481     0.8558     55.2041
17000     0.5372      0.8228     0.8558     54.7426
17100     0.5307      0.8333     0.8558     55.4987
17200     0.4994      0.8291     0.8558     54.4005
17300     0.5523      0.8143     0.8558     54.8848
17400     0.5001      0.8397     0.8558     55.8068
17500     0.5283      0.8291     0.8558     54.6171
17600     0.5640      0.7911     0.8558     55.1409
17700     0.4722      0.8523     0.8558     55.4248
17800     0.5894      0.8291     0.8558     54.9854
17900     0.5243      0.8397     0.8558     55.9423
18000     0.4483      0.8523     0.8558     55.5513
18100     0.4811      0.8586     0.8558     55.3508
18200     0.4083      0.8819     0.8558     55.9540
18300     0.5458      0.8122     0.8558     56.3211
18400     0.4637      0.8608     0.8558     57.1294
18500     0.4914      0.8291     0.8558     55.5090
18600     0.4947      0.8460     0.8558     56.3800
18700     0.5167      0.8376     0.8558     55.2240
18800     0.4861      0.8376     0.8558     54.3827
18900     0.5287      0.8101     0.8558     55.5408
19000     0.4806      0.8460     0.8558     56.1725
19100     0.4921      0.8481     0.8558     55.1302
19200     0.5697      0.8228     0.8558     57.6795
19300     0.5113      0.8354     0.8558     55.2700
19400     0.5097      0.8101     0.8558     55.4654
19500     0.5283      0.8101     0.8558     56.3658
19600     0.5497      0.8207     0.8558     56.0289
19700     0.5768      0.8228     0.8558     57.0274
19800     0.6083      0.8228     0.8558     55.4824
19900     0.4443      0.8629     0.8558     55.3800
20000     0.5423      0.8333     0.8558     55.6797
20100     0.4878      0.8376     0.8558     56.0286
20199     0.6170      0.7975     0.8558     55.1295
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     0.4419      0.8586     0.8481     8.7744
00100     0.3877      0.8692     0.8515     55.6907
00200     0.4415      0.8755     0.8515     54.6571
00300     0.4653      0.8650     0.8515     55.5196
00400     0.4234      0.8692     0.8515     55.0995
00500     0.4189      0.8523     0.8515     54.6088
00600     0.3853      0.8713     0.8515     55.6552
00700     0.4427      0.8629     0.8550     55.7636
00800     0.4478      0.8776     0.8550     56.6010
00900     0.4173      0.8713     0.8550     55.1496
01000     0.4266      0.8650     0.8550     55.2604
01100     0.3902      0.8734     0.8550     55.5203
01200     0.4179      0.8523     0.8550     54.8399
01300     0.4384      0.8608     0.8550     56.2068
01400     0.4522      0.8629     0.8550     55.5002
01500     0.3761      0.8776     0.8550     55.8983
01600     0.4274      0.8755     0.8550     56.0376
01700     0.4161      0.8755     0.8550     55.4872
01800     0.4276      0.8692     0.8550     55.2373
01900     0.3561      0.8840     0.8550     55.2721
02000     0.4572      0.8439     0.8550     54.7057
02100     0.3978      0.8671     0.8550     55.2119
02200     0.3833      0.8861     0.8550     55.7527
02300     0.4580      0.8565     0.8550     54.5936
02400     0.4110      0.8523     0.8550     55.3353
02500     0.3653      0.8776     0.8550     55.0812
02600     0.3771      0.8819     0.8550     55.7845
02700     0.4485      0.8523     0.8550     55.5087
02800     0.4396      0.8586     0.8550     55.2590
02900     0.4175      0.8608     0.8550     56.2055
03000     0.4594      0.8629     0.8550     56.0206
03100     0.4215      0.8544     0.8550     55.3604
03200     0.4255      0.8840     0.8550     55.6919
03300     0.3878      0.8840     0.8550     55.2368
03400     0.4299      0.8713     0.8550     54.8488
03500     0.4864      0.8502     0.8550     56.7427
03600     0.4564      0.8397     0.8556     54.8993
03700     0.4213      0.8608     0.8556     56.1289
03800     0.4670      0.8565     0.8556     57.2652
03900     0.3967      0.8882     0.8556     56.2023
04000     0.3627      0.8882     0.8556     55.9934
04100     0.4160      0.8586     0.8556     55.8217
04200     0.3635      0.8819     0.8556     55.4315
04300     0.3805      0.8819     0.8556     55.0910
04400     0.3785      0.8734     0.8556     55.2916
04500     0.4513      0.8523     0.8556     55.2844
04600     0.4273      0.8586     0.8556     56.2997
04700     0.4000      0.8776     0.8556     54.9650
04800     0.5065      0.8376     0.8556     55.0695
04900     0.4747      0.8713     0.8556     55.3850
05000     0.4166      0.8650     0.8556     56.1745
05100     0.4294      0.8544     0.8556     55.5088
05200     0.3580      0.8861     0.8556     56.0404
05300     0.3693      0.8819     0.8556     56.4127
05400     0.4572      0.8544     0.8556     56.0989
05500     0.5025      0.8418     0.8556     54.8312
05600     0.4863      0.8439     0.8556     55.0564
05700     0.3966      0.8882     0.8556     55.4293
05800     0.4996      0.8460     0.8576     54.7727
05900     0.3771      0.8734     0.8576     55.3632
06000     0.3338      0.8776     0.8576     55.3993
06100     0.4023      0.8840     0.8576     55.0347
06200     0.4047      0.8671     0.8576     56.7208
06300     0.4553      0.8650     0.8576     55.1289
06400     0.4146      0.8692     0.8576     55.8947
06500     0.4339      0.8460     0.8576     56.5526
06600     0.4754      0.8481     0.8576     55.7045
06700     0.4876      0.8418     0.8576     56.7484
06800     0.4240      0.8586     0.8576     54.8917
06900     0.3829      0.8987     0.8576     55.4038
07000     0.4350      0.8608     0.8576     55.4891
07100     0.4191      0.8776     0.8576     55.1089
07200     0.4409      0.8671     0.8576     55.8060
07300     0.3810      0.8755     0.8576     55.1506
07400     0.4429      0.8713     0.8576     55.1022
07500     0.4156      0.8734     0.8576     54.6459
07600     0.4306      0.8544     0.8576     54.5432
07700     0.4305      0.8734     0.8576     55.8411
07800     0.4856      0.8418     0.8576     56.9019
07900     0.4505      0.8650     0.8576     56.2782
08000     0.3837      0.8523     0.8576     54.9214
08100     0.3366      0.8987     0.8576     55.7833
08200     0.4144      0.8755     0.8576     55.6179
08300     0.4300      0.8734     0.8576     55.8979
08400     0.5283      0.8460     0.8576     56.2608
08500     0.3971      0.8840     0.8576     55.1241
08600     0.3440      0.8903     0.8576     55.4671
08700     0.4199      0.8797     0.8576     54.5552
08800     0.3881      0.8755     0.8576     56.2146
08900     0.3584      0.8797     0.8576     56.2292
09000     0.4321      0.8692     0.8576     54.7410
09100     0.3918      0.8797     0.8576     56.2275
09200     0.3849      0.8776     0.8576     56.1533
09300     0.4169      0.8734     0.8576     56.1149
09400     0.3862      0.8819     0.8576     54.7006
09500     0.4460      0.8671     0.8576     55.1717
09600     0.4121      0.8692     0.8576     54.8013
09700     0.4728      0.8629     0.8587     56.9029
09800     0.4807      0.8460     0.8587     55.4532
09900     0.4167      0.8797     0.8587     55.9792
Start testing:
Test Accuracy: 0.8419
