Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=294, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=235899598, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
832263e1-0199-449e-9983-ff33630c49bf
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 167, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 374, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 211, in forward
    part2 = CustomMM_bmm.apply(quant_pass(pact_a_bmm(hx, self.a11), self.ib, self.a11), self.weight_hh * w_mask, self.bias_hh, self.noise_level, self.wb, self.bias_r)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 150, in forward
    output = input.bmm(wq + noise_w) + bq + bias_w
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 22.17 GiB total capacity; 20.97 GiB already allocated; 10.50 MiB free; 21.19 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=294, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=235899598, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
8d1e254d-db3e-4d85-b023-8b687cb05068
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     3.2889      0.1200     0.0863     14.8329
00100     1.9424      0.3900     0.4452     58.0615
00200     1.3894      0.4800     0.5883     56.7737
00300     1.2101      0.6700     0.6466     59.2327
00400     1.0644      0.6500     0.6966     56.6508
00500     0.9791      0.6600     0.7433     57.5323
00600     1.0225      0.7200     0.7463     56.9173
00700     0.8583      0.7200     0.7714     58.6852
00800     0.9033      0.7000     0.7791     55.1736
00900     0.9275      0.6900     0.7791     55.7120
01000     0.9705      0.7000     0.7791     56.5898
01100     0.8168      0.7600     0.7841     58.2377
01200     0.7672      0.7500     0.8014     54.8502
01300     0.9613      0.7200     0.8014     58.2667
01400     0.7754      0.7500     0.8014     61.0590
01500     0.9485      0.6400     0.8064     57.3955
01600     0.9299      0.7100     0.8064     55.3395
01700     0.6917      0.8100     0.8097     58.4514
01800     0.4865      0.8300     0.8097     55.8104
01900     0.8626      0.7100     0.8097     57.6156
02000     0.7092      0.7900     0.8303     57.2195
02100     0.9951      0.6600     0.8303     58.2929
02200     0.8519      0.7000     0.8303     55.4762
02300     0.8704      0.7000     0.8349     55.1315
02400     0.6790      0.8200     0.8349     55.0271
02500     0.5665      0.8300     0.8362     55.6087
02600     0.5698      0.7900     0.8362     54.2345
02700     0.7215      0.7400     0.8362     57.6684
02800     0.8459      0.7300     0.8362     54.6518
02900     0.7121      0.7500     0.8362     55.5425
03000     0.7747      0.7600     0.8362     54.5083
03100     0.9209      0.7400     0.8362     57.5515
03200     0.5176      0.8400     0.8362     55.7892
03300     0.5986      0.8300     0.8450     56.9653
03400     0.5513      0.8500     0.8450     54.0784
03500     0.7597      0.8200     0.8511     54.4913
03600     0.7097      0.8000     0.8511     54.1664
03700     0.6421      0.8000     0.8511     56.2304
03800     0.5946      0.8100     0.8511     54.4029
03900     0.6019      0.8100     0.8511     55.4942
04000     0.7226      0.7500     0.8515     54.6135
04100     0.6328      0.7800     0.8515     55.3195
04200     0.5283      0.8700     0.8515     54.8596
04300     0.5965      0.7800     0.8602     55.7312
04400     0.5257      0.8800     0.8602     56.3775
04500     0.6760      0.8500     0.8602     55.9663
04600     0.7023      0.7700     0.8602     54.1535
04700     0.7807      0.7800     0.8602     55.3489
04800     0.5878      0.8100     0.8602     58.7727
04900     0.7175      0.8000     0.8602     56.5582
05000     0.6605      0.7600     0.8602     53.6627
05100     0.4945      0.8300     0.8602     56.4563
05200     0.4779      0.8600     0.8602     55.2652
05300     0.7523      0.8000     0.8602     58.6842
05400     0.6084      0.8100     0.8628     58.1988
05500     0.5868      0.7900     0.8628     59.5125
05600     0.5287      0.8200     0.8628     55.5316
05700     0.6379      0.8000     0.8628     54.8694
05800     0.7436      0.7000     0.8647     58.2870
05900     0.3937      0.8600     0.8647     55.4855
06000     0.5886      0.7700     0.8647     57.5568
06100     0.6735      0.7800     0.8647     58.9727
06200     0.3927      0.9000     0.8647     54.5278
06300     0.6007      0.8100     0.8647     54.5736
06400     0.6449      0.8200     0.8647     54.2471
06500     0.5363      0.8400     0.8647     54.3119
06600     0.5158      0.8300     0.8723     56.4822
06700     0.6119      0.8100     0.8723     54.5755
06800     0.6746      0.7800     0.8723     57.1315
06900     0.4081      0.8500     0.8723     56.7806
07000     0.5369      0.8100     0.8723     54.9846
07100     0.3526      0.8800     0.8723     58.1795
07200     0.4646      0.8300     0.8723     63.6506
07300     0.4760      0.8400     0.8723     54.3088
07400     0.5275      0.8000     0.8723     54.1998
07500     0.4810      0.8900     0.8723     54.0024
07600     0.4163      0.8700     0.8723     57.1516
07700     0.6539      0.8000     0.8734     55.2361
07800     0.4787      0.8200     0.8734     54.0993
07900     0.3252      0.8700     0.8734     54.3387
08000     0.4814      0.8600     0.8734     54.8986
08100     0.5175      0.8400     0.8734     57.0319
08200     0.6621      0.7900     0.8734     57.1276
08300     0.4368      0.8200     0.8734     54.6259
08400     0.6428      0.8000     0.8734     54.3284
08500     0.3686      0.8800     0.8734     54.1163
08600     0.4472      0.8300     0.8734     54.1525
08700     0.3864      0.8700     0.8734     53.9679
08800     0.3872      0.8800     0.8734     57.8948
08900     0.4989      0.8500     0.8734     55.9862
09000     0.6553      0.7800     0.8765     57.1307
09100     0.3642      0.8900     0.8765     53.9769
09200     0.5657      0.8400     0.8765     55.1181
09300     0.4075      0.8400     0.8765     57.1514
09400     0.4449      0.8800     0.8765     54.4441
09500     0.4167      0.8900     0.8813     59.8048
09600     0.6295      0.8200     0.8813     55.2039
09700     0.5086      0.8400     0.8813     54.1130
09800     0.4561      0.8200     0.8813     55.0806
09900     0.4581      0.8500     0.8813     54.4328
10000     0.3832      0.8600     0.8813     55.0017
10100     0.4155      0.8700     0.8828     57.5706
10200     0.3940      0.8400     0.8828     56.3936
10300     0.4655      0.8500     0.8828     55.2912
10400     0.4455      0.8400     0.8828     55.0689
10500     0.3631      0.8700     0.8847     57.6323
10600     0.4291      0.8600     0.8847     57.8040
10700     0.5504      0.8300     0.8847     57.1093
10800     0.4007      0.8700     0.8847     56.1786
10900     0.4703      0.8700     0.8847     57.6070
11000     0.3903      0.8900     0.8847     56.0524
11100     0.4858      0.8000     0.8847     59.7867
11200     0.3737      0.8900     0.8917     58.5135
11300     0.3928      0.8800     0.8917     54.0758
11400     0.4105      0.8600     0.8917     57.7098
11500     0.4048      0.8800     0.8917     55.2528
11600     0.3648      0.9200     0.8917     54.6037
11700     0.3505      0.8700     0.8917     54.5655
11800     0.4748      0.8600     0.8917     56.5111
11900     0.3427      0.8700     0.8917     55.1490
12000     0.4291      0.8600     0.8917     55.0572
12100     0.5308      0.7900     0.8917     59.5963
12200     0.4847      0.8600     0.8917     55.9791
12300     0.3135      0.9000     0.8917     55.3656
12400     0.5169      0.8500     0.8917     56.7595
12500     0.3445      0.9100     0.8917     55.8722
12600     0.2871      0.9300     0.8917     58.0913
12700     0.3668      0.9200     0.8917     55.5265
12800     0.6405      0.7900     0.8917     57.3756
12900     0.4833      0.8000     0.8917     55.1165
13000     0.4427      0.8600     0.8917     54.2710
13100     0.4999      0.8300     0.8917     54.4152
13200     0.3252      0.8500     0.8917     57.3526
13300     0.3702      0.8600     0.8917     56.3081
13400     0.3587      0.8800     0.8972     56.7697
13500     0.5594      0.7900     0.8972     57.1176
13600     0.3047      0.9100     0.8972     58.0657
13700     0.5405      0.8400     0.8972     55.0631
13800     0.3856      0.8400     0.8972     54.3566
13900     0.3071      0.9200     0.8972     55.6029
14000     0.2748      0.9300     0.8972     57.7253
14100     0.3819      0.8700     0.8972     54.4264
14200     0.3571      0.8700     0.8972     58.4982
14300     0.3532      0.8900     0.8972     55.2036
14400     0.3917      0.8800     0.8974     57.9747
14500     0.3175      0.8600     0.8974     54.0842
14600     0.3854      0.8900     0.8974     54.3048
14700     0.4216      0.8300     0.8974     57.8666
14800     0.4632      0.8500     0.8974     54.9137
14900     0.4398      0.8500     0.8974     57.5803
15000     0.4620      0.8600     0.8974     55.6115
15100     0.6733      0.8600     0.8974     54.6657
15200     0.3177      0.9000     0.8974     58.6472
15300     0.3597      0.8800     0.8974     55.5802
15400     0.3373      0.9200     0.8974     54.2216
15500     0.5140      0.8400     0.8974     54.8738
15600     0.2861      0.8800     0.8974     57.6025
15700     0.3035      0.9100     0.8974     59.3755
15800     0.3096      0.9100     0.8974     56.0422
15900     0.1811      0.9500     0.8974     55.9359
16000     0.3367      0.8800     0.8974     55.5490
16100     0.5127      0.8100     0.8974     58.9684
16200     0.4362      0.8600     0.8974     55.9316
16300     0.4954      0.8200     0.8974     55.9492
16400     0.2456      0.9200     0.8974     54.4617
16500     0.2868      0.9200     0.8974     57.8011
16600     0.4349      0.8400     0.8974     58.2089
16700     0.3222      0.9000     0.8974     56.6468
16800     0.3850      0.8800     0.8974     55.4808
16900     0.4037      0.8700     0.8974     56.7960
17000     0.3583      0.8600     0.8974     58.3639
17100     0.4371      0.8600     0.8974     55.0554
17200     0.2831      0.9100     0.8974     54.3242
17300     0.3089      0.9200     0.8974     54.1969
17400     0.4626      0.8500     0.8974     58.1030
17500     0.4305      0.8900     0.8974     55.4046
17600     0.3383      0.8700     0.8974     55.6549
17700     0.3680      0.8300     0.8974     55.8310
17800     0.3509      0.8700     0.8974     57.2815
17900     0.3731      0.8900     0.8974     55.2918
18000     0.2252      0.9300     0.8974     54.8009
18100     0.4491      0.8500     0.8974     59.7835
18200     0.2892      0.9100     0.8974     55.5784
18300     0.3201      0.9000     0.8974     54.9666
18400     0.2124      0.9400     0.8974     57.0861
18500     0.3261      0.8800     0.8974     54.1501
18600     0.2713      0.8800     0.8974     55.6955
18700     0.3641      0.8600     0.8974     56.0088
18800     0.3756      0.8600     0.8974     54.3268
18900     0.3366      0.8500     0.8974     54.6879
19000     0.3809      0.8800     0.8974     57.2105
19100     0.2533      0.9300     0.9018     61.6780
19200     0.2536      0.9300     0.9018     54.8344
19300     0.2761      0.9000     0.9018     56.6368
19400     0.2276      0.9300     0.9018     58.5159
19500     0.3446      0.8900     0.9018     56.8856
19600     0.2423      0.9100     0.9018     55.2936
19700     0.4007      0.9000     0.9018     54.5627
19800     0.2094      0.9100     0.9018     54.4578
19900     0.2581      0.9100     0.9018     60.4666
20000     0.2701      0.9100     0.9018     56.0336
20100     0.3136      0.9100     0.9018     53.8896
20199     0.3400      0.8900     0.9018     57.0357
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     0.8749      0.7100     0.8084     13.9267
00100     0.4396      0.8600     0.8984     54.6846
00200     0.4438      0.8600     0.9088     54.7940
00300     0.2398      0.9400     0.9088     56.3583
00400     0.3881      0.8600     0.9088     59.2484
00500     0.2541      0.9200     0.9088     55.8422
00600     0.3204      0.9200     0.9088     55.8857
00700     0.4999      0.8700     0.9088     54.4095
00800     0.3460      0.9000     0.9088     55.0274
00900     0.4197      0.9000     0.9088     58.4700
01000     0.4654      0.8200     0.9088     58.7576
01100     0.3367      0.8800     0.9088     56.2527
01200     0.4602      0.8400     0.9088     58.2459
01300     0.1937      0.9600     0.9088     54.3608
01400     0.2264      0.9400     0.9088     60.7134
01500     0.3701      0.8600     0.9088     54.5860
01600     0.3420      0.9000     0.9088     54.3825
01700     0.3559      0.8600     0.9088     53.7145
01800     0.2816      0.9100     0.9088     58.6531
01900     0.4969      0.8700     0.9088     53.9376
02000     0.2673      0.9000     0.9089     58.3495
02100     0.3651      0.8200     0.9089     55.9197
02200     0.1985      0.9300     0.9089     57.2134
02300     0.4100      0.8400     0.9089     55.9946
02400     0.3761      0.9000     0.9089     55.5888
02500     0.3588      0.8800     0.9089     57.0607
02600     0.3331      0.9100     0.9089     54.1776
02700     0.2888      0.9000     0.9090     54.7609
02800     0.3383      0.9100     0.9090     55.4937
02900     0.1562      0.9600     0.9090     54.7454
03000     0.4111      0.8400     0.9090     56.3593
03100     0.4309      0.8700     0.9103     56.7690
03200     0.3289      0.9200     0.9103     53.9859
03300     0.2070      0.9500     0.9103     54.8322
03400     0.3254      0.8900     0.9103     57.1764
03500     0.2193      0.9300     0.9103     54.5583
03600     0.3850      0.8900     0.9103     54.3676
03700     0.3364      0.9000     0.9103     54.4939
03800     0.2698      0.9200     0.9103     54.6703
03900     0.3375      0.9100     0.9103     58.4236
04000     0.2675      0.9100     0.9103     54.1949
04100     0.2742      0.9100     0.9103     56.1739
04200     0.3874      0.8600     0.9103     53.9496
04300     0.3204      0.8900     0.9103     56.7279
04400     0.5689      0.7800     0.9103     55.0335
04500     0.3373      0.9000     0.9103     57.8754
04600     0.2763      0.9100     0.9103     55.1058
04700     0.3216      0.9200     0.9103     57.5880
04800     0.3186      0.9000     0.9103     55.4055
04900     0.3185      0.9200     0.9103     56.5578
05000     0.3663      0.9200     0.9103     54.3210
05100     0.3473      0.9100     0.9103     53.7686
05200     0.3503      0.8900     0.9103     54.2535
05300     0.4316      0.8600     0.9103     55.3282
05400     0.4814      0.8100     0.9103     54.9697
05500     0.3928      0.8800     0.9112     55.5999
05600     0.3389      0.9000     0.9112     54.6957
05700     0.3641      0.8700     0.9112     55.8549
05800     0.2318      0.9300     0.9112     60.6350
05900     0.3317      0.8900     0.9112     58.2505
06000     0.3300      0.9000     0.9112     60.4272
06100     0.2842      0.9000     0.9129     59.5798
06200     0.1890      0.9400     0.9129     54.5674
06300     0.4615      0.8500     0.9129     55.4186
06400     0.2871      0.8900     0.9129     55.7790
06500     0.3253      0.9200     0.9129     54.6830
06600     0.2069      0.9500     0.9129     55.3760
06700     0.3606      0.8600     0.9129     54.1910
06800     0.4525      0.8800     0.9129     58.2810
06900     0.3137      0.8900     0.9129     55.8264
07000     0.4004      0.8800     0.9129     56.9430
07100     0.3476      0.9000     0.9129     56.6243
07200     0.2749      0.9200     0.9129     54.4725
07300     0.2592      0.9100     0.9129     54.9002
07400     0.4357      0.8800     0.9129     60.9526
07500     0.3715      0.8900     0.9129     55.3012
07600     0.2664      0.9200     0.9129     54.7398
07700     0.3726      0.8900     0.9129     54.3620
07800     0.2149      0.9600     0.9129     58.3450
07900     0.3381      0.9100     0.9129     56.3799
08000     0.2515      0.9300     0.9129     54.4562
08100     0.4175      0.8900     0.9129     57.9970
08200     0.3628      0.8900     0.9129     54.7718
08300     0.1754      0.9700     0.9129     56.1033
08400     0.3098      0.9200     0.9129     54.4246
08500     0.2571      0.9300     0.9129     54.7645
08600     0.3626      0.8900     0.9129     54.5890
08700     0.2913      0.9300     0.9129     55.0718
08800     0.2392      0.9300     0.9129     56.5753
08900     0.3746      0.8700     0.9129     55.6838
09000     0.3607      0.9000     0.9129     57.2515
09100     0.2984      0.9000     0.9129     60.0184
09200     0.2193      0.9400     0.9129     54.0370
09300     0.2959      0.9200     0.9129     55.9159
09400     0.2098      0.9400     0.9129     54.8539
09500     0.4021      0.9200     0.9129     55.9339
09600     0.3346      0.9000     0.9134     55.2835
09700     0.2752      0.9100     0.9134     54.3977
09800     0.2563      0.9400     0.9134     60.2214
09900     0.3394      0.9000     0.9134     56.2324
Start testing:
Test Accuracy: 0.9020
