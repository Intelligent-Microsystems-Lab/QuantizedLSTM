Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=294, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=8627169, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
76839e96-47a0-49dd-b810-fa5cab443d09
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 147, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 290, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 213, in forward
    gates = quant_pass(pact_a_bmm( quant_pass(pact_a_bmm(part1, self.a12), self.abMVM, self.a12) + quant_pass(pact_a_bmm(part2, self.a13), self.abMVM, self.a13), self.a14), self.abNM, self.a14)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 124, in pact_a_bmm
    return torch.sign(x) * .5 * (torch.abs(x) - torch.abs(torch.abs(x) - a) + a)
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 10.76 GiB total capacity; 9.63 GiB already allocated; 17.12 MiB free; 9.79 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=294, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=8627169, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
c3790615-5819-4c95-99a5-dd7851525bcb
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     2.7055      0.1000     0.0785     19.7138
00100     1.5388      0.4800     0.0923     56.2989
00200     1.0115      0.6800     0.1038     58.9548
00300     0.8822      0.7300     0.1038     58.5460
00400     0.8550      0.7500     0.1145     58.3971
00500     0.8575      0.7600     0.1227     59.0459
00600     0.6898      0.8000     0.1227     59.2244
00700     0.4892      0.8700     0.1227     59.7533
00800     0.6492      0.7700     0.1227     63.9286
00900     0.4456      0.8600     0.1227     57.9873
01000     0.6387      0.8300     0.1227     59.3629
01100     0.5059      0.8400     0.1227     61.2972
01200     0.5197      0.8300     0.1275     59.1855
01300     0.4831      0.8600     0.1275     60.4559
01400     0.4544      0.8900     0.1275     56.4467
01500     0.5844      0.8300     0.1275     59.2688
01600     0.5177      0.8300     0.1275     58.5469
01700     0.5832      0.8400     0.1316     62.8042
01800     0.5498      0.8300     0.1374     57.9926
01900     0.4009      0.9100     0.1374     56.5976
02000     0.6253      0.8100     0.1374     60.2129
02100     0.4411      0.8500     0.1374     56.0645
02200     0.5323      0.8300     0.1529     60.7260
02300     0.4960      0.8700     0.1529     56.3090
02400     0.3587      0.8900     0.1529     56.5472
02500     0.4359      0.8800     0.1529     56.5068
02600     0.4111      0.8500     0.1529     60.7715
02700     0.4020      0.8800     0.1529     56.0375
02800     0.3701      0.9200     0.1529     57.4224
02900     0.5441      0.8000     0.1529     61.6962
03000     0.3407      0.8900     0.1529     57.5489
03100     0.4355      0.8700     0.1529     60.9840
03200     0.2650      0.9200     0.1591     56.7747
03300     0.2618      0.9400     0.1591     57.1125
03400     0.2498      0.9000     0.1598     56.7277
03500     0.2504      0.9200     0.1679     59.7968
03600     0.6119      0.8200     0.1679     60.7448
03700     0.6214      0.8600     0.1739     62.0392
03800     0.3782      0.8500     0.1763     57.0939
03900     0.4275      0.8700     0.1763     59.6073
04000     0.3975      0.8800     0.1776     58.6071
04100     0.3102      0.9100     0.1946     57.5348
04200     0.3485      0.9200     0.1962     56.8411
04300     0.2885      0.9100     0.1962     56.2161
04400     0.2153      0.9400     0.1962     59.4489
04500     0.3645      0.8300     0.2095     57.9045
04600     0.2648      0.9200     0.2095     59.4413
04700     0.3499      0.9100     0.2095     60.5650
04800     0.3949      0.8700     0.2095     57.1342
04900     0.4163      0.8900     0.2197     56.8899
05000     0.4840      0.8600     0.2197     57.5271
05100     0.3052      0.9300     0.2197     56.1004
05200     0.3985      0.8800     0.2211     61.6536
05300     0.3004      0.9100     0.2211     60.7675
05400     0.3649      0.8900     0.2491     56.2975
05500     0.3625      0.9100     0.2491     57.5456
05600     0.2677      0.9300     0.2491     59.8437
05700     0.2992      0.9200     0.2599     60.0134
05800     0.2314      0.9300     0.2599     59.3571
05900     0.3607      0.9000     0.2599     57.9475
06000     0.2234      0.9400     0.2733     59.7364
06100     0.3276      0.9100     0.2733     58.2177
06200     0.1831      0.9700     0.2733     60.8319
06300     0.2864      0.9000     0.2733     55.8448
06400     0.2229      0.9400     0.2733     57.7365
06500     0.3090      0.9000     0.2733     56.4287
06600     0.3972      0.8800     0.2848     57.5385
06700     0.2880      0.9100     0.2858     56.4195
06800     0.2292      0.9300     0.2988     60.4808
06900     0.2612      0.9200     0.2988     57.6141
07000     0.2549      0.9000     0.2988     55.8904
07100     0.2821      0.9200     0.2988     55.5618
07200     0.2545      0.9300     0.2988     57.3859
07300     0.2478      0.9200     0.3046     57.1331
07400     0.2942      0.9100     0.3203     56.3246
07500     0.3202      0.9100     0.3203     59.6663
07600     0.2569      0.9400     0.3253     59.0121
07700     0.2194      0.9500     0.3253     56.5474
07800     0.2676      0.9200     0.3622     57.7206
07900     0.1877      0.9500     0.3622     58.8155
08000     0.1176      0.9700     0.3650     56.7061
08100     0.2338      0.9300     0.3650     55.8159
08200     0.2720      0.9600     0.3650     56.8362
08300     0.1612      0.9500     0.3650     59.3932
08400     0.2068      0.9300     0.3650     57.0566
08500     0.1645      0.9600     0.3650     58.7040
08600     0.4202      0.9100     0.3696     57.4544
08700     0.2572      0.9100     0.3696     55.7086
08800     0.1536      0.9700     0.3696     56.1333
08900     0.1287      0.9700     0.3696     56.2439
09000     0.2767      0.9300     0.3696     56.5584
09100     0.2036      0.9500     0.3696     56.8433
09200     0.2832      0.9200     0.3696     56.9097
09300     0.2136      0.9400     0.3808     56.6733
09400     0.2647      0.9100     0.3877     58.2972
09500     0.2424      0.9500     0.3877     57.3506
09600     0.2462      0.9100     0.3882     58.4048
09700     0.3084      0.8900     0.3996     59.5428
09800     0.2290      0.9200     0.3996     56.8392
09900     0.1220      0.9700     0.3996     59.0798
10000     0.3555      0.9200     0.4056     57.7326
10100     0.1580      0.9600     0.4056     58.8755
10200     0.1319      0.9600     0.4056     55.7054
10300     0.2574      0.9000     0.4056     58.1116
10400     0.2021      0.9500     0.4056     59.6962
10500     0.2378      0.9100     0.4056     60.3201
10600     0.3036      0.9300     0.4056     60.2546
10700     0.2672      0.9400     0.4056     57.4205
10800     0.3723      0.8900     0.4056     57.5232
10900     0.1393      0.9700     0.4056     61.2509
11000     0.2214      0.9300     0.4056     62.2364
11100     0.1776      0.9400     0.4056     56.5320
11200     0.3028      0.9300     0.4056     57.3955
11300     0.1785      0.9600     0.4056     58.5384
11400     0.2338      0.9100     0.4056     56.2314
11500     0.1662      0.9500     0.4056     59.3742
11600     0.1865      0.9500     0.4056     59.3941
11700     0.0987      0.9800     0.4056     57.2892
11800     0.1345      0.9800     0.4056     60.7780
11900     0.0947      0.9900     0.4056     61.1483
12000     0.1157      0.9700     0.4056     60.3083
12100     0.2135      0.9100     0.4056     57.7496
12200     0.0776      0.9900     0.4056     56.8105
12300     0.2682      0.9200     0.4056     56.4506
12400     0.2657      0.9200     0.4056     56.1822
12500     0.1249      0.9700     0.4073     59.5195
12600     0.1095      0.9700     0.4073     57.4151
12700     0.1499      0.9500     0.4073     59.7256
12800     0.1549      0.9500     0.4073     57.4332
12900     0.1315      0.9700     0.4073     61.2962
13000     0.2019      0.9400     0.4073     57.3141
13100     0.2024      0.9500     0.4073     56.2480
13200     0.1554      0.9700     0.4073     56.1352
13300     0.2134      0.9700     0.4073     58.3268
13400     0.1321      0.9900     0.4073     59.4882
13500     0.2342      0.9000     0.4073     59.7955
13600     0.0845      0.9800     0.4073     56.2647
13700     0.1766      0.9400     0.4073     58.1913
13800     0.2640      0.9400     0.4073     60.5046
13900     0.1563      0.9500     0.4073     60.4081
14000     0.2480      0.9300     0.4073     59.3972
14100     0.2417      0.9400     0.4073     60.9132
14200     0.2016      0.9500     0.4073     60.9360
14300     0.1911      0.9300     0.4073     60.2574
14400     0.2550      0.9400     0.4073     57.1267
14500     0.1243      0.9800     0.4073     59.1863
14600     0.1395      0.9600     0.4073     56.9091
14700     0.2182      0.9400     0.4073     61.2762
14800     0.1791      0.9600     0.4073     59.9785
14900     0.2655      0.9300     0.4073     56.3579
15000     0.2037      0.9300     0.4073     56.2002
15100     0.0803      1.0000     0.4073     57.9970
15200     0.1890      0.9500     0.4073     60.6352
15300     0.0942      1.0000     0.4073     58.8423
15400     0.3181      0.9400     0.4073     56.9201
15500     0.0973      0.9800     0.4073     57.6111
15600     0.1514      0.9600     0.4073     56.7578
15700     0.2283      0.9400     0.4073     56.6860
15800     0.1513      0.9500     0.4073     59.0728
15900     0.2561      0.9400     0.4073     56.2830
16000     0.1092      0.9600     0.4073     60.5916
16100     0.2134      0.9400     0.4073     58.3567
16200     0.1408      0.9500     0.4073     62.4682
16300     0.1393      0.9700     0.4073     58.8123
16400     0.1209      0.9800     0.4073     55.7573
16500     0.1564      0.9400     0.4073     56.0543
16600     0.1408      0.9600     0.4073     56.7466
16700     0.1613      0.9500     0.4073     60.8819
16800     0.2387      0.9300     0.4073     60.0426
16900     0.1835      0.9500     0.4073     58.6633
17000     0.1300      0.9600     0.4073     57.9569
17100     0.1687      0.9500     0.4125     56.0850
17200     0.1006      0.9800     0.4125     57.8447
17300     0.1525      0.9600     0.4125     60.8904
17400     0.1316      0.9600     0.4125     58.4332
17500     0.1154      0.9800     0.4125     61.4874
17600     0.1956      0.9500     0.4125     59.1714
17700     0.2817      0.8900     0.4125     56.6157
17800     0.1562      0.9300     0.4125     57.2129
17900     0.1798      0.9600     0.4125     58.0554
18000     0.2775      0.9400     0.4125     57.6901
18100     0.1594      0.9600     0.4125     58.6127
18200     0.1260      0.9500     0.4125     57.1802
18300     0.1032      0.9700     0.4125     56.4304
18400     0.2203      0.9200     0.4157     58.7009
18500     0.0807      0.9800     0.4157     59.7788
18600     0.1796      0.9300     0.4157     57.0223
18700     0.2077      0.9500     0.4157     56.6112
18800     0.1106      0.9500     0.4157     63.0771
18900     0.2496      0.9300     0.4157     62.2566
19000     0.1511      0.9700     0.4251     59.2971
19100     0.1507      0.9600     0.4251     56.2099
19200     0.1880      0.9500     0.4251     60.1109
19300     0.1326      0.9700     0.4251     57.8091
19400     0.2230      0.9200     0.4251     59.8355
19500     0.1646      0.9500     0.4251     61.1247
19600     0.1718      0.9600     0.4251     57.5713
19700     0.0955      0.9800     0.4251     58.2946
19800     0.1227      0.9600     0.4251     59.2360
19900     0.2912      0.9000     0.4251     56.0642
20000     0.1293      0.9600     0.4251     61.3856
20100     0.1546      0.9600     0.4304     56.3195
20199     0.0983      0.9800     0.4304     56.0055
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     2.5295      0.5000     0.4218     18.4125
00100     1.3485      0.6100     0.6443     56.5692
00200     1.2897      0.6500     0.7187     56.2154
00300     0.9506      0.7300     0.7384     56.4989
00400     0.9617      0.7400     0.7605     57.4484
00500     0.8301      0.7800     0.7605     55.4568
00600     0.7727      0.7800     0.7889     59.7349
00700     0.6107      0.8400     0.7889     60.3637
00800     0.8145      0.7600     0.7908     56.6992
00900     1.0969      0.7100     0.7932     57.8788
01000     0.6163      0.8200     0.7932     56.4540
01100     0.9415      0.7700     0.8021     56.3782
01200     0.8423      0.7900     0.8021     57.3889
01300     0.8047      0.7400     0.8097     63.8627
01400     0.6226      0.8700     0.8097     56.7215
01500     0.7722      0.7900     0.8152     56.3481
01600     0.8987      0.7900     0.8152     60.5205
01700     0.6851      0.8200     0.8152     56.6312
01800     0.4433      0.8400     0.8152     57.8110
01900     0.5726      0.8300     0.8183     56.4155
02000     0.6351      0.8600     0.8183     55.4944
02100     0.6629      0.8300     0.8183     55.5305
02200     0.7053      0.8000     0.8183     56.3944
02300     0.8095      0.7700     0.8224     58.6751
02400     0.6163      0.8400     0.8224     59.9050
02500     0.4379      0.8600     0.8224     57.1226
02600     0.6870      0.7900     0.8250     56.3145
02700     0.9739      0.7700     0.8250     59.0101
02800     0.5152      0.8300     0.8250     57.9462
02900     0.6139      0.8200     0.8295     62.1119
03000     0.6560      0.8100     0.8295     57.4156
03100     0.6446      0.8300     0.8295     56.4094
03200     0.5901      0.8400     0.8301     57.6684
03300     0.5837      0.8500     0.8322     59.4228
03400     0.6028      0.8500     0.8322     57.6490
03500     0.4823      0.8700     0.8322     56.6265
03600     0.6945      0.8200     0.8322     59.0575
03700     0.7866      0.7800     0.8322     58.6142
03800     0.6915      0.8200     0.8419     58.8747
03900     0.7947      0.8300     0.8419     58.7382
04000     0.6312      0.8400     0.8419     59.4408
04100     0.4576      0.8900     0.8419     56.8882
04200     0.6928      0.7900     0.8419     63.3353
04300     0.6019      0.8600     0.8419     60.0109
04400     0.6497      0.8300     0.8419     55.9656
04500     0.7592      0.7800     0.8419     59.5099
04600     0.7432      0.8000     0.8419     56.5900
04700     0.5888      0.8200     0.8419     56.2593
04800     0.5589      0.8500     0.8419     57.9478
04900     0.8705      0.8000     0.8419     55.8778
05000     0.6731      0.8200     0.8419     56.0420
05100     0.5806      0.8300     0.8419     59.7842
05200     0.4593      0.8600     0.8419     59.5187
05300     0.4972      0.8400     0.8419     58.1448
05400     0.3350      0.8900     0.8419     60.2223
05500     0.6716      0.8200     0.8419     56.4059
05600     0.6816      0.8200     0.8443     59.4432
05700     0.4030      0.8900     0.8443     57.8444
05800     0.3820      0.8900     0.8443     60.3329
05900     0.4941      0.8600     0.8443     57.9161
06000     0.5083      0.8400     0.8472     57.2807
06100     0.5616      0.8500     0.8472     59.2477
06200     0.5944      0.8200     0.8472     62.0819
06300     0.4649      0.9000     0.8472     57.6136
06400     0.6437      0.7700     0.8472     58.6940
06500     0.6378      0.8400     0.8472     59.5679
06600     0.5456      0.8300     0.8472     56.8876
06700     0.6012      0.8700     0.8481     55.8685
06800     0.4368      0.9000     0.8481     57.6567
06900     0.3857      0.8900     0.8481     61.4327
07000     0.7024      0.7900     0.8481     57.1451
07100     0.4285      0.8800     0.8481     57.1399
07200     0.6182      0.8300     0.8481     56.6894
07300     0.5405      0.8900     0.8523     56.8473
07400     0.4872      0.8400     0.8523     60.5029
07500     0.4575      0.8700     0.8553     59.2189
07600     0.6745      0.8400     0.8553     56.6850
07700     0.6191      0.8300     0.8553     56.8863
07800     0.3871      0.9000     0.8553     60.3329
07900     0.4562      0.8700     0.8553     56.6364
08000     0.5142      0.8600     0.8553     55.6886
08100     0.4807      0.8400     0.8553     57.0727
08200     0.3967      0.8800     0.8553     56.1610
08300     0.2895      0.9300     0.8553     58.2686
08400     0.6188      0.8200     0.8553     58.3272
08500     0.5146      0.8500     0.8553     56.3407
08600     0.7039      0.8400     0.8556     58.7872
08700     0.3995      0.8800     0.8556     59.4485
08800     0.6515      0.7800     0.8556     60.5426
08900     0.4529      0.8600     0.8556     56.7670
09000     0.5246      0.8200     0.8556     55.8795
09100     0.3725      0.8900     0.8556     61.1768
09200     0.4050      0.8700     0.8556     57.4759
09300     0.3051      0.9100     0.8556     61.4315
09400     0.4663      0.8500     0.8556     57.0747
09500     0.6274      0.8300     0.8567     60.0354
09600     0.3569      0.9000     0.8567     58.9196
09700     0.4670      0.8600     0.8567     56.0732
09800     0.2398      0.9100     0.8567     58.0916
09900     0.4375      0.8600     0.8570     57.0342
Start testing:
Test Accuracy: 0.8922
