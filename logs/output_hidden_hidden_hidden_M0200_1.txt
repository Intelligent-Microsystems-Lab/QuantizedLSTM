Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=194, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=235899598, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
63ba69b9-34bb-495f-a27c-d53bd6befdbc
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 167, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 290, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 213, in forward
    gates = quant_pass(pact_a_bmm( quant_pass(pact_a_bmm(part1, self.a12), self.abMVM, self.a12) + quant_pass(pact_a_bmm(part2, self.a13), self.abMVM, self.a13), self.a14), self.abNM, self.a14)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 124, in pact_a_bmm
    return torch.sign(x) * .5 * (torch.abs(x) - torch.abs(torch.abs(x) - a) + a)
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 11.78 GiB total capacity; 10.40 GiB already allocated; 19.38 MiB free; 10.59 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=194, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=235899598, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
18b12b01-a5d3-4a72-8776-871de6c7fa5f
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     2.6765      0.1300     0.0873     17.2708
00100     1.6138      0.4700     0.4698     71.7423
00200     1.6385      0.4100     0.6137     69.2014
00300     1.1534      0.6300     0.6805     65.3322
00400     1.2738      0.6300     0.7132     70.9905
00500     0.9057      0.7000     0.7517     69.9179
00600     0.8506      0.7500     0.7669     66.8470
00700     0.8516      0.7300     0.7669     69.5035
00800     0.9444      0.7200     0.7669     73.1709
00900     1.0540      0.6700     0.7669     66.1382
01000     0.8176      0.7500     0.7669     66.2441
01100     0.8224      0.7200     0.7905     66.3013
01200     0.7766      0.7900     0.7905     71.4947
01300     0.8193      0.7300     0.7905     65.3692
01400     0.8933      0.7300     0.8058     69.3862
01500     0.6675      0.8100     0.8058     67.1148
01600     0.8452      0.7600     0.8058     70.9792
01700     0.7732      0.7700     0.8058     67.8476
01800     0.6327      0.8100     0.8058     69.0903
01900     0.7738      0.7800     0.8058     68.0322
02000     0.7225      0.8100     0.8058     68.0924
02100     0.9219      0.6900     0.8058     70.6435
02200     0.5655      0.8400     0.8058     71.8762
02300     0.8833      0.7100     0.8082     69.3109
02400     0.7879      0.7300     0.8130     71.3348
02500     0.7144      0.8000     0.8130     66.4829
02600     0.5787      0.8300     0.8130     69.7418
02700     0.8102      0.7900     0.8130     71.8304
02800     0.7343      0.8100     0.8232     68.8319
02900     0.6725      0.7700     0.8232     67.1977
03000     0.5979      0.8100     0.8232     70.7271
03100     0.6278      0.7900     0.8232     65.0612
03200     0.7203      0.8000     0.8232     70.0950
03300     0.7892      0.7400     0.8232     73.2289
03400     0.6496      0.8100     0.8232     72.5547
03500     0.9391      0.7200     0.8232     67.4382
03600     0.6495      0.8100     0.8232     74.4187
03700     0.6143      0.8300     0.8266     73.1342
03800     0.8173      0.7100     0.8266     71.6720
03900     0.7602      0.7900     0.8308     68.7533
04000     0.7587      0.7500     0.8308     67.9304
04100     0.6539      0.8000     0.8308     70.4296
04200     0.5514      0.8700     0.8308     67.4130
04300     0.8285      0.7000     0.8308     70.5340
04400     0.5971      0.8200     0.8370     70.5425
04500     0.7117      0.7700     0.8390     70.4229
04600     0.7542      0.7700     0.8390     71.0990
04700     0.6458      0.7700     0.8402     71.6347
04800     0.7073      0.7800     0.8402     70.4075
04900     0.5927      0.8300     0.8402     67.7735
05000     0.5534      0.8200     0.8402     72.0139
05100     0.5385      0.8100     0.8402     71.4047
05200     0.7490      0.8000     0.8402     70.0671
05300     0.8412      0.7900     0.8413     71.1129
05400     0.5584      0.8300     0.8413     69.8585
05500     0.6155      0.7700     0.8413     71.3718
05600     0.6392      0.7800     0.8413     68.7285
05700     0.7290      0.7400     0.8413     67.9952
05800     0.6346      0.8000     0.8413     70.6653
05900     0.7490      0.7500     0.8444     73.6246
06000     0.4820      0.8300     0.8465     71.1442
06100     0.8498      0.7500     0.8465     67.9988
06200     0.6082      0.8400     0.8465     72.4244
06300     0.7465      0.7500     0.8550     68.2070
06400     0.6511      0.8200     0.8550     70.6355
06500     0.5565      0.8700     0.8550     70.6914
06600     0.4332      0.9000     0.8550     71.5890
06700     0.7028      0.8000     0.8550     68.8002
06800     0.4998      0.8700     0.8550     66.6906
06900     0.7092      0.7700     0.8550     69.4858
07000     0.6342      0.7900     0.8550     71.8039
07100     0.5780      0.8200     0.8550     70.6820
07200     0.7381      0.7400     0.8550     70.0906
07300     0.8376      0.7500     0.8550     68.4211
07400     0.5395      0.8200     0.8550     70.2891
07500     0.5036      0.8600     0.8550     71.0256
07600     0.5857      0.7900     0.8550     73.7188
07700     0.5295      0.8600     0.8550     72.0852
07800     0.5680      0.8300     0.8576     71.4751
07900     0.7279      0.7700     0.8576     73.4256
08000     0.5317      0.8300     0.8576     67.5470
08100     0.7126      0.7800     0.8576     68.0406
08200     0.6972      0.7500     0.8576     68.7175
08300     0.6253      0.7800     0.8595     70.4819
08400     0.5437      0.8700     0.8595     69.2485
08500     0.7337      0.7900     0.8595     67.7054
08600     0.5519      0.8100     0.8595     65.6432
08700     0.6274      0.8300     0.8595     69.6355
08800     0.5385      0.8100     0.8595     72.5311
08900     0.5589      0.7800     0.8595     65.5731
09000     0.4020      0.8700     0.8595     66.6009
09100     0.6698      0.7800     0.8595     69.4106
09200     0.5913      0.8200     0.8595     69.6098
09300     0.6506      0.8200     0.8595     67.7848
09400     0.6494      0.7900     0.8595     66.7765
09500     0.3907      0.8900     0.8595     67.4703
09600     0.6873      0.8200     0.8595     69.9368
09700     0.7387      0.8100     0.8640     67.6668
09800     0.5026      0.8200     0.8640     65.8355
09900     0.5588      0.8300     0.8663     68.1249
10000     0.5872      0.7500     0.8663     72.5377
10100     0.5574      0.8800     0.8663     67.6780
10200     0.3463      0.8700     0.8663     71.8665
10300     0.5727      0.8200     0.8663     69.9060
10400     0.4649      0.8200     0.8663     70.6591
10500     0.4695      0.8400     0.8663     71.8862
10600     0.5858      0.8300     0.8667     70.3111
10700     0.5107      0.8300     0.8667     68.0410
10800     0.5086      0.8100     0.8667     69.7259
10900     0.6407      0.7900     0.8667     70.5114
11000     0.5140      0.8300     0.8667     67.3885
11100     0.4269      0.8900     0.8667     73.6974
11200     0.4996      0.8400     0.8667     71.4936
11300     0.6402      0.8100     0.8667     73.1730
11400     0.7543      0.7900     0.8667     67.4227
11500     0.4844      0.8700     0.8799     68.8923
11600     0.4689      0.8600     0.8799     70.9248
11700     0.5129      0.8600     0.8799     73.2910
11800     0.3807      0.9100     0.8799     70.2056
11900     0.3936      0.8700     0.8804     72.0942
12000     0.6494      0.7400     0.8804     69.7122
12100     0.5991      0.8100     0.8825     69.4646
12200     0.6034      0.7900     0.8826     69.4749
12300     0.4690      0.8400     0.8826     68.8638
12400     0.6200      0.8200     0.8826     66.7912
12500     0.5489      0.7900     0.8840     67.7572
12600     0.4659      0.8700     0.8840     70.7357
12700     0.3482      0.8900     0.8840     75.2766
12800     0.3405      0.8900     0.8840     69.3876
12900     0.3907      0.8900     0.8840     69.6893
13000     0.3590      0.8800     0.8840     68.6210
13100     0.4730      0.8800     0.8840     66.5150
13200     0.3288      0.9300     0.8840     70.4853
13300     0.3195      0.9100     0.8840     72.9509
13400     0.4715      0.8400     0.8840     69.5771
13500     0.4233      0.8700     0.8840     67.8734
13600     0.4742      0.8600     0.8840     72.1803
13700     0.3921      0.8700     0.8840     68.5787
13800     0.5686      0.8100     0.8840     71.9283
13900     0.4671      0.8400     0.8840     70.5452
14000     0.6625      0.7400     0.8895     70.9505
14100     0.5349      0.8100     0.8895     67.0047
14200     0.3472      0.9000     0.8895     70.2084
14300     0.4829      0.8400     0.8895     70.2624
14400     0.4443      0.8900     0.8895     73.5117
14500     0.5296      0.8600     0.8895     66.6116
14600     0.3726      0.8800     0.8895     73.0433
14700     0.4565      0.8800     0.8895     69.2040
14800     0.3801      0.9100     0.8895     72.4349
14900     0.4709      0.8900     0.8895     67.7620
15000     0.3232      0.9200     0.8895     71.2430
15100     0.4712      0.8500     0.8895     69.4216
15200     0.5430      0.8700     0.8895     70.6154
15300     0.3942      0.8700     0.8895     66.6022
15400     0.5040      0.8400     0.8895     72.6335
15500     0.5497      0.8400     0.8895     68.6846
15600     0.3271      0.9100     0.8895     72.1288
15700     0.4533      0.8500     0.8895     70.7102
15800     0.4369      0.8300     0.8895     70.2283
15900     0.3913      0.8900     0.8895     71.5350
16000     0.5651      0.8500     0.8895     67.9073
16100     0.5212      0.8300     0.8895     65.7289
16200     0.4366      0.8800     0.8895     70.0491
16300     0.3805      0.9000     0.8895     67.2251
16400     0.3723      0.9100     0.8895     71.0771
16500     0.3438      0.9000     0.8895     71.0589
16600     0.5179      0.8800     0.8895     71.5235
16700     0.4066      0.8700     0.8895     74.1639
16800     0.3663      0.8900     0.8895     69.8706
16900     0.3522      0.8900     0.8895     67.8997
17000     0.5134      0.8700     0.8895     72.5339
17100     0.5859      0.8500     0.8895     70.6482
17200     0.3714      0.8800     0.8895     71.6264
17300     0.4360      0.8700     0.8895     73.5198
17400     0.3512      0.9200     0.8895     74.5563
17500     0.4460      0.8700     0.8895     69.3676
17600     0.4213      0.8900     0.8895     66.5795
17700     0.6019      0.8100     0.8895     70.2790
17800     0.3161      0.9100     0.8895     72.0764
17900     0.6209      0.8600     0.8895     70.1239
18000     0.5616      0.8300     0.8895     74.3024
18100     0.3865      0.9100     0.8895     71.8196
18200     0.3344      0.9300     0.8895     70.5814
18300     0.5041      0.8300     0.8895     73.1779
18400     0.4332      0.8600     0.8895     72.0476
18500     0.5103      0.8500     0.8895     71.0992
18600     0.5155      0.8200     0.8895     66.8942
18700     0.4789      0.8600     0.8895     71.8640
18800     0.2898      0.9200     0.8895     73.0264
18900     0.5667      0.8500     0.8895     73.1895
19000     0.3968      0.8900     0.8895     67.3269
19100     0.3825      0.9100     0.8895     69.9361
19200     0.5206      0.8500     0.8895     73.3161
19300     0.3050      0.9400     0.8895     72.6744
19400     0.6930      0.7900     0.8895     72.9210
19500     0.5065      0.8600     0.8895     68.2916
19600     0.4620      0.8700     0.8895     72.5554
19700     0.5398      0.8400     0.8895     68.3963
19800     0.4632      0.8500     0.8895     68.9342
19900     0.5311      0.8300     0.8895     70.2215
20000     0.4196      0.8800     0.8895     69.3062
20100     0.4928      0.8900     0.8895     73.1775
20199     0.6943      0.8100     0.8895     67.5797
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     0.7728      0.7400     0.8669     18.6949
00100     0.4654      0.8400     0.8861     71.5799
00200     0.4824      0.8400     0.8889     69.4112
00300     0.4313      0.9100     0.8952     71.7151
00400     0.5649      0.8100     0.8952     72.7681
00500     0.2685      0.9000     0.8952     73.5714
00600     0.3263      0.9000     0.8955     68.0110
00700     0.5741      0.8400     0.8955     66.6969
00800     0.6262      0.8000     0.8955     69.0591
00900     0.3727      0.8900     0.8956     71.0687
01000     0.3525      0.9200     0.8956     69.5865
01100     0.3150      0.9100     0.8956     67.4907
01200     0.5828      0.8500     0.8964     71.0003
01300     0.4192      0.8600     0.8971     69.8723
01400     0.3699      0.8900     0.8971     71.2701
01500     0.4692      0.8600     0.8971     69.5931
01600     0.3554      0.9100     0.8971     69.2040
01700     0.4619      0.8900     0.8971     69.6106
01800     0.4282      0.9000     0.8974     71.5367
01900     0.4711      0.8700     0.8974     66.4466
02000     0.3124      0.8900     0.8974     72.2198
02100     0.4209      0.8600     0.8974     71.2399
02200     0.3139      0.9300     0.8974     66.6525
02300     0.3993      0.8700     0.8974     70.3285
02400     0.5178      0.8100     0.8974     69.4017
02500     0.3562      0.8800     0.8996     67.9927
02600     0.3195      0.9300     0.8996     69.8004
02700     0.2868      0.9400     0.8996     70.6207
02800     0.3543      0.9200     0.8996     67.2578
02900     0.4710      0.8700     0.8996     71.4725
03000     0.3158      0.8900     0.8996     72.6519
03100     0.6311      0.8200     0.8996     70.4991
03200     0.4090      0.8500     0.8996     72.7084
03300     0.3606      0.9100     0.8996     68.3579
03400     0.4203      0.8500     0.8996     71.3899
03500     0.3333      0.8900     0.8996     70.1286
03600     0.5441      0.8400     0.8996     70.1289
03700     0.5056      0.8500     0.8999     68.5009
03800     0.3734      0.9000     0.8999     72.2372
03900     0.3920      0.9000     0.8999     67.6450
04000     0.4510      0.8700     0.8999     71.9073
04100     0.3889      0.8700     0.8999     70.1966
04200     0.4554      0.8600     0.8999     65.7249
04300     0.4425      0.8500     0.8999     69.8104
04400     0.4273      0.8900     0.8999     69.8102
04500     0.3115      0.9000     0.8999     69.0683
04600     0.3643      0.9000     0.8999     71.6665
04700     0.4637      0.8400     0.8999     72.3362
04800     0.3773      0.8700     0.8999     73.8100
04900     0.4592      0.8300     0.8999     70.7087
05000     0.4675      0.8800     0.9003     71.3252
05100     0.3085      0.9200     0.9032     65.5941
05200     0.3400      0.9100     0.9032     69.5903
05300     0.3616      0.9000     0.9032     69.6328
05400     0.3372      0.8900     0.9032     68.4553
05500     0.4059      0.8400     0.9032     67.1688
05600     0.4101      0.8500     0.9032     66.2711
05700     0.4156      0.8500     0.9032     67.9994
05800     0.3692      0.9300     0.9032     65.3428
05900     0.3915      0.8700     0.9032     69.4240
06000     0.4366      0.8400     0.9032     71.8384
06100     0.4706      0.8800     0.9032     69.2316
06200     0.3309      0.9000     0.9032     72.5204
06300     0.6040      0.8300     0.9032     70.5742
06400     0.5088      0.8300     0.9032     70.7882
06500     0.3853      0.8600     0.9032     70.1204
06600     0.3239      0.8900     0.9032     65.9118
06700     0.4407      0.8400     0.9032     65.9966
06800     0.5800      0.8300     0.9032     68.9626
06900     0.5587      0.8500     0.9032     69.8772
07000     0.4822      0.8500     0.9032     69.4478
07100     0.3781      0.8800     0.9032     68.5710
07200     0.3684      0.8900     0.9032     73.2824
07300     0.4884      0.8500     0.9032     71.2088
07400     0.5895      0.8400     0.9032     72.1990
07500     0.5153      0.8300     0.9032     72.7157
07600     0.3859      0.8400     0.9032     72.1386
07700     0.4649      0.8500     0.9032     66.2538
07800     0.5372      0.8100     0.9032     72.9281
07900     0.3533      0.8900     0.9032     71.2866
08000     0.2890      0.9300     0.9032     72.5137
08100     0.4905      0.8700     0.9032     72.2562
08200     0.5090      0.8500     0.9032     70.3084
08300     0.4431      0.8700     0.9032     68.2413
08400     0.3987      0.8900     0.9032     69.8508
08500     0.3621      0.8700     0.9032     71.5760
08600     0.3893      0.9000     0.9032     69.1809
08700     0.4011      0.8700     0.9032     71.6033
08800     0.5835      0.8500     0.9032     70.2272
08900     0.5233      0.8300     0.9032     67.4488
09000     0.5696      0.8000     0.9032     70.0124
09100     0.5709      0.8500     0.9032     68.6039
09200     0.4556      0.8600     0.9032     65.5729
09300     0.3261      0.9000     0.9032     70.2036
09400     0.4476      0.8300     0.9032     72.0164
09500     0.3867      0.8900     0.9032     69.1238
09600     0.2799      0.9100     0.9032     70.6922
09700     0.5904      0.8100     0.9032     70.0743
09800     0.3291      0.9200     0.9032     65.9802
09900     0.5223      0.8500     0.9032     66.4218
Start testing:
Test Accuracy: 0.8863
