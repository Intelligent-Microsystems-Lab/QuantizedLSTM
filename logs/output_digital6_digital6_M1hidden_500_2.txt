Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=494, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=8627169, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
bf345639-1995-4a5d-95e8-f73b9c45ca1c
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 147, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 374, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 211, in forward
    part2 = CustomMM_bmm.apply(quant_pass(pact_a_bmm(hx, self.a11), self.ib, self.a11), self.weight_hh * w_mask, self.bias_hh, self.noise_level, self.wb, self.bias_r)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 146, in forward
    wq = quant_pass(weight, wb, torch.tensor([1.]).to(input.device))
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 94, in forward
    x_scaled = x/x_range
RuntimeError: CUDA out of memory. Tried to allocate 16.00 MiB (GPU 0; 10.76 GiB total capacity; 8.81 GiB already allocated; 3.12 MiB free; 9.80 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=494, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=8627169, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
8499d207-6631-4584-992b-aa3529e6911a
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     3.4617      0.0700     0.0827     17.8389
00100     1.7167      0.4500     0.0834     63.2836
00200     1.0681      0.6300     0.0947     63.6567
00300     1.2392      0.5700     0.0947     64.4881
00400     0.9041      0.7000     0.0947     63.8213
00500     0.9155      0.7000     0.1024     64.2289
00600     0.8510      0.7200     0.1024     63.8177
00700     0.5059      0.8300     0.1024     64.5047
00800     0.7181      0.7300     0.1036     63.8133
00900     0.6308      0.8100     0.1036     63.6007
01000     0.6117      0.7700     0.1036     63.6647
01100     0.4529      0.8200     0.1036     63.6766
01200     0.3982      0.8600     0.1036     63.2366
01300     0.6641      0.8100     0.1036     64.1293
01400     0.5318      0.8100     0.1036     64.5232
01500     0.5059      0.8900     0.1036     63.8042
01600     0.4569      0.8800     0.1036     63.5329
01700     0.5504      0.8400     0.1036     64.3101
01800     0.5317      0.8100     0.1067     64.5093
01900     0.3873      0.8900     0.1095     64.8729
02000     0.4350      0.8700     0.1151     64.5987
02100     0.4200      0.8400     0.1165     64.7970
02200     0.5067      0.7900     0.1167     64.0939
02300     0.4980      0.8600     0.1167     63.3804
02400     0.3000      0.8800     0.1167     63.3598
02500     0.4847      0.8900     0.1172     64.0376
02600     0.3941      0.8700     0.1193     64.6887
02700     0.2969      0.8800     0.1240     64.2931
02800     0.3195      0.9000     0.1240     63.8540
02900     0.5177      0.8400     0.1248     64.2671
03000     0.3698      0.8800     0.1262     64.3277
03100     0.3721      0.8600     0.1270     64.2375
03200     0.3209      0.8900     0.1316     65.0082
03300     0.3107      0.8900     0.1316     63.9135
03400     0.4990      0.8400     0.1316     64.4441
03500     0.4655      0.8500     0.1340     64.6372
03600     0.2682      0.9400     0.1340     63.7904
03700     0.3416      0.9100     0.1369     64.2002
03800     0.3782      0.9000     0.1369     63.2399
03900     0.3410      0.9000     0.1390     64.2162
04000     0.2678      0.9200     0.1529     63.6163
04100     0.3381      0.9000     0.1529     64.1758
04200     0.2752      0.9300     0.1529     62.9906
04300     0.3899      0.9100     0.1597     64.0065
04400     0.3211      0.8900     0.1615     63.5510
04500     0.1254      0.9500     0.1714     64.0209
04600     0.4036      0.9000     0.1714     63.4358
04700     0.3683      0.8800     0.1714     63.4694
04800     0.3836      0.8900     0.1714     63.0568
04900     0.4452      0.8600     0.1826     63.8850
05000     0.3776      0.8800     0.1826     62.6659
05100     0.3763      0.8700     0.1897     63.5151
05200     0.2955      0.9000     0.1897     63.0687
05300     0.2375      0.9300     0.1897     63.1456
05400     0.1990      0.9400     0.1897     63.0319
05500     0.2484      0.8700     0.1897     63.0618
05600     0.1240      0.9700     0.1897     62.9415
05700     0.5711      0.8300     0.1917     63.8123
05800     0.2140      0.9500     0.1949     63.8529
05900     0.3126      0.8600     0.1991     63.7042
06000     0.3763      0.9000     0.2203     63.8182
06100     0.2743      0.8600     0.2203     63.1994
06200     0.2260      0.9300     0.2203     63.3067
06300     0.2857      0.9100     0.2203     63.3188
06400     0.3975      0.8700     0.2203     63.2393
06500     0.2321      0.9100     0.2203     63.0181
06600     0.3112      0.9000     0.2203     63.0379
06700     0.2072      0.9300     0.2300     63.9779
06800     0.1818      0.9300     0.2300     63.8494
06900     0.3107      0.9000     0.2300     63.0714
07000     0.3170      0.9100     0.2335     64.2343
07100     0.2536      0.9100     0.2335     63.2984
07200     0.4557      0.8600     0.2450     63.7231
07300     0.5352      0.8500     0.2450     63.7722
07400     0.1853      0.9500     0.2450     63.9044
07500     0.1941      0.9500     0.2518     64.8107
07600     0.3215      0.8900     0.2624     64.0043
07700     0.1929      0.9500     0.2706     64.8324
07800     0.3269      0.9000     0.2746     64.1747
07900     0.3296      0.8900     0.2746     63.3730
08000     0.2685      0.9300     0.2781     63.5140
08100     0.2817      0.9300     0.2781     63.0828
08200     0.1397      0.9600     0.2803     64.1087
08300     0.2926      0.9000     0.2803     63.4320
08400     0.4778      0.8600     0.2803     63.2540
08500     0.3554      0.9100     0.2803     63.5226
08600     0.2726      0.9000     0.2934     64.2017
08700     0.2967      0.9100     0.2991     63.5783
08800     0.3470      0.8900     0.2991     63.3398
08900     0.2092      0.9200     0.3043     64.0542
09000     0.2210      0.9100     0.3043     63.1769
09100     0.3443      0.9200     0.3167     63.9617
09200     0.3791      0.8800     0.3167     63.0920
09300     0.5152      0.8900     0.3270     63.6785
09400     0.3956      0.8700     0.3270     63.4095
09500     0.1836      0.9300     0.3270     63.1299
09600     0.1978      0.9500     0.3270     62.9253
09700     0.1511      0.9200     0.3270     63.9162
09800     0.2466      0.9000     0.3270     63.8685
09900     0.3287      0.9100     0.3270     63.7733
10000     0.2052      0.9300     0.3270     63.4946
10100     0.3668      0.9200     0.3270     62.9937
10200     0.1462      0.9200     0.3292     63.7076
10300     0.1289      0.9600     0.3292     63.5494
10400     0.3385      0.9200     0.3364     64.3343
10500     0.1045      0.9600     0.3364     63.2516
10600     0.1415      0.9600     0.3364     62.8970
10700     0.2696      0.9700     0.3364     63.2451
10800     0.1826      0.9400     0.3364     62.8607
10900     0.1321      0.9700     0.3364     63.6306
11000     0.1310      0.9600     0.3364     63.3709
11100     0.1884      0.9400     0.3364     63.0068
11200     0.1352      0.9500     0.3405     64.0629
11300     0.2665      0.9100     0.3405     63.3173
11400     0.2059      0.9100     0.3405     63.6781
11500     0.0773      0.9800     0.3405     63.4895
11600     0.1569      0.9500     0.3405     63.7206
11700     0.1935      0.9400     0.3447     63.6959
11800     0.2629      0.9200     0.3447     63.1869
11900     0.1690      0.9600     0.3447     63.4006
12000     0.3425      0.9100     0.3447     63.3259
12100     0.1164      0.9600     0.3447     62.8882
12200     0.0461      0.9900     0.3447     63.2521
12300     0.1223      0.9600     0.3447     63.6136
12400     0.0904      0.9800     0.3447     62.7759
12500     0.1272      0.9800     0.3447     62.9981
12600     0.2287      0.9200     0.3506     64.3163
12700     0.1948      0.9400     0.3506     63.6314
12800     0.0996      0.9600     0.3506     63.1612
12900     0.1209      0.9700     0.3506     63.7300
13000     0.2513      0.9200     0.3506     63.2660
13100     0.1703      0.9700     0.3506     63.6447
13200     0.0876      0.9700     0.3506     62.7417
13300     0.2360      0.9300     0.3506     63.3878
13400     0.1693      0.9600     0.3506     63.2137
13500     0.1170      0.9600     0.3506     63.3898
13600     0.1455      0.9400     0.3515     64.2271
13700     0.2872      0.9400     0.3571     64.3131
13800     0.0902      0.9800     0.3571     63.4161
13900     0.1200      0.9600     0.3571     63.3370
14000     0.1432      0.9500     0.3571     63.2793
14100     0.2032      0.9500     0.3571     63.0607
14200     0.0770      0.9800     0.3571     63.6652
14300     0.1445      0.9600     0.3571     63.1039
14400     0.0633      0.9600     0.3571     62.9427
14500     0.2195      0.8900     0.3571     63.0531
14600     0.1300      0.9300     0.3571     63.0461
14700     0.1313      0.9800     0.3571     62.8987
14800     0.1695      0.9600     0.3571     63.2932
14900     0.1387      0.9700     0.3571     63.1750
15000     0.1678      0.9600     0.3571     63.2876
15100     0.1283      0.9500     0.3571     64.1820
15200     0.0946      0.9700     0.3571     64.1219
15300     0.1717      0.9600     0.3571     63.2050
15400     0.1413      0.9700     0.3571     63.1472
15500     0.1091      0.9600     0.3571     63.2498
15600     0.2929      0.9000     0.3571     63.2871
15700     0.2300      0.9400     0.3571     63.0438
15800     0.1535      0.9600     0.3571     62.8358
15900     0.1502      0.9600     0.3571     63.3606
16000     0.0848      0.9900     0.3571     63.1996
16100     0.0955      0.9600     0.3571     63.3143
16200     0.0440      0.9800     0.3571     63.0367
16300     0.2616      0.9500     0.3571     63.7111
16400     0.0877      0.9400     0.3571     63.0319
16500     0.1117      0.9900     0.3571     63.1262
16600     0.1273      0.9400     0.3571     62.7895
16700     0.1591      0.9500     0.3571     63.3629
16800     0.2222      0.9300     0.3571     63.3487
16900     0.1699      0.9400     0.3571     63.2820
17000     0.0845      1.0000     0.3571     62.8098
17100     0.0648      0.9800     0.3571     62.9265
17200     0.2520      0.9200     0.3571     62.7852
17300     0.2576      0.9200     0.3571     63.0590
17400     0.2059      0.9300     0.3571     63.5185
17500     0.1280      0.9800     0.3571     63.1015
17600     0.1958      0.9300     0.3571     63.7491
17700     0.0945      0.9700     0.3571     63.8195
17800     0.1484      0.9700     0.3571     63.9725
17900     0.1467      0.9300     0.3571     64.3886
18000     0.0587      0.9900     0.3571     64.4070
18100     0.2935      0.9300     0.3571     63.4866
18200     0.1437      0.9500     0.3571     63.3320
18300     0.2325      0.9200     0.3571     63.4837
18400     0.1088      0.9600     0.3571     63.9300
18500     0.0710      0.9900     0.3571     63.7866
18600     0.1512      0.9500     0.3571     64.0308
18700     0.1216      0.9400     0.3571     64.1147
18800     0.1219      0.9600     0.3571     63.2195
18900     0.1526      0.9400     0.3571     64.1279
19000     0.1114      0.9600     0.3571     64.2599
19100     0.0670      0.9600     0.3571     63.8752
19200     0.1285      0.9600     0.3571     64.2604
19300     0.0830      0.9600     0.3571     64.2049
19400     0.0610      0.9800     0.3571     63.6036
19500     0.1863      0.9500     0.3571     63.7593
19600     0.1809      0.9600     0.3571     63.6916
19700     0.0469      0.9700     0.3571     63.3667
19800     0.1350      0.9700     0.3571     63.4447
19900     0.1772      0.9300     0.3571     64.1209
20000     0.3717      0.9100     0.3571     63.8055
20100     0.1144      0.9700     0.3571     63.2994
20199     0.1872      0.9600     0.3571     63.3855
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     4.0762      0.3300     0.3125     17.2506
00100     1.6550      0.5700     0.5286     64.9654
00200     1.6270      0.6400     0.6087     64.4267
00300     1.5523      0.6400     0.6605     64.2162
00400     0.9399      0.7400     0.6722     64.6495
00500     1.1872      0.7000     0.7052     64.3588
00600     1.1648      0.6900     0.7141     64.1755
00700     1.0300      0.7600     0.7445     63.5812
00800     0.7474      0.7900     0.7445     63.6481
00900     1.1163      0.7200     0.7480     63.9769
01000     1.1858      0.6900     0.7635     65.0363
01100     0.9329      0.7700     0.7674     64.7744
01200     0.6364      0.8400     0.7674     64.6871
01300     0.7865      0.8100     0.7674     64.9129
01400     0.8893      0.8500     0.7733     64.5642
01500     0.8317      0.8000     0.7821     63.9552
01600     0.9799      0.7800     0.7837     64.6910
01700     0.9564      0.7900     0.7914     64.7634
01800     0.7740      0.7600     0.7914     63.7572
01900     1.1700      0.7600     0.7914     63.6008
02000     1.0674      0.7100     0.7914     63.0858
02100     0.8588      0.7700     0.7914     63.6195
02200     0.6379      0.8500     0.7914     63.9404
02300     1.1494      0.7200     0.7914     64.6691
02400     0.6283      0.8000     0.8029     64.6806
02500     0.5022      0.8400     0.8085     64.5820
02600     0.4756      0.8500     0.8089     64.4738
02700     0.6667      0.8100     0.8089     64.0034
02800     0.9469      0.7900     0.8089     64.1632
02900     1.0946      0.7300     0.8089     63.9447
03000     0.9245      0.7800     0.8148     63.8643
03100     0.5582      0.7900     0.8148     63.7092
03200     0.5915      0.8700     0.8148     63.6670
03300     0.6690      0.7900     0.8187     64.0040
03400     1.2314      0.7200     0.8202     64.5008
03500     0.6660      0.8200     0.8202     63.8680
03600     0.7975      0.8200     0.8228     64.6784
03700     0.8717      0.8100     0.8228     64.0787
03800     0.8042      0.8500     0.8228     65.2409
03900     0.6471      0.8400     0.8228     64.3001
04000     1.0396      0.7600     0.8228     63.8317
04100     0.5855      0.8600     0.8228     64.3081
04200     0.9178      0.8000     0.8228     63.4890
04300     0.7396      0.8500     0.8228     63.4299
04400     0.7083      0.8300     0.8228     63.1813
04500     0.5207      0.8400     0.8228     63.0629
04600     0.5109      0.8500     0.8228     63.5569
04700     0.5537      0.8100     0.8228     64.3471
04800     0.5819      0.8400     0.8228     65.8213
04900     0.4585      0.8900     0.8280     64.2356
05000     0.7253      0.8600     0.8280     63.0720
05100     0.5423      0.8700     0.8280     63.7713
05200     1.0344      0.7700     0.8280     63.6505
05300     0.8019      0.8300     0.8305     64.6481
05400     0.5398      0.8800     0.8305     63.2068
05500     1.0168      0.7800     0.8305     64.5586
05600     0.8308      0.8300     0.8305     64.1388
05700     0.6430      0.8100     0.8305     64.9426
05800     0.3536      0.8800     0.8305     63.6915
05900     0.4458      0.8800     0.8305     63.9519
06000     0.7039      0.8300     0.8307     65.7521
06100     0.7696      0.8300     0.8356     64.6963
06200     0.7617      0.8300     0.8356     63.3540
06300     0.9162      0.8000     0.8356     63.9530
06400     0.6535      0.8100     0.8356     63.2417
06500     0.5279      0.8400     0.8356     64.1464
06600     1.0318      0.7700     0.8356     63.4362
06700     0.6262      0.8800     0.8356     63.5003
06800     0.7421      0.8000     0.8356     62.8739
06900     0.4759      0.8700     0.8367     63.6112
07000     0.8462      0.8000     0.8367     63.1256
07100     0.5986      0.8400     0.8367     63.5730
07200     0.6279      0.8400     0.8392     64.9971
07300     0.9758      0.8200     0.8402     64.2022
07400     0.5729      0.8600     0.8402     63.7138
07500     0.8293      0.8300     0.8402     63.6071
07600     0.7329      0.8200     0.8402     63.7039
07700     0.9067      0.7600     0.8402     63.6235
07800     0.7613      0.8500     0.8403     63.7514
07900     0.5409      0.8800     0.8403     63.1876
08000     1.0178      0.8100     0.8403     65.2472
08100     0.6230      0.8300     0.8403     63.1355
08200     0.6446      0.8600     0.8403     63.1466
08300     0.3954      0.8900     0.8403     64.0329
08400     1.0015      0.7800     0.8403     63.9718
08500     0.5031      0.8700     0.8430     64.4863
08600     0.4467      0.8900     0.8448     64.7920
08700     0.4477      0.8000     0.8452     64.5742
08800     0.5584      0.8300     0.8452     63.9305
08900     0.9349      0.7800     0.8452     64.7000
09000     0.2028      0.9200     0.8452     63.9303
09100     0.5786      0.8600     0.8452     64.5976
09200     0.5857      0.8500     0.8452     64.3195
09300     0.8987      0.7800     0.8452     65.1561
09400     0.6346      0.7900     0.8452     66.1116
09500     0.3366      0.9300     0.8452     65.5662
09600     0.5130      0.8800     0.8500     65.8545
09700     0.6090      0.8200     0.8500     65.1348
09800     0.7077      0.8400     0.8500     64.9941
09900     0.4892      0.8500     0.8500     66.3603
Start testing:
Test Accuracy: 0.8924
