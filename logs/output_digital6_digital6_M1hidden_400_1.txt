Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=394, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=235899598, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
c3c4e06e-7f93-4b51-a6f1-d9cf34aeb090
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 147, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 374, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 213, in forward
    gates = quant_pass(pact_a_bmm( quant_pass(pact_a_bmm(part1, self.a12), self.abMVM, self.a12) + quant_pass(pact_a_bmm(part2, self.a13), self.abMVM, self.a13), self.a14), self.abNM, self.a14)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 89, in forward
    x01q =  torch.round(x01 * step_d ) / step_d
RuntimeError: CUDA out of memory. Tried to allocate 12.00 MiB (GPU 0; 11.78 GiB total capacity; 10.49 GiB already allocated; 3.38 MiB free; 10.62 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=394, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=235899598, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
0784f7c5-69cf-4c5f-b0b7-c693f48229c2
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     3.8162      0.0800     0.0780     17.2559
00100     1.6919      0.3100     0.0852     64.6921
00200     1.1987      0.6100     0.0961     64.1800
00300     1.3558      0.5800     0.0961     64.0989
00400     0.8697      0.7000     0.0961     64.7323
00500     0.8839      0.6800     0.0976     63.2707
00600     0.7682      0.7700     0.1009     63.6785
00700     0.5486      0.8100     0.1009     64.5323
00800     0.7338      0.7300     0.1009     63.5584
00900     0.8333      0.7400     0.1009     64.5324
01000     0.6401      0.8200     0.1009     63.2555
01100     0.7292      0.7300     0.1016     63.4230
01200     0.7145      0.7600     0.1019     63.9633
01300     0.3340      0.9000     0.1019     63.6256
01400     0.6442      0.7700     0.1025     63.9245
01500     0.4518      0.8300     0.1047     64.0696
01600     0.3781      0.8600     0.1047     63.0112
01700     0.6089      0.7900     0.1092     64.7416
01800     0.4210      0.8800     0.1092     64.2552
01900     0.5750      0.8300     0.1092     63.5955
02000     0.4706      0.8400     0.1147     63.8339
02100     0.4658      0.8400     0.1147     63.7286
02200     0.4898      0.8300     0.1147     63.6958
02300     0.3461      0.8800     0.1147     62.8960
02400     0.5514      0.8300     0.1188     64.1283
02500     0.4503      0.8700     0.1225     65.6572
02600     0.5271      0.9000     0.1225     64.2726
02700     0.5418      0.8400     0.1225     64.1902
02800     0.3537      0.8700     0.1269     65.2428
02900     0.5006      0.8100     0.1269     64.6735
03000     0.3899      0.8600     0.1269     65.3119
03100     0.3924      0.8800     0.1269     64.7563
03200     0.4010      0.8700     0.1269     63.7045
03300     0.5990      0.8300     0.1269     65.3484
03400     0.5517      0.8300     0.1361     64.4683
03500     0.5447      0.7800     0.1361     63.5216
03600     0.3168      0.9000     0.1361     63.9899
03700     0.3335      0.8400     0.1464     64.2438
03800     0.4344      0.8500     0.1464     63.5008
03900     0.3335      0.9200     0.1464     63.9600
04000     0.3553      0.9100     0.1464     64.1980
04100     0.3240      0.9100     0.1482     64.7558
04200     0.5344      0.8800     0.1482     64.8771
04300     0.3063      0.9000     0.1601     65.9736
04400     0.2437      0.8700     0.1601     63.7108
04500     0.3193      0.8500     0.1601     65.6957
04600     0.3920      0.8500     0.1601     64.3726
04700     0.2733      0.9300     0.1601     63.6403
04800     0.3477      0.8900     0.1621     65.5252
04900     0.3995      0.8500     0.1621     63.6496
05000     0.5189      0.8500     0.1621     65.2631
05100     0.4637      0.8600     0.1660     63.8258
05200     0.3499      0.8800     0.1660     65.3875
05300     0.4295      0.8600     0.1754     65.0385
05400     0.3345      0.8900     0.1754     64.3738
05500     0.2672      0.8700     0.1754     64.2588
05600     0.3388      0.8600     0.1754     66.1822
05700     0.3050      0.8900     0.1754     64.6206
05800     0.3624      0.9100     0.1878     63.9293
05900     0.3816      0.8800     0.1878     63.7016
06000     0.2946      0.8900     0.1878     63.2014
06100     0.2696      0.8900     0.2002     64.9538
06200     0.4053      0.9100     0.2002     65.0618
06300     0.3424      0.8500     0.2002     65.8390
06400     0.2215      0.9300     0.2002     65.1295
06500     0.2783      0.9000     0.2028     65.0664
06600     0.3952      0.8500     0.2063     64.3606
06700     0.2837      0.8900     0.2063     64.1682
06800     0.4082      0.8300     0.2063     63.4739
06900     0.4328      0.8400     0.2063     64.2497
07000     0.1391      0.9200     0.2063     64.2616
07100     0.2821      0.8900     0.2220     65.4585
07200     0.2768      0.9400     0.2220     63.6487
07300     0.4754      0.8200     0.2220     64.9674
07400     0.2517      0.9200     0.2220     65.0926
07500     0.3947      0.8900     0.2242     65.7122
07600     0.2141      0.9200     0.2469     63.3990
07700     0.4075      0.8800     0.2469     63.5703
07800     0.4910      0.8600     0.2836     64.2121
07900     0.3691      0.9100     0.2836     64.3270
08000     0.4441      0.8600     0.2854     64.4703
08100     0.1928      0.8900     0.2854     64.1574
08200     0.2276      0.9200     0.2889     65.0620
08300     0.2676      0.9300     0.2889     63.9476
08400     0.3053      0.8900     0.2889     64.5894
08500     0.3240      0.9300     0.2889     63.5011
08600     0.3123      0.9100     0.2890     63.8383
08700     0.1535      0.9700     0.2890     63.2624
08800     0.3923      0.8500     0.3044     65.1077
08900     0.2285      0.9300     0.3044     64.2371
09000     0.2432      0.9200     0.3044     64.8567
09100     0.2848      0.9200     0.3044     63.8898
09200     0.3561      0.9100     0.3044     64.6137
09300     0.2229      0.9300     0.3044     63.1929
09400     0.1677      0.9600     0.3044     64.5277
09500     0.2594      0.9000     0.3044     63.6025
09600     0.1712      0.9300     0.3044     63.9964
09700     0.1657      0.9300     0.3044     66.2272
09800     0.1733      0.9500     0.3044     63.7493
09900     0.3895      0.8800     0.3046     65.0014
10000     0.2544      0.9000     0.3062     66.2180
10100     0.2604      0.8800     0.3062     63.3514
10200     0.3315      0.9100     0.3062     65.2848
10300     0.3124      0.8700     0.3062     65.1900
10400     0.1454      0.9600     0.3147     65.3395
10500     0.2909      0.9100     0.3147     66.1522
10600     0.2448      0.9200     0.3176     64.3131
10700     0.2325      0.9400     0.3266     65.0421
10800     0.3112      0.9000     0.3266     64.5069
10900     0.2289      0.9000     0.3299     63.6228
11000     0.2579      0.9100     0.3339     64.2447
11100     0.2160      0.9400     0.3339     64.7000
11200     0.2621      0.9600     0.3339     64.3258
11300     0.1696      0.9300     0.3339     63.6179
11400     0.1469      0.9500     0.3339     64.1414
11500     0.1617      0.9400     0.3339     64.1346
11600     0.2280      0.9300     0.3339     63.5445
11700     0.3511      0.8800     0.3339     63.2673
11800     0.1925      0.9500     0.3339     62.8881
11900     0.0606      1.0000     0.3339     64.1125
12000     0.1264      0.9600     0.3339     65.5668
12100     0.1204      0.9800     0.3339     64.6052
12200     0.1976      0.9300     0.3339     63.7570
12300     0.1263      0.9600     0.3339     65.2279
12400     0.1617      0.9700     0.3339     64.1320
12500     0.1239      0.9700     0.3339     64.6822
12600     0.2577      0.9200     0.3339     65.1289
12700     0.2599      0.9500     0.3339     64.7651
12800     0.0843      0.9800     0.3339     65.3475
12900     0.2398      0.9300     0.3408     66.1747
13000     0.1197      0.9500     0.3408     64.4063
13100     0.2825      0.9300     0.3408     63.6878
13200     0.1782      0.9500     0.3408     65.4624
13300     0.2171      0.9400     0.3408     65.2174
13400     0.1437      0.9300     0.3408     65.6721
13500     0.2594      0.9100     0.3408     65.9730
13600     0.1825      0.9300     0.3528     65.1116
13700     0.1953      0.9400     0.3528     63.1599
13800     0.2029      0.9400     0.3528     63.4345
13900     0.2037      0.9300     0.3528     64.8718
14000     0.1422      0.9700     0.3528     65.8302
14100     0.1072      0.9400     0.3528     64.3098
14200     0.1709      0.9400     0.3528     65.5099
14300     0.1388      0.9200     0.3528     63.0340
14400     0.1362      0.9400     0.3528     63.7452
14500     0.1499      0.9600     0.3528     63.8502
14600     0.2319      0.9400     0.3528     64.0872
14700     0.0961      0.9800     0.3528     64.2368
14800     0.1415      0.9400     0.3528     65.6916
14900     0.1639      0.9500     0.3528     63.5709
15000     0.1091      0.9900     0.3528     65.6356
15100     0.1458      0.9500     0.3528     67.4075
15200     0.2130      0.9200     0.3528     65.4517
15300     0.2159      0.9300     0.3528     64.2216
15400     0.1227      0.9700     0.3528     63.6376
15500     0.2168      0.9400     0.3528     63.6984
15600     0.1535      0.9500     0.3528     64.1686
15700     0.4583      0.8700     0.3528     65.3669
15800     0.1141      0.9600     0.3528     63.7990
15900     0.3121      0.9000     0.3528     65.9304
16000     0.2539      0.9300     0.3528     64.3332
16100     0.1238      0.9500     0.3602     64.7070
16200     0.2131      0.9400     0.3602     64.8680
16300     0.2390      0.9200     0.3602     64.1633
16400     0.1019      0.9700     0.3602     65.8051
16500     0.1350      0.9600     0.3602     65.1348
16600     0.1776      0.9200     0.3602     64.9522
16700     0.0724      0.9900     0.3602     65.1752
16800     0.2422      0.9400     0.3602     64.8440
16900     0.0695      0.9800     0.3602     63.9060
17000     0.1105      0.9500     0.3602     64.9347
17100     0.2182      0.9400     0.3602     63.3123
17200     0.1685      0.9600     0.3602     63.8012
17300     0.2554      0.9100     0.3602     63.2061
17400     0.1150      0.9600     0.3602     65.2999
17500     0.1682      0.9500     0.3602     65.9235
17600     0.1815      0.9400     0.3602     63.2720
17700     0.2566      0.9300     0.3602     63.3357
17800     0.1427      0.9400     0.3602     64.4943
17900     0.1809      0.9000     0.3602     64.6989
18000     0.2295      0.9500     0.3602     64.0894
18100     0.2012      0.9400     0.3602     65.7929
18200     0.2554      0.9000     0.3602     64.6535
18300     0.1011      0.9700     0.3602     65.2364
18400     0.1123      0.9700     0.3602     65.6462
18500     0.1408      0.9700     0.3602     65.3122
18600     0.2099      0.9200     0.3602     65.5133
18700     0.2661      0.9400     0.3602     63.5480
18800     0.1586      0.9600     0.3602     62.9971
18900     0.1180      0.9400     0.3602     64.0911
19000     0.1494      0.9500     0.3602     64.3697
19100     0.0800      0.9700     0.3602     65.3226
19200     0.0974      0.9800     0.3602     63.5255
19300     0.1271      0.9600     0.3602     64.7498
19400     0.1631      0.9500     0.3602     63.5268
19500     0.1466      0.9300     0.3602     63.8270
19600     0.1439      0.9400     0.3664     64.0624
19700     0.1337      0.9500     0.3664     64.0265
19800     0.1674      0.9400     0.3743     63.6936
19900     0.2364      0.9100     0.3743     65.0665
20000     0.0600      1.0000     0.3743     63.5870
20100     0.1355      0.9700     0.3743     64.3694
20199     0.2603      0.9300     0.3861     63.4779
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     3.6700      0.4400     0.3643     17.6753
00100     2.3310      0.5600     0.5538     65.1641
00200     1.6763      0.6300     0.6184     64.5961
00300     1.4475      0.6700     0.6718     64.5659
00400     1.9375      0.6000     0.6898     64.8824
00500     2.0119      0.6000     0.7038     65.3913
00600     1.0364      0.6500     0.7114     64.1758
00700     1.3270      0.7400     0.7196     64.8172
00800     0.7138      0.7900     0.7318     63.6128
00900     0.7826      0.8000     0.7395     64.1007
01000     1.4653      0.7200     0.7480     64.5996
01100     0.7554      0.8000     0.7480     63.7741
01200     1.9340      0.6800     0.7604     65.6324
01300     0.6661      0.7800     0.7604     65.3229
01400     1.1294      0.7500     0.7701     65.0910
01500     0.8904      0.7600     0.7720     65.9018
01600     1.0684      0.7700     0.7720     65.1937
01700     1.4014      0.6800     0.7720     66.8139
01800     0.7286      0.8300     0.7818     65.1848
01900     1.0000      0.7400     0.7818     65.2018
02000     0.3955      0.8900     0.7818     63.9861
02100     0.8231      0.8300     0.7818     66.3071
02200     0.9027      0.7900     0.7865     65.5567
02300     0.7886      0.7700     0.7865     65.3887
02400     0.7429      0.8200     0.7865     64.7133
02500     1.3840      0.7100     0.7865     64.4907
02600     0.4292      0.8500     0.7897     66.0249
02700     0.5770      0.8600     0.7963     65.2376
02800     0.6918      0.8200     0.7963     64.5282
02900     1.3321      0.7400     0.7963     66.0321
03000     0.9799      0.7700     0.8039     65.9477
03100     0.5751      0.8700     0.8039     65.0161
03200     0.9022      0.7600     0.8039     66.0573
03300     0.6962      0.8100     0.8039     64.1469
03400     0.5463      0.8300     0.8039     63.8775
03500     0.6252      0.8400     0.8039     64.5625
03600     0.8107      0.8000     0.8118     65.5266
03700     0.7214      0.7700     0.8118     66.9293
03800     0.8788      0.8300     0.8118     66.9001
03900     0.8629      0.7900     0.8128     64.9541
04000     1.1382      0.7600     0.8128     65.5499
04100     0.8865      0.7700     0.8128     66.1922
04200     0.8225      0.8300     0.8128     66.2281
04300     0.7935      0.8200     0.8128     64.6287
04400     0.5678      0.8600     0.8128     65.4530
04500     0.7947      0.8300     0.8128     65.4630
04600     0.5886      0.8100     0.8128     65.8315
04700     1.1682      0.7500     0.8128     64.3283
04800     0.8370      0.8200     0.8215     65.4714
04900     0.6200      0.8100     0.8215     63.6176
05000     0.8438      0.7900     0.8215     64.4981
05100     0.7142      0.8300     0.8215     65.0234
05200     1.0237      0.7700     0.8215     64.8701
05300     0.5281      0.8500     0.8215     64.5587
05400     0.4920      0.8800     0.8221     64.9098
05500     0.8641      0.7900     0.8221     64.8804
05600     0.5759      0.8600     0.8221     65.1317
05700     0.2821      0.8800     0.8255     64.3811
05800     0.7007      0.8800     0.8255     64.5387
05900     0.8285      0.7800     0.8255     64.7984
06000     0.4289      0.8300     0.8255     64.7429
06100     0.6212      0.7700     0.8255     65.6104
06200     0.6386      0.8200     0.8255     64.5243
06300     0.5445      0.9000     0.8255     63.9263
06400     0.8301      0.8100     0.8255     63.4284
06500     0.6713      0.7800     0.8255     64.4511
06600     0.7271      0.7900     0.8307     67.3611
06700     0.8399      0.8400     0.8307     63.7658
06800     1.1503      0.7900     0.8307     63.5753
06900     0.4960      0.8500     0.8307     63.9060
07000     0.7198      0.7900     0.8307     63.1865
07100     0.7628      0.8400     0.8307     64.6165
07200     0.6798      0.8000     0.8307     63.8989
07300     0.4309      0.8600     0.8329     67.1554
07400     0.6806      0.8100     0.8329     68.0208
07500     0.6837      0.8300     0.8329     69.3849
07600     0.3269      0.9000     0.8329     68.1931
07700     0.7657      0.7600     0.8329     68.6872
07800     0.4784      0.9000     0.8329     67.9555
07900     0.7626      0.8400     0.8329     68.4148
08000     0.8277      0.7700     0.8329     68.7232
08100     0.7595      0.8400     0.8329     70.1833
08200     0.4273      0.8400     0.8329     67.4082
08300     0.6460      0.8500     0.8339     69.5505
08400     0.5315      0.8300     0.8339     67.8255
08500     0.3792      0.8900     0.8339     70.1619
08600     0.5461      0.8700     0.8339     67.3796
08700     1.0245      0.7900     0.8339     70.3492
08800     0.7759      0.8500     0.8339     69.9329
08900     0.6504      0.8600     0.8388     69.5232
09000     0.4836      0.8500     0.8388     67.7747
09100     1.1100      0.7400     0.8388     69.8211
09200     0.8397      0.8000     0.8388     64.9160
09300     0.6706      0.7900     0.8388     67.7231
09400     0.5886      0.8400     0.8388     66.5582
09500     0.6535      0.8300     0.8388     65.5235
09600     0.7992      0.7900     0.8388     65.7737
09700     0.6442      0.8300     0.8410     68.9960
09800     0.5181      0.8600     0.8444     67.6331
09900     0.7544      0.8000     0.8444     68.1803
Start testing:
Test Accuracy: 0.8936
