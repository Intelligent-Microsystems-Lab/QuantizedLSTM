Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=14, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.0, noise_injectionT=0.0, pact_a=True, quant_actMVM=11, quant_actNM=11, quant_inp=11, quant_w=11, random_seed=235899598, rows_bias=100, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
b512c2b6-a4aa-44f5-b1e1-6e25abca82db
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 147, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 373, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 209, in forward
    part1 = CustomMM_bmm.apply(quant_pass(pact_a_bmm(input.repeat(self.n_blocks, 1, 1), self.a1), self.ib, self.a1), self.weight_ih, self.bias_ih, self.noise_level, self.wb, self.bias_r)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 145, in forward
    wq = quant_pass(weight, wb, 1.)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 82, in forward
    if len(x_range) > 1:
TypeError: object of type 'float' has no len()
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=14, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.0, noise_injectionT=0.0, pact_a=True, quant_actMVM=11, quant_actNM=11, quant_inp=11, quant_w=11, random_seed=235899598, rows_bias=100, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
a6ec43ac-071b-42a9-84ed-f5af2e1fb4e1
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 147, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 373, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 209, in forward
    part1 = CustomMM_bmm.apply(quant_pass(pact_a_bmm(input.repeat(self.n_blocks, 1, 1), self.a1), self.ib, self.a1), self.weight_ih, self.bias_ih, self.noise_level, self.wb, self.bias_r)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 145, in forward
    wq = quant_pass(weight, wb, torch.tensor([1.]).device(input.device))
TypeError: 'torch.device' object is not callable
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=14, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.0, noise_injectionT=0.0, pact_a=True, quant_actMVM=11, quant_actNM=11, quant_inp=11, quant_w=11, random_seed=235899598, rows_bias=100, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
142a867d-4e67-4bde-b614-0936d8966749
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     3.4635      0.1034     0.1351     10.2545
00100     2.1737      0.2363     0.3134     55.5845
00200     1.5802      0.5211     0.4992     54.7115
00300     1.3147      0.5802     0.5947     55.5628
00400     1.2076      0.6097     0.6391     56.0820
00500     1.0563      0.6814     0.6700     55.8888
00600     1.0398      0.6751     0.7035     56.8349
00700     0.8846      0.7278     0.7185     56.6203
00800     0.8948      0.7194     0.7232     55.5499
00900     0.9744      0.6688     0.7465     55.2009
01000     0.8458      0.7321     0.7533     56.6936
01100     0.8051      0.7489     0.7648     56.1174
01200     0.8288      0.7321     0.7695     55.6109
01300     0.8709      0.7173     0.7756     57.2105
01400     0.7708      0.7363     0.7817     56.7132
01500     0.6819      0.7764     0.7888     56.7127
01600     0.6827      0.7996     0.7888     57.2946
01700     0.7900      0.7363     0.7942     56.7396
01800     0.6559      0.7806     0.7942     57.0756
01900     0.6655      0.7848     0.8117     56.4358
02000     0.6984      0.7785     0.8117     55.6815
02100     0.7467      0.7679     0.8117     55.7746
02200     0.7445      0.7658     0.8117     56.2538
02300     0.6953      0.7785     0.8136     55.1584
02400     0.6237      0.8038     0.8136     56.0361
02500     0.6094      0.8017     0.8136     55.9069
02600     0.5729      0.8186     0.8136     56.2332
02700     0.6589      0.8080     0.8159     56.0789
02800     0.5332      0.8354     0.8159     55.9430
02900     0.6740      0.7954     0.8232     55.3779
03000     0.6108      0.8270     0.8232     55.8568
03100     0.6658      0.7869     0.8232     55.3376
03200     0.6274      0.7975     0.8232     56.2350
03300     0.6946      0.7890     0.8295     57.1579
03400     0.6564      0.7890     0.8295     56.0539
03500     0.5885      0.7954     0.8356     57.7327
03600     0.5656      0.8228     0.8356     55.4974
03700     0.6499      0.7785     0.8356     57.3768
03800     0.6153      0.8122     0.8392     57.6317
03900     0.5304      0.8439     0.8392     57.0064
04000     0.5620      0.8249     0.8392     55.9219
04100     0.5811      0.7975     0.8392     55.0276
04200     0.6121      0.8080     0.8392     55.7534
04300     0.5572      0.8270     0.8392     56.5134
04400     0.5419      0.8333     0.8419     55.7882
04500     0.5577      0.8186     0.8419     54.7189
04600     0.5374      0.8460     0.8433     57.3000
04700     0.5663      0.8270     0.8433     57.3112
04800     0.6324      0.8080     0.8433     57.6033
04900     0.6113      0.8059     0.8448     58.1069
05000     0.5779      0.8228     0.8448     56.5013
05100     0.5296      0.8418     0.8448     57.0908
05200     0.5827      0.8186     0.8448     58.5340
05300     0.5141      0.8080     0.8448     57.4130
05400     0.5328      0.8333     0.8448     56.1458
05500     0.4747      0.8439     0.8448     55.7612
05600     0.5758      0.8207     0.8448     59.0615
05700     0.5581      0.8354     0.8448     55.1765
05800     0.5395      0.8376     0.8448     55.4821
05900     0.4655      0.8439     0.8468     57.0118
06000     0.5163      0.8418     0.8468     55.7854
06100     0.5376      0.8122     0.8468     56.0558
06200     0.6441      0.7911     0.8486     55.6664
06300     0.5516      0.8228     0.8486     55.2503
06400     0.6122      0.8059     0.8486     57.2490
06500     0.5220      0.8312     0.8486     55.2182
06600     0.5255      0.8418     0.8486     56.6403
06700     0.5695      0.8186     0.8486     57.1485
06800     0.5131      0.8333     0.8486     56.0894
06900     0.5611      0.8418     0.8486     57.2710
07000     0.5004      0.8418     0.8486     56.2999
07100     0.4811      0.8418     0.8486     55.1365
07200     0.5750      0.8186     0.8486     56.5957
07300     0.5623      0.8249     0.8486     57.0028
07400     0.4799      0.8608     0.8486     56.4053
07500     0.5388      0.8312     0.8486     56.5669
07600     0.5400      0.8333     0.8486     55.8012
07700     0.4926      0.8249     0.8489     57.2228
07800     0.4541      0.8418     0.8528     56.7678
07900     0.4863      0.8565     0.8528     56.3786
08000     0.5383      0.8312     0.8528     57.2542
08100     0.5067      0.8333     0.8528     55.9103
08200     0.4790      0.8481     0.8528     58.8513
08300     0.5448      0.8460     0.8528     57.3399
08400     0.5222      0.8312     0.8528     57.0583
08500     0.5899      0.8017     0.8528     57.6002
08600     0.5090      0.8418     0.8576     56.6164
08700     0.4825      0.8270     0.8576     56.3329
08800     0.5214      0.8565     0.8576     57.1884
08900     0.4965      0.8418     0.8576     56.5914
09000     0.4748      0.8418     0.8576     56.5296
09100     0.4818      0.8439     0.8576     55.9237
09200     0.4934      0.8418     0.8576     56.5253
09300     0.5271      0.8502     0.8576     56.7035
09400     0.5444      0.8249     0.8591     55.4496
09500     0.6169      0.7996     0.8591     56.6257
09600     0.4950      0.8207     0.8591     57.3417
09700     0.4851      0.8481     0.8619     58.4298
09800     0.4507      0.8586     0.8619     55.8711
09900     0.4895      0.8165     0.8619     57.1364
10000     0.5413      0.8249     0.8619     57.5993
10100     0.5208      0.8333     0.8619     56.1422
10200     0.4434      0.8713     0.8619     55.0411
10300     0.5257      0.8249     0.8636     55.3050
10400     0.5074      0.8439     0.8636     56.4562
10500     0.4503      0.8692     0.8636     56.0669
10600     0.5292      0.8291     0.8636     55.3938
10700     0.4753      0.8586     0.8636     58.3115
10800     0.4981      0.8333     0.8636     55.8977
10900     0.4961      0.8376     0.8636     58.0651
11000     0.4822      0.8418     0.8636     56.0940
11100     0.4611      0.8502     0.8644     56.4277
11200     0.5480      0.8249     0.8644     56.7348
11300     0.4657      0.8692     0.8644     56.7797
11400     0.3699      0.8903     0.8644     56.1337
11500     0.4952      0.8418     0.8644     55.9146
11600     0.4537      0.8650     0.8644     56.9598
11700     0.4473      0.8586     0.8644     57.5051
11800     0.3988      0.8861     0.8644     56.8676
11900     0.5079      0.8312     0.8644     55.4684
12000     0.4809      0.8544     0.8644     58.0689
12100     0.5091      0.8207     0.8644     56.3655
12200     0.5148      0.8418     0.8644     56.2474
12300     0.5044      0.8397     0.8644     60.2089
12400     0.5102      0.8376     0.8644     58.4670
12500     0.5111      0.8207     0.8644     55.7852
12600     0.4970      0.8333     0.8644     56.4114
12700     0.5006      0.8228     0.8644     56.4688
12800     0.4489      0.8544     0.8644     56.4511
12900     0.3936      0.8797     0.8644     56.9473
13000     0.4957      0.8228     0.8644     57.4352
13100     0.4678      0.8544     0.8644     56.1286
13200     0.4487      0.8544     0.8644     56.4019
13300     0.4728      0.8460     0.8644     57.4122
13400     0.4296      0.8650     0.8669     55.7742
13500     0.4872      0.8418     0.8669     55.5147
13600     0.4599      0.8502     0.8669     56.2837
13700     0.4343      0.8692     0.8669     55.9463
13800     0.5183      0.8291     0.8669     56.5496
13900     0.5060      0.8418     0.8669     56.8437
14000     0.5015      0.8439     0.8669     55.8029
14100     0.4405      0.8565     0.8669     58.6894
14200     0.4191      0.8797     0.8669     57.1576
14300     0.5114      0.8122     0.8669     57.2382
14400     0.4771      0.8586     0.8669     57.7303
14500     0.3850      0.8713     0.8669     56.8523
14600     0.4870      0.8333     0.8669     57.0083
14700     0.4815      0.8439     0.8669     56.9381
14800     0.4284      0.8650     0.8669     56.9120
14900     0.5127      0.8397     0.8669     57.2423
15000     0.4133      0.8650     0.8669     56.9406
15100     0.5482      0.8249     0.8669     56.9050
15200     0.4806      0.8376     0.8669     56.9721
15300     0.5259      0.8460     0.8669     57.8053
15400     0.5183      0.8523     0.8669     56.7981
15500     0.5088      0.8080     0.8669     56.9492
15600     0.4396      0.8629     0.8669     57.3655
15700     0.4945      0.8312     0.8669     57.3257
15800     0.4436      0.8650     0.8669     56.0742
15900     0.5220      0.8186     0.8669     56.2601
16000     0.4178      0.8586     0.8669     57.0283
16100     0.3810      0.8713     0.8669     55.6821
16200     0.4212      0.8692     0.8669     56.7552
16300     0.5066      0.8502     0.8669     56.3813
16400     0.4848      0.8523     0.8669     56.2106
16500     0.4767      0.8418     0.8669     56.7666
16600     0.4238      0.8418     0.8669     57.4863
16700     0.3922      0.8819     0.8669     56.1604
16800     0.4554      0.8671     0.8669     57.2994
16900     0.4203      0.8671     0.8669     57.3824
17000     0.4215      0.8797     0.8669     56.3110
17100     0.4102      0.8565     0.8669     56.2123
17200     0.4648      0.8608     0.8669     58.6034
17300     0.5392      0.8333     0.8669     58.5432
17400     0.4558      0.8671     0.8669     57.4472
17500     0.4709      0.8502     0.8669     57.2381
17600     0.4284      0.8650     0.8669     59.0760
17700     0.4434      0.8692     0.8669     57.6315
17800     0.4199      0.8608     0.8669     57.2917
17900     0.4512      0.8629     0.8669     57.6492
18000     0.4390      0.8586     0.8669     55.9360
18100     0.4137      0.8903     0.8669     57.5307
18200     0.4309      0.8734     0.8669     56.6737
18300     0.4768      0.8565     0.8669     57.6656
18400     0.3959      0.8692     0.8669     57.8653
18500     0.4830      0.8354     0.8669     56.8041
18600     0.4964      0.8376     0.8669     56.3297
18700     0.4379      0.8734     0.8669     56.4039
18800     0.4775      0.8544     0.8669     57.9585
18900     0.4663      0.8397     0.8669     56.0476
19000     0.4251      0.8629     0.8669     56.1755
19100     0.4336      0.8819     0.8669     56.6785
19200     0.4781      0.8439     0.8669     58.1837
19300     0.4497      0.8586     0.8669     56.2871
19400     0.4900      0.8439     0.8669     56.0927
19500     0.4538      0.8650     0.8669     56.6646
19600     0.5019      0.8291     0.8697     56.0854
19700     0.4505      0.8650     0.8697     56.1112
19800     0.4646      0.8418     0.8697     58.2689
19900     0.4841      0.8544     0.8697     56.8681
20000     0.4547      0.8544     0.8697     57.1543
20100     0.3988      0.8776     0.8697     57.3001
20199     0.4299      0.8608     0.8697     56.2288
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     0.3264      0.9030     0.8659     9.4631
00100     0.4571      0.8629     0.8668     57.4130
00200     0.4897      0.8565     0.8685     56.5884
00300     0.3774      0.9072     0.8687     56.9482
00400     0.3620      0.8713     0.8687     57.0710
00500     0.3854      0.8734     0.8722     56.9145
00600     0.3672      0.8861     0.8722     55.9058
00700     0.3425      0.8882     0.8722     56.1047
00800     0.3506      0.8987     0.8722     56.5949
00900     0.3051      0.9030     0.8729     55.6285
01000     0.3153      0.8987     0.8729     56.1391
01100     0.3263      0.8924     0.8729     56.8379
01200     0.3464      0.8987     0.8729     56.1722
01300     0.4096      0.8776     0.8730     55.4439
01400     0.3277      0.9030     0.8730     56.6353
01500     0.3667      0.8692     0.8730     56.9828
01600     0.3529      0.8861     0.8730     58.8234
01700     0.3962      0.8671     0.8730     55.6881
01800     0.3864      0.8924     0.8730     56.3376
01900     0.4377      0.8671     0.8730     56.7255
02000     0.3467      0.8755     0.8730     57.1174
02100     0.3559      0.8840     0.8730     56.6095
02200     0.3832      0.8840     0.8730     56.3742
02300     0.3980      0.8966     0.8730     55.5438
02400     0.4396      0.8692     0.8730     56.3740
02500     0.3612      0.8840     0.8730     57.9456
02600     0.4042      0.8671     0.8730     57.3478
02700     0.4460      0.8586     0.8730     57.3030
02800     0.3786      0.8840     0.8730     56.0343
02900     0.3254      0.9051     0.8730     56.8449
03000     0.3637      0.8966     0.8730     56.9699
03100     0.4473      0.8544     0.8735     56.9711
03200     0.3890      0.8861     0.8735     57.3533
03300     0.3544      0.8776     0.8752     55.8789
03400     0.3445      0.8966     0.8752     55.8047
03500     0.3947      0.8713     0.8752     57.2882
03600     0.3672      0.8840     0.8752     56.0814
03700     0.4032      0.8734     0.8752     56.5010
03800     0.3444      0.8882     0.8752     56.3391
03900     0.4053      0.8713     0.8752     56.2975
04000     0.3802      0.8776     0.8752     57.8578
04100     0.3485      0.8840     0.8755     56.4310
04200     0.3731      0.8819     0.8755     55.6528
04300     0.3585      0.8987     0.8755     55.5451
04400     0.3262      0.9114     0.8755     57.2447
04500     0.3662      0.9008     0.8755     57.6163
04600     0.4081      0.8692     0.8755     56.7830
04700     0.4202      0.8797     0.8755     58.2099
04800     0.3417      0.8903     0.8755     57.0872
04900     0.3857      0.8924     0.8755     57.0659
05000     0.3922      0.8840     0.8755     57.6467
05100     0.3989      0.8861     0.8755     56.4175
05200     0.3448      0.8966     0.8755     56.3543
05300     0.3519      0.9114     0.8755     55.2692
05400     0.4173      0.8671     0.8755     56.0268
05500     0.4319      0.8692     0.8755     55.9677
05600     0.3369      0.8819     0.8755     55.9439
05700     0.3698      0.8840     0.8755     56.2704
05800     0.3614      0.8861     0.8755     55.8367
05900     0.3753      0.8903     0.8755     57.2828
06000     0.3494      0.8945     0.8755     57.0298
06100     0.3371      0.8903     0.8755     56.1910
06200     0.3830      0.8819     0.8755     56.9372
06300     0.3360      0.8987     0.8755     56.5985
06400     0.3570      0.8903     0.8755     56.0818
06500     0.2974      0.9156     0.8755     57.8421
06600     0.3493      0.8819     0.8755     58.2623
06700     0.3809      0.8966     0.8755     56.6665
06800     0.4097      0.8460     0.8755     56.5754
06900     0.3425      0.8924     0.8755     56.3649
07000     0.3544      0.8903     0.8755     58.2875
07100     0.4787      0.8692     0.8755     59.6606
07200     0.4393      0.8608     0.8755     56.9012
07300     0.4252      0.8840     0.8755     57.5409
07400     0.4120      0.8692     0.8755     57.6641
07500     0.4060      0.8755     0.8755     57.7814
07600     0.3181      0.9072     0.8755     57.8300
07700     0.3919      0.8924     0.8755     57.1378
07800     0.3284      0.9008     0.8755     57.7512
07900     0.3893      0.8692     0.8755     56.1927
08000     0.3847      0.8819     0.8755     55.7956
08100     0.4387      0.8502     0.8755     56.1818
08200     0.3291      0.9051     0.8755     55.3613
08300     0.4243      0.8629     0.8755     56.0634
08400     0.3595      0.9030     0.8755     55.8022
08500     0.4091      0.8755     0.8755     55.7993
08600     0.4279      0.8692     0.8755     55.8371
08700     0.3372      0.8966     0.8755     55.9840
08800     0.3353      0.9008     0.8755     56.2868
08900     0.3769      0.8819     0.8755     56.0947
09000     0.3802      0.8692     0.8755     58.0074
09100     0.3732      0.8713     0.8762     56.1058
09200     0.3931      0.8903     0.8762     56.5173
09300     0.4030      0.8586     0.8762     56.3991
09400     0.4073      0.8819     0.8762     56.7278
09500     0.4048      0.8819     0.8762     55.9252
09600     0.3603      0.8882     0.8762     56.3508
09700     0.3292      0.9030     0.8762     55.8859
09800     0.4267      0.8629     0.8762     55.9796
09900     0.3765      0.8797     0.8762     57.4174
Start testing:
Test Accuracy: 0.8570
