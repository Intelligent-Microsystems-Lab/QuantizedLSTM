Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=394, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=193012823, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
597c488b-df84-4661-b98f-a367b6110416
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 167, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 374, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 213, in forward
    gates = quant_pass(pact_a_bmm( quant_pass(pact_a_bmm(part1, self.a12), self.abMVM, self.a12) + quant_pass(pact_a_bmm(part2, self.a13), self.abMVM, self.a13), self.a14), self.abNM, self.a14)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 124, in pact_a_bmm
    return torch.sign(x) * .5 * (torch.abs(x) - torch.abs(torch.abs(x) - a) + a)
RuntimeError: CUDA out of memory. Tried to allocate 12.00 MiB (GPU 0; 22.17 GiB total capacity; 20.95 GiB already allocated; 10.50 MiB free; 21.19 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=394, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=193012823, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
6d1eeb47-e4fa-40e2-a2e9-02c36fddc56e
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     3.3527      0.0900     0.0896     23.9371
00100     1.6506      0.4000     0.1001     78.0421
00200     1.4609      0.5700     0.1001     77.6218
00300     0.9810      0.6700     0.1001     78.0435
00400     0.9032      0.7000     0.1001     77.1921
00500     0.7367      0.8200     0.1001     78.7433
00600     0.7599      0.7100     0.1001     77.3821
00700     0.6655      0.7600     0.1001     77.4562
00800     0.8204      0.7500     0.1001     77.5026
00900     0.5955      0.8600     0.1001     78.2848
01000     0.8368      0.7400     0.1001     77.7595
01100     0.5660      0.8100     0.1138     78.6741
01200     0.4789      0.8700     0.1138     77.1762
01300     0.6815      0.7800     0.1138     77.9777
01400     0.4748      0.8800     0.1138     77.5829
01500     0.5258      0.8300     0.1138     77.7224
01600     0.4195      0.8600     0.1138     77.6971
01700     0.7554      0.7700     0.1138     77.7084
01800     0.6228      0.8100     0.1162     77.7251
01900     0.3918      0.8900     0.1162     77.8413
02000     0.4218      0.8400     0.1162     77.2587
02100     0.4992      0.8300     0.1162     77.7835
02200     0.3153      0.9200     0.1162     78.1852
02300     0.3917      0.8600     0.1195     78.8876
02400     0.5611      0.8200     0.1195     77.9247
02500     0.4667      0.8300     0.1199     78.3374
02600     0.4436      0.8700     0.1215     77.3769
02700     0.2422      0.9200     0.1215     77.4428
02800     0.7154      0.8300     0.1215     77.7356
02900     0.3243      0.8600     0.1275     77.2718
03000     0.4509      0.8400     0.1279     78.9370
03100     0.4159      0.8600     0.1319     78.3217
03200     0.6195      0.8100     0.1319     77.8734
03300     0.3535      0.8600     0.1319     79.2108
03400     0.6169      0.7800     0.1319     77.8148
03500     0.2397      0.9200     0.1319     77.8159
03600     0.3132      0.8600     0.1319     78.8580
03700     0.5221      0.8200     0.1345     77.9186
03800     0.4102      0.8600     0.1345     77.5013
03900     0.4247      0.8700     0.1345     78.0201
04000     0.2849      0.9300     0.1461     78.0201
04100     0.2737      0.8900     0.1461     77.6789
04200     0.3044      0.9000     0.1484     77.3089
04300     0.3636      0.8900     0.1484     77.8590
04400     0.2978      0.9100     0.1552     78.2556
04500     0.4315      0.8800     0.1552     77.5986
04600     0.4634      0.8800     0.1552     77.7647
04700     0.2650      0.8900     0.1552     77.8026
04800     0.4138      0.8500     0.1581     78.0641
04900     0.4798      0.8500     0.1581     79.6394
05000     0.3807      0.8800     0.1581     77.5369
05100     0.2762      0.9300     0.1640     79.3614
05200     0.3428      0.8800     0.1656     78.1061
05300     0.3086      0.9100     0.1676     78.2902
05400     0.2796      0.8900     0.1676     77.6942
05500     0.4501      0.8700     0.1701     77.4512
05600     0.3482      0.9000     0.1750     78.0775
05700     0.1540      0.9500     0.1765     77.5617
05800     0.3949      0.9300     0.1765     77.7370
05900     0.3760      0.9100     0.1799     79.0267
06000     0.4036      0.8500     0.1799     78.9884
06100     0.3340      0.9100     0.1867     78.0388
06200     0.3144      0.8900     0.1867     78.4344
06300     0.3464      0.9200     0.1867     78.3716
06400     0.3806      0.8700     0.1867     78.9464
06500     0.2031      0.9300     0.1877     77.5129
06600     0.2936      0.9000     0.1877     77.4195
06700     0.1826      0.9400     0.1953     78.7348
06800     0.1400      0.9400     0.1953     77.3428
06900     0.3170      0.9000     0.1953     78.1999
07000     0.2612      0.8700     0.2121     78.1662
07100     0.4967      0.8500     0.2121     77.8141
07200     0.2998      0.9100     0.2121     76.8786
07300     0.3260      0.8900     0.2128     78.2185
07400     0.1721      0.9400     0.2128     77.6775
07500     0.1349      0.9600     0.2147     78.4485
07600     0.1552      0.9600     0.2246     78.4343
07700     0.3348      0.9000     0.2246     78.1638
07800     0.2514      0.8700     0.2246     78.6498
07900     0.2820      0.8900     0.2290     78.7520
08000     0.1936      0.9300     0.2290     79.3824
08100     0.2660      0.9000     0.2431     78.0007
08200     0.3323      0.8500     0.2584     77.3811
08300     0.2389      0.9400     0.2584     78.2256
08400     0.2651      0.9000     0.2584     77.7856
08500     0.1883      0.9000     0.2584     78.0158
08600     0.2584      0.9000     0.2584     78.5875
08700     0.3258      0.8800     0.2588     78.1858
08800     0.3847      0.8300     0.2629     77.8657
08900     0.1872      0.9400     0.2629     79.1570
09000     0.2778      0.9000     0.2629     79.7068
09100     0.1721      0.9200     0.2649     78.1861
09200     0.2178      0.9100     0.2649     78.2784
09300     0.1183      0.9400     0.2649     78.0021
09400     0.2684      0.9200     0.2649     77.3470
09500     0.3246      0.8900     0.2649     77.3942
09600     0.1908      0.9400     0.2649     78.1901
09700     0.1337      0.9500     0.2802     79.2478
09800     0.5016      0.8300     0.2802     78.8360
09900     0.1501      0.9500     0.2984     78.5471
10000     0.3508      0.8700     0.2984     77.9011
10100     0.2079      0.9300     0.2991     78.5094
10200     0.2497      0.9100     0.2991     78.1902
10300     0.2549      0.9200     0.3156     78.6296
10400     0.1368      0.9700     0.3156     77.2928
10500     0.1843      0.9200     0.3156     77.7016
10600     0.3280      0.9100     0.3156     78.0185
10700     0.1674      0.9300     0.3156     78.7744
10800     0.1889      0.9500     0.3156     77.4510
10900     0.2126      0.9400     0.3156     77.9606
11000     0.2045      0.9200     0.3156     77.5939
11100     0.2840      0.9400     0.3156     77.4991
11200     0.1087      0.9700     0.3156     78.1419
11300     0.0756      0.9900     0.3156     79.0704
11400     0.1699      0.9300     0.3156     78.0499
11500     0.2028      0.9500     0.3156     78.1122
11600     0.1034      0.9600     0.3156     77.3245
11700     0.2387      0.9200     0.3156     77.4446
11800     0.1945      0.9200     0.3156     78.4120
11900     0.2208      0.9300     0.3156     77.4872
12000     0.2228      0.9300     0.3156     77.9345
12100     0.2522      0.9300     0.3156     77.5215
12200     0.1446      0.9700     0.3156     78.2050
12300     0.2213      0.9500     0.3156     78.0047
12400     0.1547      0.9500     0.3156     78.6478
12500     0.2779      0.9000     0.3156     78.4585
12600     0.2066      0.9300     0.3156     80.2948
12700     0.1448      0.9600     0.3156     79.3222
12800     0.1630      0.9500     0.3156     77.7716
12900     0.2402      0.9400     0.3156     78.3037
13000     0.1759      0.9600     0.3156     77.5393
13100     0.1886      0.9500     0.3156     78.0223
13200     0.1800      0.9100     0.3156     76.9430
13300     0.1229      0.9600     0.3156     77.3670
13400     0.1601      0.9400     0.3156     77.2281
13500     0.1291      0.9500     0.3156     77.8344
13600     0.2407      0.9300     0.3156     78.9471
13700     0.1090      0.9800     0.3156     79.2014
13800     0.2098      0.9200     0.3156     77.6761
13900     0.2546      0.9400     0.3156     78.0389
14000     0.0983      0.9600     0.3156     77.5139
14100     0.1815      0.9400     0.3156     77.8713
14200     0.1686      0.9600     0.3156     77.7650
14300     0.1416      0.9400     0.3156     77.4461
14400     0.1406      0.9200     0.3156     78.0816
14500     0.1523      0.9500     0.3156     78.0870
14600     0.2285      0.9200     0.3156     79.2489
14700     0.1504      0.9600     0.3156     79.6517
14800     0.2410      0.9400     0.3156     78.3768
14900     0.1176      0.9600     0.3156     77.9938
15000     0.1412      0.9400     0.3156     79.0920
15100     0.2355      0.9300     0.3156     78.0108
15200     0.1613      0.9600     0.3156     77.4866
15300     0.2353      0.9400     0.3156     77.4852
15400     0.2296      0.9200     0.3156     77.8131
15500     0.2574      0.9000     0.3156     77.6611
15600     0.0729      0.9800     0.3156     78.1881
15700     0.1541      0.9600     0.3156     77.9624
15800     0.1121      0.9700     0.3156     79.5713
15900     0.2347      0.9200     0.3156     79.6518
16000     0.1334      0.9500     0.3156     77.0927
16100     0.0794      0.9700     0.3156     78.3632
16200     0.0949      0.9600     0.3156     79.0901
16300     0.1040      0.9600     0.3156     77.6387
16400     0.2135      0.9600     0.3156     78.2246
16500     0.1623      0.9300     0.3156     78.0711
16600     0.1011      0.9800     0.3156     77.4469
16700     0.1410      0.9700     0.3156     77.8160
16800     0.2009      0.9100     0.3156     78.1177
16900     0.2050      0.9600     0.3156     78.2578
17000     0.1777      0.9600     0.3156     77.7224
17100     0.1382      0.9600     0.3156     77.2721
17200     0.1500      0.9600     0.3156     78.0949
17300     0.0387      0.9900     0.3156     79.0240
17400     0.2333      0.9100     0.3156     78.0642
17500     0.0772      0.9900     0.3156     78.1252
17600     0.1370      0.9600     0.3156     78.8427
17700     0.2114      0.9300     0.3156     77.9488
17800     0.2156      0.9300     0.3156     78.5723
17900     0.0863      0.9800     0.3156     78.3083
18000     0.1693      0.9600     0.3156     77.1453
18100     0.1346      0.9500     0.3156     78.1185
18200     0.0625      0.9800     0.3156     78.1409
18300     0.1969      0.9100     0.3156     77.7833
18400     0.0625      0.9900     0.3156     77.7114
18500     0.2152      0.9400     0.3156     78.8219
18600     0.1382      0.9400     0.3156     79.0283
18700     0.1872      0.9300     0.3156     78.1546
18800     0.2669      0.9300     0.3156     77.3047
18900     0.0866      0.9500     0.3156     78.3063
19000     0.1089      0.9700     0.3156     77.3254
19100     0.1915      0.9500     0.3156     78.6210
19200     0.1478      0.9500     0.3156     78.2967
19300     0.0896      0.9600     0.3156     78.2026
19400     0.1501      0.9700     0.3156     77.4248
19500     0.0859      0.9900     0.3156     78.3363
19600     0.1216      0.9600     0.3156     79.0696
19700     0.0800      0.9800     0.3156     79.2762
19800     0.0799      0.9900     0.3156     78.0281
19900     0.2108      0.9500     0.3156     77.5290
20000     0.1798      0.9500     0.3194     78.5150
20100     0.2265      0.8900     0.3194     80.0192
20199     0.1119      0.9600     0.3194     77.7353
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     5.5088      0.2100     0.3316     19.6105
00100     2.6482      0.4300     0.4850     80.5724
00200     1.4771      0.6500     0.6077     78.0219
00300     1.0191      0.6900     0.6551     79.7779
00400     0.8539      0.7600     0.6774     78.5085
00500     1.4225      0.6400     0.7049     78.8948
00600     1.3695      0.6700     0.7103     78.5561
00700     1.0926      0.7100     0.7109     79.2569
00800     1.4786      0.6900     0.7262     79.2674
00900     1.0420      0.7700     0.7309     80.1501
01000     0.8458      0.8000     0.7524     78.3784
01100     1.6057      0.5900     0.7564     79.7986
01200     0.8303      0.7700     0.7672     79.0410
01300     1.1558      0.7900     0.7672     77.8791
01400     0.7544      0.7400     0.7672     78.1879
01500     1.2060      0.7100     0.7672     78.0397
01600     0.6507      0.8200     0.7722     79.4805
01700     0.8924      0.7500     0.7722     78.3881
01800     0.5909      0.8100     0.7775     79.7966
01900     1.0056      0.7700     0.7796     78.9170
02000     0.5381      0.8400     0.7871     79.1679
02100     0.9340      0.7400     0.7879     80.4152
02200     0.8003      0.8100     0.7879     78.4785
02300     1.0857      0.7300     0.7879     77.9349
02400     0.9056      0.7000     0.7879     79.1829
02500     0.6520      0.8400     0.8000     80.3163
02600     0.9832      0.7900     0.8000     78.8264
02700     0.4539      0.8800     0.8092     78.9300
02800     0.7448      0.7900     0.8092     78.7668
02900     0.7821      0.8000     0.8092     77.6857
03000     0.7365      0.8400     0.8092     78.0747
03100     0.9963      0.7600     0.8092     77.6323
03200     0.5405      0.8300     0.8092     77.7586
03300     1.2841      0.7000     0.8092     78.0546
03400     0.7147      0.8200     0.8114     78.2083
03500     0.7614      0.8200     0.8114     78.2266
03600     0.7919      0.8200     0.8114     77.7148
03700     0.8062      0.8300     0.8114     78.0947
03800     0.6660      0.8300     0.8114     79.1839
03900     0.6013      0.8600     0.8114     78.1461
04000     0.9490      0.7600     0.8114     79.3024
04100     0.8791      0.7900     0.8124     79.4234
04200     0.8163      0.8000     0.8124     78.7782
04300     0.3428      0.9100     0.8124     77.7536
04400     0.7476      0.7600     0.8158     78.0207
04500     0.6146      0.8200     0.8158     77.4482
04600     1.1377      0.7200     0.8158     78.4568
04700     0.6682      0.8000     0.8216     78.4875
04800     0.6592      0.8300     0.8216     78.8855
04900     0.8705      0.7900     0.8216     77.0422
05000     0.5792      0.8000     0.8216     78.1269
05100     0.9470      0.7600     0.8216     77.6497
05200     1.2284      0.6900     0.8216     78.1372
05300     0.8341      0.7800     0.8216     77.2607
05400     0.8770      0.8500     0.8216     79.1160
05500     0.8028      0.8400     0.8216     78.6706
05600     1.1643      0.7500     0.8216     77.1722
05700     0.7448      0.7800     0.8286     77.9106
05800     0.9044      0.8000     0.8286     77.3225
05900     0.6604      0.8400     0.8286     77.2087
06000     1.0553      0.7700     0.8286     77.7086
06100     0.7870      0.8600     0.8286     77.2996
06200     1.0753      0.7800     0.8286     78.0084
06300     0.7148      0.8400     0.8286     77.4996
06400     0.8341      0.8400     0.8286     77.7724
06500     0.9407      0.7900     0.8286     77.8898
06600     0.7873      0.8400     0.8286     77.3711
06700     0.7343      0.7800     0.8286     79.2982
06800     1.0291      0.7700     0.8366     79.9532
06900     1.1577      0.7200     0.8366     79.6848
07000     0.6454      0.8300     0.8366     79.5482
07100     0.5057      0.8400     0.8366     78.8630
07200     0.4243      0.8600     0.8366     78.9425
07300     0.5015      0.8400     0.8366     78.9870
07400     1.2158      0.7700     0.8366     78.7703
07500     1.0873      0.7800     0.8366     77.4421
07600     0.4653      0.8700     0.8366     77.5532
07700     0.8108      0.8200     0.8366     77.9061
07800     0.6531      0.8200     0.8366     79.1329
07900     0.2849      0.9100     0.8366     77.7092
08000     0.9375      0.7400     0.8366     78.8882
08100     1.1845      0.7800     0.8366     77.4931
08200     0.6478      0.8200     0.8366     77.4049
08300     0.4689      0.8900     0.8366     77.3512
08400     0.4583      0.9000     0.8366     77.9088
08500     0.8228      0.8100     0.8366     77.3343
08600     0.6891      0.8200     0.8366     77.7126
08700     0.7769      0.8200     0.8366     78.5596
08800     0.9538      0.7900     0.8366     78.5587
08900     0.6106      0.8500     0.8411     79.3055
09000     0.9785      0.7600     0.8411     76.2433
09100     0.6494      0.8000     0.8411     74.4693
09200     0.7274      0.8100     0.8411     74.1177
09300     0.6189      0.8100     0.8411     77.3018
09400     0.6414      0.8100     0.8411     74.8227
09500     0.5568      0.8800     0.8411     72.7786
09600     0.4482      0.8900     0.8413     73.8680
09700     0.8065      0.8600     0.8413     72.3164
09800     0.5353      0.8500     0.8413     75.4885
09900     0.6080      0.8400     0.8413     77.5807
Start testing:
Test Accuracy: 0.8900
