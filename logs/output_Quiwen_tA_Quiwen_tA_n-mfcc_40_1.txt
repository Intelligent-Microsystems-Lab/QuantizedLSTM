Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Traceback (most recent call last):
  File "KWS_LSTM.py", line 80, in <module>
    test_dataloader = torch.utils.data.DataLoader(speech_dataset_test, batch_size=args.batch_size, shuffle=True, num_workers=args.dataloader_num_workers)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 224, in __init__
    sampler = RandomSampler(dataset, generator=generator)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/utils/data/sampler.py", line 96, in __init__
    "value, but got num_samples={}".format(self.num_samples))
ValueError: num_samples should be a positive integer value, but got num_samples=0
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Traceback (most recent call last):
  File "KWS_LSTM.py", line 83, in <module>
    model = KWS_LSTM(input_dim = args.n_mfcc, hidden_dim = args.hidden, output_dim = len(args.word_list), batch_size = args.batch_size, device = device, quant_factor = 1, quant_beta = 1, wb = args.quant_w, abMVM = args.quant_actMVM, abNM = args.quant_actNM, ib = args.quant_inp, noise_level = args.noise_injectionT, blocks = 1, pool_method = 'Max', fc_blocks = 0, cy_div = 1, cy_scale = 1, train_a = args.train_a).to(device)
  File "/afs/crc.nd.edu/user/c/cschaef6/Qiuwen/QuantizedLSTM/model.py", line 241, in __init__
    self.lstmBlocks = LSTMLayer(LSTMCellQ, self.input_dim, self.hidden_dim, self.wb, self.ib, self.abMVM, self.abNM, self.noise_level, self.device, cy_div, cy_scale, train_a = train_a)
TypeError: __init__() got an unexpected keyword argument 'train_a'
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, dataloader_num_workers=8, dataset_path_test='../../QuantizedLSTM/data.nosync/speech_commands_test_set_v0.02', dataset_path_train='../../QuantizedLSTM/data.nosync/speech_commands_v0.02', hidden=118, hop_length=320, l2=0.01, learning_rate='0.0005,0.0001,0.00002', n_mfcc=40, noise_injectionT=0, quant_actMVM=8, quant_actNM=8, quant_inp=8, quant_w=8, random_seed=235899598, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, train_a=True, training_steps='10000,10000,10000', unknown_percentage=0.1, validation_percentage=10, win_length=640, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
ea886fba-b40f-4a23-afea-f4bd113ab667
Start Training:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     4.0478      0.0400     0.0871     18.5079
00100     3.6767      0.2400     0.2311     45.7461
00200     3.5239      0.2600     0.3133     45.0439
00300     3.2190      0.3100     0.3883     43.3693
00400     3.0052      0.4400     0.4766     42.5126
00500     2.7003      0.5900     0.5251     42.5409
00600     2.5916      0.6300     0.5877     42.4857
00700     2.5711      0.5500     0.6182     43.2745
00800     2.7775      0.5500     0.6456     42.8249
00900     2.4954      0.5800     0.6707     42.8806
01000     2.3838      0.6500     0.6892     43.1758
01100     2.2584      0.7100     0.7147     43.0314
01200     2.1610      0.6500     0.7210     42.8925
01300     1.9900      0.7800     0.7282     42.5568
01400     2.1695      0.7000     0.7619     42.7667
01500     1.8842      0.8400     0.7673     42.7537
01600     1.8991      0.8200     0.7673     42.8587
01700     2.2394      0.6700     0.7815     42.5959
01800     1.9353      0.7900     0.7910     42.5662
01900     2.1595      0.7400     0.8009     43.0457
02000     1.7696      0.8100     0.8009     42.3775
02100     2.0616      0.7200     0.8049     42.7256
02200     1.8866      0.7800     0.8097     42.8512
02300     1.8508      0.8400     0.8128     42.7073
02400     1.7947      0.8500     0.8128     42.3346
02500     1.6851      0.8900     0.8222     43.0510
02600     1.8935      0.8200     0.8333     43.1687
02700     1.8789      0.8400     0.8333     43.5005
02800     1.8065      0.8400     0.8333     42.9821
02900     1.8934      0.7700     0.8340     43.2904
03000     1.9329      0.8200     0.8409     42.7482
03100     1.7780      0.8500     0.8409     43.5808
03200     1.8843      0.7700     0.8409     42.6169
03300     1.8144      0.8100     0.8409     43.4250
03400     1.7451      0.8600     0.8454     43.1231
03500     1.7455      0.8400     0.8504     42.5451
03600     1.6954      0.8700     0.8542     43.5118
03700     1.7821      0.8500     0.8542     43.2398
03800     1.7126      0.8600     0.8542     42.7894
03900     1.6507      0.9100     0.8542     43.5124
04000     1.8248      0.8000     0.8542     43.2110
04100     1.7523      0.8500     0.8651     43.4662
04200     1.8175      0.8200     0.8651     42.7069
04300     1.7573      0.8600     0.8651     43.8514
04400     1.6610      0.8600     0.8651     43.0176
04500     1.6081      0.8900     0.8651     43.8035
04600     1.7304      0.8700     0.8651     43.8708
04700     1.7276      0.8400     0.8659     42.9919
04800     1.5768      0.9100     0.8659     44.0887
04900     1.6770      0.8500     0.8659     43.0517
05000     1.8004      0.8500     0.8659     43.6184
05100     1.5356      0.9200     0.8676     43.1810
05200     1.7698      0.8500     0.8676     42.5722
05300     1.9053      0.8100     0.8701     43.6846
05400     1.6951      0.8700     0.8701     43.1023
05500     1.4450      0.9600     0.8701     43.3579
05600     1.6544      0.9000     0.8701     42.9512
05700     1.4775      0.9600     0.8720     42.6259
05800     1.6534      0.8500     0.8720     43.3599
05900     1.5792      0.9100     0.8721     42.9458
06000     1.5032      0.9400     0.8737     44.0163
06100     1.6659      0.8900     0.8798     43.1867
06200     1.5301      0.9000     0.8798     42.9990
06300     1.6016      0.8700     0.8823     42.9630
06400     1.5486      0.9000     0.8823     43.7067
06500     1.4570      0.9200     0.8823     43.8628
06600     1.5540      0.9200     0.8823     43.2492
06700     1.5886      0.9100     0.8871     43.3489
06800     1.6711      0.8700     0.8871     43.9515
06900     1.5956      0.8900     0.8871     43.0443
07000     1.6759      0.8900     0.8871     43.5247
07100     1.5391      0.9300     0.8871     44.4423
07200     1.6895      0.8600     0.8871     44.1263
07300     1.6799      0.8700     0.8871     44.5701
07400     1.6070      0.8600     0.8871     44.9612
07500     1.7310      0.8600     0.8871     44.8225
07600     1.6421      0.9100     0.8871     44.2641
07700     1.5474      0.9100     0.8871     43.4826
07800     1.5895      0.9000     0.8871     43.8775
07900     1.5332      0.8900     0.8885     45.0857
08000     1.5235      0.8900     0.8885     43.4985
08100     1.7305      0.8100     0.8885     43.8790
08200     1.5653      0.9000     0.8885     43.4791
08300     1.4896      0.9400     0.8900     42.9946
08400     1.4613      0.9400     0.8900     43.6147
08500     1.6879      0.8300     0.8900     43.0714
08600     1.5301      0.9300     0.8908     43.0102
08700     1.5518      0.9200     0.8908     43.7344
08800     1.5487      0.8800     0.8928     43.5419
08900     1.4542      0.9400     0.8928     44.3346
09000     1.5100      0.9200     0.8941     43.3041
09100     1.8005      0.8000     0.9020     43.8177
09200     1.4606      0.9300     0.9020     43.1414
09300     1.6560      0.8800     0.9020     43.3183
09400     1.5849      0.8900     0.9020     43.2033
09500     1.4646      0.9400     0.9020     44.7092
09600     1.4808      0.9100     0.9020     43.2638
09700     1.5093      0.9000     0.9020     44.0025
09800     1.4998      0.9100     0.9020     43.8395
09900     1.4022      0.9700     0.9020     44.6147
10000     1.4829      0.9300     0.9020     44.5758
10100     1.5969      0.8900     0.9022     45.1921
10200     1.5141      0.9200     0.9022     43.5212
10300     1.5082      0.9200     0.9022     44.1023
10400     1.4083      0.9500     0.9022     43.6064
10500     1.5246      0.9000     0.9022     44.0640
10600     1.5819      0.9200     0.9022     44.3053
10700     1.4809      0.9100     0.9024     43.9409
10800     1.3682      0.9700     0.9050     45.2034
10900     1.3915      0.9600     0.9050     45.5054
11000     1.5028      0.8900     0.9050     43.4710
11100     1.5013      0.9100     0.9050     43.6650
11200     1.5738      0.9000     0.9050     43.4995
11300     1.5527      0.9100     0.9050     44.0273
11400     1.4430      0.9300     0.9050     44.5358
11500     1.4666      0.9400     0.9050     44.7846
11600     1.4949      0.9200     0.9050     43.3943
11700     1.6548      0.8600     0.9050     43.7410
11800     1.5304      0.9100     0.9050     44.0944
11900     1.5661      0.8800     0.9050     43.6897
12000     1.4301      0.9200     0.9050     43.7091
12100     1.4356      0.9300     0.9050     45.1974
12200     1.5626      0.9200     0.9050     44.5534
12300     1.4855      0.9300     0.9050     45.4324
12400     1.4147      0.9600     0.9050     45.4097
12500     1.5688      0.8800     0.9050     45.1958
12600     1.4672      0.9300     0.9050     44.1520
12700     1.4749      0.9500     0.9050     44.4535
12800     1.4563      0.9300     0.9050     43.2977
12900     1.3830      0.9500     0.9050     43.0090
13000     1.4807      0.9300     0.9050     45.2873
13100     1.4161      0.9300     0.9069     43.2673
13200     1.5488      0.8900     0.9069     43.1619
13300     1.5189      0.9400     0.9069     46.1746
13400     1.4622      0.9200     0.9082     43.7172
13500     1.6220      0.8700     0.9082     44.2997
13600     1.5084      0.9200     0.9082     45.3307
13700     1.5669      0.8900     0.9082     44.7784
13800     1.5715      0.9000     0.9082     43.6817
13900     1.4281      0.9200     0.9082     43.3267
14000     1.4632      0.9400     0.9082     43.1951
14100     1.5092      0.9300     0.9082     44.2417
14200     1.5091      0.8800     0.9082     45.2126
14300     1.4070      0.9400     0.9082     44.0553
14400     1.4603      0.9300     0.9082     45.2660
14500     1.5953      0.8500     0.9082     43.9213
14600     1.3699      0.9600     0.9082     43.3733
14700     1.6334      0.8700     0.9082     45.0784
14800     1.6354      0.8800     0.9082     44.7922
14900     1.4482      0.9300     0.9082     43.9174
15000     1.4405      0.9400     0.9082     43.6132
15100     1.5361      0.8800     0.9082     43.6705
15200     1.3675      0.9600     0.9082     43.7369
15300     1.4494      0.9500     0.9082     44.7347
15400     1.5167      0.9400     0.9082     43.5763
15500     1.4750      0.9100     0.9082     43.3758
15600     1.4482      0.9200     0.9082     43.5625
15700     1.5253      0.9000     0.9082     44.4020
15800     1.3936      0.9400     0.9082     43.8500
15900     1.4024      0.9400     0.9082     43.9162
16000     1.4303      0.9500     0.9082     43.3151
16100     1.4293      0.9200     0.9082     44.6058
16200     1.4224      0.9500     0.9082     44.1187
16300     1.4901      0.9200     0.9082     43.4681
16400     1.4078      0.9400     0.9082     44.1885
16500     1.5351      0.9000     0.9082     44.6731
16600     1.5302      0.9000     0.9082     45.5691
16700     1.5235      0.9000     0.9082     44.7845
16800     1.4828      0.9200     0.9082     43.8372
16900     1.4658      0.9300     0.9082     43.7621
17000     1.3250      0.9800     0.9082     43.6776
17100     1.5772      0.9100     0.9082     44.4892
17200     1.4880      0.9100     0.9082     43.0760
17300     1.6279      0.8800     0.9082     45.1479
17400     1.3774      0.9700     0.9082     43.0540
17500     1.4436      0.9300     0.9082     43.8228
17600     1.3931      0.9400     0.9082     44.8992
17700     1.5387      0.9200     0.9082     44.5643
17800     1.5110      0.9000     0.9082     46.7546
17900     1.4078      0.9200     0.9082     45.5666
18000     1.5331      0.9300     0.9082     44.8883
18100     1.4052      0.9100     0.9082     44.3085
18200     1.5175      0.9400     0.9082     44.2880
18300     1.5108      0.9000     0.9082     44.7716
18400     1.4639      0.9400     0.9082     43.5986
18500     1.4981      0.9400     0.9082     43.6120
18600     1.4180      0.9600     0.9082     43.9474
18700     1.4542      0.9400     0.9082     45.3729
18800     1.3914      0.9500     0.9082     44.1580
18900     1.5016      0.9400     0.9082     43.6584
19000     1.3846      0.9700     0.9082     43.6336
19100     1.5322      0.9000     0.9082     44.6592
19200     1.4751      0.9500     0.9082     44.6436
19300     1.4420      0.9200     0.9082     43.3915
19400     1.3953      0.9600     0.9082     43.4544
19500     1.5718      0.8800     0.9082     44.3736
19600     1.5619      0.9100     0.9082     43.7339
19700     1.3576      0.9600     0.9082     43.9320
19800     1.4829      0.9300     0.9082     43.7176
19900     1.4397      0.9600     0.9082     44.4139
20000     1.4125      0.9400     0.9082     44.2992
20100     1.5107      0.9000     0.9082     44.5630
20200     1.4398      0.9400     0.9082     44.2432
20300     1.3782      0.9700     0.9082     44.6345
20400     1.4728      0.9300     0.9082     43.7235
20500     1.4690      0.9200     0.9082     43.9244
20600     1.4649      0.9500     0.9082     43.6316
20700     1.3940      0.9400     0.9082     44.7746
20800     1.3943      0.9600     0.9082     44.7677
20900     1.5370      0.8900     0.9082     45.6992
21000     1.4180      0.9400     0.9082     43.6299
21100     1.4607      0.9400     0.9082     43.8456
21200     1.4040      0.9400     0.9082     44.2835
21300     1.4053      0.9600     0.9082     43.2494
21400     1.5699      0.9000     0.9082     43.4543
21500     1.4968      0.9000     0.9082     43.7355
21600     1.4841      0.9200     0.9084     44.3804
21700     1.4022      0.9600     0.9084     43.9237
21800     1.4196      0.9400     0.9084     44.8872
21900     1.4546      0.9500     0.9084     45.0333
22000     1.4175      0.9400     0.9084     44.0012
22100     1.3830      0.9500     0.9084     43.4671
22200     1.3921      0.9500     0.9084     43.9321
22300     1.3271      0.9800     0.9084     45.0332
22400     1.4517      0.9200     0.9084     43.5420
22500     1.3854      0.9300     0.9084     43.2094
22600     1.3354      0.9800     0.9084     45.6104
22700     1.4236      0.9300     0.9090     43.5836
22800     1.4972      0.9300     0.9090     44.1893
22900     1.4372      0.9500     0.9090     44.0735
23000     1.4436      0.9300     0.9090     44.1469
23100     1.4160      0.9400     0.9090     45.3444
23200     1.5481      0.8900     0.9090     43.5034
23300     1.5011      0.8800     0.9090     44.9466
23400     1.5872      0.8800     0.9090     44.1117
23500     1.4664      0.9400     0.9090     46.0851
23600     1.3910      0.9700     0.9090     44.6695
23700     1.3717      0.9500     0.9090     43.3198
23800     1.4690      0.9100     0.9090     43.6158
23900     1.4694      0.9300     0.9090     45.0160
24000     1.5335      0.8900     0.9090     45.7123
24100     1.3501      0.9700     0.9090     44.0459
24200     1.4858      0.9200     0.9090     43.4054
24300     1.4524      0.9400     0.9090     42.9741
24400     1.3863      0.9600     0.9090     44.3751
24500     1.3099      0.9800     0.9090     44.4277
24600     1.4547      0.9300     0.9090     44.5834
24700     1.5348      0.9300     0.9090     44.1399
24800     1.6836      0.8400     0.9090     44.2770
24900     1.3767      0.9600     0.9090     43.9513
25000     1.4883      0.9000     0.9090     44.6245
25100     1.3405      0.9700     0.9090     44.4557
25200     1.3932      0.9400     0.9090     44.9035
25300     1.4325      0.9400     0.9090     43.7833
25400     1.5432      0.9000     0.9090     43.2482
25500     1.4864      0.9100     0.9090     43.6611
25600     1.4318      0.9500     0.9090     45.6520
25700     1.4718      0.9300     0.9090     44.7619
25800     1.3625      0.9500     0.9090     45.0940
25900     1.4018      0.9500     0.9090     45.5898
26000     1.5048      0.9000     0.9090     46.6641
26100     1.4800      0.9300     0.9090     47.9178
26200     1.5300      0.9200     0.9090     46.4948
26300     1.5875      0.8600     0.9090     46.0516
26400     1.5635      0.8800     0.9090     47.7431
26500     1.4618      0.9200     0.9090     45.4494
26600     1.4858      0.9000     0.9090     47.1919
26700     1.4460      0.9100     0.9090     45.8902
26800     1.4313      0.9400     0.9090     45.0412
26900     1.4814      0.9500     0.9090     47.3910
27000     1.4373      0.9400     0.9090     46.2947
27100     1.4801      0.9200     0.9090     48.6057
27200     1.4723      0.9200     0.9090     46.0595
27300     1.3208      0.9600     0.9090     46.2337
27400     1.5118      0.9100     0.9090     47.4459
27500     1.4264      0.9400     0.9090     44.7772
27600     1.4003      0.9400     0.9090     44.7696
27700     1.4793      0.9100     0.9090     45.5072
27800     1.3986      0.9400     0.9090     47.3821
27900     1.4821      0.9300     0.9090     47.0506
28000     1.3164      0.9700     0.9090     45.1569
28100     1.4083      0.9300     0.9090     46.9381
28200     1.4136      0.9500     0.9090     47.8895
28300     1.5403      0.9200     0.9090     45.8953
28400     1.5031      0.8700     0.9090     45.8443
28500     1.4647      0.9400     0.9090     45.6583
28600     1.3772      0.9500     0.9090     44.0052
28700     1.5940      0.8800     0.9090     46.6262
28800     1.4997      0.9200     0.9090     44.2073
28900     1.4262      0.9200     0.9090     45.8389
29000     1.4967      0.8800     0.9090     47.1720
29100     1.3502      0.9800     0.9090     45.5697
29200     1.4953      0.9300     0.9090     46.1592
29300     1.5121      0.9100     0.9090     48.6211
29400     1.3643      0.9500     0.9090     47.0037
29500     1.3692      0.9500     0.9090     47.7191
29600     1.4103      0.9400     0.9090     41.6828
29700     1.4106      0.9500     0.9101     41.3659
29800     1.3618      0.9500     0.9101     40.7720
29900     1.3194      0.9900     0.9101     40.9454
29999     1.3949      0.9300     0.9101     40.8896
Start Testing:
Test Accuracy: 0.8977
