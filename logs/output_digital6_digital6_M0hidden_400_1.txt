Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=394, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=235899598, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
abbf7eba-cdc9-4b45-a22a-f36910ddde77
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 147, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 290, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 213, in forward
    gates = quant_pass(pact_a_bmm( quant_pass(pact_a_bmm(part1, self.a12), self.abMVM, self.a12) + quant_pass(pact_a_bmm(part2, self.a13), self.abMVM, self.a13), self.a14), self.abNM, self.a14)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 89, in forward
    x01q =  torch.round(x01 * step_d ) / step_d
RuntimeError: CUDA out of memory. Tried to allocate 12.00 MiB (GPU 0; 10.76 GiB total capacity; 9.68 GiB already allocated; 13.12 MiB free; 9.79 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=394, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=235899598, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
0ecafb42-ad67-4952-922a-379f2b26f0c6
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     2.8353      0.0500     0.0842     18.6496
00100     1.3555      0.5600     0.0914     61.4615
00200     1.0845      0.6400     0.0975     61.1037
00300     0.7284      0.7600     0.1001     60.7746
00400     0.7299      0.7600     0.1044     61.3352
00500     0.6451      0.7900     0.1076     61.0826
00600     0.6494      0.8300     0.1160     61.3484
00700     0.5153      0.8200     0.1160     60.6289
00800     0.5418      0.8300     0.1203     60.8780
00900     0.5822      0.8300     0.1203     60.3702
01000     0.5184      0.8200     0.1203     61.2245
01100     0.5902      0.8000     0.1203     61.0978
01200     0.7102      0.7700     0.1214     60.9736
01300     0.4254      0.8500     0.1313     61.5166
01400     0.4350      0.8500     0.1313     60.8173
01500     0.3773      0.8900     0.1313     61.0805
01600     0.4978      0.8200     0.1313     60.7173
01700     0.5275      0.8400     0.1313     60.5162
01800     0.3040      0.9000     0.1324     61.0030
01900     0.4666      0.8500     0.1324     61.3723
02000     0.4291      0.8700     0.1377     61.1934
02100     0.3658      0.8800     0.1377     60.9746
02200     0.5519      0.8200     0.1403     61.4818
02300     0.2683      0.9200     0.1403     60.7156
02400     0.3597      0.9100     0.1478     61.0974
02500     0.3750      0.8800     0.1478     61.0958
02600     0.2152      0.9400     0.1478     61.0193
02700     0.3840      0.9200     0.1478     60.8045
02800     0.3919      0.8700     0.1478     60.6781
02900     0.3598      0.9000     0.1552     61.1705
03000     0.3278      0.8800     0.1552     61.3247
03100     0.3611      0.8800     0.1559     61.1599
03200     0.4731      0.8800     0.1559     62.1367
03300     0.5925      0.8200     0.1664     63.1860
03400     0.4223      0.8600     0.1759     61.9128
03500     0.5237      0.8700     0.1759     61.0242
03600     0.3409      0.9000     0.1759     60.8838
03700     0.3490      0.9000     0.1759     60.5809
03800     0.2558      0.9100     0.1759     60.4456
03900     0.4512      0.8800     0.1759     60.9289
04000     0.2240      0.9300     0.1759     60.2652
04100     0.2737      0.9400     0.1759     61.3582
04200     0.3777      0.8900     0.1843     61.6691
04300     0.2512      0.9200     0.1843     61.2994
04400     0.4623      0.9000     0.1894     61.3516
04500     0.2863      0.9300     0.1899     61.7494
04600     0.3961      0.8900     0.1923     61.7815
04700     0.2449      0.9300     0.1939     61.9752
04800     0.3316      0.9200     0.2216     61.2272
04900     0.2914      0.9100     0.2216     60.3302
05000     0.3118      0.9200     0.2216     60.9024
05100     0.1643      0.9600     0.2216     60.4038
05200     0.2728      0.9300     0.2232     61.8095
05300     0.2926      0.8800     0.2242     61.6190
05400     0.2560      0.9300     0.2242     61.1366
05500     0.3433      0.9300     0.2242     61.6701
05600     0.2759      0.9100     0.2242     61.9188
05700     0.4411      0.9000     0.2322     62.0928
05800     0.3573      0.9300     0.2350     62.1967
05900     0.3901      0.8800     0.2489     62.0870
06000     0.2250      0.9400     0.2489     60.5162
06100     0.3420      0.9200     0.2489     60.8211
06200     0.2189      0.9700     0.2489     60.3843
06300     0.2670      0.9000     0.2651     60.8106
06400     0.3307      0.9000     0.2651     60.7633
06500     0.4087      0.8300     0.2651     60.8360
06600     0.3546      0.9200     0.2651     61.0255
06700     0.2646      0.9200     0.2651     61.0622
06800     0.2075      0.9200     0.2651     60.7600
06900     0.3735      0.8900     0.2651     61.1314
07000     0.2634      0.9200     0.2845     63.2560
07100     0.2358      0.9200     0.3026     61.3917
07200     0.2414      0.9400     0.3026     60.6033
07300     0.3568      0.9000     0.3026     61.9832
07400     0.2790      0.9200     0.3109     61.5834
07500     0.2676      0.9200     0.3109     60.6919
07600     0.1694      0.9500     0.3109     62.5802
07700     0.3779      0.8900     0.3109     60.9257
07800     0.1932      0.9500     0.3150     61.1204
07900     0.2532      0.9000     0.3153     61.8449
08000     0.2740      0.9300     0.3220     60.9465
08100     0.3223      0.9200     0.3489     61.5813
08200     0.1960      0.9500     0.3489     61.2105
08300     0.5127      0.8700     0.3772     61.4611
08400     0.2877      0.9400     0.3772     60.8157
08500     0.2151      0.9800     0.4066     61.4136
08600     0.2308      0.9100     0.4066     62.9069
08700     0.2808      0.9000     0.4066     61.5325
08800     0.3075      0.9100     0.4066     62.3084
08900     0.4156      0.8400     0.4066     60.6504
09000     0.1780      0.9500     0.4066     61.4990
09100     0.2605      0.9200     0.4066     60.9791
09200     0.2735      0.8900     0.4102     62.0043
09300     0.1922      0.9500     0.4102     60.4286
09400     0.2174      0.9700     0.4102     61.6222
09500     0.2321      0.9500     0.4102     60.8535
09600     0.1739      0.9600     0.4102     60.4792
09700     0.2536      0.9400     0.4102     60.8580
09800     0.3076      0.9000     0.4102     61.4709
09900     0.1878      0.9200     0.4102     62.2328
10000     0.3576      0.9200     0.4102     63.0800
10100     0.1689      0.9500     0.4102     63.6780
10200     0.2565      0.9200     0.4309     62.0552
10300     0.2321      0.9700     0.4309     63.7252
10400     0.1910      0.9600     0.4309     60.8131
10500     0.1402      0.9500     0.4309     63.2314
10600     0.1415      0.9400     0.4309     61.8723
10700     0.2703      0.9100     0.4309     62.4511
10800     0.2300      0.9500     0.4309     61.7700
10900     0.2144      0.9400     0.4309     62.7788
11000     0.2419      0.9200     0.4309     61.9179
11100     0.1135      0.9900     0.4309     61.2617
11200     0.1855      0.9400     0.4309     61.2787
11300     0.2948      0.9000     0.4309     61.0264
11400     0.1959      0.9600     0.4309     61.5322
11500     0.1620      0.9600     0.4452     61.1872
11600     0.1559      0.9600     0.4452     61.9236
11700     0.1241      0.9800     0.4452     61.4205
11800     0.1849      0.9600     0.4452     61.1620
11900     0.2397      0.9200     0.4452     60.8815
12000     0.2464      0.9400     0.4452     60.7727
12100     0.2927      0.8900     0.4452     60.6964
12200     0.1737      0.9500     0.4452     61.0112
12300     0.2384      0.9200     0.4452     60.3169
12400     0.1574      0.9700     0.4452     60.5837
12500     0.3234      0.9300     0.4452     61.1382
12600     0.1737      0.9500     0.4452     60.5031
12700     0.1029      0.9600     0.4452     60.8482
12800     0.1245      0.9600     0.4471     61.7183
12900     0.2385      0.9400     0.4471     61.4809
13000     0.2580      0.9000     0.4475     61.7846
13100     0.1646      0.9600     0.4475     61.5318
13200     0.2414      0.9500     0.4475     60.8365
13300     0.1111      0.9800     0.4475     60.4955
13400     0.1142      0.9700     0.4475     60.9708
13500     0.1546      0.9500     0.4475     60.9646
13600     0.1261      0.9800     0.4475     61.0329
13700     0.1365      0.9500     0.4475     61.7308
13800     0.2498      0.9300     0.4475     60.8783
13900     0.1858      0.9600     0.4475     60.3846
14000     0.0935      0.9800     0.4475     60.8601
14100     0.1773      0.9700     0.4475     60.0965
14200     0.0761      0.9900     0.4475     60.4210
14300     0.1503      0.9600     0.4475     60.0264
14400     0.1771      0.9300     0.4475     60.3915
14500     0.1159      0.9700     0.4475     60.9009
14600     0.1916      0.9300     0.4475     60.9134
14700     0.2352      0.9500     0.4475     61.5939
14800     0.1376      0.9600     0.4533     62.4627
14900     0.1083      0.9800     0.4533     61.4507
15000     0.1094      0.9700     0.4533     61.2122
15100     0.1368      0.9700     0.4533     60.8786
15200     0.1162      0.9700     0.4533     62.3106
15300     0.1295      0.9600     0.4533     61.7895
15400     0.3067      0.9000     0.4533     63.9945
15500     0.0963      0.9700     0.4533     63.3483
15600     0.2231      0.9500     0.4533     61.2307
15700     0.2284      0.9200     0.4533     63.2681
15800     0.1396      0.9600     0.4533     62.4536
15900     0.2614      0.9100     0.4533     61.0224
16000     0.1310      0.9600     0.4533     61.3422
16100     0.1039      0.9600     0.4533     61.4734
16200     0.1564      0.9700     0.4533     61.3293
16300     0.1136      0.9700     0.4533     61.5334
16400     0.1561      0.9500     0.4533     60.6861
16500     0.1380      0.9700     0.4533     61.9816
16600     0.1815      0.9600     0.4533     62.5524
16700     0.0988      0.9700     0.4533     61.9122
16800     0.2632      0.9300     0.4533     60.5718
16900     0.2066      0.9500     0.4533     61.4224
17000     0.1708      0.9400     0.4533     62.1606
17100     0.1412      0.9600     0.4533     62.2020
17200     0.1064      0.9800     0.4533     62.1760
17300     0.1701      0.9500     0.4533     62.0634
17400     0.2010      0.9500     0.4533     61.4149
17500     0.0968      0.9600     0.4533     60.7150
17600     0.2122      0.9500     0.4533     61.5390
17700     0.1698      0.9600     0.4533     63.9703
17800     0.0985      0.9800     0.4533     64.6699
17900     0.0751      0.9900     0.4533     63.0247
18000     0.0961      0.9700     0.4533     62.2043
18100     0.1376      0.9600     0.4533     60.7302
18200     0.0725      0.9900     0.4533     62.3550
18300     0.2201      0.9300     0.4533     61.3674
18400     0.1934      0.9600     0.4533     61.0167
18500     0.1755      0.9600     0.4533     60.5826
18600     0.1548      0.9600     0.4533     60.8638
18700     0.0594      1.0000     0.4533     61.0322
18800     0.0947      0.9700     0.4662     60.7850
18900     0.1234      0.9400     0.4662     60.4669
19000     0.1371      0.9500     0.4662     60.5331
19100     0.0559      1.0000     0.4662     60.4890
19200     0.1547      0.9600     0.4662     61.7979
19300     0.0828      0.9900     0.4662     61.2974
19400     0.1057      0.9700     0.4662     60.7579
19500     0.1170      0.9700     0.4662     61.1180
19600     0.1521      0.9500     0.4662     61.1783
19700     0.1696      0.9600     0.4662     60.4561
19800     0.1530      0.9500     0.4662     61.5051
19900     0.0971      0.9700     0.4662     62.0379
20000     0.1567      0.9500     0.4662     60.8100
20100     0.0913      0.9900     0.4662     61.1313
20199     0.1530      0.9800     0.4662     59.9694
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     2.4415      0.5100     0.4368     16.3324
00100     1.2058      0.6300     0.6558     61.2666
00200     0.6957      0.8000     0.7171     61.7269
00300     0.7687      0.7600     0.7704     62.3094
00400     0.6479      0.8100     0.7818     61.7007
00500     0.7294      0.7900     0.7888     62.0843
00600     0.8673      0.8100     0.7998     61.8749
00700     0.9115      0.8200     0.7998     60.6834
00800     0.9569      0.7000     0.8059     61.4087
00900     0.6224      0.8400     0.8111     61.4968
01000     0.6995      0.8200     0.8264     61.4661
01100     0.7054      0.8400     0.8264     60.3877
01200     0.8305      0.8200     0.8270     62.2402
01300     0.3626      0.8800     0.8312     60.6353
01400     0.4675      0.8400     0.8312     60.3463
01500     0.6266      0.8200     0.8312     60.8715
01600     0.4424      0.8700     0.8317     61.5766
01700     0.6519      0.8300     0.8317     61.0158
01800     0.3852      0.8800     0.8317     61.0046
01900     0.5469      0.8500     0.8318     60.6769
02000     0.4240      0.8800     0.8318     60.7362
02100     0.6187      0.8200     0.8381     61.9281
02200     0.5396      0.8500     0.8381     60.3824
02300     0.7770      0.7600     0.8381     61.9392
02400     0.7436      0.8500     0.8381     61.3398
02500     0.5603      0.8500     0.8381     61.7042
02600     0.4190      0.8900     0.8381     61.1204
02700     0.3806      0.9100     0.8443     61.5994
02800     0.5119      0.8700     0.8443     60.1857
02900     0.6100      0.8400     0.8443     60.8424
03000     0.7292      0.8200     0.8465     60.6347
03100     0.9034      0.7900     0.8465     61.7437
03200     0.3855      0.9000     0.8465     61.1711
03300     0.5139      0.8400     0.8465     61.9558
03400     0.2622      0.9100     0.8481     62.2372
03500     0.4144      0.8600     0.8519     60.8322
03600     0.5148      0.8600     0.8519     61.7052
03700     0.6899      0.8200     0.8519     60.9646
03800     0.6930      0.8400     0.8519     60.8334
03900     0.6643      0.8200     0.8560     60.8974
04000     0.6886      0.8500     0.8560     61.1255
04100     0.5562      0.8500     0.8560     61.6409
04200     0.7398      0.7600     0.8560     63.0068
04300     0.3939      0.9000     0.8560     61.8004
04400     0.4935      0.8600     0.8560     61.3451
04500     0.8775      0.8200     0.8560     61.1888
04600     0.8249      0.7900     0.8560     61.4844
04700     0.4000      0.8800     0.8560     60.4043
04800     0.4256      0.9000     0.8560     60.6814
04900     0.3068      0.8800     0.8560     60.9418
05000     0.5354      0.8500     0.8560     60.9598
05100     0.5740      0.8300     0.8560     61.1995
05200     0.5736      0.8500     0.8560     60.6579
05300     0.4023      0.9100     0.8588     61.2502
05400     0.6066      0.8400     0.8588     61.7019
05500     0.3451      0.8900     0.8596     62.4764
05600     0.5962      0.8300     0.8596     61.4905
05700     0.4640      0.8600     0.8596     62.2457
05800     0.4428      0.8900     0.8596     61.0616
05900     0.8870      0.7800     0.8607     61.6215
06000     0.6661      0.8100     0.8607     61.2321
06100     0.6781      0.8400     0.8607     61.2269
06200     0.2930      0.9100     0.8607     60.4101
06300     0.6607      0.8300     0.8607     60.8146
06400     0.3592      0.9000     0.8607     61.5478
06500     0.4277      0.8500     0.8607     60.6878
06600     0.6182      0.8200     0.8623     61.1649
06700     0.5482      0.8900     0.8623     61.2206
06800     0.4546      0.8700     0.8623     61.1569
06900     0.4706      0.8500     0.8623     61.9135
07000     0.7492      0.7800     0.8678     64.1914
07100     0.3709      0.8900     0.8708     62.6292
07200     0.4209      0.8800     0.8708     62.6373
07300     0.6844      0.8200     0.8708     62.3166
07400     0.4658      0.8500     0.8732     62.7883
07500     0.6312      0.8000     0.8732     61.5299
07600     0.4129      0.8700     0.8732     61.9412
07700     0.5830      0.8600     0.8732     61.8947
07800     0.4772      0.8700     0.8732     62.0533
07900     0.6955      0.8000     0.8732     62.6444
08000     0.3310      0.8700     0.8732     61.6841
08100     0.2941      0.9400     0.8732     62.2893
08200     0.3874      0.8800     0.8732     62.9570
08300     0.4393      0.8900     0.8732     61.8916
08400     0.5518      0.8300     0.8732     62.4592
08500     0.4374      0.8700     0.8732     62.2060
08600     0.4031      0.8600     0.8732     62.5866
08700     0.5692      0.8300     0.8732     62.7881
08800     0.6645      0.8400     0.8732     62.1342
08900     0.5104      0.8700     0.8732     61.4640
09000     0.4713      0.8900     0.8732     63.3576
09100     0.7203      0.8400     0.8732     61.7957
09200     0.7062      0.7900     0.8732     61.0347
09300     0.4408      0.8700     0.8753     61.8193
09400     0.2637      0.9200     0.8753     61.0513
09500     0.4277      0.8900     0.8753     61.8395
09600     0.3674      0.8900     0.8753     66.4089
09700     0.6653      0.8500     0.8753     64.3841
09800     0.5113      0.8700     0.8753     61.1844
09900     0.3873      0.8800     0.8753     61.1240
Start testing:
Test Accuracy: 0.8991
