Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=494, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=235899598, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
3a144b4e-6cb6-4fd1-8b91-99ca43a7e138
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 167, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 290, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 229, in forward
    activated_input = quant_pass(pact_a_bmm(input_gate_out * activation_out, self.a8), self.abNM, self.a8)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 89, in forward
    x01q =  torch.round(x01 * step_d ) / step_d
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 22.17 GiB total capacity; 19.10 GiB already allocated; 14.50 MiB free; 21.18 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=494, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=235899598, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
8f9f4ba3-3f61-4022-a9c5-140fe168a2e4
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     2.8341      0.0900     0.1418     17.9144
00100     1.4028      0.5600     0.5827     59.1193
00200     1.2337      0.6200     0.7062     57.7312
00300     0.9140      0.6900     0.7494     57.3166
00400     1.1926      0.6400     0.7660     57.6735
00500     0.8832      0.7100     0.7924     56.9824
00600     0.8205      0.7400     0.8062     56.9152
00700     0.8439      0.7700     0.8062     57.0558
00800     0.7616      0.7800     0.8062     56.3554
00900     0.8882      0.7300     0.8254     57.7091
01000     0.8204      0.7300     0.8254     56.2244
01100     0.8000      0.7600     0.8254     56.5631
01200     0.6704      0.8200     0.8276     57.3335
01300     0.8852      0.7200     0.8440     58.1969
01400     0.5532      0.8400     0.8440     57.2262
01500     0.5723      0.8300     0.8440     57.4001
01600     0.6814      0.7900     0.8440     56.7357
01700     0.6292      0.8200     0.8449     58.8824
01800     0.6823      0.7800     0.8449     56.5831
01900     0.6170      0.8200     0.8451     58.3414
02000     0.8250      0.7500     0.8451     57.2315
02100     0.6028      0.8200     0.8451     58.4196
02200     1.0716      0.6900     0.8606     58.3838
02300     0.7389      0.7800     0.8606     56.3009
02400     0.8508      0.7200     0.8606     57.3632
02500     0.6365      0.8000     0.8606     57.4278
02600     0.7900      0.7600     0.8668     57.3160
02700     0.6564      0.7800     0.8668     57.1789
02800     0.6791      0.7900     0.8668     58.1566
02900     0.6967      0.7700     0.8668     56.9495
03000     0.6627      0.8000     0.8728     58.5625
03100     0.6204      0.8300     0.8728     57.6522
03200     0.4785      0.8600     0.8728     57.2054
03300     0.7253      0.7900     0.8728     56.9834
03400     0.6482      0.8100     0.8728     56.5177
03500     0.8368      0.7400     0.8728     57.6202
03600     0.6319      0.8300     0.8728     59.4199
03700     0.7094      0.7800     0.8728     57.1263
03800     0.6088      0.7800     0.8728     57.0039
03900     0.5104      0.8100     0.8728     57.3212
04000     0.5719      0.8100     0.8728     57.4452
04100     0.5310      0.8600     0.8728     56.9709
04200     0.6574      0.7700     0.8728     57.4337
04300     0.5311      0.8600     0.8728     56.5588
04400     0.5990      0.8200     0.8728     56.8412
04500     0.3804      0.8900     0.8745     57.8138
04600     0.4898      0.8500     0.8745     56.7656
04700     0.4335      0.8900     0.8745     56.2279
04800     0.4646      0.9000     0.8745     57.9768
04900     0.6827      0.7800     0.8745     57.3101
05000     0.3871      0.9000     0.8745     56.9615
05100     0.4190      0.8900     0.8745     57.9539
05200     0.6076      0.8500     0.8745     56.7557
05300     0.7457      0.7600     0.8745     57.5214
05400     0.4888      0.8000     0.8745     57.2237
05500     0.5724      0.8000     0.8745     57.7199
05600     0.6235      0.7700     0.8853     59.1754
05700     0.6508      0.7800     0.8853     57.9045
05800     0.5331      0.8500     0.8853     56.9774
05900     0.5564      0.8200     0.8853     57.9177
06000     0.5547      0.8300     0.8853     57.4976
06100     0.5580      0.8200     0.8853     57.9348
06200     0.5566      0.8200     0.8853     56.7668
06300     0.6665      0.8100     0.8853     57.6067
06400     0.4990      0.8700     0.8853     59.9770
06500     0.5247      0.8400     0.8853     57.8060
06600     0.7336      0.7600     0.8866     57.4534
06700     0.5836      0.8000     0.8866     58.1443
06800     0.6648      0.8300     0.8866     57.7101
06900     0.5550      0.8000     0.8866     57.4710
07000     0.5185      0.8400     0.8866     57.0346
07100     0.5398      0.8400     0.8866     56.5778
07200     0.4675      0.8300     0.8866     56.6238
07300     0.5057      0.8800     0.8866     57.3106
07400     0.6266      0.7900     0.8866     57.1532
07500     0.6570      0.7800     0.8866     57.9423
07600     0.4144      0.8600     0.8866     58.6162
07700     0.6024      0.8200     0.8866     57.2651
07800     0.5595      0.8400     0.8866     57.4155
07900     0.5641      0.7800     0.8866     58.2289
08000     0.6667      0.7900     0.8866     56.5244
08100     0.5387      0.8500     0.8866     57.6276
08200     0.4435      0.8800     0.8866     58.3188
08300     0.7570      0.7900     0.8866     57.8952
08400     0.5951      0.8200     0.8866     57.5755
08500     0.5010      0.8500     0.8866     57.3933
08600     0.4225      0.8700     0.8866     57.5635
08700     0.4660      0.8600     0.8866     56.7622
08800     0.4270      0.8400     0.8866     57.9496
08900     0.4006      0.8800     0.8866     57.7179
09000     0.4763      0.8800     0.8866     56.4411
09100     0.2823      0.9100     0.8866     56.6890
09200     0.3840      0.8800     0.8866     56.2086
09300     0.4779      0.8500     0.8866     57.3716
09400     0.5147      0.8100     0.8866     57.5377
09500     0.3147      0.9000     0.8866     56.8903
09600     0.4777      0.8300     0.8866     56.3235
09700     0.4025      0.8900     0.8866     57.3468
09800     0.4606      0.9000     0.8866     58.0665
09900     0.5026      0.8400     0.8884     58.7791
10000     0.5518      0.8300     0.8884     57.6643
10100     0.4039      0.8800     0.8884     57.2819
10200     0.2940      0.9200     0.8940     57.8102
10300     0.5415      0.8500     0.8940     57.2276
10400     0.4052      0.8700     0.9007     58.5709
10500     0.3847      0.8800     0.9007     58.5203
10600     0.5019      0.8600     0.9007     57.5613
10700     0.5229      0.8100     0.9007     58.3696
10800     0.3749      0.8900     0.9007     57.7989
10900     0.5302      0.8400     0.9007     57.8410
11000     0.4191      0.8300     0.9007     57.5319
11100     0.3279      0.9100     0.9007     57.5186
11200     0.5772      0.8500     0.9007     57.8366
11300     0.4055      0.8600     0.9007     57.1471
11400     0.3214      0.9100     0.9007     57.0720
11500     0.3608      0.9100     0.9007     57.6580
11600     0.4308      0.8600     0.9007     57.0959
11700     0.4561      0.8600     0.9007     57.0575
11800     0.3751      0.8600     0.9016     57.8937
11900     0.3403      0.9200     0.9016     57.4699
12000     0.4001      0.9000     0.9016     57.2683
12100     0.3505      0.9100     0.9052     59.0409
12200     0.2839      0.9300     0.9052     57.9699
12300     0.4257      0.8600     0.9052     57.9671
12400     0.3528      0.9200     0.9052     59.3378
12500     0.3982      0.8800     0.9052     58.7581
12600     0.3613      0.8800     0.9052     56.6346
12700     0.4868      0.8300     0.9089     58.4346
12800     0.4012      0.8600     0.9089     60.5728
12900     0.2428      0.9400     0.9089     59.8777
13000     0.3219      0.9300     0.9089     61.2393
13100     0.5131      0.8300     0.9089     60.9692
13200     0.4888      0.8600     0.9089     59.0746
13300     0.3996      0.8800     0.9089     57.5752
13400     0.4316      0.8600     0.9089     57.3493
13500     0.2371      0.9300     0.9089     57.2760
13600     0.4064      0.8900     0.9089     57.1428
13700     0.3314      0.9300     0.9089     57.1657
13800     0.4071      0.8700     0.9089     57.2811
13900     0.3391      0.8700     0.9089     56.9440
14000     0.4741      0.8500     0.9089     57.5820
14100     0.4245      0.8900     0.9089     57.0536
14200     0.3547      0.8900     0.9089     58.4428
14300     0.3274      0.8900     0.9089     56.8192
14400     0.3126      0.9300     0.9089     57.2606
14500     0.4165      0.8800     0.9089     57.8093
14600     0.3749      0.8700     0.9089     57.2046
14700     0.3236      0.9000     0.9089     56.3416
14800     0.3745      0.8800     0.9089     56.8861
14900     0.5049      0.8400     0.9089     56.9025
15000     0.4352      0.8600     0.9089     58.4619
15100     0.2460      0.9000     0.9089     57.0008
15200     0.2717      0.9400     0.9089     57.2485
15300     0.2848      0.9300     0.9089     56.1898
15400     0.3658      0.8800     0.9089     57.4026
15500     0.3924      0.8900     0.9089     57.5430
15600     0.3665      0.9100     0.9089     56.7707
15700     0.6539      0.8000     0.9089     57.8742
15800     0.2388      0.9300     0.9089     56.7886
15900     0.4468      0.8700     0.9089     57.5592
16000     0.5338      0.8300     0.9089     55.9651
16100     0.4011      0.8900     0.9089     56.8462
16200     0.3722      0.8900     0.9089     57.2756
16300     0.2443      0.9300     0.9089     57.1232
16400     0.3009      0.9100     0.9089     57.4865
16500     0.2789      0.9300     0.9089     57.7396
16600     0.3266      0.8600     0.9089     56.7464
16700     0.2626      0.9200     0.9089     57.4684
16800     0.4176      0.8800     0.9089     57.9699
16900     0.3252      0.8900     0.9089     57.6778
17000     0.3721      0.8600     0.9089     58.3382
17100     0.5083      0.8600     0.9089     57.6873
17200     0.2401      0.9300     0.9089     57.4432
17300     0.3624      0.9000     0.9089     56.1587
17400     0.3267      0.8800     0.9089     57.6092
17500     0.3958      0.8600     0.9089     56.8649
17600     0.3701      0.9400     0.9089     56.6427
17700     0.1594      0.9700     0.9089     57.6216
17800     0.2727      0.9200     0.9089     59.0036
17900     0.4420      0.8600     0.9089     57.1911
18000     0.2633      0.9300     0.9089     56.3689
18100     0.3005      0.9100     0.9089     58.2011
18200     0.3325      0.9000     0.9089     57.5560
18300     0.5656      0.8600     0.9089     57.7461
18400     0.2995      0.9300     0.9089     57.5667
18500     0.2077      0.9500     0.9089     57.2668
18600     0.3136      0.9000     0.9089     57.7766
18700     0.2845      0.9100     0.9089     56.6073
18800     0.3210      0.9100     0.9089     57.1829
18900     0.4280      0.8300     0.9089     58.6771
19000     0.3078      0.9300     0.9089     58.2548
19100     0.2798      0.9200     0.9089     58.2729
19200     0.2305      0.9300     0.9089     56.8632
19300     0.1956      0.9500     0.9089     56.5464
19400     0.2739      0.9100     0.9089     57.4957
19500     0.3651      0.9000     0.9089     57.3045
19600     0.3800      0.8800     0.9089     56.9672
19700     0.3087      0.9100     0.9089     59.5324
19800     0.4785      0.8500     0.9089     57.0261
19900     0.3019      0.9100     0.9089     57.6098
20000     0.2341      0.9300     0.9089     57.5128
20100     0.3594      0.9200     0.9089     56.9955
20199     0.3068      0.9100     0.9089     56.2485
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     0.3349      0.9200     0.8922     15.9341
00100     0.4249      0.9000     0.9084     57.5872
00200     0.3473      0.8800     0.9119     57.3296
00300     0.2395      0.9300     0.9119     56.9917
00400     0.4074      0.8600     0.9119     57.0074
00500     0.2894      0.9200     0.9119     56.4461
00600     0.2931      0.9000     0.9119     56.4326
00700     0.4699      0.8700     0.9119     56.6709
00800     0.1447      0.9700     0.9125     57.6658
00900     0.3655      0.8800     0.9162     56.8916
01000     0.2061      0.9300     0.9162     56.6560
01100     0.4521      0.8700     0.9162     57.1964
01200     0.3814      0.9000     0.9162     57.0262
01300     0.4159      0.8600     0.9162     57.5744
01400     0.2394      0.9400     0.9162     56.5937
01500     0.4367      0.8900     0.9162     57.0126
01600     0.1993      0.9300     0.9162     58.2363
01700     0.4308      0.8800     0.9162     56.8119
01800     0.2023      0.9500     0.9162     57.5617
01900     0.3628      0.8900     0.9162     56.5461
02000     0.3187      0.9200     0.9162     56.2950
02100     0.2834      0.9200     0.9162     57.2950
02200     0.2523      0.9300     0.9162     56.1547
02300     0.2801      0.9300     0.9162     56.9554
02400     0.3721      0.8900     0.9162     56.7805
02500     0.2901      0.9200     0.9162     57.0122
02600     0.2776      0.9300     0.9162     57.0888
02700     0.2493      0.9300     0.9162     57.5156
02800     0.3443      0.9000     0.9162     56.5498
02900     0.4950      0.8600     0.9162     57.2874
03000     0.3766      0.8900     0.9162     56.8228
03100     0.3157      0.9100     0.9162     57.1120
03200     0.4088      0.9100     0.9162     56.9377
03300     0.3440      0.8900     0.9162     57.3017
03400     0.3646      0.9000     0.9162     56.6401
03500     0.4514      0.8900     0.9162     56.3461
03600     0.4057      0.9000     0.9162     56.2206
03700     0.2851      0.9200     0.9162     56.1637
03800     0.2796      0.9300     0.9162     57.5912
03900     0.2776      0.9300     0.9162     57.1013
04000     0.2805      0.9100     0.9162     57.2016
04100     0.3406      0.8900     0.9162     56.3871
04200     0.3513      0.8900     0.9162     56.4805
04300     0.3782      0.8800     0.9162     57.3101
04400     0.2737      0.9200     0.9162     58.9493
04500     0.4582      0.8700     0.9162     57.2697
04600     0.3620      0.8900     0.9162     58.2916
04700     0.2742      0.8900     0.9162     58.2677
04800     0.4379      0.8700     0.9162     56.4932
04900     0.2908      0.9200     0.9162     56.7563
05000     0.2623      0.9400     0.9162     56.1545
05100     0.3729      0.8900     0.9162     57.1785
05200     0.3261      0.8900     0.9162     58.3337
05300     0.3644      0.9000     0.9162     57.5435
05400     0.2315      0.9400     0.9162     56.7562
05500     0.3049      0.9100     0.9162     58.2194
05600     0.3167      0.8800     0.9162     57.5409
05700     0.2799      0.9100     0.9162     56.4463
05800     0.4684      0.8800     0.9162     57.5657
05900     0.2711      0.9300     0.9162     57.5898
06000     0.2555      0.9300     0.9162     58.8351
06100     0.2861      0.9300     0.9162     58.9607
06200     0.3712      0.9200     0.9162     56.2991
06300     0.2314      0.9500     0.9162     56.6488
06400     0.2969      0.9200     0.9162     57.6114
06500     0.4367      0.8600     0.9162     57.9775
06600     0.2703      0.9300     0.9162     58.0657
06700     0.2157      0.9300     0.9162     56.9614
06800     0.2524      0.9300     0.9162     57.0747
06900     0.2891      0.9000     0.9162     56.2448
07000     0.2730      0.9300     0.9162     56.9355
07100     0.2393      0.9300     0.9162     57.0266
07200     0.2337      0.9300     0.9162     56.4745
07300     0.3619      0.9100     0.9162     56.4471
07400     0.4296      0.8700     0.9162     57.0465
07500     0.3330      0.8900     0.9162     56.5596
07600     0.2861      0.9300     0.9162     56.9612
07700     0.2825      0.9100     0.9162     56.6472
07800     0.3118      0.9000     0.9162     57.5671
07900     0.3534      0.9000     0.9162     56.9209
08000     0.2490      0.9200     0.9162     57.6130
08100     0.3078      0.8900     0.9162     56.8790
08200     0.3822      0.8800     0.9162     56.5980
08300     0.3533      0.9300     0.9162     57.0229
08400     0.2042      0.9500     0.9162     57.8602
08500     0.4094      0.8700     0.9162     56.6482
08600     0.3565      0.9000     0.9162     57.5919
08700     0.2495      0.9200     0.9162     57.1897
08800     0.3604      0.8800     0.9162     56.5400
08900     0.2589      0.9200     0.9162     57.1051
09000     0.2505      0.9200     0.9162     56.1680
09100     0.2216      0.9300     0.9162     56.4755
09200     0.1584      0.9800     0.9162     56.3414
09300     0.2063      0.9300     0.9162     56.1469
09400     0.3633      0.9000     0.9162     56.1688
09500     0.2087      0.9600     0.9162     56.7755
09600     0.1339      0.9800     0.9162     56.5462
09700     0.3318      0.9100     0.9162     56.9023
09800     0.4278      0.9000     0.9162     60.0005
09900     0.3344      0.9000     0.9162     57.4177
Start testing:
Test Accuracy: 0.8993
