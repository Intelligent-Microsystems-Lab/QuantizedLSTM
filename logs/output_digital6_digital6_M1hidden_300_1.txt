Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=294, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=235899598, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
43a87509-d041-4d77-ae91-fcddb035d86e
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 147, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 374, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 211, in forward
    part2 = CustomMM_bmm.apply(quant_pass(pact_a_bmm(hx, self.a11), self.ib, self.a11), self.weight_hh * w_mask, self.bias_hh, self.noise_level, self.wb, self.bias_r)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 141, in forward
    noise_w = torch.randn(weight.shape, device = input.device) * max_w * nl
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 11.78 GiB total capacity; 10.44 GiB already allocated; 21.38 MiB free; 10.60 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=294, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=235899598, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
749c8b0a-353f-4d30-a1d8-f2c14faee8f7
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     2.9610      0.1300     0.0876     17.1804
00100     1.9003      0.3500     0.0902     73.8904
00200     1.5295      0.4700     0.0902     71.1488
00300     1.1083      0.5900     0.0902     69.9349
00400     0.9770      0.6700     0.0909     76.5237
00500     0.8631      0.7000     0.0947     76.5048
00600     0.9807      0.7300     0.1056     72.5243
00700     0.8562      0.7100     0.1056     75.3663
00800     0.7454      0.7300     0.1056     71.3705
00900     0.9274      0.7100     0.1056     72.7581
01000     0.7361      0.7400     0.1056     73.4408
01100     0.5028      0.8600     0.1056     77.7195
01200     0.4549      0.8200     0.1056     78.3439
01300     0.8003      0.7900     0.1057     73.8163
01400     0.5533      0.8300     0.1057     71.9474
01500     0.7353      0.7300     0.1057     73.1833
01600     0.6734      0.7600     0.1109     73.3824
01700     0.5974      0.8300     0.1109     75.0868
01800     0.4224      0.8300     0.1157     72.0124
01900     0.6072      0.7600     0.1157     76.7232
02000     0.4147      0.8500     0.1157     72.1889
02100     0.7921      0.7600     0.1157     72.3661
02200     0.6694      0.7600     0.1167     78.1235
02300     0.6778      0.8100     0.1167     74.2487
02400     0.4028      0.8800     0.1171     79.8841
02500     0.3344      0.8900     0.1211     73.7142
02600     0.2686      0.9200     0.1236     72.0757
02700     0.6291      0.8000     0.1236     75.8193
02800     0.6075      0.8200     0.1238     74.8213
02900     0.4487      0.8700     0.1238     75.6392
03000     0.3913      0.8400     0.1238     77.2870
03100     0.6081      0.8300     0.1245     75.4400
03200     0.3988      0.8600     0.1399     74.3802
03300     0.3149      0.8900     0.1399     74.9213
03400     0.4075      0.8800     0.1399     78.1387
03500     0.5219      0.8100     0.1399     78.2595
03600     0.3407      0.9000     0.1399     77.7494
03700     0.5421      0.8200     0.1415     74.9956
03800     0.3729      0.8200     0.1415     73.3446
03900     0.3853      0.8900     0.1415     77.8427
04000     0.3436      0.9100     0.1415     72.9382
04100     0.2873      0.8900     0.1422     72.9933
04200     0.3197      0.8800     0.1422     73.3611
04300     0.2935      0.8900     0.1539     73.0603
04400     0.3668      0.8600     0.1539     72.3687
04500     0.3062      0.9300     0.1645     76.0196
04600     0.4110      0.8500     0.1645     78.2419
04700     0.5354      0.8000     0.1645     72.4996
04800     0.3628      0.8600     0.1645     73.1526
04900     0.4124      0.8700     0.1645     79.9784
05000     0.3655      0.8800     0.1645     78.5146
05100     0.4332      0.9100     0.1670     75.5048
05200     0.3624      0.8900     0.1670     77.7012
05300     0.3870      0.8600     0.1670     73.0590
05400     0.2708      0.9300     0.1670     73.5860
05500     0.3424      0.9000     0.1975     76.3679
05600     0.5645      0.8500     0.1975     74.8164
05700     0.4813      0.8000     0.1975     77.5691
05800     0.4766      0.8400     0.1975     73.1434
05900     0.2480      0.9200     0.1975     75.2004
06000     0.2988      0.9100     0.1982     74.9196
06100     0.5178      0.8200     0.1982     74.5645
06200     0.2435      0.9100     0.1982     76.1772
06300     0.3412      0.8800     0.1982     81.4851
06400     0.3094      0.9200     0.1982     76.9655
06500     0.4282      0.8700     0.1982     74.6940
06600     0.3846      0.8500     0.2067     75.4739
06700     0.4255      0.8500     0.2081     74.7310
06800     0.4988      0.8400     0.2335     73.0635
06900     0.2206      0.9100     0.2335     79.7216
07000     0.3403      0.8800     0.2335     73.0631
07100     0.1986      0.9600     0.2335     77.3576
07200     0.2131      0.9400     0.2335     71.2363
07300     0.2295      0.9400     0.2335     74.7248
07400     0.2494      0.9000     0.2351     74.7243
07500     0.1401      0.9700     0.2351     75.0265
07600     0.2455      0.9100     0.2384     76.6186
07700     0.3636      0.9100     0.2426     77.9347
07800     0.2341      0.9000     0.2426     75.3239
07900     0.3330      0.8600     0.2484     74.4855
08000     0.4267      0.8700     0.2484     73.8386
08100     0.2696      0.9300     0.2484     74.9090
08200     0.4004      0.8500     0.2616     75.5442
08300     0.1816      0.9200     0.2616     76.5285
08400     0.3672      0.8700     0.2616     78.3286
08500     0.3075      0.8900     0.2616     78.5888
08600     0.2976      0.9100     0.2616     71.9966
08700     0.2041      0.9600     0.2616     74.2000
08800     0.3201      0.9300     0.2616     72.9252
08900     0.2673      0.9300     0.2708     76.1681
09000     0.2876      0.8800     0.2708     75.0731
09100     0.1992      0.9500     0.2708     74.1779
09200     0.3205      0.9000     0.2708     75.0250
09300     0.3036      0.8700     0.2708     79.4849
09400     0.1502      0.9400     0.3053     76.5168
09500     0.2942      0.9000     0.3053     74.5566
09600     0.5673      0.8700     0.3053     72.9915
09700     0.2228      0.9200     0.3053     76.6419
09800     0.2807      0.9200     0.3053     76.1108
09900     0.2355      0.9500     0.3053     73.7185
10000     0.2923      0.9200     0.3053     78.1681
10100     0.2934      0.8700     0.3053     75.6216
10200     0.2041      0.9200     0.3053     76.5556
10300     0.2385      0.9100     0.3053     73.6576
10400     0.2292      0.8900     0.3053     78.3464
10500     0.2841      0.9200     0.3053     77.5001
10600     0.3275      0.9000     0.3053     72.7715
10700     0.2588      0.9200     0.3053     79.0570
10800     0.1677      0.9600     0.3053     77.8783
10900     0.3185      0.9200     0.3053     78.2158
11000     0.2374      0.9400     0.3053     75.9014
11100     0.1897      0.9200     0.3053     73.4150
11200     0.2915      0.9400     0.3053     77.1823
11300     0.3763      0.8600     0.3053     73.7211
11400     0.1687      0.9300     0.3053     72.8690
11500     0.2470      0.9200     0.3053     74.6056
11600     0.1219      0.9800     0.3053     78.1957
11700     0.1504      0.9600     0.3053     77.8003
11800     0.1991      0.9300     0.3053     77.0575
11900     0.1683      0.9400     0.3053     74.4801
12000     0.1750      0.9500     0.3053     73.1598
12100     0.1386      0.9700     0.3053     78.5809
12200     0.1237      0.9600     0.3053     80.1961
12300     0.1014      0.9600     0.3053     74.4777
12400     0.2229      0.9500     0.3053     75.3243
12500     0.1852      0.9500     0.3053     78.2940
12600     0.1010      0.9700     0.3053     76.5044
12700     0.1991      0.9200     0.3053     72.7214
12800     0.3390      0.8500     0.3053     74.0835
12900     0.2460      0.9100     0.3053     75.0896
13000     0.3311      0.9200     0.3053     77.4578
13100     0.2744      0.9300     0.3053     71.8963
13200     0.1337      0.9500     0.3053     75.7759
13300     0.1684      0.9300     0.3053     76.5046
13400     0.2429      0.9400     0.3102     73.0870
13500     0.2386      0.9200     0.3102     79.6966
13600     0.0728      0.9600     0.3102     75.2429
13700     0.2418      0.9300     0.3102     73.5702
13800     0.2229      0.9200     0.3102     72.5783
13900     0.1848      0.9100     0.3146     77.4225
14000     0.2055      0.9600     0.3146     75.6233
14100     0.1555      0.9500     0.3146     75.5838
14200     0.2486      0.9300     0.3146     76.4448
14300     0.1449      0.9200     0.3146     72.2093
14400     0.1990      0.9700     0.3146     74.6922
14500     0.1240      0.9700     0.3146     73.2097
14600     0.1796      0.9400     0.3146     75.3906
14700     0.1863      0.9200     0.3146     74.3156
14800     0.1953      0.9400     0.3146     74.7784
14900     0.2879      0.9100     0.3146     76.9706
15000     0.2928      0.9200     0.3146     75.9255
15100     0.3504      0.9000     0.3146     75.7474
15200     0.1529      0.9500     0.3146     78.6349
15300     0.1860      0.9400     0.3146     75.6562
15400     0.0604      0.9800     0.3146     77.2564
15500     0.1577      0.9400     0.3146     73.7519
15600     0.1620      0.9600     0.3146     74.0558
15700     0.1158      0.9600     0.3146     79.8521
15800     0.1651      0.9500     0.3146     80.1626
15900     0.1270      0.9800     0.3146     71.4473
16000     0.1051      0.9600     0.3146     73.3487
16100     0.2523      0.9100     0.3146     72.8446
16200     0.2500      0.9300     0.3146     75.1940
16300     0.3396      0.9200     0.3146     77.8079
16400     0.1591      0.9600     0.3146     73.4588
16500     0.0738      0.9700     0.3146     72.9224
16600     0.1108      0.9600     0.3146     74.0347
16700     0.1772      0.9300     0.3146     76.5365
16800     0.1272      0.9600     0.3146     77.7605
16900     0.1285      0.9700     0.3146     75.9902
17000     0.1211      0.9600     0.3146     80.6026
17100     0.3474      0.9100     0.3146     74.9440
17200     0.1073      0.9700     0.3146     75.4459
17300     0.1035      0.9600     0.3146     78.8508
17400     0.2054      0.9200     0.3146     77.8880
17500     0.2997      0.9300     0.3146     78.7949
17600     0.1723      0.9600     0.3146     72.3735
17700     0.1488      0.9300     0.3146     73.0786
17800     0.1765      0.9200     0.3146     75.7973
17900     0.1949      0.9500     0.3232     76.5503
18000     0.0941      0.9600     0.3232     77.0638
18100     0.2266      0.9300     0.3276     74.0522
18200     0.1460      0.9400     0.3276     72.2339
18300     0.1305      0.9400     0.3276     73.0363
18400     0.1358      0.9700     0.3336     74.8611
18500     0.2085      0.9700     0.3336     75.5191
18600     0.1258      0.9700     0.3336     72.8004
18700     0.1458      0.9300     0.3336     72.6643
18800     0.1118      0.9600     0.3336     79.6074
18900     0.1231      0.9500     0.3336     78.7978
19000     0.1184      0.9600     0.3336     79.6528
19100     0.0721      0.9700     0.3336     74.4299
19200     0.1323      0.9500     0.3336     71.8747
19300     0.1802      0.9500     0.3336     72.5060
19400     0.0704      0.9700     0.3336     73.4265
19500     0.2053      0.9500     0.3336     75.0300
19600     0.0799      0.9800     0.3336     73.4455
19700     0.2500      0.9400     0.3336     78.8143
19800     0.1080      0.9800     0.3336     80.5232
19900     0.1495      0.9400     0.3336     78.1956
20000     0.1511      0.9600     0.3336     73.8598
20100     0.2188      0.9400     0.3336     76.1528
20199     0.1735      0.9500     0.3336     74.5801
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     5.2486      0.2500     0.3013     19.1357
00100     1.9063      0.4100     0.4953     77.3516
00200     1.6294      0.5300     0.5929     72.8563
00300     1.4439      0.6600     0.6339     75.8072
00400     1.3037      0.6800     0.6743     71.1752
00500     0.9208      0.7400     0.6813     76.5625
00600     1.3828      0.6800     0.6814     74.7570
00700     1.2902      0.6800     0.6938     77.1546
00800     0.8900      0.8000     0.7121     73.0350
00900     1.0239      0.7400     0.7252     77.0960
01000     0.9859      0.6900     0.7409     75.2191
01100     0.7998      0.8000     0.7517     73.8983
01200     1.1006      0.7600     0.7517     70.9395
01300     0.8204      0.7700     0.7517     74.7295
01400     0.5992      0.8100     0.7517     76.9648
01500     1.2607      0.7000     0.7517     75.1956
01600     1.6713      0.6900     0.7543     74.5715
01700     0.7869      0.7800     0.7588     77.0871
01800     0.5773      0.8300     0.7606     77.1177
01900     1.0163      0.7800     0.7606     75.8300
02000     0.9437      0.8100     0.7750     74.3776
02100     1.3241      0.7700     0.7750     74.5464
02200     0.4801      0.8500     0.7750     77.0325
02300     0.9362      0.7900     0.7750     78.6084
02400     1.1402      0.6800     0.7898     76.5025
02500     0.8417      0.7800     0.7898     76.8616
02600     0.6206      0.8200     0.7898     74.9507
02700     0.7397      0.8000     0.7898     78.2545
02800     0.9527      0.7900     0.7898     77.8179
02900     0.6846      0.8000     0.7898     79.7168
03000     0.6509      0.8100     0.7898     73.5754
03100     0.9328      0.7700     0.7898     72.5890
03200     0.9018      0.8000     0.7898     75.8750
03300     0.6355      0.8200     0.7919     73.6187
03400     0.6544      0.8200     0.7941     78.7633
03500     0.4357      0.9000     0.7941     73.1570
03600     1.0562      0.7300     0.7941     75.7562
03700     0.8938      0.7600     0.7991     76.5607
03800     0.4428      0.8500     0.7991     77.2028
03900     1.0790      0.7100     0.7991     76.9263
04000     0.5120      0.8500     0.7991     77.2294
04100     0.6701      0.7500     0.7991     75.9329
04200     0.8727      0.7500     0.7991     74.8991
04300     0.8360      0.7300     0.7991     77.8902
04400     1.0659      0.7700     0.7991     74.8083
04500     0.6598      0.7900     0.7993     74.2222
04600     1.0515      0.7500     0.7994     75.8260
04700     1.0319      0.7500     0.7994     74.7630
04800     0.7453      0.8000     0.7994     72.8709
04900     0.6009      0.8400     0.7994     71.9338
05000     0.8084      0.8000     0.8057     72.9717
05100     0.6854      0.8300     0.8101     76.8704
05200     0.4611      0.8900     0.8101     77.8968
05300     0.8100      0.8200     0.8101     75.3893
05400     0.8780      0.7300     0.8150     74.6569
05500     0.8302      0.7800     0.8150     78.1307
05600     1.2018      0.7200     0.8150     75.0911
05700     0.8235      0.8000     0.8150     77.9481
05800     0.5267      0.8700     0.8150     78.3358
05900     0.5840      0.8100     0.8150     79.5271
06000     0.7136      0.7600     0.8150     73.7765
06100     0.5958      0.8600     0.8159     80.1488
06200     0.4576      0.8600     0.8196     78.7150
06300     0.8787      0.7800     0.8196     74.7468
06400     0.6804      0.8500     0.8196     75.8398
06500     0.7186      0.8000     0.8196     76.1679
06600     0.4008      0.8600     0.8196     75.9119
06700     0.6569      0.8300     0.8196     78.5871
06800     1.3940      0.7200     0.8196     71.6172
06900     1.0488      0.7700     0.8196     73.4909
07000     0.5555      0.8300     0.8196     76.7895
07100     0.5674      0.8500     0.8234     76.6010
07200     0.8080      0.7900     0.8234     74.9234
07300     0.5544      0.8400     0.8234     78.2536
07400     1.0875      0.7800     0.8234     73.7993
07500     0.6482      0.8400     0.8243     76.9318
07600     0.6480      0.8400     0.8243     75.0205
07700     0.6461      0.8300     0.8243     76.7723
07800     0.7545      0.8500     0.8243     77.8530
07900     0.8636      0.8300     0.8250     73.3655
08000     0.6167      0.8200     0.8250     76.1639
08100     0.8320      0.7700     0.8255     75.4371
08200     0.5457      0.8200     0.8305     78.3253
08300     0.4798      0.8900     0.8305     74.0744
08400     0.5720      0.8000     0.8305     72.6405
08500     0.6504      0.8300     0.8305     78.7334
08600     0.5156      0.8300     0.8305     75.2362
08700     0.7415      0.8500     0.8305     75.2655
08800     0.4607      0.8800     0.8317     75.2500
08900     0.6619      0.8300     0.8317     74.9519
09000     0.9306      0.7400     0.8317     78.6717
09100     0.4896      0.8600     0.8339     75.4170
09200     0.7601      0.8500     0.8339     77.1702
09300     0.5243      0.8700     0.8339     78.7719
09400     0.5644      0.8300     0.8339     75.3469
09500     0.7265      0.8200     0.8384     75.8288
09600     0.8414      0.7800     0.8384     72.4089
09700     0.6699      0.7700     0.8384     73.5200
09800     0.6567      0.8000     0.8384     77.5344
09900     0.5488      0.8300     0.8384     72.7110
Start testing:
Test Accuracy: 0.8857
