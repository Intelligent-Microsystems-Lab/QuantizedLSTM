Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=108, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=1, n_mfcc=40, n_msb=5, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=193012823, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
502c09f9-012f-4e13-80fe-9e0bff2a7cff
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 167, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 373, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 212, in forward
    gates = quant_pass(pact_a_bmm( quant_pass(pact_a_bmm(part1, self.a12), self.abMVM, self.a12) + quant_pass(pact_a_bmm(part2, self.a13), self.abMVM, self.a13), self.a14), self.abNM, self.a14)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 87, in forward
    x01 = torch.clamp(x_scaled,-1+(1./step_d),1-(1./step_d))
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 10.76 GiB total capacity; 9.60 GiB already allocated; 3.12 MiB free; 9.80 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=108, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=1, n_mfcc=40, n_msb=5, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=193012823, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
041d6b4d-0202-4cb4-953a-63764c65f3f8
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     3.2957      0.0781     0.0897     9.8628
00100     1.8230      0.3819     0.4571     56.8727
00200     1.2926      0.5844     0.6099     55.8974
00300     1.1432      0.6477     0.6929     56.3784
00400     1.0319      0.6624     0.7051     54.5161
00500     0.8418      0.7152     0.7500     53.7009
00600     0.7731      0.7595     0.7505     54.0510
00700     0.7818      0.7447     0.7722     53.4672
00800     0.8804      0.7236     0.7784     53.5537
00900     0.8336      0.7363     0.7784     53.4222
01000     0.7734      0.7532     0.7928     53.7508
01100     0.6899      0.7911     0.7981     53.7967
01200     0.7422      0.7700     0.8038     53.0856
01300     0.7088      0.7637     0.8038     53.1435
01400     0.7833      0.7426     0.8039     53.2218
01500     0.6798      0.7827     0.8039     53.0683
01600     0.7154      0.7658     0.8039     53.5384
01700     0.6743      0.7932     0.8117     53.2356
01800     0.6330      0.7996     0.8117     53.3852
01900     0.6240      0.7827     0.8138     54.3995
02000     0.6573      0.7764     0.8138     53.7227
02100     0.5992      0.8207     0.8138     53.8306
02200     0.6961      0.7827     0.8138     53.6704
02300     0.7080      0.7574     0.8168     53.1576
02400     0.4960      0.8354     0.8168     53.6279
02500     0.6179      0.7869     0.8227     53.0076
02600     0.7127      0.7890     0.8227     53.0606
02700     0.6024      0.8122     0.8353     53.9909
02800     0.6800      0.7848     0.8353     54.9783
02900     0.6128      0.8080     0.8353     54.3403
03000     0.5873      0.8059     0.8353     54.6325
03100     0.6103      0.7932     0.8353     54.9800
03200     0.6590      0.8038     0.8353     56.2592
03300     0.5786      0.8122     0.8353     55.0059
03400     0.5436      0.8143     0.8353     55.5305
03500     0.6693      0.7869     0.8353     55.5429
03600     0.6147      0.8165     0.8353     54.9715
03700     0.6336      0.7869     0.8353     56.1443
03800     0.6063      0.7848     0.8353     56.5851
03900     0.5729      0.8291     0.8353     56.4017
04000     0.5437      0.8397     0.8353     56.0982
04100     0.5802      0.8249     0.8353     55.6424
04200     0.6361      0.8080     0.8353     55.4059
04300     0.5654      0.8143     0.8353     55.8867
04400     0.6423      0.7869     0.8353     56.1421
04500     0.4881      0.8481     0.8353     55.7417
04600     0.5297      0.8228     0.8353     55.7118
04700     0.5857      0.8207     0.8353     55.1914
04800     0.5920      0.8291     0.8353     56.8557
04900     0.5323      0.8460     0.8353     55.4056
05000     0.5461      0.8143     0.8353     55.3245
05100     0.4963      0.8481     0.8353     56.0048
05200     0.5204      0.8333     0.8353     55.2873
05300     0.5066      0.8397     0.8353     55.4464
05400     0.5530      0.8270     0.8353     55.9643
05500     0.5580      0.8207     0.8438     55.7071
05600     0.5491      0.8312     0.8451     56.1688
05700     0.5138      0.8502     0.8451     56.2422
05800     0.5273      0.8270     0.8451     55.5274
05900     0.4960      0.8439     0.8451     56.1266
06000     0.4922      0.8312     0.8451     55.7106
06100     0.5544      0.8080     0.8451     55.8005
06200     0.5691      0.8354     0.8451     56.2964
06300     0.5633      0.8249     0.8451     55.3706
06400     0.4846      0.8376     0.8451     56.5089
06500     0.5316      0.8270     0.8451     55.5629
06600     0.5266      0.8333     0.8451     56.0825
06700     0.5447      0.8270     0.8451     56.0075
06800     0.5030      0.8418     0.8451     55.2122
06900     0.4960      0.8523     0.8451     55.7534
07000     0.4746      0.8376     0.8451     56.1504
07100     0.5403      0.8291     0.8451     55.6318
07200     0.5422      0.8333     0.8451     56.1127
07300     0.5188      0.8270     0.8451     55.6950
07400     0.5791      0.8080     0.8451     55.2339
07500     0.4904      0.8608     0.8451     55.6199
07600     0.4942      0.8291     0.8451     55.3287
07700     0.4204      0.8650     0.8451     55.3647
07800     0.4742      0.8439     0.8451     55.7491
07900     0.5327      0.8418     0.8451     55.2302
08000     0.4627      0.8481     0.8451     56.0946
08100     0.5687      0.8017     0.8451     55.4443
08200     0.4769      0.8439     0.8451     55.5515
08300     0.4550      0.8523     0.8451     55.6543
08400     0.5151      0.8376     0.8451     55.7797
08500     0.4451      0.8734     0.8451     55.3664
08600     0.5716      0.8059     0.8451     55.9374
08700     0.4730      0.8354     0.8451     55.6944
08800     0.3885      0.8692     0.8451     56.2417
08900     0.5581      0.8207     0.8451     55.4066
09000     0.5106      0.8207     0.8451     55.1730
09100     0.4705      0.8565     0.8451     55.9045
09200     0.4398      0.8776     0.8451     55.9372
09300     0.4799      0.8439     0.8451     55.9159
09400     0.5235      0.8312     0.8451     56.7806
09500     0.4363      0.8755     0.8451     55.6935
09600     0.4890      0.8418     0.8451     55.7131
09700     0.5171      0.8228     0.8451     56.0512
09800     0.4046      0.8713     0.8451     55.4951
09900     0.4756      0.8439     0.8451     55.8497
10000     0.5266      0.8186     0.8451     55.8244
10100     0.5013      0.8228     0.8451     55.6295
10200     0.4307      0.8586     0.8451     56.1810
10300     0.4840      0.8418     0.8451     55.1745
10400     0.4361      0.8650     0.8451     56.1764
10500     0.4228      0.8650     0.8451     55.7429
10600     0.4472      0.8734     0.8451     55.8302
10700     0.3731      0.8819     0.8451     56.6274
10800     0.5078      0.8376     0.8451     55.8529
10900     0.5307      0.8249     0.8451     55.6049
11000     0.4015      0.8565     0.8451     56.4194
11100     0.4021      0.8776     0.8451     54.9718
11200     0.4453      0.8671     0.8451     55.9174
11300     0.4190      0.8671     0.8451     55.4264
11400     0.5782      0.8312     0.8451     55.1437
11500     0.4383      0.8819     0.8451     55.8057
11600     0.4797      0.8291     0.8451     56.0298
11700     0.3419      0.8861     0.8451     55.7555
11800     0.3797      0.8692     0.8451     56.3878
11900     0.4363      0.8565     0.8451     55.3810
12000     0.4038      0.8734     0.8451     56.0629
12100     0.3984      0.8734     0.8451     56.1869
12200     0.4203      0.8797     0.8451     56.1151
12300     0.4251      0.8502     0.8451     56.2179
12400     0.3780      0.8903     0.8451     56.0192
12500     0.4836      0.8502     0.8451     55.6281
12600     0.3832      0.8734     0.8451     55.8659
12700     0.4395      0.8544     0.8451     55.9322
12800     0.4076      0.8671     0.8451     56.1745
12900     0.4345      0.8565     0.8451     56.2618
13000     0.4593      0.8376     0.8451     56.9480
13100     0.4077      0.8650     0.8451     56.4512
13200     0.4124      0.8840     0.8451     56.1191
13300     0.4603      0.8692     0.8451     55.7106
13400     0.3719      0.8797     0.8451     55.6484
13500     0.4151      0.8629     0.8451     55.2974
13600     0.3966      0.8797     0.8451     56.2573
13700     0.3949      0.8776     0.8451     55.1740
13800     0.3913      0.8861     0.8451     55.5023
13900     0.4106      0.8629     0.8451     55.6363
14000     0.3964      0.8755     0.8451     55.2647
14100     0.3949      0.8671     0.8451     55.6439
14200     0.3524      0.9008     0.8451     56.2959
14300     0.3925      0.8713     0.8451     55.8659
14400     0.3373      0.8945     0.8451     55.9397
14500     0.4319      0.8586     0.8451     55.8901
14600     0.4427      0.8586     0.8451     55.9325
14700     0.4390      0.8629     0.8451     55.9015
14800     0.3736      0.8861     0.8451     55.6450
14900     0.3812      0.8776     0.8451     55.8631
15000     0.3972      0.8797     0.8451     55.4927
15100     0.4212      0.8629     0.8451     55.4504
15200     0.4236      0.8734     0.8451     55.6426
15300     0.4031      0.8713     0.8451     55.6010
15400     0.3391      0.9008     0.8451     55.3734
15500     0.3718      0.8797     0.8451     56.0124
15600     0.3722      0.8819     0.8451     55.0614
15700     0.3779      0.8840     0.8451     55.5351
15800     0.4093      0.8544     0.8451     55.8449
15900     0.4341      0.8692     0.8451     55.4952
16000     0.5190      0.8354     0.8451     55.6294
16100     0.4032      0.8629     0.8451     55.3626
16200     0.3846      0.8797     0.8451     55.3468
16300     0.3585      0.8882     0.8451     55.6878
16400     0.3337      0.9030     0.8451     55.3102
16500     0.4308      0.8565     0.8451     55.7573
16600     0.3792      0.8819     0.8451     56.5364
16700     0.4363      0.8650     0.8451     55.5635
16800     0.4114      0.8692     0.8451     56.1375
16900     0.4266      0.8608     0.8451     55.1053
17000     0.3738      0.8755     0.8451     55.7080
17100     0.3839      0.8776     0.8451     56.0495
17200     0.3816      0.8882     0.8451     55.0893
17300     0.3717      0.8713     0.8451     55.2758
17400     0.3746      0.8861     0.8451     55.4229
17500     0.3683      0.8797     0.8451     55.2437
17600     0.3222      0.9135     0.8451     55.6076
17700     0.4482      0.8523     0.8451     55.4777
17800     0.3482      0.8861     0.8451     55.1035
17900     0.3432      0.8903     0.8451     55.2463
18000     0.3888      0.8945     0.8451     55.3599
18100     0.4119      0.8671     0.8451     55.2477
18200     0.3773      0.8861     0.8451     55.9631
18300     0.4004      0.8819     0.8451     54.9564
18400     0.3582      0.8797     0.8451     55.5601
18500     0.4232      0.8650     0.8451     55.1647
18600     0.3729      0.8861     0.8451     55.8195
18700     0.3257      0.9008     0.8451     55.7381
18800     0.4103      0.8650     0.8451     55.2355
18900     0.3026      0.8966     0.8451     55.0420
19000     0.3057      0.9114     0.8451     55.8110
19100     0.3798      0.8861     0.8451     55.4958
19200     0.4052      0.8734     0.8451     56.0405
19300     0.4075      0.8692     0.8451     55.5428
19400     0.3405      0.8987     0.8451     55.9445
19500     0.3798      0.8819     0.8451     55.9061
19600     0.4033      0.8882     0.8451     55.7309
19700     0.3991      0.8523     0.8451     55.8818
19800     0.5083      0.8544     0.8451     55.9592
19900     0.3897      0.8734     0.8451     55.4846
20000     0.3519      0.9030     0.8451     55.9420
20100     0.4443      0.8523     0.8451     55.6901
20199     0.3816      0.8713     0.8451     54.8007
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     0.7369      0.7932     0.7604     8.6909
00100     0.3809      0.8924     0.8708     55.7956
00200     0.4767      0.8439     0.8711     55.1075
00300     0.4120      0.8755     0.8791     55.5328
00400     0.4159      0.8713     0.8791     55.5603
00500     0.4516      0.8650     0.8791     54.9596
00600     0.3903      0.8776     0.8791     55.7368
00700     0.3551      0.8819     0.8791     55.0863
00800     0.4339      0.8650     0.8791     55.1759
00900     0.3505      0.8924     0.8791     55.8783
01000     0.3703      0.8966     0.8791     55.3619
01100     0.4308      0.8629     0.8791     56.1071
01200     0.3757      0.8861     0.8791     55.3335
01300     0.3874      0.8797     0.8791     54.9980
01400     0.4320      0.8734     0.8791     55.2225
01500     0.4215      0.8713     0.8791     56.1381
01600     0.4389      0.8629     0.8804     55.8068
01700     0.3902      0.8776     0.8804     55.8825
01800     0.4053      0.8586     0.8804     55.0362
01900     0.4339      0.8692     0.8804     56.2454
02000     0.3719      0.8861     0.8804     55.3315
02100     0.4312      0.8586     0.8804     55.7257
02200     0.3715      0.8713     0.8843     55.9605
02300     0.3546      0.8903     0.8843     55.2410
02400     0.3599      0.8819     0.8843     56.0880
02500     0.3813      0.8819     0.8843     56.3527
02600     0.5139      0.8481     0.8843     55.2901
02700     0.3474      0.8882     0.8843     55.7338
02800     0.4115      0.8713     0.8843     55.3268
02900     0.4445      0.8776     0.8843     55.3850
03000     0.3765      0.8797     0.8843     56.4462
03100     0.4076      0.8586     0.8843     55.2326
03200     0.4544      0.8608     0.8843     55.2341
03300     0.3874      0.8840     0.8843     55.9493
03400     0.3901      0.8608     0.8843     56.3518
03500     0.4027      0.8608     0.8843     56.3586
03600     0.3582      0.8861     0.8843     55.7353
03700     0.4024      0.8840     0.8843     55.7439
03800     0.3853      0.8734     0.8843     56.1347
03900     0.3976      0.8840     0.8843     55.7989
04000     0.3986      0.8650     0.8843     55.8026
04100     0.3321      0.9030     0.8843     56.1441
04200     0.4025      0.8713     0.8843     55.5594
04300     0.3632      0.8882     0.8843     55.6504
04400     0.3766      0.8861     0.8843     54.8268
04500     0.4090      0.8776     0.8843     55.5663
04600     0.4102      0.8671     0.8843     55.7417
04700     0.3467      0.8882     0.8843     55.5842
04800     0.3761      0.8840     0.8843     55.2970
04900     0.4002      0.8776     0.8843     55.8073
05000     0.3735      0.8650     0.8843     55.6556
05100     0.3746      0.8861     0.8843     56.0217
05200     0.4189      0.8586     0.8843     55.7975
05300     0.3723      0.8797     0.8843     55.4712
05400     0.4073      0.8797     0.8843     56.4938
05500     0.4692      0.8376     0.8843     55.8228
05600     0.4100      0.8713     0.8843     55.7761
05700     0.4218      0.8650     0.8843     57.1104
05800     0.3075      0.9008     0.8843     55.2258
05900     0.3477      0.8924     0.8843     55.4790
06000     0.3070      0.9030     0.8843     55.5611
06100     0.3376      0.8882     0.8843     55.7468
06200     0.3823      0.8650     0.8843     55.4942
06300     0.3542      0.9008     0.8843     55.5529
06400     0.5016      0.8502     0.8843     55.5451
06500     0.3990      0.8840     0.8843     56.1049
06600     0.4309      0.8692     0.8843     55.6137
06700     0.4578      0.8544     0.8843     55.4452
06800     0.3804      0.8840     0.8843     56.1980
06900     0.4236      0.8629     0.8843     55.6346
07000     0.3744      0.8861     0.8843     56.1839
07100     0.3828      0.8776     0.8843     55.1928
07200     0.4667      0.8650     0.8843     55.2421
07300     0.3832      0.8861     0.8843     55.9360
07400     0.3980      0.8797     0.8843     55.3760
07500     0.3455      0.9008     0.8843     56.2032
07600     0.3426      0.8882     0.8843     55.3876
07700     0.4002      0.8840     0.8843     55.7134
07800     0.3661      0.8945     0.8843     55.8054
07900     0.3912      0.8671     0.8843     54.8849
08000     0.3680      0.8840     0.8843     55.1779
08100     0.4276      0.8713     0.8843     55.4000
08200     0.3839      0.8734     0.8843     55.4696
08300     0.3840      0.8776     0.8843     56.0292
08400     0.3786      0.8734     0.8843     55.5785
08500     0.3981      0.8713     0.8855     55.6067
08600     0.3893      0.8840     0.8855     56.0293
08700     0.4103      0.8671     0.8855     55.4886
08800     0.3820      0.8797     0.8855     55.9301
08900     0.4145      0.8671     0.8855     56.1814
09000     0.4299      0.8586     0.8855     55.8381
09100     0.4014      0.8819     0.8855     55.6569
09200     0.3615      0.8840     0.8855     55.7523
09300     0.3911      0.8755     0.8855     56.0713
09400     0.4533      0.8376     0.8855     55.7912
09500     0.3505      0.8903     0.8855     55.9093
09600     0.4569      0.8671     0.8855     55.4284
09700     0.3690      0.8692     0.8855     56.1482
09800     0.4008      0.8840     0.8855     56.1595
09900     0.3742      0.8671     0.8855     56.7693
Start testing:
Test Accuracy: 0.8725
