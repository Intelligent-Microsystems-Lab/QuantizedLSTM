Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=194, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=8627169, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
43c0cf6a-7502-400a-9ec5-5aa4e5cec591
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 167, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 290, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 213, in forward
    gates = quant_pass(pact_a_bmm( quant_pass(pact_a_bmm(part1, self.a12), self.abMVM, self.a12) + quant_pass(pact_a_bmm(part2, self.a13), self.abMVM, self.a13), self.a14), self.abNM, self.a14)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 124, in pact_a_bmm
    return torch.sign(x) * .5 * (torch.abs(x) - torch.abs(torch.abs(x) - a) + a)
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 10.76 GiB total capacity; 9.54 GiB already allocated; 15.12 MiB free; 9.79 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=194, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=8627169, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
0e7bfcaf-0267-42aa-951b-5beb0798af2f
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     2.6867      0.1100     0.0789     19.9428
00100     1.7302      0.3900     0.0984     74.1180
00200     1.2579      0.5900     0.0987     74.3560
00300     0.9366      0.6600     0.1025     73.1475
00400     0.7914      0.7800     0.1030     73.6776
00500     0.7273      0.8000     0.1164     73.1672
00600     0.8939      0.7000     0.1164     72.9227
00700     0.7882      0.7200     0.1164     73.2502
00800     0.5856      0.7900     0.1164     72.1134
00900     0.6270      0.8000     0.1164     71.8390
01000     0.7705      0.8000     0.1164     73.4015
01100     0.6852      0.7800     0.1196     72.4561
01200     0.6110      0.8200     0.1254     73.3046
01300     0.5761      0.8600     0.1254     73.7918
01400     0.6266      0.8000     0.1254     73.1395
01500     0.6264      0.8200     0.1370     72.8705
01600     0.4243      0.8700     0.1370     73.6085
01700     0.4814      0.8300     0.1370     72.5399
01800     0.5454      0.8100     0.1370     73.0536
01900     0.4323      0.8400     0.1370     73.6172
02000     0.4761      0.8500     0.1370     73.5692
02100     0.5220      0.8600     0.1370     73.9331
02200     0.5089      0.8800     0.1370     73.7136
02300     0.5820      0.8200     0.1385     74.6569
02400     0.4519      0.8500     0.1457     73.4043
02500     0.4216      0.8600     0.1457     72.0530
02600     0.3312      0.8800     0.1457     74.2640
02700     0.3733      0.8700     0.1457     73.2177
02800     0.5289      0.8500     0.1457     73.2711
02900     0.4910      0.8400     0.1544     73.6831
03000     0.4062      0.8600     0.1544     74.2167
03100     0.4593      0.8700     0.1556     73.1164
03200     0.4739      0.8700     0.1556     74.2823
03300     0.5414      0.8400     0.1564     74.2616
03400     0.4298      0.8900     0.1654     72.7090
03500     0.3999      0.8900     0.1654     73.1052
03600     0.3423      0.9200     0.1654     73.1395
03700     0.4902      0.8200     0.1654     73.9323
03800     0.3189      0.9200     0.1684     73.7047
03900     0.3499      0.8800     0.1717     72.1145
04000     0.3641      0.9100     0.1760     72.4545
04100     0.4291      0.8800     0.1760     74.2173
04200     0.3222      0.9300     0.1842     73.6469
04300     0.2888      0.9300     0.1842     73.4615
04400     0.2895      0.9300     0.1842     74.2331
04500     0.4132      0.8700     0.1842     73.9910
04600     0.3526      0.8800     0.1864     73.1297
04700     0.2010      0.9500     0.1864     74.3588
04800     0.3365      0.9000     0.1934     75.3231
04900     0.2730      0.9200     0.1947     76.1865
05000     0.3996      0.8600     0.2043     74.0364
05100     0.3286      0.9000     0.2043     73.8923
05200     0.4096      0.8800     0.2190     73.7855
05300     0.4942      0.8400     0.2190     73.9289
05400     0.3188      0.9300     0.2190     74.4730
05500     0.4578      0.8700     0.2223     73.7937
05600     0.4461      0.8200     0.2355     73.5664
05700     0.3213      0.8900     0.2355     74.1929
05800     0.3158      0.9100     0.2355     73.0338
05900     0.2445      0.9200     0.2355     72.7135
06000     0.4443      0.8700     0.2355     74.5600
06100     0.2824      0.9200     0.2355     74.0284
06200     0.4055      0.8700     0.2355     72.4686
06300     0.5656      0.8400     0.2355     74.2552
06400     0.3641      0.8900     0.2355     74.0746
06500     0.3132      0.9100     0.2355     73.6195
06600     0.4282      0.8800     0.2417     73.4400
06700     0.3927      0.9100     0.2472     74.3145
06800     0.4520      0.8700     0.2480     74.8361
06900     0.6223      0.8400     0.2480     73.4489
07000     0.2974      0.9400     0.2480     74.5245
07100     0.2402      0.9000     0.2480     73.7921
07200     0.2951      0.9200     0.2480     72.6333
07300     0.3772      0.9200     0.2480     73.3443
07400     0.4058      0.8800     0.2577     73.0501
07500     0.3408      0.9200     0.2617     73.9697
07600     0.4258      0.8500     0.2799     73.9263
07700     0.4812      0.8800     0.2858     74.2564
07800     0.4996      0.8500     0.2858     74.6300
07900     0.2909      0.9100     0.2858     74.1272
08000     0.3917      0.8800     0.2858     73.1766
08100     0.2548      0.9400     0.2858     74.2351
08200     0.3224      0.9100     0.2858     73.5503
08300     0.2166      0.9100     0.2858     72.8576
08400     0.3290      0.9200     0.2858     73.6953
08500     0.3232      0.9100     0.2858     74.2083
08600     0.1682      0.9600     0.3039     74.3986
08700     0.3842      0.8800     0.3243     73.8264
08800     0.2167      0.9500     0.3422     73.2872
08900     0.1267      0.9600     0.3422     73.9179
09000     0.2898      0.9500     0.3422     73.9350
09100     0.2738      0.9200     0.3422     72.8101
09200     0.1755      0.9600     0.3422     74.2997
09300     0.2062      0.9300     0.3598     72.8492
09400     0.3608      0.9000     0.3598     73.0262
09500     0.1303      0.9900     0.3598     73.8013
09600     0.2986      0.9100     0.3598     73.2035
09700     0.3481      0.9200     0.3598     74.8777
09800     0.1739      0.9400     0.3836     72.9487
09900     0.3399      0.9000     0.3836     74.2744
10000     0.2452      0.9200     0.3836     72.8023
10100     0.2279      0.9500     0.3836     73.4923
10200     0.2347      0.9000     0.3836     73.3173
10300     0.2788      0.9200     0.3836     73.1487
10400     0.2101      0.9500     0.3836     74.0337
10500     0.3078      0.9000     0.3836     72.8211
10600     0.2451      0.9700     0.3836     74.5258
10700     0.2436      0.9300     0.3836     74.1010
10800     0.1998      0.9500     0.3836     72.9339
10900     0.2042      0.9400     0.3836     75.3760
11000     0.1071      0.9800     0.3836     74.9514
11100     0.1593      0.9500     0.3836     73.8212
11200     0.1968      0.9600     0.3836     74.0666
11300     0.2397      0.9200     0.3836     73.6942
11400     0.2888      0.9300     0.3836     73.1452
11500     0.2000      0.9400     0.3836     73.6311
11600     0.1880      0.9600     0.3836     74.6050
11700     0.2207      0.9300     0.3836     72.9978
11800     0.1850      0.9300     0.3836     75.0286
11900     0.1745      0.9600     0.3836     73.8198
12000     0.2364      0.9300     0.3836     73.8538
12100     0.2568      0.9200     0.3836     74.7048
12200     0.2801      0.9200     0.3836     73.8594
12300     0.2117      0.9300     0.3836     73.5040
12400     0.2059      0.9300     0.3836     74.6556
12500     0.2998      0.9100     0.3836     73.5594
12600     0.3613      0.8800     0.3836     72.3303
12700     0.2819      0.9200     0.3836     74.5251
12800     0.3247      0.9000     0.3836     73.0819
12900     0.1978      0.9400     0.3836     73.4512
13000     0.1363      0.9800     0.3836     74.3268
13100     0.1720      0.9500     0.3836     73.4559
13200     0.1595      0.9500     0.3836     73.1981
13300     0.2833      0.9200     0.3836     73.5772
13400     0.2040      0.9500     0.3836     73.4965
13500     0.2883      0.9100     0.3836     74.3269
13600     0.2132      0.9300     0.3836     74.0794
13700     0.1276      0.9700     0.3836     73.3242
13800     0.1821      0.9600     0.3836     73.7138
13900     0.3883      0.8600     0.3836     74.9710
14000     0.1321      0.9800     0.3836     74.5660
14100     0.1461      0.9600     0.3836     74.9538
14200     0.2293      0.9600     0.3836     72.5260
14300     0.2384      0.9200     0.3836     73.5803
14400     0.1678      0.9600     0.3836     73.9437
14500     0.1057      0.9700     0.3836     74.3763
14600     0.1674      0.9500     0.3836     73.6887
14700     0.1558      0.9400     0.3836     74.8218
14800     0.2060      0.9500     0.3836     73.6563
14900     0.2905      0.9100     0.3836     73.5259
15000     0.2497      0.9600     0.3836     73.5813
15100     0.2680      0.9300     0.3836     74.1308
15200     0.2443      0.9400     0.3872     73.8085
15300     0.1379      0.9600     0.3872     73.1716
15400     0.3059      0.9100     0.3872     73.0961
15500     0.1098      0.9800     0.3872     72.9411
15600     0.1154      0.9800     0.3872     74.2892
15700     0.1775      0.9400     0.3872     74.8518
15800     0.2311      0.9400     0.3872     74.5015
15900     0.2894      0.9300     0.3872     73.0913
16000     0.3250      0.8900     0.3872     72.9388
16100     0.2211      0.9400     0.3872     72.8025
16200     0.1577      0.9600     0.3872     72.9945
16300     0.1931      0.9400     0.3872     75.6762
16400     0.1482      0.9600     0.3872     75.3693
16500     0.1663      0.9700     0.3872     73.0791
16600     0.2319      0.9300     0.3872     73.1769
16700     0.1168      0.9800     0.3872     73.4392
16800     0.2413      0.9200     0.3872     73.1323
16900     0.1967      0.9500     0.3872     73.9095
17000     0.1644      0.9300     0.3872     74.1108
17100     0.2389      0.9200     0.3872     75.2134
17200     0.2857      0.9300     0.3872     72.6794
17300     0.1759      0.9400     0.3872     73.2211
17400     0.1611      0.9700     0.3872     73.9368
17500     0.0953      0.9800     0.3872     74.2058
17600     0.2080      0.9400     0.3872     73.2162
17700     0.2848      0.9000     0.3872     74.5175
17800     0.2702      0.9000     0.3872     73.7316
17900     0.1388      0.9600     0.3872     74.7559
18000     0.2209      0.9500     0.3872     74.1267
18100     0.1444      0.9900     0.3872     73.9491
18200     0.2494      0.9300     0.3872     73.5438
18300     0.1678      0.9500     0.3872     72.9675
18400     0.1906      0.9500     0.3872     74.1046
18500     0.1467      0.9700     0.3872     72.5703
18600     0.1417      0.9600     0.3872     72.8734
18700     0.1724      0.9400     0.3872     74.9869
18800     0.2417      0.9400     0.3872     72.5198
18900     0.1576      0.9600     0.3872     73.4839
19000     0.1790      0.9600     0.3872     73.2492
19100     0.1006      0.9900     0.3872     73.8154
19200     0.0741      0.9700     0.3872     72.7750
19300     0.2526      0.9600     0.3872     74.0489
19400     0.2077      0.9600     0.3872     73.2024
19500     0.2452      0.9500     0.3872     72.4305
19600     0.1286      0.9700     0.3872     72.7323
19700     0.1824      0.9600     0.3872     73.8254
19800     0.1535      0.9500     0.3872     73.6422
19900     0.2071      0.9400     0.3872     74.4580
20000     0.1615      0.9600     0.3872     72.7733
20100     0.1206      0.9800     0.3872     72.6242
20199     0.1807      0.9400     0.3872     72.3649
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     2.8297      0.3300     0.3463     18.3186
00100     1.5808      0.5400     0.5331     74.0473
00200     1.9296      0.5600     0.6131     73.4335
00300     1.0755      0.7000     0.6703     73.7429
00400     0.7208      0.7800     0.6921     74.2110
00500     1.1392      0.7000     0.7028     73.2475
00600     1.1742      0.6600     0.7323     73.7299
00700     0.9414      0.7900     0.7404     73.4385
00800     0.8150      0.7800     0.7404     73.7053
00900     0.6383      0.8000     0.7516     72.9012
01000     0.9741      0.7300     0.7516     72.7809
01100     0.9275      0.7400     0.7681     73.6264
01200     1.2545      0.7000     0.7687     73.9380
01300     1.0627      0.7100     0.7732     74.1229
01400     0.6167      0.8300     0.7769     74.2912
01500     0.6594      0.7900     0.7769     73.5733
01600     0.8581      0.7200     0.7769     74.5146
01700     0.7399      0.8300     0.7780     73.2855
01800     0.9730      0.7000     0.7780     73.8390
01900     0.9862      0.7300     0.7831     73.6995
02000     0.4336      0.8600     0.7831     74.6702
02100     0.7435      0.7700     0.7832     74.0987
02200     0.7775      0.8000     0.7902     73.8291
02300     0.6942      0.8100     0.7902     73.0019
02400     0.7500      0.7900     0.7902     73.6088
02500     0.7386      0.8200     0.7997     73.7700
02600     0.8397      0.7600     0.8041     73.8904
02700     0.7239      0.8000     0.8041     75.2649
02800     0.7336      0.8000     0.8041     73.5707
02900     0.7190      0.7800     0.8041     73.6877
03000     1.3166      0.7100     0.8041     74.7174
03100     0.5666      0.8300     0.8041     73.6814
03200     0.7775      0.8000     0.8041     74.6778
03300     0.4747      0.8600     0.8041     73.8445
03400     0.9413      0.7800     0.8041     74.4855
03500     0.7138      0.7900     0.8046     73.5951
03600     0.7702      0.7900     0.8161     74.0599
03700     0.8476      0.7800     0.8161     72.9672
03800     0.9055      0.7500     0.8161     72.8675
03900     0.5426      0.8200     0.8161     74.4778
04000     0.5361      0.8300     0.8161     73.8648
04100     0.7849      0.7900     0.8161     72.4587
04200     0.7343      0.7500     0.8161     73.9115
04300     0.6661      0.7600     0.8161     72.8247
04400     0.6173      0.8200     0.8164     74.1504
04500     0.5347      0.8300     0.8164     74.0424
04600     0.9005      0.7600     0.8164     73.6586
04700     0.5247      0.8600     0.8225     74.9160
04800     0.6187      0.8300     0.8229     74.1971
04900     0.5438      0.8300     0.8232     74.5385
05000     0.6353      0.8800     0.8232     76.4415
05100     0.8553      0.7800     0.8232     74.9897
05200     0.5741      0.8100     0.8232     73.8841
05300     0.7233      0.7600     0.8232     74.4698
05400     0.6459      0.8500     0.8232     74.4395
05500     0.6217      0.8300     0.8232     73.5696
05600     0.5746      0.8600     0.8232     73.3593
05700     0.9681      0.7600     0.8232     73.3220
05800     0.5165      0.8400     0.8232     74.5836
05900     0.4840      0.8500     0.8232     73.7575
06000     0.7291      0.7600     0.8232     74.8158
06100     0.8856      0.7500     0.8241     75.2225
06200     0.7803      0.7400     0.8241     72.9810
06300     0.6503      0.7800     0.8241     72.6041
06400     0.8688      0.7800     0.8241     73.4150
06500     0.5217      0.8600     0.8257     73.0337
06600     0.4819      0.8500     0.8289     73.2380
06700     0.6655      0.7900     0.8289     73.2839
06800     0.7440      0.7600     0.8289     72.8057
06900     0.7066      0.8600     0.8289     73.3529
07000     0.6345      0.8100     0.8289     72.5698
07100     0.5730      0.8400     0.8289     73.8424
07200     0.4761      0.8500     0.8299     73.4949
07300     0.7457      0.8200     0.8332     72.7048
07400     0.5254      0.8300     0.8332     73.6340
07500     0.3823      0.8500     0.8332     73.8063
07600     0.6509      0.7700     0.8332     74.0643
07700     0.8146      0.8200     0.8332     73.7899
07800     0.4128      0.8700     0.8332     73.1409
07900     0.5084      0.8900     0.8332     74.5192
08000     0.7247      0.8000     0.8332     73.8461
08100     0.3908      0.8800     0.8332     74.5211
08200     0.9709      0.7700     0.8332     74.1078
08300     0.3984      0.8900     0.8332     73.9374
08400     0.6196      0.8300     0.8332     73.5440
08500     0.6382      0.8100     0.8332     74.9914
08600     0.9581      0.7500     0.8332     74.8715
08700     0.4778      0.8500     0.8332     75.5599
08800     0.5462      0.8500     0.8355     73.8252
08900     0.3649      0.8900     0.8355     73.5229
09000     0.3804      0.8700     0.8355     74.1688
09100     0.5970      0.8400     0.8355     73.5479
09200     0.6451      0.8400     0.8384     73.8154
09300     0.4839      0.8500     0.8384     72.7300
09400     0.5808      0.8400     0.8384     73.8492
09500     0.5860      0.7900     0.8384     74.3563
09600     0.5703      0.8800     0.8384     74.5906
09700     0.4209      0.8800     0.8384     71.4762
09800     0.5486      0.8500     0.8459     71.9717
09900     0.5380      0.8400     0.8459     70.4976
Start testing:
Test Accuracy: 0.8806
