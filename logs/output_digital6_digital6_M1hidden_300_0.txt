Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=294, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=193012823, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
b39ea981-ffde-4080-9d18-40be2e059d60
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 167, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 374, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 213, in forward
    gates = quant_pass(pact_a_bmm( quant_pass(pact_a_bmm(part1, self.a12), self.abMVM, self.a12) + quant_pass(pact_a_bmm(part2, self.a13), self.abMVM, self.a13), self.a14), self.abNM, self.a14)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 89, in forward
    x01q =  torch.round(x01 * step_d ) / step_d
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 22.17 GiB total capacity; 20.85 GiB already allocated; 12.50 MiB free; 21.18 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=294, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=193012823, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
f6d302b1-aa38-4713-9b33-f6b9b5b44ac9
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     3.3252      0.0900     0.0768     16.8482
00100     1.7350      0.4200     0.0905     61.9414
00200     1.5007      0.4700     0.0927     63.5056
00300     1.2570      0.6000     0.0961     62.2618
00400     1.0510      0.6500     0.1017     63.4590
00500     0.8064      0.7600     0.1017     57.8857
00600     0.7837      0.7400     0.1017     57.9118
00700     0.7142      0.8100     0.1032     58.5765
00800     0.7689      0.8100     0.1032     61.2632
00900     0.5960      0.7800     0.1032     60.1116
01000     0.6179      0.8000     0.1032     60.1321
01100     0.9837      0.7500     0.1048     58.3729
01200     0.6408      0.7900     0.1056     57.6689
01300     0.6620      0.8000     0.1056     62.5575
01400     0.4342      0.8200     0.1056     57.8668
01500     0.5026      0.7800     0.1109     62.0787
01600     0.4109      0.8600     0.1109     57.9290
01700     0.5801      0.8100     0.1109     58.9367
01800     0.7474      0.7700     0.1109     57.5273
01900     0.5843      0.7600     0.1111     58.6967
02000     0.4019      0.8900     0.1111     58.2524
02100     0.5573      0.7900     0.1111     58.2448
02200     0.3960      0.8400     0.1234     61.2610
02300     0.4581      0.8200     0.1257     62.0959
02400     0.4410      0.8200     0.1257     66.3918
02500     0.3362      0.8600     0.1257     61.4527
02600     0.3431      0.9200     0.1257     60.2875
02700     0.3741      0.8800     0.1270     61.6472
02800     0.4475      0.8400     0.1270     59.1278
02900     0.7468      0.7900     0.1270     58.1334
03000     0.4338      0.8600     0.1270     58.5019
03100     0.4495      0.8500     0.1270     58.8544
03200     0.4202      0.8300     0.1312     62.6456
03300     0.3735      0.8500     0.1312     58.6236
03400     0.3661      0.9000     0.1381     57.9337
03500     0.3317      0.9000     0.1381     57.7131
03600     0.5158      0.8700     0.1381     59.2969
03700     0.2997      0.8700     0.1381     62.9182
03800     0.3737      0.8800     0.1464     63.6553
03900     0.2811      0.8800     0.1464     64.7990
04000     0.4019      0.8600     0.1464     60.4525
04100     0.4319      0.8500     0.1464     60.5640
04200     0.3120      0.8900     0.1498     58.2878
04300     0.2803      0.8900     0.1498     63.4580
04400     0.2208      0.9400     0.1678     61.2653
04500     0.4786      0.8600     0.1678     58.7982
04600     0.4442      0.8500     0.1678     58.7334
04700     0.3593      0.8900     0.1678     62.0427
04800     0.6337      0.8400     0.1678     58.9071
04900     0.4364      0.8700     0.1772     60.1605
05000     0.3453      0.9000     0.1772     59.6238
05100     0.2729      0.9100     0.1841     61.9246
05200     0.5334      0.8100     0.1841     60.7218
05300     0.2037      0.9400     0.1841     60.9343
05400     0.2286      0.9200     0.1841     60.4998
05500     0.3583      0.8900     0.1841     61.5181
05600     0.3641      0.8800     0.1847     60.8157
05700     0.2265      0.9100     0.2024     62.3867
05800     0.3628      0.8900     0.2024     57.8691
05900     0.2167      0.9400     0.2024     57.7473
06000     0.3305      0.9200     0.2059     59.2228
06100     0.3212      0.9200     0.2059     58.4588
06200     0.4181      0.8800     0.2059     59.6527
06300     0.2169      0.9100     0.2059     60.9746
06400     0.1701      0.9300     0.2059     58.5494
06500     0.4363      0.8600     0.2059     61.2552
06600     0.2893      0.8900     0.2114     59.7703
06700     0.4397      0.8700     0.2114     61.5641
06800     0.3632      0.8700     0.2282     59.2817
06900     0.1817      0.9500     0.2282     58.0935
07000     0.3335      0.9000     0.2282     58.5412
07100     0.2856      0.8900     0.2282     62.4538
07200     0.2731      0.8800     0.2282     58.0900
07300     0.2706      0.9100     0.2304     58.7612
07400     0.3353      0.8600     0.2304     58.5773
07500     0.1120      0.9700     0.2364     63.0323
07600     0.3253      0.8900     0.2364     58.2898
07700     0.2025      0.9300     0.2364     59.8963
07800     0.4388      0.8900     0.2435     59.2760
07900     0.3330      0.9100     0.2435     64.7522
08000     0.3018      0.9000     0.2636     65.1860
08100     0.3335      0.9100     0.2636     59.5848
08200     0.3001      0.8700     0.2636     59.6381
08300     0.3266      0.9100     0.2658     62.1584
08400     0.3628      0.8700     0.2743     63.1059
08500     0.2623      0.8700     0.2743     61.4372
08600     0.2352      0.9000     0.2743     60.4767
08700     0.1110      0.9600     0.2743     60.2249
08800     0.3938      0.9000     0.2743     61.0661
08900     0.1706      0.9500     0.2743     59.6066
09000     0.3665      0.8900     0.2743     62.8102
09100     0.2990      0.9100     0.2743     62.2794
09200     0.2371      0.9000     0.2924     58.7927
09300     0.2431      0.9200     0.2944     59.1912
09400     0.2159      0.9200     0.2953     60.8732
09500     0.2297      0.9000     0.2953     58.1805
09600     0.2533      0.9100     0.2953     61.6920
09700     0.2169      0.9200     0.2953     60.5551
09800     0.1783      0.9700     0.2953     57.6754
09900     0.1729      0.9600     0.2953     64.1793
10000     0.3348      0.9100     0.2953     61.9770
10100     0.1108      0.9800     0.2953     63.2749
10200     0.1928      0.9500     0.3005     61.7712
10300     0.1811      0.9300     0.3005     61.1926
10400     0.2144      0.9100     0.3005     58.3475
10500     0.1777      0.9400     0.3102     61.7786
10600     0.3295      0.8900     0.3102     60.6837
10700     0.1294      0.9400     0.3102     61.8296
10800     0.1002      0.9700     0.3102     63.4854
10900     0.1621      0.9500     0.3102     63.8084
11000     0.2022      0.9200     0.3102     61.8595
11100     0.2131      0.9100     0.3102     59.7824
11200     0.1662      0.9400     0.3102     64.1209
11300     0.2778      0.8900     0.3102     58.4067
11400     0.0984      0.9400     0.3102     60.7077
11500     0.2021      0.9300     0.3102     61.7527
11600     0.1943      0.9300     0.3102     58.0724
11700     0.2451      0.9300     0.3102     61.9311
11800     0.2027      0.9200     0.3102     61.8318
11900     0.2125      0.9200     0.3102     63.4307
12000     0.2796      0.9100     0.3102     57.8879
12100     0.0924      0.9800     0.3102     58.2544
12200     0.2054      0.9600     0.3102     57.7665
12300     0.2375      0.9300     0.3102     62.7772
12400     0.0653      0.9600     0.3102     59.0686
12500     0.2072      0.9400     0.3102     61.7709
12600     0.1426      0.9500     0.3102     59.9439
12700     0.1710      0.9500     0.3102     62.1278
12800     0.2732      0.8900     0.3102     60.0591
12900     0.1506      0.9600     0.3102     63.3287
13000     0.1011      0.9600     0.3102     57.2270
13100     0.1807      0.9400     0.3102     58.6014
13200     0.1368      0.9200     0.3102     60.4948
13300     0.2575      0.9300     0.3102     58.2933
13400     0.1415      0.9400     0.3102     58.1238
13500     0.1197      0.9800     0.3102     64.6325
13600     0.2096      0.9500     0.3102     64.4544
13700     0.1551      0.9400     0.3102     58.1701
13800     0.2541      0.8800     0.3102     62.5564
13900     0.2047      0.9400     0.3102     61.6922
14000     0.0981      0.9900     0.3102     62.7385
14100     0.1238      0.9700     0.3102     60.4912
14200     0.1753      0.9300     0.3102     58.2889
14300     0.2044      0.9000     0.3102     57.5929
14400     0.0892      0.9800     0.3102     62.2348
14500     0.2910      0.8900     0.3136     60.1337
14600     0.1030      0.9700     0.3136     60.3923
14700     0.1222      0.9700     0.3146     62.5015
14800     0.1682      0.9100     0.3146     58.7748
14900     0.1666      0.9600     0.3210     57.6414
15000     0.2012      0.9300     0.3210     58.9027
15100     0.1936      0.9300     0.3210     61.3967
15200     0.2069      0.9400     0.3210     58.4334
15300     0.3072      0.9400     0.3210     62.2911
15400     0.2350      0.9300     0.3267     59.6139
15500     0.0946      0.9700     0.3267     61.5766
15600     0.2351      0.9300     0.3267     59.9311
15700     0.1442      0.9500     0.3267     61.6459
15800     0.1223      0.9600     0.3267     62.2291
15900     0.1253      0.9600     0.3267     61.7439
16000     0.2112      0.9200     0.3323     62.9244
16100     0.1743      0.9500     0.3323     60.7943
16200     0.3024      0.9000     0.3323     62.3344
16300     0.0980      0.9700     0.3323     62.7083
16400     0.3143      0.9200     0.3323     61.8336
16500     0.0580      0.9900     0.3323     59.3525
16600     0.2596      0.8800     0.3323     58.8683
16700     0.1763      0.9600     0.3323     59.5704
16800     0.1787      0.9500     0.3323     61.9051
16900     0.2159      0.9300     0.3323     61.7687
17000     0.1220      0.9500     0.3323     58.2492
17100     0.1855      0.9500     0.3323     59.8249
17200     0.1710      0.9500     0.3323     61.2111
17300     0.1509      0.9600     0.3323     62.9491
17400     0.0688      0.9700     0.3323     58.7310
17500     0.2622      0.9000     0.3323     62.8377
17600     0.2840      0.9200     0.3323     62.5780
17700     0.2541      0.9500     0.3323     59.1843
17800     0.2023      0.9500     0.3323     58.1990
17900     0.1085      0.9600     0.3323     60.1667
18000     0.2405      0.9300     0.3323     59.2880
18100     0.2164      0.9200     0.3323     60.6445
18200     0.1314      0.9600     0.3323     62.3263
18300     0.1138      0.9800     0.3323     60.4538
18400     0.2861      0.9100     0.3323     59.8170
18500     0.1067      0.9700     0.3323     61.0239
18600     0.0974      0.9700     0.3323     62.0679
18700     0.0899      0.9700     0.3323     58.9174
18800     0.1547      0.9600     0.3323     58.0451
18900     0.1165      0.9600     0.3323     64.6665
19000     0.1302      0.9600     0.3323     61.0675
19100     0.1981      0.9400     0.3323     59.0684
19200     0.1354      0.9600     0.3323     64.7937
19300     0.1302      0.9400     0.3323     59.2658
19400     0.1325      0.9600     0.3323     61.1645
19500     0.2147      0.9100     0.3323     60.7380
19600     0.1153      0.9800     0.3323     57.8591
19700     0.0654      0.9900     0.3323     61.0463
19800     0.1334      0.9600     0.3323     58.7271
19900     0.1033      0.9700     0.3323     59.9115
20000     0.1455      0.9700     0.3323     59.7038
20100     0.1023      0.9700     0.3323     57.5835
20199     0.1773      0.9800     0.3323     60.5286
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     4.3864      0.2700     0.3015     15.0083
00100     1.4329      0.6200     0.4781     58.8224
00200     1.9008      0.5900     0.5998     61.8596
00300     1.4589      0.5800     0.6388     63.5907
00400     1.4503      0.7000     0.6848     62.0331
00500     1.2630      0.6300     0.6926     63.2398
00600     0.8031      0.7900     0.6969     59.6972
00700     1.1422      0.7300     0.7023     57.9080
00800     1.7468      0.6700     0.7248     59.2388
00900     1.0336      0.7500     0.7248     58.6219
01000     0.5519      0.8400     0.7329     61.8165
01100     0.8835      0.7600     0.7421     63.8744
01200     0.7706      0.8200     0.7421     59.0173
01300     1.4770      0.6900     0.7526     58.4355
01400     0.6442      0.7900     0.7526     61.4843
01500     1.2656      0.6700     0.7526     59.1633
01600     0.8396      0.7600     0.7560     58.6462
01700     1.0162      0.7600     0.7590     59.5163
01800     1.0260      0.7400     0.7601     63.9837
01900     0.9399      0.7800     0.7609     58.8278
02000     0.8053      0.8300     0.7687     67.1769
02100     0.8762      0.7600     0.7718     60.2017
02200     1.1360      0.7900     0.7718     59.2922
02300     0.7735      0.7800     0.7718     60.9930
02400     0.7201      0.7300     0.7718     59.6690
02500     0.9730      0.7700     0.7764     61.0940
02600     0.6633      0.7900     0.7808     59.4451
02700     0.9528      0.7900     0.7895     64.7240
02800     0.5887      0.8600     0.7895     60.9563
02900     0.9848      0.7800     0.7895     63.5491
03000     0.6357      0.8400     0.7895     57.8375
03100     0.5869      0.7800     0.7895     58.5337
03200     0.6467      0.8500     0.7895     59.5709
03300     0.8936      0.8300     0.7895     58.4070
03400     0.6614      0.7900     0.7895     59.6098
03500     0.8216      0.8200     0.7895     62.5606
03600     1.1491      0.7000     0.7895     58.7496
03700     0.8084      0.7800     0.7974     58.6009
03800     0.7063      0.7900     0.7974     62.7029
03900     0.7911      0.8100     0.7998     59.5525
04000     0.6972      0.8500     0.7998     60.4739
04100     0.6740      0.7900     0.8022     62.1944
04200     0.8153      0.7800     0.8022     59.6732
04300     1.0064      0.7300     0.8054     57.8985
04400     0.9295      0.7700     0.8054     58.4375
04500     0.9514      0.8300     0.8054     60.7638
04600     0.6389      0.8400     0.8054     58.3867
04700     0.6453      0.8000     0.8054     57.6116
04800     0.7894      0.7800     0.8054     58.1201
04900     0.9780      0.7500     0.8054     59.0756
05000     0.6869      0.8100     0.8054     57.8954
05100     0.4556      0.8800     0.8081     60.2506
05200     0.8268      0.8300     0.8088     60.8427
05300     0.8572      0.7800     0.8088     60.1325
05400     0.7942      0.8000     0.8088     60.0099
05500     0.7629      0.8800     0.8088     59.5169
05600     0.9817      0.7700     0.8130     58.5824
05700     1.0021      0.7500     0.8130     62.2996
05800     1.1397      0.7500     0.8176     59.9973
05900     0.7485      0.8400     0.8176     62.2557
06000     0.7367      0.7700     0.8176     65.8887
06100     0.7506      0.8300     0.8176     58.8162
06200     1.2773      0.7400     0.8176     58.4816
06300     0.6733      0.8300     0.8176     63.5759
06400     0.8004      0.8300     0.8176     62.2456
06500     0.8880      0.8100     0.8176     58.9140
06600     0.7002      0.8400     0.8176     61.8916
06700     0.6433      0.8200     0.8176     61.2261
06800     0.4894      0.8900     0.8176     61.0318
06900     0.6383      0.7700     0.8176     58.3278
07000     0.8791      0.8100     0.8176     61.8666
07100     0.5319      0.8400     0.8262     58.9924
07200     0.8490      0.8300     0.8262     60.0448
07300     0.5387      0.8300     0.8262     59.0268
07400     0.5935      0.8200     0.8262     60.9592
07500     0.8430      0.8000     0.8262     59.6298
07600     0.7981      0.7900     0.8262     59.4865
07700     0.6164      0.8600     0.8262     57.9231
07800     0.5195      0.8800     0.8318     59.2026
07900     0.4033      0.8800     0.8318     58.1960
08000     0.9222      0.8100     0.8318     60.3373
08100     0.6485      0.8200     0.8318     58.5624
08200     0.5811      0.8800     0.8318     61.6385
08300     0.9986      0.8000     0.8318     62.0671
08400     0.5251      0.8300     0.8318     61.2932
08500     0.6432      0.8300     0.8318     61.5245
08600     0.6963      0.8100     0.8330     61.7053
08700     0.6268      0.8100     0.8330     62.4317
08800     1.2035      0.7700     0.8330     59.1276
08900     0.6556      0.8400     0.8330     63.1279
09000     0.6903      0.8000     0.8330     59.5931
09100     0.3312      0.9400     0.8330     58.3946
09200     0.7174      0.8200     0.8330     58.8639
09300     0.5912      0.8300     0.8330     59.4843
09400     0.6540      0.8000     0.8330     58.4229
09500     0.8260      0.8200     0.8330     59.7728
09600     0.7556      0.8100     0.8330     59.1292
09700     0.7635      0.8400     0.8330     62.0982
09800     0.6820      0.8100     0.8330     60.7832
09900     0.6671      0.8500     0.8330     60.0616
Start testing:
Test Accuracy: 0.8837
