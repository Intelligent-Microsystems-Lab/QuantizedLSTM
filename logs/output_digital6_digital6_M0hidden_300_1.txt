Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=294, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=235899598, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
6189341f-f410-44a2-b736-585352a9327c
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 147, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 290, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 211, in forward
    part2 = CustomMM_bmm.apply(quant_pass(pact_a_bmm(hx, self.a11), self.ib, self.a11), self.weight_hh * w_mask, self.bias_hh, self.noise_level, self.wb, self.bias_r)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 141, in forward
    noise_w = torch.randn(weight.shape, device = input.device) * max_w * nl
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 11.78 GiB total capacity; 10.44 GiB already allocated; 21.38 MiB free; 10.60 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=294, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=235899598, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
7052552a-d298-49b2-a998-d8a739d25ce5
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     2.9447      0.0300     0.0773     16.6469
00100     1.5576      0.5000     0.1008     56.9984
00200     1.1396      0.6800     0.1008     56.2774
00300     0.9106      0.7200     0.1008     56.7294
00400     0.6832      0.7700     0.1025     57.0857
00500     0.7076      0.7500     0.1048     57.0923
00600     0.6073      0.8300     0.1048     56.9473
00700     0.7799      0.7500     0.1048     57.3277
00800     0.8952      0.7400     0.1058     56.9702
00900     0.7581      0.7600     0.1058     57.8168
01000     0.5606      0.8300     0.1130     57.4632
01100     0.4549      0.8900     0.1230     58.2529
01200     0.5631      0.8200     0.1230     57.3532
01300     0.5554      0.8400     0.1230     57.5826
01400     0.3649      0.9100     0.1230     58.0323
01500     0.4393      0.8900     0.1230     57.2885
01600     0.5163      0.8300     0.1241     58.0269
01700     0.4518      0.8400     0.1241     58.3832
01800     0.6129      0.8300     0.1246     57.0384
01900     0.4961      0.8600     0.1246     57.5679
02000     0.4133      0.8600     0.1246     57.0465
02100     0.5250      0.8300     0.1253     56.9690
02200     0.3150      0.9300     0.1348     57.2599
02300     0.5319      0.8800     0.1348     56.6963
02400     0.3960      0.8500     0.1442     57.3947
02500     0.4280      0.8600     0.1442     57.2223
02600     0.4386      0.8800     0.1442     57.4297
02700     0.3765      0.8700     0.1442     57.0214
02800     0.4100      0.8600     0.1442     57.3779
02900     0.5841      0.8000     0.1442     57.5104
03000     0.2689      0.9400     0.1559     57.6501
03100     0.3737      0.8700     0.1559     57.1588
03200     0.3851      0.9000     0.1559     56.8298
03300     0.4363      0.8200     0.1559     56.1401
03400     0.3106      0.9100     0.1559     57.2311
03500     0.3595      0.9300     0.1589     56.9154
03600     0.3947      0.8800     0.1679     56.8429
03700     0.4359      0.8800     0.1679     57.5659
03800     0.5220      0.8800     0.1679     57.0986
03900     0.2173      0.9400     0.1679     56.6727
04000     0.4331      0.8900     0.1754     57.1713
04100     0.3306      0.9200     0.1806     57.2476
04200     0.3183      0.9300     0.1806     58.7877
04300     0.4280      0.8800     0.1806     58.2574
04400     0.5715      0.8500     0.1806     59.8604
04500     0.3550      0.9000     0.1806     58.8747
04600     0.3634      0.8800     0.1854     57.4096
04700     0.2677      0.9500     0.1867     59.3895
04800     0.3232      0.9000     0.1867     57.6799
04900     0.2888      0.9500     0.1960     57.9625
05000     0.4853      0.8700     0.1965     57.0469
05100     0.2579      0.9200     0.1965     56.8700
05200     0.4494      0.8800     0.1983     57.4743
05300     0.3570      0.9000     0.2240     57.5470
05400     0.3144      0.9100     0.2240     57.0375
05500     0.4043      0.8800     0.2464     57.6764
05600     0.3805      0.9100     0.2464     58.3743
05700     0.1870      0.9300     0.2464     57.8535
05800     0.2679      0.9000     0.2464     58.1563
05900     0.2313      0.9200     0.2515     58.0498
06000     0.2085      0.9600     0.2515     58.8572
06100     0.1744      0.9400     0.2515     59.1199
06200     0.3351      0.8700     0.2515     57.5250
06300     0.3154      0.9000     0.2515     57.9098
06400     0.2201      0.9400     0.2515     57.2321
06500     0.3605      0.8800     0.2531     56.7598
06600     0.2067      0.9300     0.2556     56.9552
06700     0.4354      0.8800     0.2556     56.9198
06800     0.4422      0.8400     0.2658     57.3087
06900     0.3529      0.8600     0.2658     57.2898
07000     0.2320      0.9200     0.2855     56.7614
07100     0.2256      0.9200     0.2855     57.0417
07200     0.2941      0.9200     0.2855     58.2142
07300     0.4871      0.8600     0.2855     57.3854
07400     0.2771      0.9200     0.2913     57.6666
07500     0.3795      0.8700     0.2913     56.8049
07600     0.3201      0.8800     0.2913     57.1849
07700     0.3056      0.9000     0.2941     57.6275
07800     0.2368      0.9300     0.2941     57.0143
07900     0.3722      0.8900     0.2941     58.1286
08000     0.3013      0.9200     0.3045     57.5304
08100     0.2983      0.9400     0.3045     58.1805
08200     0.2693      0.9500     0.3045     57.8571
08300     0.3043      0.9300     0.3301     57.9941
08400     0.3063      0.9100     0.3301     58.2074
08500     0.1702      0.9600     0.3301     57.6098
08600     0.3664      0.8800     0.3301     57.7627
08700     0.1237      0.9900     0.3360     60.4003
08800     0.2428      0.9300     0.3409     61.0909
08900     0.2079      0.9200     0.3409     58.9382
09000     0.3467      0.9000     0.3409     58.1744
09100     0.2191      0.9500     0.3552     56.9050
09200     0.2158      0.9200     0.3552     57.3082
09300     0.1867      0.9400     0.3636     56.7047
09400     0.2464      0.9200     0.3637     57.4067
09500     0.2275      0.9400     0.3637     57.0584
09600     0.2424      0.9200     0.3637     57.1712
09700     0.3461      0.9000     0.3678     56.9386
09800     0.2684      0.9200     0.3718     58.2100
09900     0.1592      0.9500     0.3853     57.7427
10000     0.1857      0.9500     0.3853     57.1958
10100     0.2445      0.9500     0.3853     57.6036
10200     0.3066      0.8900     0.3853     56.9857
10300     0.3172      0.8900     0.4019     56.9689
10400     0.1915      0.9500     0.4019     58.0801
10500     0.2226      0.9300     0.4019     57.8374
10600     0.3019      0.9300     0.4019     57.7941
10700     0.2460      0.9400     0.4019     58.1831
10800     0.1757      0.9600     0.4019     56.9528
10900     0.3013      0.9200     0.4019     56.4104
11000     0.1831      0.9600     0.4019     57.1699
11100     0.1322      0.9600     0.4019     57.1849
11200     0.1996      0.9300     0.4019     56.7239
11300     0.1434      0.9500     0.4019     57.0381
11400     0.2448      0.9100     0.4019     57.0424
11500     0.1771      0.9400     0.4019     57.3202
11600     0.1285      0.9700     0.4019     57.3498
11700     0.1126      0.9700     0.4019     57.3589
11800     0.1919      0.9500     0.4019     56.9089
11900     0.1044      0.9900     0.4019     56.7254
12000     0.1974      0.9300     0.4019     56.9696
12100     0.1440      0.9800     0.4019     56.7181
12200     0.2020      0.9400     0.4019     57.7626
12300     0.1244      0.9600     0.4019     56.9518
12400     0.2291      0.9500     0.4019     57.1382
12500     0.1670      0.9500     0.4019     56.7846
12600     0.2324      0.8800     0.4019     59.1877
12700     0.3687      0.9000     0.4019     57.5251
12800     0.2291      0.9200     0.4019     57.9240
12900     0.1722      0.9700     0.4019     57.9321
13000     0.2100      0.9400     0.4019     60.2838
13100     0.2404      0.9500     0.4019     60.6503
13200     0.1610      0.9400     0.4019     58.1788
13300     0.1739      0.9400     0.4019     58.6999
13400     0.1756      0.9400     0.4019     58.1983
13500     0.1286      0.9700     0.4019     58.0186
13600     0.2128      0.9500     0.4019     57.9932
13700     0.1626      0.9500     0.4019     57.1819
13800     0.2163      0.9400     0.4019     56.6551
13900     0.1934      0.9600     0.4019     58.2542
14000     0.2731      0.9300     0.4019     58.2149
14100     0.2635      0.9400     0.4019     58.4962
14200     0.1891      0.9600     0.4019     58.2790
14300     0.1562      0.9800     0.4019     57.4241
14400     0.1224      0.9800     0.4019     58.5018
14500     0.1310      0.9700     0.4019     57.1487
14600     0.2428      0.9300     0.4019     60.1731
14700     0.2064      0.9500     0.4019     60.3318
14800     0.1298      0.9700     0.4019     59.1172
14900     0.2144      0.9400     0.4019     58.9361
15000     0.1329      0.9800     0.4019     59.2018
15100     0.1376      0.9700     0.4019     59.6835
15200     0.3298      0.9300     0.4019     58.7591
15300     0.1310      0.9600     0.4019     57.6836
15400     0.2647      0.9300     0.4019     57.0120
15500     0.1886      0.9500     0.4019     57.5868
15600     0.1594      0.9700     0.4019     57.5673
15700     0.0884      1.0000     0.4019     57.2035
15800     0.2186      0.9300     0.4019     57.4503
15900     0.1357      0.9700     0.4019     58.9710
16000     0.1729      0.9600     0.4019     58.6867
16100     0.1094      0.9800     0.4019     57.3102
16200     0.0979      0.9700     0.4019     58.9008
16300     0.1534      0.9500     0.4019     59.4809
16400     0.1047      0.9800     0.4019     57.9255
16500     0.1269      0.9700     0.4019     58.0873
16600     0.2397      0.9300     0.4019     59.7242
16700     0.1940      0.9600     0.4019     58.2598
16800     0.1024      0.9700     0.4019     57.6461
16900     0.1103      0.9800     0.4019     59.0635
17000     0.1506      0.9600     0.4019     58.6507
17100     0.1633      0.9500     0.4019     58.0518
17200     0.1261      0.9700     0.4019     59.7310
17300     0.1047      1.0000     0.4019     57.7333
17400     0.0857      0.9900     0.4019     57.3358
17500     0.1588      0.9500     0.4019     57.9011
17600     0.0880      0.9800     0.4019     58.4754
17700     0.2658      0.9200     0.4019     59.6863
17800     0.2070      0.9500     0.4019     59.4537
17900     0.0951      0.9800     0.4019     60.0497
18000     0.1681      0.9500     0.4019     59.0805
18100     0.2098      0.9400     0.4019     59.7691
18200     0.1792      0.9400     0.4019     58.6699
18300     0.1642      0.9500     0.4019     57.7251
18400     0.1608      0.9600     0.4104     59.7313
18500     0.1037      0.9700     0.4104     58.2332
18600     0.1925      0.9500     0.4104     58.3145
18700     0.2191      0.9500     0.4104     60.7113
18800     0.2102      0.9400     0.4104     59.3622
18900     0.1601      0.9600     0.4104     58.1018
19000     0.1210      0.9700     0.4104     57.3109
19100     0.1369      0.9700     0.4104     56.4224
19200     0.1668      0.9500     0.4104     57.2913
19300     0.1667      0.9600     0.4104     56.8379
19400     0.1354      0.9500     0.4104     56.7701
19500     0.1864      0.9600     0.4104     57.2583
19600     0.1555      0.9500     0.4104     57.6509
19700     0.1523      0.9600     0.4104     56.8569
19800     0.1242      0.9700     0.4104     57.2098
19900     0.1032      0.9800     0.4104     57.7375
20000     0.1978      0.9600     0.4104     56.7369
20100     0.1013      0.9800     0.4104     57.0051
20199     0.1531      0.9500     0.4104     57.0489
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     2.6042      0.4900     0.3923     15.4632
00100     1.6209      0.5600     0.5773     57.6902
00200     1.1221      0.6700     0.6620     56.7595
00300     0.9220      0.7500     0.7015     57.2449
00400     0.8468      0.7400     0.7587     57.1761
00500     0.8612      0.7600     0.7587     57.3051
00600     1.0012      0.7300     0.7587     56.8852
00700     1.0252      0.7100     0.7760     56.7396
00800     0.8330      0.7400     0.7760     57.3778
00900     1.2648      0.6700     0.7828     57.2831
01000     0.6281      0.8400     0.7829     56.9437
01100     0.5437      0.8300     0.8022     58.5272
01200     0.7849      0.8100     0.8022     58.7268
01300     0.5098      0.8700     0.8022     58.2379
01400     0.7136      0.7700     0.8022     57.6765
01500     0.6411      0.8000     0.8022     57.1207
01600     1.2085      0.7300     0.8060     57.5871
01700     0.8659      0.8100     0.8060     57.2114
01800     0.6981      0.7900     0.8060     57.3701
01900     0.8231      0.8200     0.8060     58.0290
02000     0.6947      0.7800     0.8112     57.9562
02100     0.7689      0.7600     0.8239     59.0458
02200     0.7502      0.7900     0.8239     58.4728
02300     0.5948      0.8500     0.8239     59.0258
02400     0.6735      0.7800     0.8239     57.4986
02500     0.6476      0.8600     0.8239     57.8418
02600     0.8680      0.7800     0.8239     59.0486
02700     0.7485      0.8200     0.8260     57.4362
02800     0.7843      0.7800     0.8260     57.1876
02900     0.7066      0.8300     0.8260     58.1665
03000     0.5028      0.8800     0.8260     57.5079
03100     0.8015      0.8300     0.8260     57.5860
03200     0.5909      0.8400     0.8278     57.7220
03300     0.7030      0.8200     0.8340     57.3107
03400     0.6113      0.8300     0.8340     57.1271
03500     0.6189      0.8100     0.8340     56.5865
03600     0.5024      0.8600     0.8340     57.6641
03700     0.5781      0.8200     0.8340     59.0209
03800     0.5412      0.8200     0.8340     58.8278
03900     0.5679      0.8200     0.8340     57.9837
04000     0.7109      0.8000     0.8340     58.0151
04100     0.5700      0.8600     0.8348     58.7678
04200     0.7501      0.8300     0.8348     58.3057
04300     0.7220      0.8200     0.8437     57.9630
04400     0.4633      0.9000     0.8437     58.2571
04500     0.4473      0.8600     0.8437     56.3862
04600     0.6670      0.8100     0.8437     57.3406
04700     0.8005      0.7400     0.8437     56.6325
04800     0.5599      0.8300     0.8437     57.7459
04900     0.6661      0.8100     0.8437     57.5587
05000     0.5482      0.8400     0.8437     58.7681
05100     0.6315      0.8700     0.8437     58.2031
05200     0.9884      0.7300     0.8437     57.2278
05300     0.4052      0.8900     0.8437     58.6577
05400     0.5666      0.8500     0.8437     57.5689
05500     0.4162      0.8900     0.8437     58.8251
05600     0.3568      0.8900     0.8437     56.7441
05700     0.6194      0.7900     0.8437     57.3818
05800     0.5807      0.8400     0.8437     56.3495
05900     0.5765      0.8500     0.8443     57.6824
06000     0.4143      0.8400     0.8457     56.9942
06100     0.5650      0.8500     0.8457     57.2748
06200     0.4877      0.8400     0.8509     57.2259
06300     0.4208      0.8800     0.8509     56.7091
06400     0.5774      0.8300     0.8519     56.9942
06500     0.9099      0.7300     0.8519     57.0699
06600     0.4188      0.8900     0.8552     59.6942
06700     0.7419      0.8200     0.8552     56.8320
06800     0.6212      0.8100     0.8552     57.8628
06900     0.4624      0.8800     0.8552     58.6473
07000     0.5893      0.8300     0.8552     58.2463
07100     0.3964      0.8500     0.8552     57.8396
07200     0.8136      0.7500     0.8552     57.3564
07300     0.6580      0.8200     0.8552     56.3956
07400     0.7293      0.8400     0.8552     56.8704
07500     0.6369      0.8400     0.8571     57.6729
07600     0.3014      0.9500     0.8573     57.3690
07700     0.6748      0.8200     0.8573     56.7333
07800     0.7506      0.8000     0.8573     58.7409
07900     0.5137      0.8700     0.8573     58.4566
08000     0.2603      0.9300     0.8573     57.9276
08100     0.3941      0.8600     0.8581     59.3828
08200     0.5317      0.8700     0.8581     57.7413
08300     0.4102      0.8300     0.8581     57.5424
08400     0.4652      0.8600     0.8594     58.4442
08500     0.6407      0.8200     0.8594     57.0596
08600     0.4474      0.8600     0.8594     57.9714
08700     0.6668      0.8200     0.8594     57.6973
08800     0.3071      0.8900     0.8594     58.2903
08900     0.4147      0.8700     0.8594     57.3302
09000     0.5417      0.8500     0.8594     57.6006
09100     0.6215      0.8400     0.8594     57.7117
09200     0.6316      0.8100     0.8594     58.3114
09300     0.6019      0.8400     0.8594     57.0528
09400     0.6479      0.8500     0.8594     57.3267
09500     0.6542      0.8200     0.8594     57.4916
09600     0.5849      0.7900     0.8594     58.0059
09700     0.5757      0.8300     0.8594     57.3807
09800     0.4179      0.8900     0.8601     57.1934
09900     0.3466      0.9200     0.8601     57.2063
Start testing:
Test Accuracy: 0.8894
