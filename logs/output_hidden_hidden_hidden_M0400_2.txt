Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=394, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=8627169, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
5e41b6ce-8ea2-4803-a0d4-2aa8a500486a
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 147, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 290, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 213, in forward
    gates = quant_pass(pact_a_bmm( quant_pass(pact_a_bmm(part1, self.a12), self.abMVM, self.a12) + quant_pass(pact_a_bmm(part2, self.a13), self.abMVM, self.a13), self.a14), self.abNM, self.a14)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 89, in forward
    x01q =  torch.round(x01 * step_d ) / step_d
RuntimeError: CUDA out of memory. Tried to allocate 12.00 MiB (GPU 0; 10.76 GiB total capacity; 9.69 GiB already allocated; 9.12 MiB free; 9.80 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=394, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=8627169, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
c93b04bd-4478-4be2-9e66-9da7cc900cce
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     2.9230      0.0900     0.0781     15.3789
00100     1.2684      0.5700     0.5695     57.7408
00200     1.1333      0.5900     0.6953     56.2185
00300     1.0134      0.7200     0.6953     54.2467
00400     0.9646      0.7000     0.7506     55.3456
00500     1.0440      0.6700     0.7506     54.8686
00600     0.7657      0.7700     0.7506     55.3113
00700     0.5903      0.8300     0.8029     55.7394
00800     0.6683      0.8000     0.8029     54.4811
00900     0.8277      0.7300     0.8107     59.9202
01000     0.9988      0.6900     0.8164     56.0730
01100     0.6747      0.8100     0.8164     55.1673
01200     0.6303      0.7600     0.8164     57.9719
01300     0.8553      0.7700     0.8278     56.8007
01400     0.5981      0.8100     0.8278     58.4285
01500     0.8232      0.7500     0.8278     54.4892
01600     0.8475      0.7000     0.8307     55.5322
01700     0.5792      0.8200     0.8307     55.2621
01800     0.6088      0.8200     0.8307     54.4001
01900     0.4893      0.8400     0.8307     56.6556
02000     0.7380      0.7600     0.8307     55.6343
02100     0.5548      0.8400     0.8388     57.0898
02200     0.6349      0.8300     0.8388     58.3402
02300     0.5891      0.8500     0.8388     58.8744
02400     0.7873      0.7700     0.8388     56.3372
02500     0.6414      0.7900     0.8470     56.5084
02600     0.4858      0.8700     0.8484     56.0342
02700     0.6985      0.7700     0.8484     54.6965
02800     0.6671      0.7200     0.8484     54.6408
02900     0.6786      0.7400     0.8484     59.2267
03000     0.8315      0.7600     0.8484     56.4234
03100     0.5213      0.8500     0.8516     54.8490
03200     0.6112      0.8200     0.8545     56.3521
03300     0.5523      0.8300     0.8595     56.0951
03400     0.5793      0.8000     0.8595     57.8421
03500     0.6294      0.7800     0.8595     57.3856
03600     0.7893      0.8100     0.8595     58.8069
03700     0.5553      0.8200     0.8595     54.7561
03800     0.5525      0.8100     0.8595     55.6574
03900     0.5683      0.8400     0.8595     57.4141
04000     0.7434      0.7600     0.8595     54.7779
04100     0.4457      0.8600     0.8595     54.5956
04200     0.5329      0.8100     0.8595     55.5173
04300     0.5024      0.8500     0.8605     58.7540
04400     0.5010      0.8700     0.8605     55.1457
04500     0.8402      0.7400     0.8605     58.1640
04600     0.6167      0.7900     0.8639     55.6271
04700     0.7454      0.8100     0.8639     59.3305
04800     0.5509      0.8300     0.8639     55.0177
04900     0.6476      0.8300     0.8639     58.5183
05000     0.6260      0.7900     0.8639     58.6264
05100     0.3831      0.8700     0.8639     55.7125
05200     0.6970      0.7900     0.8639     58.1296
05300     0.4894      0.8400     0.8639     59.5176
05400     0.5186      0.8700     0.8639     55.6448
05500     0.5691      0.8200     0.8639     57.2797
05600     0.5082      0.8000     0.8640     55.4372
05700     0.6905      0.7800     0.8657     58.8405
05800     0.5451      0.8300     0.8657     55.2561
05900     0.7374      0.7900     0.8657     54.9466
06000     0.5991      0.8000     0.8681     55.9156
06100     0.5453      0.8200     0.8722     55.9657
06200     0.6733      0.7400     0.8722     56.8882
06300     0.4659      0.8200     0.8722     55.2624
06400     0.4735      0.8600     0.8722     58.3682
06500     0.4097      0.8600     0.8722     56.8203
06600     0.5224      0.8300     0.8722     60.1963
06700     0.5564      0.8300     0.8789     58.2280
06800     0.5266      0.7500     0.8789     56.1949
06900     0.5061      0.8300     0.8789     55.7263
07000     0.6170      0.8000     0.8789     55.3775
07100     0.4951      0.8500     0.8789     55.4053
07200     0.6458      0.8100     0.8789     57.7728
07300     0.6469      0.8000     0.8789     56.4514
07400     0.5566      0.8000     0.8789     59.2447
07500     0.5345      0.8700     0.8789     57.8229
07600     0.3956      0.8800     0.8789     55.0828
07700     0.4731      0.8600     0.8789     55.2449
07800     0.5458      0.8300     0.8789     54.8504
07900     0.4698      0.8300     0.8789     56.9735
08000     0.4518      0.8700     0.8789     56.5307
08100     0.4048      0.8700     0.8789     54.6405
08200     0.4570      0.8400     0.8789     54.8032
08300     0.4829      0.8400     0.8789     54.9148
08400     0.5671      0.8500     0.8789     57.9862
08500     0.3593      0.8900     0.8808     56.4081
08600     0.4496      0.8900     0.8808     55.0733
08700     0.3953      0.8900     0.8808     56.6462
08800     0.5803      0.7900     0.8808     55.4044
08900     0.3640      0.8900     0.8808     58.2443
09000     0.6141      0.8100     0.8808     55.1064
09100     0.3912      0.8800     0.8808     54.1310
09200     0.4674      0.8600     0.8808     54.4701
09300     0.2831      0.9100     0.8808     55.0146
09400     0.4285      0.9000     0.8808     54.9774
09500     0.4013      0.8800     0.8808     57.9539
09600     0.6430      0.8000     0.8808     56.8017
09700     0.5526      0.8200     0.8850     62.0507
09800     0.3846      0.8900     0.8850     54.3893
09900     0.5317      0.8000     0.8850     54.8542
10000     0.4465      0.8600     0.8850     57.4630
10100     0.3929      0.8900     0.8850     56.6740
10200     0.5089      0.8600     0.8850     55.6816
10300     0.5624      0.8300     0.8881     58.3477
10400     0.4010      0.9000     0.8881     54.2636
10500     0.5265      0.8200     0.8893     56.3035
10600     0.5392      0.8700     0.8893     55.5771
10700     0.4321      0.8800     0.8893     54.7815
10800     0.3237      0.9000     0.8893     55.0579
10900     0.4073      0.8700     0.8893     56.9507
11000     0.6065      0.8100     0.8908     54.7843
11100     0.3609      0.8900     0.8908     54.8883
11200     0.3785      0.8900     0.8908     56.6234
11300     0.3096      0.9000     0.8908     59.4786
11400     0.2863      0.9000     0.8908     59.8159
11500     0.3018      0.9300     0.8908     56.1802
11600     0.4374      0.8800     0.8908     54.4606
11700     0.3473      0.9300     0.8908     54.9562
11800     0.4511      0.8700     0.8908     57.8933
11900     0.4291      0.8800     0.8908     58.1151
12000     0.2143      0.9700     0.8934     60.7636
12100     0.4478      0.8600     0.8934     55.5595
12200     0.4182      0.8900     0.8934     61.2455
12300     0.4264      0.8700     0.8934     57.7145
12400     0.4755      0.8500     0.8934     56.2051
12500     0.2798      0.9300     0.8934     54.6136
12600     0.4646      0.8700     0.8934     54.2312
12700     0.4475      0.9100     0.8934     54.8474
12800     0.4539      0.8200     0.8934     60.3867
12900     0.4088      0.8700     0.8934     57.7460
13000     0.2973      0.9000     0.8934     55.0375
13100     0.4094      0.8900     0.8934     55.4780
13200     0.3846      0.8700     0.8934     54.3966
13300     0.3323      0.8900     0.8934     58.2799
13400     0.4981      0.8300     0.8934     60.8241
13500     0.4371      0.8800     0.8934     58.0957
13600     0.4526      0.8800     0.8934     55.2776
13700     0.2825      0.9200     0.8972     58.3412
13800     0.3519      0.9200     0.8972     56.3254
13900     0.2604      0.9300     0.8972     56.8192
14000     0.3875      0.8600     0.8972     57.8570
14100     0.4831      0.8200     0.8972     57.8428
14200     0.5534      0.8400     0.8972     58.2614
14300     0.3451      0.9000     0.8972     57.3489
14400     0.3220      0.9200     0.8972     57.8725
14500     0.3082      0.9100     0.8972     55.1562
14600     0.4471      0.8400     0.8972     56.6645
14700     0.3434      0.9000     0.8972     57.8878
14800     0.4882      0.8500     0.8972     55.2743
14900     0.3362      0.9100     0.8982     61.0826
15000     0.2210      0.9300     0.8982     58.5410
15100     0.2720      0.9100     0.8982     54.6267
15200     0.2682      0.8800     0.8982     58.2319
15300     0.4815      0.8400     0.8982     57.3955
15400     0.3239      0.8900     0.8982     55.4604
15500     0.4595      0.8900     0.8982     55.5854
15600     0.2783      0.9100     0.8982     54.6648
15700     0.2837      0.9200     0.8982     58.5993
15800     0.2572      0.9000     0.8982     55.2645
15900     0.4014      0.8800     0.8982     54.4645
16000     0.4234      0.8700     0.8982     54.7086
16100     0.4625      0.8600     0.8982     54.9838
16200     0.4457      0.8500     0.8982     57.8637
16300     0.2579      0.9100     0.8982     64.2502
16400     0.4377      0.8800     0.8982     55.7716
16500     0.4172      0.9100     0.8982     56.3654
16600     0.3546      0.9000     0.8982     56.6546
16700     0.4251      0.9000     0.8982     57.7414
16800     0.2467      0.9300     0.8982     58.1390
16900     0.3959      0.8500     0.8982     55.3503
17000     0.2878      0.9100     0.8982     56.0821
17100     0.3473      0.9200     0.8982     54.4884
17200     0.3568      0.9100     0.8982     55.6260
17300     0.4709      0.8700     0.8982     55.2900
17400     0.3118      0.8800     0.8982     54.3600
17500     0.2329      0.9300     0.8982     57.2203
17600     0.2309      0.9500     0.8982     57.9321
17700     0.2708      0.9200     0.8982     59.4662
17800     0.3868      0.8500     0.8982     55.0843
17900     0.3547      0.9400     0.8982     55.5142
18000     0.2312      0.9300     0.8982     54.4183
18100     0.4559      0.8400     0.8982     56.7384
18200     0.3884      0.8600     0.8982     55.6680
18300     0.2748      0.9200     0.8982     54.7880
18400     0.2752      0.9300     0.8982     56.1144
18500     0.2276      0.9200     0.8982     55.5368
18600     0.3024      0.9000     0.8982     54.9853
18700     0.4457      0.8200     0.8982     54.9668
18800     0.2399      0.9600     0.8982     58.0016
18900     0.2818      0.9100     0.8982     59.0491
19000     0.2655      0.9400     0.8982     54.6529
19100     0.2839      0.9100     0.8982     56.1492
19200     0.3648      0.8900     0.8982     55.3843
19300     0.4679      0.8700     0.8982     55.4009
19400     0.3617      0.9000     0.8982     55.6474
19500     0.2961      0.9300     0.8982     55.5651
19600     0.2045      0.9300     0.8982     57.6720
19700     0.3450      0.8900     0.8982     54.8506
19800     0.3036      0.8900     0.8982     58.2918
19900     0.2324      0.9500     0.8982     61.2099
20000     0.3289      0.9200     0.8982     56.8133
20100     0.3490      0.9000     0.8982     58.1443
20199     0.3667      0.8900     0.8982     55.4105
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     0.5132      0.8500     0.8459     16.6158
00100     0.3667      0.8900     0.9010     55.4884
00200     0.3235      0.9200     0.9027     56.0905
00300     0.3369      0.8900     0.9027     55.0740
00400     0.3381      0.8600     0.9027     55.1118
00500     0.3625      0.9000     0.9027     55.1192
00600     0.3417      0.8800     0.9027     57.6679
00700     0.3600      0.8700     0.9027     55.6203
00800     0.4614      0.8400     0.9035     56.4663
00900     0.3490      0.8900     0.9035     55.5139
01000     0.3828      0.8800     0.9035     54.5218
01100     0.3818      0.8700     0.9067     58.3314
01200     0.2397      0.9300     0.9067     57.0190
01300     0.2538      0.9300     0.9067     57.5962
01400     0.4554      0.8400     0.9067     55.1177
01500     0.4246      0.8600     0.9067     55.1719
01600     0.3045      0.9200     0.9067     55.4242
01700     0.3006      0.8700     0.9067     55.1635
01800     0.5646      0.8100     0.9067     56.1354
01900     0.4077      0.8900     0.9067     54.3751
02000     0.2223      0.9300     0.9067     55.1637
02100     0.3753      0.8800     0.9067     54.4713
02200     0.3010      0.9200     0.9067     56.4103
02300     0.3773      0.8800     0.9067     60.3091
02400     0.3848      0.8700     0.9067     57.2230
02500     0.3207      0.9100     0.9067     60.2894
02600     0.3921      0.8900     0.9067     57.6276
02700     0.3854      0.8500     0.9067     55.8919
02800     0.3915      0.9000     0.9067     56.9942
02900     0.4231      0.8700     0.9067     55.5166
03000     0.1968      0.9500     0.9073     60.3424
03100     0.2700      0.9200     0.9073     55.6538
03200     0.2680      0.9300     0.9073     54.1819
03300     0.3718      0.8900     0.9073     56.4248
03400     0.2149      0.9600     0.9073     57.1866
03500     0.2168      0.9500     0.9073     54.3731
03600     0.2276      0.9400     0.9073     58.0797
03700     0.3027      0.9500     0.9073     55.9435
03800     0.3231      0.9200     0.9073     56.1120
03900     0.2679      0.9100     0.9073     62.5698
04000     0.3503      0.9200     0.9073     55.3578
04100     0.3421      0.9300     0.9073     59.1834
04200     0.4143      0.8700     0.9073     56.9103
04300     0.2503      0.9200     0.9073     57.8202
04400     0.2782      0.9100     0.9073     55.7627
04500     0.2660      0.9100     0.9073     55.2212
04600     0.2246      0.9200     0.9073     54.9656
04700     0.3171      0.9100     0.9073     56.3715
04800     0.2006      0.9500     0.9073     59.6568
04900     0.4472      0.8900     0.9073     55.4573
05000     0.3838      0.8800     0.9073     54.6275
05100     0.3184      0.9200     0.9073     57.3726
05200     0.2853      0.9100     0.9073     56.1758
05300     0.5247      0.8600     0.9073     55.4173
05400     0.3316      0.9000     0.9073     58.0888
05500     0.4001      0.8600     0.9073     55.0603
05600     0.3676      0.9000     0.9073     54.2350
05700     0.3110      0.9000     0.9073     55.2299
05800     0.1847      0.9400     0.9073     55.0948
05900     0.2742      0.9200     0.9073     57.9666
06000     0.3474      0.9000     0.9103     58.7114
06100     0.4385      0.8300     0.9103     56.3173
06200     0.3695      0.8900     0.9103     55.7122
06300     0.5183      0.7900     0.9103     55.0069
06400     0.3033      0.9300     0.9103     54.5442
06500     0.2314      0.9300     0.9103     56.0035
06600     0.3760      0.8800     0.9103     55.0858
06700     0.3382      0.8800     0.9103     55.1695
06800     0.1781      0.9500     0.9103     55.7059
06900     0.2962      0.9300     0.9103     55.7341
07000     0.2061      0.9500     0.9103     58.4756
07100     0.2932      0.9100     0.9103     54.6330
07200     0.2487      0.9100     0.9103     57.4283
07300     0.3797      0.8800     0.9103     55.8724
07400     0.2963      0.9200     0.9103     57.5117
07500     0.1794      0.9600     0.9103     55.6934
07600     0.3701      0.8900     0.9103     55.0679
07700     0.3025      0.9200     0.9103     57.7438
07800     0.6059      0.8400     0.9103     55.3150
07900     0.2832      0.9100     0.9103     54.4411
08000     0.3590      0.8900     0.9103     54.5332
08100     0.3697      0.8700     0.9103     55.9556
08200     0.3328      0.9100     0.9103     55.1418
08300     0.3129      0.9100     0.9103     56.4301
08400     0.3468      0.9000     0.9103     55.5227
08500     0.2726      0.9200     0.9103     58.7408
08600     0.3047      0.9100     0.9103     56.0960
08700     0.4037      0.8800     0.9103     58.7745
08800     0.2369      0.9300     0.9103     55.3865
08900     0.2991      0.9000     0.9103     56.0446
09000     0.4617      0.8300     0.9103     56.8263
09100     0.3722      0.8700     0.9103     55.6276
09200     0.3275      0.9000     0.9103     56.1819
09300     0.4455      0.8700     0.9103     56.4434
09400     0.2937      0.9300     0.9103     56.4699
09500     0.3042      0.9000     0.9103     56.2339
09600     0.2096      0.9400     0.9103     54.5656
09700     0.3382      0.9100     0.9103     55.0086
09800     0.3484      0.8700     0.9103     55.0056
09900     0.3679      0.8500     0.9103     57.9954
Start testing:
Test Accuracy: 0.9026
