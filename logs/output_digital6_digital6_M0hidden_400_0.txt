Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=394, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=193012823, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
b9e07f1e-2636-46cb-9547-d1a28a9ea2e1
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 167, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 290, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 213, in forward
    gates = quant_pass(pact_a_bmm( quant_pass(pact_a_bmm(part1, self.a12), self.abMVM, self.a12) + quant_pass(pact_a_bmm(part2, self.a13), self.abMVM, self.a13), self.a14), self.abNM, self.a14)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 124, in pact_a_bmm
    return torch.sign(x) * .5 * (torch.abs(x) - torch.abs(torch.abs(x) - a) + a)
RuntimeError: CUDA out of memory. Tried to allocate 12.00 MiB (GPU 0; 22.17 GiB total capacity; 20.96 GiB already allocated; 2.50 MiB free; 21.19 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=394, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=193012823, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
947f0a4c-88f2-4e6f-8f07-ec2906120481
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     2.9441      0.0600     0.0819     18.5015
00100     1.2804      0.5500     0.0981     61.0909
00200     0.8883      0.7100     0.0987     61.2406
00300     0.9649      0.6800     0.1047     63.9868
00400     0.6578      0.7900     0.1047     63.7862
00500     0.4678      0.8500     0.1047     62.3172
00600     0.7328      0.7700     0.1067     65.1140
00700     0.5060      0.8600     0.1070     62.0110
00800     0.6514      0.7900     0.1174     60.7539
00900     0.4845      0.8400     0.1174     60.3914
01000     0.6048      0.8000     0.1174     63.9400
01100     0.6662      0.7700     0.1174     66.4177
01200     0.5065      0.8200     0.1206     65.5695
01300     0.4419      0.8600     0.1206     60.4544
01400     0.3039      0.9000     0.1206     65.5862
01500     0.4815      0.8500     0.1255     61.4505
01600     0.4737      0.8700     0.1273     64.8063
01700     0.3600      0.8900     0.1273     65.1429
01800     0.3540      0.8900     0.1273     60.3254
01900     0.3524      0.9200     0.1349     64.2173
02000     0.3348      0.9000     0.1353     62.7584
02100     0.4367      0.8900     0.1530     61.5686
02200     0.4456      0.8800     0.1530     66.3461
02300     0.3620      0.8900     0.1531     60.5897
02400     0.4031      0.9000     0.1531     60.1915
02500     0.3398      0.9100     0.1535     62.5981
02600     0.4758      0.8800     0.1535     60.4032
02700     0.3331      0.8700     0.1676     63.7903
02800     0.3151      0.8900     0.1676     62.9607
02900     0.3559      0.9200     0.1676     60.6995
03000     0.4383      0.8800     0.1676     62.8135
03100     0.3453      0.8900     0.1698     61.3083
03200     0.4186      0.8900     0.1698     65.1609
03300     0.3923      0.9000     0.1698     61.0020
03400     0.4174      0.8500     0.1710     60.8573
03500     0.2793      0.9000     0.1710     63.9723
03600     0.3576      0.8900     0.1860     64.5135
03700     0.4518      0.8600     0.1860     60.4016
03800     0.3639      0.9000     0.1860     60.1171
03900     0.4251      0.8800     0.1860     60.5388
04000     0.3633      0.8600     0.1894     63.4378
04100     0.4246      0.8000     0.1894     61.9348
04200     0.1904      0.9600     0.1943     61.8468
04300     0.3521      0.9100     0.1943     60.6886
04400     0.4206      0.8500     0.2112     62.6474
04500     0.1559      0.9600     0.2112     60.7278
04600     0.3956      0.8800     0.2112     62.0031
04700     0.2857      0.9400     0.2112     62.7522
04800     0.3578      0.9000     0.2112     61.3450
04900     0.4544      0.8500     0.2324     63.0487
05000     0.3911      0.8900     0.2324     63.3627
05100     0.2479      0.9200     0.2324     61.7455
05200     0.1870      0.9500     0.2324     61.6388
05300     0.2107      0.9600     0.2343     62.0159
05400     0.3310      0.8700     0.2343     64.1181
05500     0.2949      0.9200     0.2426     63.1430
05600     0.2627      0.9400     0.2466     61.0432
05700     0.2927      0.9100     0.2466     60.3073
05800     0.1940      0.9300     0.2466     60.2134
05900     0.2503      0.9500     0.2656     65.1495
06000     0.3764      0.8800     0.2656     60.9055
06100     0.3600      0.9100     0.2656     62.9050
06200     0.2703      0.9500     0.2656     61.4564
06300     0.1262      0.9700     0.2656     62.2863
06400     0.2887      0.9200     0.2656     60.3616
06500     0.2393      0.9500     0.2656     60.3018
06600     0.2879      0.9100     0.2656     60.6857
06700     0.3703      0.8900     0.2890     65.5280
06800     0.2852      0.9200     0.2890     62.2009
06900     0.1600      0.9500     0.3045     61.5112
07000     0.2825      0.9500     0.3095     62.4683
07100     0.4123      0.8700     0.3095     61.3782
07200     0.3168      0.9200     0.3215     61.6748
07300     0.2365      0.9300     0.3215     61.1868
07400     0.2426      0.9300     0.3236     60.7847
07500     0.2631      0.9300     0.3236     64.1841
07600     0.1900      0.9500     0.3236     61.2361
07700     0.3350      0.9000     0.3236     60.0943
07800     0.2785      0.9200     0.3501     63.5710
07900     0.1754      0.9500     0.3501     61.4226
08000     0.1878      0.9600     0.3501     60.9780
08100     0.3311      0.9100     0.3501     60.2842
08200     0.2131      0.9500     0.3501     65.7596
08300     0.2817      0.9100     0.3569     65.0878
08400     0.2691      0.9100     0.3863     61.6208
08500     0.2585      0.9200     0.3863     62.4449
08600     0.2650      0.9200     0.3937     61.6937
08700     0.2051      0.9500     0.3989     61.4982
08800     0.2401      0.9400     0.4013     63.3319
08900     0.4004      0.8900     0.4013     60.3252
09000     0.1996      0.9400     0.4013     63.8606
09100     0.2322      0.9300     0.4013     61.2509
09200     0.2650      0.9200     0.4013     63.2212
09300     0.2035      0.9600     0.4085     60.9959
09400     0.2879      0.9300     0.4085     62.8493
09500     0.1757      0.9500     0.4085     65.4071
09600     0.3051      0.9100     0.4085     60.6390
09700     0.2581      0.9600     0.4085     62.0166
09800     0.3407      0.9100     0.4085     60.7984
09900     0.1574      0.9600     0.4085     62.4680
10000     0.3395      0.9100     0.4085     63.5839
10100     0.2877      0.9200     0.4085     64.2511
10200     0.2425      0.9400     0.4123     61.4403
10300     0.1084      0.9900     0.4190     63.1627
10400     0.3255      0.9000     0.4190     60.7547
10500     0.1952      0.9600     0.4245     62.0500
10600     0.1483      0.9600     0.4245     62.7091
10700     0.2229      0.9500     0.4245     61.8427
10800     0.1407      0.9500     0.4245     60.4065
10900     0.2192      0.9400     0.4245     60.7721
11000     0.2985      0.9100     0.4245     63.7069
11100     0.2081      0.9500     0.4245     65.6771
11200     0.1878      0.9300     0.4337     62.7687
11300     0.1340      0.9700     0.4337     63.7378
11400     0.1815      0.9700     0.4462     65.3973
11500     0.0997      0.9800     0.4462     62.5585
11600     0.1832      0.9500     0.4462     64.0317
11700     0.1478      0.9700     0.4462     62.6070
11800     0.1297      0.9500     0.4462     60.8882
11900     0.1860      0.9500     0.4462     65.5391
12000     0.2853      0.9300     0.4462     65.2195
12100     0.2451      0.9400     0.4462     61.9207
12200     0.1540      0.9600     0.4556     63.0869
12300     0.1933      0.9500     0.4556     60.8055
12400     0.1510      0.9800     0.4556     60.6099
12500     0.0751      1.0000     0.4556     60.1933
12600     0.2151      0.9300     0.4556     63.3675
12700     0.0926      0.9800     0.4556     66.1578
12800     0.1361      0.9600     0.4556     65.8893
12900     0.1720      0.9700     0.4556     66.0247
13000     0.2188      0.9300     0.4556     62.1696
13100     0.1090      0.9900     0.4556     60.4936
13200     0.3046      0.9400     0.4556     61.9715
13300     0.2768      0.9300     0.4556     62.6828
13400     0.1762      0.9500     0.4556     61.8460
13500     0.1226      0.9700     0.4556     62.5474
13600     0.3227      0.9100     0.4556     63.0251
13700     0.1939      0.9600     0.4556     63.4066
13800     0.1860      0.9500     0.4556     67.4106
13900     0.1388      0.9600     0.4556     66.1042
14000     0.1065      0.9600     0.4556     65.3481
14100     0.1678      0.9700     0.4556     61.2368
14200     0.0987      0.9800     0.4556     61.2676
14300     0.1329      0.9800     0.4556     60.9672
14400     0.1790      0.9400     0.4556     63.9940
14500     0.1340      0.9700     0.4556     60.1142
14600     0.2400      0.9400     0.4556     60.5053
14700     0.1560      0.9700     0.4556     60.3642
14800     0.0926      0.9800     0.4556     63.0335
14900     0.1517      0.9600     0.4556     63.4093
15000     0.1395      0.9600     0.4556     60.9661
15100     0.1020      0.9700     0.4556     63.5329
15200     0.1321      0.9600     0.4556     60.7070
15300     0.0788      0.9900     0.4556     60.6675
15400     0.1165      0.9800     0.4556     61.6138
15500     0.1043      0.9700     0.4556     60.7143
15600     0.1172      0.9700     0.4556     60.5108
15700     0.1588      0.9600     0.4556     60.5145
15800     0.2065      0.9400     0.4556     60.3518
15900     0.1980      0.9400     0.4556     62.7127
16000     0.1862      0.9400     0.4556     62.0113
16100     0.1631      0.9700     0.4556     61.3348
16200     0.1459      0.9600     0.4556     63.4928
16300     0.1318      0.9800     0.4556     60.7565
16400     0.1723      0.9400     0.4556     62.8478
16500     0.1683      0.9500     0.4556     64.0152
16600     0.1212      0.9700     0.4556     65.8411
16700     0.1762      0.9700     0.4557     64.6879
16800     0.1556      0.9700     0.4557     61.1622
16900     0.1418      0.9600     0.4557     67.8669
17000     0.1441      0.9500     0.4557     60.4207
17100     0.1094      0.9900     0.4557     63.9450
17200     0.2045      0.9600     0.4557     64.3548
17300     0.0833      0.9800     0.4557     61.8471
17400     0.1782      0.9400     0.4557     60.8933
17500     0.2377      0.9300     0.4557     60.3871
17600     0.0584      0.9900     0.4557     62.0337
17700     0.2011      0.9500     0.4557     60.7579
17800     0.1057      0.9900     0.4557     63.3154
17900     0.1502      0.9700     0.4557     63.0439
18000     0.1848      0.9400     0.4557     62.6499
18100     0.1960      0.9700     0.4557     64.0028
18200     0.1659      0.9500     0.4557     63.2494
18300     0.1187      0.9600     0.4557     61.3087
18400     0.2466      0.9500     0.4557     63.8432
18500     0.2882      0.9300     0.4557     64.0338
18600     0.1334      0.9700     0.4557     62.8877
18700     0.1399      0.9500     0.4557     63.0724
18800     0.2706      0.9400     0.4557     61.7389
18900     0.1000      0.9800     0.4557     60.6516
19000     0.1646      0.9600     0.4557     61.4410
19100     0.0692      0.9900     0.4557     62.8006
19200     0.1234      0.9700     0.4557     63.1625
19300     0.1633      0.9800     0.4557     62.7953
19400     0.1222      0.9800     0.4557     64.5800
19500     0.1366      0.9700     0.4557     64.6780
19600     0.1923      0.9400     0.4557     62.2280
19700     0.1198      0.9500     0.4557     63.6562
19800     0.1335      0.9500     0.4557     60.4859
19900     0.0939      0.9800     0.4557     62.5041
20000     0.1141      0.9600     0.4557     60.6945
20100     0.0885      0.9800     0.4557     60.3927
20199     0.1945      0.9600     0.4557     60.2355
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     4.0532      0.4400     0.4358     19.6674
00100     0.9307      0.7400     0.6546     65.2649
00200     1.1794      0.7500     0.7285     65.4084
00300     0.7585      0.7900     0.7609     62.0897
00400     0.8303      0.7800     0.7781     60.7004
00500     0.7116      0.7400     0.7938     61.0604
00600     0.7438      0.7700     0.7938     61.3203
00700     0.6495      0.8100     0.7967     61.2769
00800     0.7441      0.8000     0.8062     62.4813
00900     0.8871      0.7600     0.8062     65.6630
01000     0.9209      0.7800     0.8123     63.7484
01100     0.6569      0.8200     0.8123     60.8005
01200     0.4460      0.8600     0.8150     62.3814
01300     0.5501      0.8300     0.8209     60.7309
01400     0.4880      0.8800     0.8209     60.4715
01500     0.8439      0.8300     0.8209     60.2237
01600     0.4714      0.8700     0.8209     61.7610
01700     0.4148      0.8900     0.8209     60.5091
01800     0.7037      0.8100     0.8237     60.7732
01900     0.6557      0.7900     0.8370     61.4454
02000     0.6440      0.8200     0.8370     60.3938
02100     0.5879      0.8300     0.8370     61.1887
02200     0.7990      0.8300     0.8370     60.6071
02300     0.3616      0.8800     0.8370     64.5868
02400     0.7847      0.8100     0.8370     63.9627
02500     0.6139      0.8200     0.8381     60.9926
02600     0.5055      0.8900     0.8381     62.9755
02700     0.7052      0.8100     0.8384     63.7799
02800     0.4542      0.8700     0.8416     61.2665
02900     0.4777      0.8700     0.8416     62.2195
03000     0.5001      0.8600     0.8416     60.3931
03100     0.5031      0.8600     0.8453     61.9829
03200     0.2905      0.9300     0.8453     63.1980
03300     0.4958      0.8200     0.8470     61.9394
03400     0.6347      0.8600     0.8470     60.9919
03500     0.7518      0.7800     0.8470     64.2186
03600     0.4829      0.8300     0.8470     61.0569
03700     0.6876      0.8000     0.8470     61.3205
03800     0.6476      0.8000     0.8470     61.8757
03900     0.6705      0.7800     0.8480     65.7077
04000     0.3947      0.8800     0.8480     66.5943
04100     0.4246      0.8800     0.8480     61.2013
04200     0.4100      0.8900     0.8480     61.9600
04300     0.4237      0.8800     0.8480     62.2755
04400     0.5258      0.8700     0.8490     63.9096
04500     0.4325      0.8500     0.8490     63.9577
04600     0.6025      0.8300     0.8490     61.4858
04700     0.6398      0.8200     0.8490     64.5502
04800     0.4937      0.8400     0.8511     64.2438
04900     0.5778      0.8400     0.8511     62.3965
05000     0.5867      0.8600     0.8511     61.3142
05100     0.5451      0.8600     0.8511     60.9418
05200     0.5459      0.8500     0.8511     64.8383
05300     0.4081      0.9200     0.8529     61.4112
05400     0.6893      0.8100     0.8529     60.6454
05500     0.4874      0.8200     0.8529     60.4811
05600     0.9212      0.7400     0.8529     60.6155
05700     0.4850      0.9100     0.8529     61.5172
05800     0.4881      0.8400     0.8529     63.7135
05900     0.2982      0.9300     0.8529     66.7634
06000     0.5613      0.8800     0.8560     61.4922
06100     0.5203      0.8800     0.8560     60.6356
06200     0.7056      0.8000     0.8560     63.6237
06300     0.6197      0.8200     0.8560     61.5771
06400     0.4477      0.9000     0.8560     60.1078
06500     0.5587      0.8500     0.8560     60.5203
06600     0.3503      0.8900     0.8578     61.0998
06700     0.4696      0.8900     0.8578     62.6489
06800     0.3583      0.8900     0.8613     61.4907
06900     0.4208      0.9000     0.8636     64.5167
07000     0.4446      0.8900     0.8636     61.4841
07100     0.5255      0.8600     0.8636     61.7084
07200     0.2193      0.9600     0.8636     66.1113
07300     0.5516      0.8900     0.8636     62.3163
07400     0.3571      0.9100     0.8636     61.3616
07500     0.4580      0.8700     0.8636     60.6682
07600     0.3702      0.8500     0.8636     63.9705
07700     0.5712      0.8700     0.8636     62.4732
07800     0.6784      0.8500     0.8640     61.0785
07900     0.4624      0.8700     0.8640     64.4610
08000     0.4989      0.8800     0.8640     60.4331
08100     0.5979      0.8400     0.8640     62.9887
08200     0.4277      0.8700     0.8640     60.5044
08300     0.2691      0.9200     0.8640     60.2820
08400     0.3885      0.8900     0.8667     66.7503
08500     0.3996      0.8600     0.8667     63.6887
08600     0.3474      0.9000     0.8672     64.2610
08700     0.6679      0.8200     0.8672     62.4406
08800     0.4392      0.8900     0.8672     60.5267
08900     0.4483      0.8500     0.8672     61.2207
09000     0.6394      0.8200     0.8672     60.6802
09100     0.4291      0.8700     0.8672     61.7617
09200     0.5015      0.8700     0.8672     65.4757
09300     0.4142      0.8600     0.8672     61.3242
09400     0.6507      0.8300     0.8672     61.0452
09500     0.4022      0.8900     0.8672     61.4220
09600     0.3934      0.8800     0.8672     62.0226
09700     0.4921      0.8800     0.8672     63.4960
09800     0.3787      0.8600     0.8678     62.5836
09900     0.6732      0.8400     0.8678     63.8011
Start testing:
Test Accuracy: 0.8995
