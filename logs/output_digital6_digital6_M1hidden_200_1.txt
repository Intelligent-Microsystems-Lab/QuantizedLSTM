Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=194, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=235899598, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
8c2d4cc2-e58f-429b-96c2-32ac6adeaf3f
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 167, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 374, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 232, in forward
    new_h = quant_pass(pact_a_bmm(activated_cell * output_gate_out, self.a11), self.abNM, self.a11)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 124, in pact_a_bmm
    return torch.sign(x) * .5 * (torch.abs(x) - torch.abs(torch.abs(x) - a) + a)
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 11.78 GiB total capacity; 10.36 GiB already allocated; 9.38 MiB free; 10.60 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=194, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=235899598, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
aa4c6efc-28c2-4f24-be5d-5d99f59ab3c9
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     3.3292      0.0700     0.0850     18.6001
00100     1.6213      0.4800     0.0957     74.0195
00200     1.4581      0.4300     0.0957     72.3304
00300     1.0565      0.5900     0.0962     76.7423
00400     1.1670      0.6300     0.0962     72.1191
00500     0.7856      0.7100     0.0985     72.7858
00600     0.9283      0.7100     0.0985     72.7304
00700     0.7108      0.7200     0.0985     80.1746
00800     0.8944      0.6500     0.0998     75.8846
00900     0.6372      0.7700     0.1099     76.9757
01000     0.6292      0.7600     0.1099     77.4694
01100     0.9387      0.6900     0.1099     74.7460
01200     0.6367      0.8000     0.1099     72.1749
01300     0.6558      0.8000     0.1099     73.8046
01400     0.9107      0.7100     0.1099     79.8964
01500     0.6022      0.7800     0.1099     75.8932
01600     0.5536      0.8000     0.1099     75.6133
01700     0.4974      0.8400     0.1099     72.8344
01800     0.7284      0.7600     0.1099     79.8925
01900     0.6391      0.7600     0.1099     75.1707
02000     0.5626      0.8300     0.1099     76.6899
02100     0.5449      0.7800     0.1099     77.9559
02200     0.4302      0.8400     0.1099     73.7245
02300     0.4798      0.8700     0.1109     73.8871
02400     0.3919      0.8500     0.1177     74.8380
02500     0.4788      0.8300     0.1193     74.4482
02600     0.5849      0.8200     0.1193     77.1846
02700     0.3088      0.9000     0.1193     77.0332
02800     0.5911      0.8100     0.1193     75.3488
02900     0.4382      0.8600     0.1193     76.0407
03000     0.4727      0.8500     0.1196     77.0084
03100     0.4886      0.8500     0.1196     76.8317
03200     0.2635      0.9300     0.1227     77.2664
03300     0.3344      0.8800     0.1251     72.3012
03400     0.3946      0.8300     0.1313     73.8767
03500     0.4421      0.8700     0.1313     77.1614
03600     0.2561      0.8900     0.1313     73.8803
03700     0.4944      0.8700     0.1313     76.9096
03800     0.4113      0.8700     0.1313     77.2734
03900     0.3477      0.8800     0.1313     75.4033
04000     0.3739      0.8800     0.1429     77.1527
04100     0.4709      0.8700     0.1429     74.9066
04200     0.3614      0.9100     0.1429     77.0783
04300     0.4251      0.8300     0.1429     76.6706
04400     0.3447      0.9300     0.1429     81.9103
04500     0.5864      0.8100     0.1429     76.9220
04600     0.3766      0.8900     0.1429     74.7032
04700     0.2743      0.8900     0.1429     76.4352
04800     0.2792      0.9300     0.1429     73.5924
04900     0.2718      0.8800     0.1433     72.8466
05000     0.4272      0.8900     0.1523     72.9608
05100     0.3881      0.8300     0.1523     74.1520
05200     0.5227      0.8100     0.1535     73.8061
05300     0.4237      0.8800     0.1535     76.1475
05400     0.4385      0.8500     0.1535     77.7565
05500     0.3266      0.9100     0.1535     72.8544
05600     0.4640      0.8400     0.1542     76.6153
05700     0.3838      0.8800     0.1638     74.9104
05800     0.2271      0.9200     0.1638     77.7257
05900     0.2420      0.9300     0.1669     75.4865
06000     0.2225      0.8800     0.1669     75.4004
06100     0.3315      0.8600     0.1669     74.4910
06200     0.3132      0.8800     0.1732     73.7885
06300     0.1786      0.9500     0.1732     72.4951
06400     0.3872      0.8500     0.1732     77.0569
06500     0.2488      0.9400     0.1732     76.2334
06600     0.3166      0.9200     0.1732     75.1938
06700     0.3648      0.9200     0.1732     78.6363
06800     0.6505      0.8200     0.1732     79.8301
06900     0.4285      0.9100     0.1732     73.7898
07000     0.2633      0.9100     0.1732     76.6141
07100     0.2544      0.9400     0.1732     74.4952
07200     0.3521      0.8600     0.1860     80.4177
07300     0.2867      0.9000     0.1860     74.7828
07400     0.5780      0.8000     0.1860     76.4456
07500     0.3000      0.8900     0.2000     74.3176
07600     0.4056      0.8700     0.2000     75.6143
07700     0.4003      0.8300     0.2000     74.6517
07800     0.2688      0.9200     0.2000     74.9728
07900     0.2757      0.9300     0.2015     77.6228
08000     0.3109      0.8800     0.2015     77.1667
08100     0.3027      0.8900     0.2020     74.2862
08200     0.3161      0.8800     0.2202     75.5989
08300     0.3215      0.8900     0.2202     77.0866
08400     0.2913      0.9000     0.2202     72.3189
08500     0.3790      0.8300     0.2202     73.4753
08600     0.4754      0.8500     0.2223     78.3497
08700     0.2286      0.9100     0.2223     74.6422
08800     0.3365      0.8600     0.2282     79.9599
08900     0.5685      0.8700     0.2282     73.3404
09000     0.2446      0.9100     0.2415     75.6111
09100     0.2877      0.8800     0.2415     77.1200
09200     0.2697      0.8600     0.2415     74.0095
09300     0.4430      0.8300     0.2502     76.7783
09400     0.2114      0.9100     0.2502     73.9597
09500     0.2121      0.9300     0.2502     72.7815
09600     0.3040      0.9000     0.2502     76.6155
09700     0.4385      0.8600     0.2502     76.0823
09800     0.1693      0.9100     0.2502     73.7195
09900     0.2114      0.9200     0.2502     78.5840
10000     0.2310      0.9100     0.2537     74.0849
10100     0.1739      0.9600     0.2647     73.9537
10200     0.3247      0.9300     0.2672     77.8301
10300     0.2134      0.9100     0.2672     74.6168
10400     0.3232      0.9000     0.2672     74.5868
10500     0.1353      0.9400     0.2672     73.7747
10600     0.1826      0.9300     0.2672     80.8864
10700     0.1851      0.9300     0.2785     73.4306
10800     0.2968      0.9200     0.2785     75.2555
10900     0.1652      0.9400     0.2785     74.7742
11000     0.2646      0.9100     0.2785     74.2157
11100     0.2519      0.9000     0.2785     74.7895
11200     0.1417      0.9400     0.2785     74.0166
11300     0.2145      0.9100     0.2785     73.0948
11400     0.2462      0.9300     0.2785     81.2598
11500     0.2767      0.9500     0.2785     78.0094
11600     0.3862      0.8300     0.2785     74.0488
11700     0.2451      0.9400     0.2785     74.7204
11800     0.2241      0.9200     0.2785     74.9914
11900     0.2329      0.9300     0.2785     77.0857
12000     0.1726      0.9400     0.2785     76.6325
12100     0.1747      0.9400     0.2785     74.4648
12200     0.2737      0.9100     0.2785     73.8315
12300     0.2822      0.9000     0.2785     79.0245
12400     0.1866      0.9200     0.2785     76.3873
12500     0.1979      0.9300     0.2785     75.4842
12600     0.1628      0.9500     0.2785     74.5541
12700     0.2343      0.9300     0.2785     78.8368
12800     0.1681      0.9300     0.2785     79.0760
12900     0.1322      0.9700     0.2785     77.2864
13000     0.3597      0.8900     0.2785     73.5249
13100     0.2265      0.9300     0.2785     77.3183
13200     0.2780      0.8900     0.2785     77.3112
13300     0.1157      0.9700     0.2785     78.5854
13400     0.2864      0.9100     0.2785     74.3373
13500     0.2960      0.9100     0.2785     72.3544
13600     0.2972      0.8900     0.2785     76.4968
13700     0.2704      0.9100     0.2785     75.8093
13800     0.2830      0.8900     0.2785     74.2128
13900     0.2668      0.9200     0.2785     72.6447
14000     0.2065      0.9200     0.2785     78.6259
14100     0.1685      0.9500     0.2785     74.5096
14200     0.0643      0.9800     0.2785     77.5821
14300     0.2029      0.9200     0.2785     78.8995
14400     0.2678      0.8900     0.2785     76.0740
14500     0.2389      0.9000     0.2785     76.7311
14600     0.1789      0.9400     0.2785     74.7728
14700     0.2325      0.9200     0.2785     72.0784
14800     0.2271      0.9100     0.2881     76.9085
14900     0.1606      0.9400     0.2881     76.8227
15000     0.2934      0.9200     0.2881     75.9743
15100     0.1835      0.9300     0.2881     74.2181
15200     0.2473      0.9200     0.2881     75.4857
15300     0.2375      0.9300     0.2881     77.3296
15400     0.2652      0.8800     0.2881     79.1861
15500     0.1744      0.9200     0.2881     77.4414
15600     0.2079      0.9400     0.2881     77.2072
15700     0.1455      0.9600     0.2881     74.0121
15800     0.1852      0.9100     0.2881     75.9831
15900     0.2707      0.9000     0.2881     81.4269
16000     0.1614      0.9400     0.2881     80.1668
16100     0.1108      0.9800     0.2881     77.6371
16200     0.4966      0.8400     0.2881     77.0463
16300     0.2795      0.9100     0.2881     77.9209
16400     0.1276      0.9600     0.2881     78.2808
16500     0.1244      0.9200     0.2881     76.1850
16600     0.2164      0.9600     0.2881     79.7106
16700     0.2169      0.9100     0.2881     74.8676
16800     0.1772      0.9100     0.2881     73.3023
16900     0.1873      0.9300     0.2881     74.3782
17000     0.2095      0.9500     0.2881     73.2533
17100     0.1042      0.9700     0.2881     73.6908
17200     0.0859      0.9800     0.2881     74.0621
17300     0.2691      0.8900     0.2881     73.1486
17400     0.1533      0.9500     0.2881     72.1275
17500     0.2370      0.9300     0.2881     78.1426
17600     0.1632      0.9400     0.2881     79.4085
17700     0.1776      0.9400     0.2881     75.0375
17800     0.1805      0.9300     0.2881     76.3523
17900     0.1240      0.9500     0.2881     74.4553
18000     0.1443      0.9500     0.2881     76.0462
18100     0.1099      0.9800     0.2881     79.8912
18200     0.1653      0.9600     0.2881     78.8012
18300     0.2089      0.9300     0.2881     74.7309
18400     0.1567      0.9400     0.2881     79.6102
18500     0.2836      0.9200     0.2881     76.0535
18600     0.2209      0.9000     0.2881     76.8405
18700     0.0856      0.9800     0.2881     76.3848
18800     0.1324      0.9700     0.2881     74.2476
18900     0.1611      0.9300     0.2881     78.3185
19000     0.1361      0.9600     0.2881     77.5376
19100     0.2354      0.9300     0.2881     76.0669
19200     0.2323      0.9400     0.2881     79.6352
19300     0.1628      0.9600     0.2881     76.0118
19400     0.2588      0.9000     0.2881     75.5369
19500     0.2214      0.9300     0.2881     80.3060
19600     0.2066      0.9100     0.2881     76.3846
19700     0.1596      0.9700     0.2881     74.2661
19800     0.2285      0.8800     0.2881     75.5237
19900     0.2482      0.9600     0.2881     77.2117
20000     0.0616      0.9800     0.2881     75.7126
20100     0.3230      0.9300     0.2881     79.7824
20199     0.2307      0.9200     0.2881     72.6295
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     5.4797      0.2600     0.2659     17.7310
00100     2.9865      0.2500     0.4227     73.6127
00200     2.1892      0.4500     0.5117     73.4768
00300     1.9812      0.4600     0.5495     81.9707
00400     1.7917      0.5200     0.5919     73.9219
00500     2.0049      0.5200     0.6207     76.1111
00600     1.2159      0.7200     0.6373     74.2062
00700     0.8986      0.7200     0.6390     78.2840
00800     1.3273      0.6800     0.6684     73.5819
00900     1.2843      0.6500     0.6868     77.7413
01000     1.4411      0.6000     0.6868     74.4813
01100     1.7189      0.6100     0.6869     81.5424
01200     1.1278      0.6500     0.6926     75.8921
01300     1.0696      0.7200     0.6926     73.7427
01400     1.0849      0.7100     0.7033     74.4678
01500     1.3111      0.6600     0.7162     78.8691
01600     1.2234      0.7100     0.7212     74.1314
01700     0.8470      0.7500     0.7212     74.1160
01800     0.7617      0.7800     0.7212     73.4828
01900     1.0427      0.7000     0.7212     77.9588
02000     0.8633      0.7900     0.7302     77.3837
02100     0.7890      0.8000     0.7302     76.5872
02200     0.8526      0.7000     0.7302     73.2183
02300     1.1825      0.7100     0.7318     75.7463
02400     1.2997      0.6900     0.7318     74.6427
02500     1.0660      0.7100     0.7332     77.2039
02600     1.2739      0.7300     0.7332     74.9670
02700     0.4713      0.8500     0.7404     73.8659
02800     1.0649      0.7400     0.7437     72.8195
02900     1.0679      0.7300     0.7437     79.9563
03000     1.2691      0.6800     0.7437     74.0288
03100     1.2720      0.7500     0.7469     74.2443
03200     1.0691      0.7000     0.7589     77.9151
03300     0.8666      0.7800     0.7589     73.2881
03400     1.0707      0.7000     0.7589     74.3666
03500     1.0275      0.7400     0.7589     79.0061
03600     0.9443      0.7500     0.7589     75.6920
03700     0.7489      0.8000     0.7617     75.1921
03800     0.7074      0.8200     0.7617     72.9460
03900     1.2638      0.7200     0.7617     78.9628
04000     0.8192      0.7600     0.7617     73.2991
04100     0.9699      0.7400     0.7617     75.4920
04200     0.6001      0.7600     0.7617     74.7840
04300     0.8883      0.7700     0.7658     74.6871
04400     0.9561      0.7800     0.7658     74.0225
04500     0.9548      0.7600     0.7727     74.0486
04600     0.9678      0.8100     0.7727     80.0253
04700     1.0978      0.7600     0.7727     77.5139
04800     1.0435      0.7500     0.7727     78.5654
04900     0.9728      0.7400     0.7733     78.0311
05000     0.6404      0.8500     0.7733     74.6075
05100     0.7164      0.7800     0.7802     73.4797
05200     0.5241      0.8500     0.7802     79.3138
05300     0.8069      0.8100     0.7802     74.9035
05400     0.5154      0.8300     0.7845     74.9372
05500     0.7917      0.7500     0.7845     75.3361
05600     0.9645      0.7200     0.7845     74.1823
05700     1.0273      0.7400     0.7845     73.6112
05800     1.6228      0.6600     0.7845     73.5080
05900     0.8867      0.7600     0.7888     74.1462
06000     0.8226      0.7700     0.7888     74.4522
06100     1.0805      0.7200     0.7888     74.4341
06200     0.7408      0.8200     0.7888     72.2187
06300     0.9885      0.7600     0.7922     78.2331
06400     0.4699      0.8400     0.7922     73.3508
06500     0.6417      0.8400     0.7922     74.9956
06600     0.8628      0.7800     0.7922     78.8842
06700     0.9161      0.6600     0.7922     79.5622
06800     0.8748      0.7800     0.8005     77.6574
06900     0.8376      0.7800     0.8005     74.4836
07000     1.1652      0.7300     0.8005     78.8127
07100     0.7852      0.7800     0.8005     73.1572
07200     0.5120      0.8500     0.8005     76.4223
07300     1.1206      0.7100     0.8005     75.3533
07400     0.6901      0.7800     0.8005     76.8470
07500     0.8247      0.7800     0.8005     78.2363
07600     0.6698      0.7900     0.8005     77.1493
07700     0.9438      0.7300     0.8005     73.3170
07800     0.8195      0.8400     0.8005     76.3459
07900     0.5807      0.8200     0.8005     80.7876
08000     0.9314      0.7600     0.8005     73.3796
08100     0.7050      0.8400     0.8014     73.5744
08200     0.5953      0.8100     0.8014     76.4879
08300     0.7901      0.8000     0.8014     76.6016
08400     1.1689      0.7000     0.8014     74.8441
08500     0.7767      0.7700     0.8014     73.2277
08600     0.7048      0.8100     0.8048     76.8409
08700     0.3876      0.8800     0.8048     73.6090
08800     0.5875      0.8400     0.8048     77.7070
08900     0.9721      0.7300     0.8048     73.4792
09000     0.8692      0.8000     0.8048     72.9068
09100     1.2794      0.7200     0.8048     74.0367
09200     0.5418      0.8200     0.8048     74.0281
09300     0.6915      0.8500     0.8048     74.0964
09400     0.8978      0.8200     0.8048     77.9712
09500     0.5458      0.8000     0.8048     78.3266
09600     0.7438      0.8000     0.8083     80.2969
09700     0.7717      0.8200     0.8115     74.5457
09800     0.9279      0.7800     0.8115     78.7402
09900     0.9306      0.7400     0.8115     79.2336
Start testing:
Test Accuracy: 0.8674
