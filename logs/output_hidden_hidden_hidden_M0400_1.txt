Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=394, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=235899598, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
90317049-df30-4122-869c-b6db8598a5f9
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 147, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 290, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 213, in forward
    gates = quant_pass(pact_a_bmm( quant_pass(pact_a_bmm(part1, self.a12), self.abMVM, self.a12) + quant_pass(pact_a_bmm(part2, self.a13), self.abMVM, self.a13), self.a14), self.abNM, self.a14)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 89, in forward
    x01q =  torch.round(x01 * step_d ) / step_d
RuntimeError: CUDA out of memory. Tried to allocate 12.00 MiB (GPU 0; 10.76 GiB total capacity; 9.69 GiB already allocated; 9.12 MiB free; 9.80 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=394, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=235899598, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
9e79f651-e3fb-4698-974e-7d2b4e93960f
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     2.8892      0.0400     0.0838     19.4797
00100     1.2680      0.5900     0.5568     56.9052
00200     1.1049      0.6500     0.6739     55.8145
00300     1.0047      0.6400     0.7292     55.8541
00400     1.0279      0.7200     0.7516     59.2243
00500     0.8110      0.7400     0.7781     58.0237
00600     0.8531      0.7800     0.7855     60.9213
00700     0.7597      0.7600     0.7969     56.1651
00800     0.8931      0.7300     0.8012     59.4853
00900     0.8827      0.7600     0.8012     56.5109
01000     0.8368      0.7900     0.8091     56.2685
01100     0.8265      0.7200     0.8157     57.6310
01200     0.9357      0.6900     0.8236     57.6432
01300     0.7685      0.7400     0.8236     56.4481
01400     0.7137      0.7700     0.8302     57.8662
01500     0.6389      0.8000     0.8326     56.3793
01600     0.6035      0.8100     0.8326     59.5901
01700     0.5945      0.8000     0.8472     60.4537
01800     0.5013      0.8800     0.8472     55.8990
01900     0.6660      0.8100     0.8472     56.9274
02000     0.7096      0.7700     0.8472     56.8975
02100     0.7360      0.7400     0.8472     59.5471
02200     0.8049      0.7900     0.8472     56.3962
02300     0.5628      0.8300     0.8472     55.7682
02400     0.7395      0.7900     0.8511     56.4709
02500     0.6567      0.8300     0.8511     57.6832
02600     0.4652      0.8700     0.8511     59.4731
02700     0.7402      0.7800     0.8511     60.4071
02800     0.6932      0.7700     0.8550     58.6574
02900     0.7434      0.7800     0.8619     56.1753
03000     0.5840      0.8200     0.8619     58.5809
03100     0.5618      0.8300     0.8619     56.7270
03200     0.6381      0.8400     0.8619     55.8954
03300     0.6958      0.7800     0.8624     56.3813
03400     0.6509      0.7900     0.8624     57.8411
03500     0.7890      0.7800     0.8624     57.8914
03600     0.6502      0.8000     0.8624     58.6673
03700     0.5901      0.8300     0.8624     56.5216
03800     0.5385      0.8200     0.8624     57.4156
03900     0.6588      0.7900     0.8624     58.0700
04000     0.5257      0.8500     0.8624     58.9177
04100     0.5969      0.7800     0.8624     59.4009
04200     0.6667      0.8000     0.8624     55.3058
04300     0.5430      0.8600     0.8624     57.2036
04400     0.7339      0.7500     0.8624     57.0781
04500     0.4139      0.8800     0.8624     60.9461
04600     0.7170      0.7700     0.8624     57.9204
04700     0.5404      0.8000     0.8672     57.7466
04800     0.6259      0.8100     0.8672     55.8756
04900     0.5048      0.8100     0.8672     56.3451
05000     0.5285      0.8300     0.8672     60.8752
05100     0.3944      0.8800     0.8672     55.9645
05200     0.4658      0.8200     0.8697     57.3520
05300     0.5470      0.8200     0.8698     58.2147
05400     0.4611      0.8700     0.8698     60.0175
05500     0.6608      0.7900     0.8698     57.1418
05600     0.6494      0.7800     0.8698     57.5131
05700     0.6952      0.8500     0.8740     61.3956
05800     0.5899      0.8000     0.8740     60.5566
05900     0.5045      0.8400     0.8740     56.6583
06000     0.4778      0.8400     0.8740     58.0158
06100     0.4612      0.8600     0.8740     56.9087
06200     0.5078      0.8600     0.8740     60.0416
06300     0.5247      0.8500     0.8740     56.2085
06400     0.6425      0.7900     0.8767     57.0769
06500     0.8530      0.7600     0.8767     56.6115
06600     0.7295      0.8100     0.8767     59.6411
06700     0.5474      0.8600     0.8767     59.6722
06800     0.3142      0.8800     0.8767     57.9241
06900     0.6691      0.8000     0.8767     61.7898
07000     0.4927      0.8300     0.8767     58.4319
07100     0.4849      0.8600     0.8767     55.5992
07200     0.6483      0.7800     0.8767     56.6000
07300     0.7274      0.8200     0.8767     56.4931
07400     0.4215      0.8900     0.8767     60.8510
07500     0.4572      0.8600     0.8767     59.8407
07600     0.4151      0.9000     0.8767     59.4811
07700     0.5773      0.8500     0.8789     60.6527
07800     0.4232      0.8400     0.8789     58.6633
07900     0.5648      0.8400     0.8789     55.4019
08000     0.5684      0.8200     0.8789     59.8120
08100     0.6101      0.8100     0.8789     59.2575
08200     0.4832      0.8500     0.8789     57.8704
08300     0.6936      0.7900     0.8789     55.5442
08400     0.4234      0.8900     0.8842     59.3195
08500     0.5259      0.8300     0.8842     60.8544
08600     0.4168      0.8900     0.8842     57.8922
08700     0.5502      0.7900     0.8857     55.8847
08800     0.4214      0.8400     0.8857     59.1289
08900     0.6202      0.8300     0.8857     57.5755
09000     0.4159      0.8900     0.8857     61.0564
09100     0.3712      0.9100     0.8857     57.9318
09200     0.4557      0.8600     0.8857     57.2269
09300     0.3927      0.8800     0.8857     55.4870
09400     0.4479      0.8600     0.8857     59.3170
09500     0.4673      0.8900     0.8857     58.6654
09600     0.4219      0.8700     0.8857     56.4495
09700     0.5628      0.8000     0.8857     55.4967
09800     0.5088      0.8700     0.8857     57.0591
09900     0.4596      0.8800     0.8857     56.7442
10000     0.6777      0.8200     0.8857     56.5512
10100     0.4213      0.8600     0.8880     61.1648
10200     0.4215      0.8800     0.8880     60.4447
10300     0.4694      0.8800     0.8880     60.3302
10400     0.4426      0.8400     0.8880     57.5855
10500     0.5274      0.8400     0.8880     58.7325
10600     0.3292      0.9100     0.8880     58.7594
10700     0.5020      0.8300     0.8880     56.6346
10800     0.5153      0.8500     0.8880     60.6165
10900     0.3840      0.8900     0.8880     58.7922
11000     0.3703      0.8600     0.8880     57.3129
11100     0.4374      0.8600     0.8880     55.5140
11200     0.3462      0.9000     0.8880     58.6597
11300     0.4822      0.8700     0.8880     64.1643
11400     0.3866      0.9300     0.8880     58.7298
11500     0.4150      0.8600     0.8880     57.2468
11600     0.4112      0.8700     0.8880     59.0375
11700     0.4014      0.8600     0.8880     57.8799
11800     0.4367      0.8300     0.8880     56.3947
11900     0.3944      0.8900     0.8880     59.2919
12000     0.4034      0.8600     0.8880     58.2507
12100     0.3766      0.9100     0.8880     55.7746
12200     0.5216      0.8600     0.8880     60.8393
12300     0.2982      0.8900     0.8880     60.3038
12400     0.5146      0.8600     0.8880     57.0124
12500     0.5484      0.8200     0.8880     57.7250
12600     0.3139      0.9100     0.8880     59.0033
12700     0.2960      0.9300     0.8880     58.4560
12800     0.2022      0.9600     0.8929     58.3262
12900     0.3695      0.9100     0.8929     56.9488
13000     0.4337      0.8700     0.8929     56.0191
13100     0.4522      0.8700     0.8929     60.6401
13200     0.2286      0.9400     0.8929     58.2169
13300     0.3537      0.9200     0.8929     58.5656
13400     0.3486      0.8900     0.8929     57.8445
13500     0.3391      0.8600     0.8929     57.0614
13600     0.2984      0.9100     0.8929     57.1915
13700     0.2971      0.9100     0.8929     58.8552
13800     0.6389      0.8000     0.8929     60.5111
13900     0.3267      0.9100     0.8929     55.6353
14000     0.2667      0.9000     0.8929     56.4995
14100     0.4084      0.8600     0.8929     60.2408
14200     0.2734      0.9300     0.8929     60.4756
14300     0.3031      0.9100     0.8929     57.2258
14400     0.2495      0.9500     0.8929     58.7125
14500     0.3666      0.8900     0.8929     59.0151
14600     0.5424      0.8700     0.8929     56.5733
14700     0.5077      0.8100     0.8929     56.8630
14800     0.3070      0.9300     0.9008     58.0190
14900     0.2988      0.9100     0.9008     58.3549
15000     0.2035      0.9700     0.9008     58.2366
15100     0.3338      0.9100     0.9008     56.3551
15200     0.3933      0.8800     0.9008     58.8697
15300     0.3408      0.9000     0.9008     57.6646
15400     0.5395      0.8400     0.9008     57.4767
15500     0.2603      0.9300     0.9008     59.9392
15600     0.3536      0.9000     0.9008     58.3959
15700     0.4804      0.8600     0.9008     63.8939
15800     0.3360      0.9100     0.9008     55.7425
15900     0.4901      0.8500     0.9008     57.9294
16000     0.3398      0.9200     0.9008     55.7391
16100     0.2503      0.9300     0.9008     62.1073
16200     0.3647      0.8900     0.9008     59.3669
16300     0.3787      0.8900     0.9008     60.7094
16400     0.4592      0.8500     0.9008     59.3622
16500     0.3504      0.9000     0.9008     57.5542
16600     0.3842      0.9000     0.9008     60.8875
16700     0.4214      0.8900     0.9008     56.6400
16800     0.4425      0.8600     0.9008     58.9285
16900     0.3944      0.8700     0.9008     56.9301
17000     0.4043      0.8900     0.9008     59.0286
17100     0.3190      0.9000     0.9008     59.7121
17200     0.3472      0.9000     0.9008     58.1267
17300     0.3612      0.8800     0.9008     57.7150
17400     0.3935      0.8600     0.9008     60.4098
17500     0.2979      0.9000     0.9008     59.8203
17600     0.2240      0.9400     0.9008     58.0604
17700     0.4689      0.8800     0.9008     57.5668
17800     0.3577      0.8900     0.9008     60.8986
17900     0.2409      0.9600     0.9008     56.7777
18000     0.2513      0.9400     0.9008     58.8022
18100     0.2716      0.9200     0.9008     60.5390
18200     0.3506      0.8900     0.9008     59.6914
18300     0.4080      0.8600     0.9008     56.6976
18400     0.2819      0.9200     0.9008     58.7735
18500     0.3490      0.9000     0.9008     58.2848
18600     0.2783      0.9100     0.9008     57.2456
18700     0.3911      0.8500     0.9008     61.4870
18800     0.2539      0.9400     0.9008     58.7535
18900     0.3209      0.9100     0.9008     61.4414
19000     0.2779      0.9200     0.9008     59.5814
19100     0.1840      0.9300     0.9008     57.2959
19200     0.3459      0.9100     0.9008     56.6660
19300     0.2167      0.9300     0.9008     55.9310
19400     0.2696      0.9300     0.9008     58.8701
19500     0.4212      0.8600     0.9008     58.8358
19600     0.3764      0.8800     0.9008     57.7629
19700     0.3615      0.8700     0.9008     56.2158
19800     0.4941      0.8400     0.9008     57.9708
19900     0.2899      0.9000     0.9008     56.9526
20000     0.2854      0.9400     0.9008     56.1248
20100     0.2958      0.9100     0.9008     56.5940
20199     0.3324      0.8900     0.9008     57.6422
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     0.7417      0.8000     0.8281     15.2065
00100     0.4469      0.8100     0.8992     58.3319
00200     0.3236      0.8700     0.9012     56.2880
00300     0.3941      0.8700     0.9012     55.8454
00400     0.2457      0.9100     0.9022     56.3776
00500     0.3049      0.8900     0.9022     56.9074
00600     0.2328      0.9200     0.9022     61.3197
00700     0.3987      0.8700     0.9022     56.1529
00800     0.3923      0.8700     0.9064     57.1794
00900     0.2642      0.9400     0.9064     55.5689
01000     0.3085      0.9200     0.9069     56.7203
01100     0.2613      0.9400     0.9069     57.9473
01200     0.4046      0.8800     0.9069     56.5622
01300     0.1786      0.9600     0.9069     57.5269
01400     0.2874      0.9000     0.9069     59.3639
01500     0.3630      0.9100     0.9069     56.5192
01600     0.2302      0.9400     0.9069     56.3166
01700     0.3815      0.8900     0.9069     56.8585
01800     0.1727      0.9600     0.9069     56.2328
01900     0.5101      0.8500     0.9069     57.4477
02000     0.2679      0.9300     0.9071     59.1734
02100     0.2785      0.9000     0.9071     56.4681
02200     0.2949      0.9000     0.9071     58.9343
02300     0.3725      0.8800     0.9071     58.8858
02400     0.2772      0.9000     0.9071     59.2303
02500     0.4661      0.8500     0.9071     60.1437
02600     0.2823      0.9400     0.9071     57.3966
02700     0.2219      0.9400     0.9071     60.4540
02800     0.4097      0.8500     0.9071     62.4125
02900     0.3157      0.9100     0.9071     59.8385
03000     0.4770      0.8700     0.9071     57.8760
03100     0.3859      0.8700     0.9071     60.5351
03200     0.1960      0.9600     0.9071     56.8671
03300     0.3348      0.9000     0.9071     55.7067
03400     0.2818      0.9200     0.9071     61.3733
03500     0.2573      0.9600     0.9071     57.5135
03600     0.2196      0.9300     0.9071     58.6551
03700     0.3825      0.8700     0.9071     61.7519
03800     0.3359      0.9100     0.9082     58.4206
03900     0.4316      0.8800     0.9084     58.8802
04000     0.4093      0.8800     0.9084     57.8449
04100     0.2532      0.9500     0.9084     55.6605
04200     0.3858      0.8600     0.9084     55.9286
04300     0.3705      0.8600     0.9084     55.4302
04400     0.3982      0.9000     0.9084     56.4797
04500     0.3272      0.9100     0.9084     57.5860
04600     0.3846      0.8800     0.9084     57.9034
04700     0.1716      0.9600     0.9084     57.4318
04800     0.2937      0.9100     0.9084     56.0514
04900     0.3530      0.8800     0.9084     57.0423
05000     0.4071      0.8800     0.9084     59.9011
05100     0.5829      0.8300     0.9084     55.9352
05200     0.2633      0.9100     0.9084     56.7667
05300     0.2410      0.9500     0.9084     59.8631
05400     0.3258      0.9100     0.9084     55.8531
05500     0.2846      0.8900     0.9084     55.9847
05600     0.3618      0.8800     0.9084     57.9539
05700     0.3497      0.9000     0.9084     56.6170
05800     0.4047      0.8600     0.9084     60.5689
05900     0.2753      0.9300     0.9084     58.6858
06000     0.4841      0.8500     0.9084     57.0008
06100     0.2906      0.9400     0.9084     56.7809
06200     0.2070      0.9500     0.9084     58.9697
06300     0.3228      0.9100     0.9084     58.5156
06400     0.2756      0.9100     0.9084     55.7095
06500     0.2817      0.9100     0.9084     59.3812
06600     0.2796      0.9200     0.9084     56.9180
06700     0.3217      0.9400     0.9084     57.5738
06800     0.3009      0.9100     0.9084     59.4960
06900     0.3200      0.9200     0.9084     58.5034
07000     0.3940      0.9000     0.9084     61.3965
07100     0.2482      0.9300     0.9084     61.2985
07200     0.2961      0.8900     0.9084     62.3943
07300     0.4083      0.8700     0.9097     57.5778
07400     0.2929      0.9100     0.9097     59.7003
07500     0.4462      0.8600     0.9097     58.8632
07600     0.4723      0.8300     0.9097     57.4276
07700     0.3204      0.9100     0.9097     55.7044
07800     0.3253      0.9100     0.9097     58.3421
07900     0.3287      0.8800     0.9097     59.0209
08000     0.2507      0.9400     0.9098     60.5143
08100     0.1723      0.9700     0.9098     57.3577
08200     0.2468      0.9300     0.9098     58.2353
08300     0.2667      0.9000     0.9098     57.7123
08400     0.3204      0.9100     0.9098     62.4041
08500     0.4587      0.8300     0.9098     57.8833
08600     0.3410      0.8900     0.9103     61.3929
08700     0.2429      0.9200     0.9103     62.8315
08800     0.4110      0.8900     0.9103     61.6419
08900     0.3269      0.8900     0.9103     59.9588
09000     0.3529      0.8600     0.9103     56.7002
09100     0.2764      0.9100     0.9103     58.9341
09200     0.4216      0.8700     0.9103     55.6581
09300     0.3303      0.8800     0.9103     56.1239
09400     0.2596      0.9100     0.9103     55.7593
09500     0.2080      0.9600     0.9103     56.9357
09600     0.2718      0.9100     0.9103     57.3534
09700     0.3686      0.8900     0.9103     56.5523
09800     0.3180      0.9100     0.9103     58.4060
09900     0.3061      0.8900     0.9103     58.0327
Start testing:
Test Accuracy: 0.8959
