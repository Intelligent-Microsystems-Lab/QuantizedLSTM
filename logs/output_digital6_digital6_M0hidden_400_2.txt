Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=394, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=8627169, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
c298dedc-177e-44d3-a21b-e00891ca3516
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 147, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 290, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 213, in forward
    gates = quant_pass(pact_a_bmm( quant_pass(pact_a_bmm(part1, self.a12), self.abMVM, self.a12) + quant_pass(pact_a_bmm(part2, self.a13), self.abMVM, self.a13), self.a14), self.abNM, self.a14)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 89, in forward
    x01q =  torch.round(x01 * step_d ) / step_d
RuntimeError: CUDA out of memory. Tried to allocate 12.00 MiB (GPU 0; 10.76 GiB total capacity; 9.68 GiB already allocated; 13.12 MiB free; 9.79 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=394, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=8627169, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
759a7af6-eefa-4b0c-ada7-53b72c088ce4
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     2.9407      0.0400     0.0799     18.4224
00100     1.2322      0.6500     0.0964     61.8559
00200     1.1332      0.6400     0.1064     61.7054
00300     0.7910      0.7500     0.1064     61.1275
00400     0.8030      0.7300     0.1064     61.8817
00500     0.7531      0.7300     0.1064     61.5566
00600     0.5625      0.8300     0.1064     61.5288
00700     0.3208      0.8900     0.1109     61.6783
00800     0.5448      0.8300     0.1109     61.4039
00900     0.5534      0.8400     0.1109     61.7201
01000     0.4241      0.8800     0.1192     61.3013
01100     0.3522      0.8900     0.1250     61.3472
01200     0.4967      0.8600     0.1250     61.5995
01300     0.6032      0.8000     0.1250     62.2533
01400     0.5234      0.8200     0.1250     62.2155
01500     0.5550      0.8500     0.1250     62.2670
01600     0.4851      0.8400     0.1250     62.0583
01700     0.3949      0.8700     0.1263     62.3335
01800     0.4302      0.8900     0.1263     61.1198
01900     0.3322      0.8900     0.1263     61.9357
02000     0.4463      0.8800     0.1394     61.9922
02100     0.3591      0.9000     0.1394     61.7974
02200     0.4426      0.8700     0.1394     61.6912
02300     0.5503      0.8500     0.1394     61.3110
02400     0.6656      0.7800     0.1405     61.9305
02500     0.4722      0.8700     0.1506     62.7614
02600     0.2629      0.9000     0.1506     61.3673
02700     0.3040      0.9400     0.1506     62.5658
02800     0.3644      0.8700     0.1506     62.2758
02900     0.4317      0.9100     0.1506     61.9554
03000     0.3524      0.8900     0.1511     62.1963
03100     0.3910      0.8800     0.1650     62.0799
03200     0.3338      0.9100     0.1650     61.8680
03300     0.3693      0.8900     0.1650     61.7565
03400     0.4358      0.8900     0.1650     61.6684
03500     0.2459      0.9200     0.1813     62.6959
03600     0.4493      0.8700     0.1813     62.1135
03700     0.3060      0.9000     0.1813     62.4297
03800     0.3769      0.8700     0.1813     62.0217
03900     0.3662      0.8700     0.1813     61.7704
04000     0.3525      0.9100     0.1884     62.1458
04100     0.2999      0.9100     0.1884     61.6043
04200     0.3034      0.9000     0.1884     61.2804
04300     0.4076      0.8500     0.1918     62.3084
04400     0.3872      0.9000     0.1918     61.3466
04500     0.4105      0.8900     0.1918     63.3217
04600     0.2432      0.9400     0.1918     62.2676
04700     0.3444      0.9000     0.1968     64.0568
04800     0.2749      0.9200     0.2188     62.5616
04900     0.3350      0.9000     0.2188     63.3713
05000     0.2591      0.9400     0.2188     63.1794
05100     0.2306      0.9300     0.2188     63.3468
05200     0.4890      0.9000     0.2188     63.1389
05300     0.2754      0.9200     0.2188     61.6991
05400     0.3170      0.8700     0.2188     61.8583
05500     0.2594      0.9200     0.2287     62.4050
05600     0.3349      0.9000     0.2312     62.3728
05700     0.3207      0.9100     0.2474     61.9268
05800     0.3613      0.8900     0.2474     61.5253
05900     0.4343      0.8500     0.2474     61.8883
06000     0.3751      0.9100     0.2568     64.4919
06100     0.4010      0.8700     0.2568     65.7460
06200     0.2432      0.9200     0.2568     64.8244
06300     0.2629      0.9200     0.2754     63.9450
06400     0.1817      0.9600     0.2754     63.6110
06500     0.2142      0.9400     0.2754     63.1487
06600     0.1605      0.9800     0.2754     61.4089
06700     0.2506      0.9500     0.2754     61.8212
06800     0.3741      0.8800     0.2838     62.4656
06900     0.2369      0.9100     0.2838     61.7902
07000     0.2729      0.9300     0.2838     61.4851
07100     0.2545      0.9100     0.2857     62.0311
07200     0.4210      0.8800     0.2857     61.3811
07300     0.2756      0.9200     0.2857     61.3941
07400     0.3279      0.9100     0.2857     61.2772
07500     0.3519      0.8900     0.2857     61.5307
07600     0.2156      0.9300     0.3026     61.8332
07700     0.2014      0.9600     0.3026     62.1478
07800     0.4171      0.8800     0.3026     61.6657
07900     0.2223      0.9400     0.3026     62.7297
08000     0.2309      0.9500     0.3026     62.4321
08100     0.1902      0.9600     0.3124     63.0230
08200     0.1622      0.9600     0.3142     62.3797
08300     0.2365      0.9400     0.3142     61.6213
08400     0.2849      0.9100     0.3142     61.7575
08500     0.3012      0.9100     0.3164     62.1654
08600     0.2748      0.9200     0.3164     61.5794
08700     0.1345      0.9600     0.3676     62.0487
08800     0.4098      0.8900     0.3676     61.4682
08900     0.2648      0.9400     0.3676     61.4237
09000     0.2245      0.9300     0.3676     61.5605
09100     0.2087      0.9500     0.3676     60.8320
09200     0.2568      0.9100     0.3676     62.3763
09300     0.1754      0.9500     0.3974     61.9701
09400     0.1749      0.9400     0.3974     62.4879
09500     0.1913      0.9500     0.3974     62.3119
09600     0.3190      0.9100     0.3974     61.7954
09700     0.2386      0.9400     0.3974     61.4394
09800     0.2352      0.9500     0.3974     61.8144
09900     0.2796      0.9300     0.3974     62.3557
10000     0.1676      0.9600     0.4209     62.7127
10100     0.2644      0.9300     0.4209     61.8617
10200     0.2039      0.9600     0.4209     61.5301
10300     0.3044      0.9000     0.4344     61.4947
10400     0.2185      0.9500     0.4344     61.0969
10500     0.2747      0.9500     0.4344     61.8512
10600     0.3324      0.9300     0.4344     61.8757
10700     0.1702      0.9600     0.4344     61.6648
10800     0.1165      0.9600     0.4344     61.6214
10900     0.2235      0.9400     0.4344     61.2469
11000     0.2252      0.9300     0.4344     60.9932
11100     0.1597      0.9700     0.4344     61.5777
11200     0.1298      0.9800     0.4344     61.5428
11300     0.2026      0.9400     0.4344     61.7716
11400     0.1557      0.9700     0.4344     61.7137
11500     0.1142      0.9800     0.4344     62.0697
11600     0.2075      0.9300     0.4344     61.8025
11700     0.1867      0.9500     0.4344     61.6899
11800     0.1451      0.9700     0.4344     61.4499
11900     0.1566      0.9700     0.4344     60.9736
12000     0.1082      0.9900     0.4344     61.5643
12100     0.2228      0.9500     0.4344     61.4038
12200     0.1969      0.9600     0.4344     62.8208
12300     0.2083      0.9300     0.4344     61.3178
12400     0.1921      0.9300     0.4344     62.4378
12500     0.1197      0.9700     0.4344     61.4096
12600     0.1477      0.9600     0.4344     61.4523
12700     0.1741      0.9500     0.4344     61.3193
12800     0.1479      0.9500     0.4344     61.9320
12900     0.1300      0.9500     0.4344     61.8976
13000     0.1321      0.9700     0.4344     61.6784
13100     0.1459      0.9600     0.4344     65.2496
13200     0.1518      0.9600     0.4344     63.4391
13300     0.1914      0.9600     0.4344     62.4065
13400     0.1753      0.9600     0.4344     62.2832
13500     0.2931      0.9300     0.4344     62.5859
13600     0.1866      0.9600     0.4344     62.3167
13700     0.0846      0.9900     0.4344     62.7895
13800     0.0950      0.9800     0.4344     62.4241
13900     0.0933      0.9700     0.4344     64.3756
14000     0.2088      0.9400     0.4344     63.4984
14100     0.3139      0.9400     0.4344     64.4943
14200     0.2309      0.9200     0.4344     63.0153
14300     0.1849      0.9500     0.4344     62.0999
14400     0.1364      0.9700     0.4344     62.2795
14500     0.1219      0.9500     0.4344     61.1769
14600     0.1723      0.9500     0.4344     61.5772
14700     0.0931      1.0000     0.4344     61.3927
14800     0.1545      0.9600     0.4344     61.9591
14900     0.0920      0.9900     0.4344     61.3938
15000     0.1539      0.9700     0.4344     62.1342
15100     0.1580      0.9600     0.4344     61.5278
15200     0.1118      0.9800     0.4344     61.8197
15300     0.1545      0.9500     0.4344     61.2397
15400     0.1894      0.9600     0.4344     61.9788
15500     0.1656      0.9500     0.4440     61.9020
15600     0.1413      0.9600     0.4440     61.5426
15700     0.0645      1.0000     0.4440     62.1858
15800     0.1245      0.9700     0.4440     61.8023
15900     0.1255      0.9700     0.4440     61.9849
16000     0.0988      0.9900     0.4440     61.6184
16100     0.2134      0.9500     0.4440     61.7787
16200     0.2220      0.9300     0.4440     61.3422
16300     0.0678      0.9900     0.4440     62.2732
16400     0.1796      0.9500     0.4440     61.0785
16500     0.1296      0.9700     0.4440     61.8277
16600     0.1636      0.9500     0.4440     61.7310
16700     0.2157      0.9300     0.4440     62.7116
16800     0.1081      0.9800     0.4440     61.7224
16900     0.1697      0.9600     0.4440     61.5445
17000     0.1311      0.9700     0.4440     61.7176
17100     0.0946      0.9700     0.4440     60.8037
17200     0.0971      0.9900     0.4440     61.5697
17300     0.1967      0.9500     0.4440     61.2788
17400     0.0856      0.9800     0.4440     60.8891
17500     0.2054      0.9500     0.4440     61.1258
17600     0.0758      0.9900     0.4440     61.6984
17700     0.1278      0.9700     0.4440     61.3998
17800     0.1779      0.9600     0.4440     61.4288
17900     0.0994      0.9800     0.4440     61.2235
18000     0.0950      0.9800     0.4440     61.5982
18100     0.1923      0.9500     0.4440     60.9495
18200     0.2378      0.9400     0.4440     61.9964
18300     0.0611      0.9900     0.4440     62.3788
18400     0.1680      0.9500     0.4440     63.3355
18500     0.0775      0.9900     0.4440     62.1074
18600     0.1027      0.9800     0.4440     62.4288
18700     0.1910      0.9700     0.4440     62.4699
18800     0.1168      0.9700     0.4440     61.7853
18900     0.1443      0.9600     0.4440     61.7915
19000     0.1431      0.9500     0.4440     61.0321
19100     0.0702      0.9900     0.4440     62.8730
19200     0.1286      0.9800     0.4440     62.1702
19300     0.2097      0.9400     0.4440     61.9895
19400     0.1111      0.9700     0.4440     61.9024
19500     0.2204      0.9500     0.4440     62.2830
19600     0.0731      0.9900     0.4440     61.9333
19700     0.1982      0.9500     0.4440     61.4863
19800     0.0618      0.9900     0.4540     62.3410
19900     0.0809      0.9900     0.4540     61.8117
20000     0.2538      0.9400     0.4540     62.3081
20100     0.0882      0.9900     0.4540     62.4267
20199     0.1324      0.9600     0.4540     61.3979
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     2.4547      0.5200     0.4162     16.4844
00100     1.6162      0.5700     0.6246     62.3284
00200     1.1035      0.6700     0.6944     61.5450
00300     1.0464      0.7400     0.7393     62.4092
00400     0.8224      0.7500     0.7393     61.9366
00500     1.0596      0.7500     0.7693     62.1375
00600     0.7216      0.8000     0.7693     62.5082
00700     0.9702      0.7400     0.7865     61.5717
00800     0.8204      0.7500     0.7865     61.7219
00900     0.9845      0.7200     0.8043     61.7294
01000     0.6269      0.8300     0.8043     63.4265
01100     0.7897      0.7700     0.8050     63.1255
01200     0.6678      0.8500     0.8098     62.2598
01300     0.7754      0.7700     0.8098     61.6919
01400     0.6570      0.8500     0.8146     62.5580
01500     0.8374      0.8100     0.8146     60.9146
01600     0.5857      0.8600     0.8146     61.5262
01700     0.8886      0.7900     0.8146     61.0470
01800     0.9630      0.7600     0.8205     62.4039
01900     0.5220      0.8300     0.8214     62.1184
02000     0.5276      0.8300     0.8280     61.9138
02100     0.6838      0.8000     0.8283     61.9120
02200     0.6864      0.8200     0.8283     61.3209
02300     0.8401      0.8000     0.8287     62.0157
02400     0.7581      0.7800     0.8319     62.7234
02500     0.6963      0.8200     0.8319     65.2139
02600     0.5330      0.8600     0.8319     63.2074
02700     0.5432      0.8300     0.8319     63.0377
02800     0.9096      0.7600     0.8319     63.5942
02900     0.7442      0.7900     0.8319     62.5503
03000     0.6192      0.8800     0.8412     61.8076
03100     0.4438      0.8700     0.8412     60.8769
03200     0.7435      0.8400     0.8412     61.8655
03300     0.4839      0.8900     0.8412     61.9326
03400     0.5584      0.7900     0.8412     63.1053
03500     0.3674      0.9200     0.8412     63.1230
03600     0.6563      0.8500     0.8412     64.4755
03700     0.5714      0.8300     0.8412     63.2377
03800     0.6038      0.8200     0.8412     62.9969
03900     0.3488      0.8900     0.8412     61.3338
04000     0.5621      0.8400     0.8412     61.3654
04100     0.5393      0.8800     0.8412     61.0632
04200     0.6346      0.8200     0.8435     62.7758
04300     0.4735      0.8800     0.8435     62.9106
04400     0.4558      0.8500     0.8435     63.5669
04500     0.4951      0.8400     0.8435     63.3204
04600     0.4325      0.8900     0.8438     63.6097
04700     0.6139      0.8300     0.8438     62.3412
04800     0.5080      0.8600     0.8438     64.1381
04900     0.6140      0.8300     0.8457     64.7543
05000     0.4083      0.8600     0.8507     64.0601
05100     0.4026      0.8800     0.8529     62.7037
05200     0.6179      0.8300     0.8529     61.0636
05300     0.5879      0.8400     0.8529     61.1215
05400     0.5809      0.8400     0.8529     61.5743
05500     0.5877      0.8000     0.8529     61.2136
05600     0.7741      0.8100     0.8529     61.6667
05700     0.5704      0.8400     0.8529     61.9548
05800     0.6450      0.8500     0.8551     61.9664
05900     0.4496      0.8800     0.8551     61.6564
06000     0.4071      0.8400     0.8551     61.6697
06100     0.6216      0.8200     0.8593     62.0420
06200     0.4895      0.8400     0.8593     62.3710
06300     0.7665      0.8500     0.8593     61.5286
06400     0.3311      0.9200     0.8593     61.6475
06500     0.3525      0.8600     0.8593     61.3965
06600     0.6780      0.8400     0.8593     62.2021
06700     0.5250      0.8500     0.8593     61.8705
06800     0.5431      0.8300     0.8593     61.6852
06900     0.5568      0.8100     0.8593     60.9533
07000     0.3898      0.8800     0.8593     61.4592
07100     0.4647      0.9100     0.8593     61.0994
07200     0.5391      0.8100     0.8609     61.6553
07300     0.6727      0.8200     0.8623     61.7078
07400     0.4282      0.9100     0.8623     61.0534
07500     0.4175      0.8900     0.8623     61.4771
07600     0.5999      0.8700     0.8623     61.7311
07700     0.3710      0.9200     0.8623     61.7482
07800     0.5260      0.8600     0.8623     61.2612
07900     0.6503      0.8500     0.8623     61.3087
08000     0.5597      0.8800     0.8623     61.3546
08100     0.5077      0.8700     0.8623     61.2594
08200     0.6995      0.8300     0.8623     61.8530
08300     0.5008      0.8500     0.8623     61.5633
08400     0.4694      0.8800     0.8623     61.8989
08500     0.4662      0.8800     0.8623     61.6950
08600     0.4524      0.8600     0.8623     61.3119
08700     0.4855      0.8600     0.8623     61.2874
08800     0.4707      0.8600     0.8623     61.4666
08900     0.4237      0.9200     0.8623     62.5434
09000     0.4428      0.8700     0.8624     63.0142
09100     0.5731      0.8200     0.8624     63.1095
09200     0.5281      0.8800     0.8624     62.2772
09300     0.4360      0.8900     0.8692     62.5327
09400     0.2951      0.9200     0.8692     61.3736
09500     0.6338      0.8400     0.8692     61.6791
09600     0.3425      0.9300     0.8692     61.9803
09700     0.4977      0.8800     0.8692     62.1412
09800     0.5414      0.8500     0.8692     61.5786
09900     0.5225      0.8300     0.8692     60.8115
Start testing:
Test Accuracy: 0.9044
