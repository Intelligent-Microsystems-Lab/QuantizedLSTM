Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=494, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=193012823, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
d1c79864-f2e4-45fd-acf2-f4fdf77f6215
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 147, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 374, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 211, in forward
    part2 = CustomMM_bmm.apply(quant_pass(pact_a_bmm(hx, self.a11), self.ib, self.a11), self.weight_hh * w_mask, self.bias_hh, self.noise_level, self.wb, self.bias_r)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 150, in forward
    output = input.bmm(wq + noise_w) + bq + bias_w
RuntimeError: CUDA out of memory. Tried to allocate 16.00 MiB (GPU 0; 10.76 GiB total capacity; 8.81 GiB already allocated; 3.12 MiB free; 9.80 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=494, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=193012823, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
63606314-08bd-4626-b2ac-d50ee1759464
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     4.1879      0.0700     0.1331     16.2195
00100     1.6648      0.5000     0.4787     57.7193
00200     1.1652      0.6400     0.6154     58.1200
00300     1.3635      0.5500     0.6625     57.9860
00400     1.1465      0.6200     0.7343     58.2674
00500     0.9777      0.6300     0.7707     58.4151
00600     0.7306      0.7000     0.7707     57.0532
00700     0.7275      0.7700     0.7855     58.5720
00800     0.9167      0.7200     0.7855     58.2912
00900     0.7002      0.8000     0.7855     58.3115
01000     0.8178      0.7100     0.7992     57.7766
01100     0.7767      0.8100     0.7992     57.7549
01200     0.6689      0.8000     0.7992     57.9362
01300     0.8526      0.7100     0.7992     58.0044
01400     0.7373      0.7700     0.8190     58.4540
01500     0.6922      0.7800     0.8190     58.9690
01600     0.7552      0.7700     0.8190     58.2422
01700     0.5537      0.8400     0.8190     58.3877
01800     0.6561      0.7900     0.8190     57.6343
01900     0.6391      0.7900     0.8209     58.2462
02000     0.6365      0.8000     0.8214     58.0278
02100     0.6739      0.8000     0.8214     58.0361
02200     0.7634      0.7600     0.8317     58.4399
02300     0.7408      0.7800     0.8367     58.5961
02400     0.7081      0.8000     0.8367     58.3183
02500     0.7006      0.8000     0.8374     58.8600
02600     0.4971      0.8700     0.8447     59.3352
02700     0.5293      0.8600     0.8447     59.2260
02800     0.6244      0.7900     0.8447     58.5418
02900     0.3829      0.8700     0.8454     58.5194
03000     0.7020      0.7900     0.8454     58.3172
03100     0.5423      0.8100     0.8454     58.6999
03200     0.6020      0.8000     0.8607     58.6693
03300     0.6395      0.8000     0.8607     58.0308
03400     0.4925      0.8400     0.8607     58.7237
03500     0.7034      0.8000     0.8607     57.5806
03600     0.4760      0.8300     0.8607     57.8623
03700     0.5589      0.8500     0.8607     57.5438
03800     0.5915      0.7600     0.8607     57.4392
03900     0.5480      0.8500     0.8607     57.9139
04000     0.4730      0.8500     0.8607     58.1978
04100     0.4399      0.8700     0.8607     58.1380
04200     0.6411      0.8400     0.8607     57.7883
04300     0.5402      0.8000     0.8607     57.6837
04400     0.4612      0.8600     0.8607     57.3620
04500     0.5952      0.7900     0.8607     57.6521
04600     0.5577      0.8400     0.8652     57.9602
04700     0.3073      0.9400     0.8652     57.5979
04800     0.6968      0.7700     0.8652     57.7771
04900     0.5332      0.8200     0.8652     57.3709
05000     0.4141      0.8500     0.8652     57.4402
05100     0.3903      0.8900     0.8652     57.7926
05200     0.7987      0.7600     0.8652     57.9459
05300     0.4604      0.8600     0.8652     57.9986
05400     0.5784      0.8300     0.8652     59.2993
05500     0.4798      0.8200     0.8652     57.8585
05600     0.5301      0.8000     0.8652     58.1971
05700     0.4861      0.8500     0.8660     59.1533
05800     0.4118      0.8900     0.8660     58.1936
05900     0.5358      0.8200     0.8660     57.3484
06000     0.5694      0.8400     0.8716     59.1304
06100     0.4921      0.8300     0.8716     58.5189
06200     0.5155      0.8500     0.8766     58.7161
06300     0.5207      0.8400     0.8766     57.5361
06400     0.5886      0.8000     0.8766     57.7990
06500     0.5103      0.8600     0.8766     58.0847
06600     0.5814      0.8300     0.8766     58.1397
06700     0.5020      0.8300     0.8766     57.9161
06800     0.5199      0.8100     0.8766     57.6061
06900     0.4251      0.8500     0.8766     57.3549
07000     0.7724      0.7200     0.8766     57.6748
07100     0.4966      0.8700     0.8788     59.0235
07200     0.5260      0.8500     0.8788     57.7456
07300     0.4282      0.8300     0.8788     57.7130
07400     0.4599      0.8400     0.8788     57.7899
07500     0.3608      0.8700     0.8788     57.9899
07600     0.6434      0.7800     0.8788     58.4557
07700     0.6128      0.8000     0.8788     57.7382
07800     0.6094      0.7700     0.8788     57.5606
07900     0.4578      0.8600     0.8803     59.0277
08000     0.4397      0.8200     0.8803     57.7606
08100     0.3735      0.8700     0.8803     58.4551
08200     0.4279      0.8900     0.8803     58.7302
08300     0.6559      0.8100     0.8803     60.8501
08400     0.4174      0.8500     0.8803     60.0419
08500     0.4798      0.8400     0.8803     60.1562
08600     0.3445      0.9200     0.8809     59.0089
08700     0.5041      0.8000     0.8809     58.8180
08800     0.5500      0.8300     0.8819     61.7370
08900     0.2559      0.9300     0.8819     59.7637
09000     0.5156      0.8500     0.8829     59.3096
09100     0.4677      0.8800     0.8829     60.2999
09200     0.4609      0.8700     0.8829     58.0754
09300     0.5554      0.7800     0.8853     58.0982
09400     0.4690      0.7900     0.8853     57.6096
09500     0.4620      0.8300     0.8853     57.6586
09600     0.3524      0.9100     0.8853     57.7792
09700     0.3496      0.8800     0.8853     58.3310
09800     0.4404      0.8500     0.8853     57.9565
09900     0.5347      0.8400     0.8853     58.5763
10000     0.4323      0.8400     0.8853     57.6256
10100     0.2750      0.9000     0.8853     57.5979
10200     0.5994      0.8300     0.8872     58.6385
10300     0.3595      0.8900     0.8926     58.2828
10400     0.4593      0.8400     0.8926     57.7973
10500     0.5864      0.8200     0.8926     58.1883
10600     0.4069      0.8800     0.8926     57.8660
10700     0.4085      0.8400     0.8926     57.8919
10800     0.3589      0.8900     0.8926     57.8953
10900     0.3703      0.8900     0.8926     57.7459
11000     0.5413      0.8400     0.8926     58.5896
11100     0.3995      0.8400     0.8926     58.7135
11200     0.2721      0.9400     0.8926     60.4808
11300     0.3901      0.8900     0.8926     58.8992
11400     0.2480      0.9200     0.8926     58.0990
11500     0.2770      0.8900     0.8926     58.0193
11600     0.4806      0.8700     0.8964     57.9528
11700     0.4301      0.8700     0.8964     58.5491
11800     0.2757      0.8800     0.9003     58.7977
11900     0.3668      0.9000     0.9003     57.4437
12000     0.4451      0.8500     0.9003     58.1268
12100     0.3210      0.8900     0.9003     57.4417
12200     0.3340      0.9200     0.9003     58.2873
12300     0.2965      0.9200     0.9003     59.3268
12400     0.3237      0.8900     0.9003     59.5189
12500     0.2794      0.9200     0.9003     59.6721
12600     0.2836      0.9300     0.9003     60.2999
12700     0.2514      0.9200     0.9003     57.9077
12800     0.2728      0.9200     0.9003     58.4719
12900     0.3112      0.9200     0.9003     59.2784
13000     0.3687      0.8500     0.9003     58.1208
13100     0.5128      0.8500     0.9003     58.0781
13200     0.3129      0.8900     0.9003     58.2330
13300     0.3416      0.8800     0.9004     60.1464
13400     0.2664      0.9200     0.9004     58.4126
13500     0.2543      0.9200     0.9004     57.7353
13600     0.5719      0.8700     0.9004     58.5990
13700     0.3278      0.9000     0.9004     57.6071
13800     0.3578      0.8700     0.9004     57.6791
13900     0.2581      0.9200     0.9004     58.8527
14000     0.2682      0.9100     0.9004     57.6929
14100     0.2960      0.8900     0.9004     58.4099
14200     0.3483      0.8400     0.9004     57.6581
14300     0.3023      0.8900     0.9004     57.9001
14400     0.2569      0.9200     0.9004     57.6779
14500     0.2486      0.9100     0.9004     57.1642
14600     0.2894      0.8800     0.9004     57.9522
14700     0.3069      0.9200     0.9012     58.9579
14800     0.3592      0.9100     0.9012     58.7505
14900     0.4435      0.8700     0.9012     58.2765
15000     0.4609      0.8500     0.9022     58.7527
15100     0.3046      0.9100     0.9022     58.2276
15200     0.3456      0.9100     0.9022     58.1306
15300     0.3845      0.8900     0.9022     57.9860
15400     0.5409      0.8200     0.9022     57.9058
15500     0.2979      0.9000     0.9022     57.5892
15600     0.3695      0.8900     0.9022     57.6877
15700     0.2892      0.9000     0.9022     58.3090
15800     0.3896      0.8800     0.9022     59.3419
15900     0.3936      0.8900     0.9022     58.1368
16000     0.3079      0.9200     0.9022     57.6952
16100     0.2981      0.8800     0.9022     58.2104
16200     0.2839      0.9100     0.9022     57.6502
16300     0.3400      0.8700     0.9022     57.8930
16400     0.3344      0.9000     0.9022     57.6403
16500     0.4784      0.8600     0.9022     58.3709
16600     0.2671      0.8900     0.9022     57.6983
16700     0.3412      0.8900     0.9022     58.0708
16800     0.2500      0.9100     0.9053     59.8682
16900     0.2141      0.9300     0.9053     58.2132
17000     0.2838      0.9400     0.9053     57.3773
17100     0.2319      0.9300     0.9053     57.2851
17200     0.2891      0.9200     0.9053     57.7085
17300     0.2277      0.9300     0.9053     57.7232
17400     0.3341      0.8900     0.9053     57.6937
17500     0.2325      0.9200     0.9053     58.1769
17600     0.1621      0.9600     0.9053     58.8650
17700     0.3197      0.9000     0.9053     57.9190
17800     0.2761      0.9300     0.9053     59.6025
17900     0.2239      0.9600     0.9053     58.8461
18000     0.3277      0.8800     0.9053     59.7860
18100     0.2554      0.9300     0.9053     59.0844
18200     0.1784      0.9600     0.9053     60.1565
18300     0.3698      0.8600     0.9053     58.8865
18400     0.4068      0.8600     0.9053     59.0263
18500     0.3038      0.8600     0.9053     57.7077
18600     0.3562      0.8700     0.9053     59.5167
18700     0.2590      0.9400     0.9053     58.4352
18800     0.2115      0.9400     0.9053     58.7532
18900     0.3315      0.9100     0.9053     58.6888
19000     0.2182      0.9300     0.9053     58.8099
19100     0.2604      0.9400     0.9053     59.0012
19200     0.2779      0.9200     0.9053     58.4791
19300     0.3251      0.9100     0.9053     58.3863
19400     0.2390      0.9300     0.9053     57.6099
19500     0.2349      0.9400     0.9053     58.8146
19600     0.2228      0.9300     0.9053     58.0840
19700     0.3083      0.8800     0.9053     58.7339
19800     0.2890      0.9100     0.9053     58.4702
19900     0.3700      0.8800     0.9053     57.3854
20000     0.2251      0.9300     0.9053     58.9683
20100     0.3499      0.9000     0.9053     57.3768
20199     0.2963      0.9100     0.9053     58.2056
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     0.5733      0.8500     0.8867     17.1122
00100     0.2203      0.9200     0.9041     60.7174
00200     0.2412      0.9200     0.9070     59.5862
00300     0.3377      0.9000     0.9070     58.9807
00400     0.2559      0.9300     0.9074     58.8909
00500     0.1698      0.9600     0.9077     59.7710
00600     0.3004      0.9000     0.9104     61.6928
00700     0.2446      0.9400     0.9104     58.2853
00800     0.3305      0.8900     0.9104     58.2092
00900     0.3508      0.8800     0.9104     57.1411
01000     0.2989      0.9000     0.9104     57.6394
01100     0.2925      0.9100     0.9104     58.2895
01200     0.2123      0.9200     0.9104     57.9962
01300     0.3222      0.8800     0.9104     57.9915
01400     0.2844      0.9100     0.9104     57.8285
01500     0.2068      0.9000     0.9104     57.4898
01600     0.2040      0.9400     0.9129     58.5545
01700     0.2406      0.9200     0.9129     57.8546
01800     0.1265      0.9800     0.9129     59.0426
01900     0.4026      0.8600     0.9129     57.0961
02000     0.2431      0.9300     0.9129     57.7405
02100     0.2141      0.9400     0.9129     59.2075
02200     0.1591      0.9500     0.9129     60.3434
02300     0.2234      0.9300     0.9129     59.4308
02400     0.2961      0.8900     0.9129     59.7080
02500     0.5160      0.8000     0.9129     59.3604
02600     0.2736      0.9200     0.9129     57.7947
02700     0.1736      0.9400     0.9129     58.1569
02800     0.1642      0.9500     0.9129     58.0412
02900     0.2714      0.9000     0.9129     57.7945
03000     0.1923      0.9300     0.9129     57.3190
03100     0.3058      0.9100     0.9129     58.1105
03200     0.3520      0.9000     0.9129     59.2092
03300     0.2948      0.9100     0.9129     60.0407
03400     0.3414      0.8900     0.9129     58.8441
03500     0.2500      0.9100     0.9129     60.2687
03600     0.1573      0.9600     0.9129     62.1816
03700     0.1947      0.9300     0.9131     62.5825
03800     0.3293      0.8700     0.9131     59.2819
03900     0.2928      0.9000     0.9131     58.5500
04000     0.2563      0.9000     0.9131     59.4562
04100     0.1157      0.9600     0.9131     58.5677
04200     0.2221      0.9300     0.9131     58.0445
04300     0.2489      0.9100     0.9131     58.3269
04400     0.5371      0.8300     0.9131     58.7933
04500     0.2595      0.9200     0.9131     57.4688
04600     0.2172      0.9400     0.9131     57.8242
04700     0.3708      0.8900     0.9131     57.4439
04800     0.2571      0.9300     0.9131     57.8061
04900     0.2328      0.9300     0.9131     57.7803
05000     0.2981      0.8800     0.9131     58.2359
05100     0.1933      0.9300     0.9131     57.2602
05200     0.2277      0.9200     0.9131     57.8476
05300     0.2015      0.9300     0.9131     57.9555
05400     0.3165      0.9100     0.9131     57.5964
05500     0.3099      0.9000     0.9131     57.6311
05600     0.4341      0.8700     0.9131     57.8979
05700     0.2464      0.9100     0.9131     59.8836
05800     0.1847      0.9400     0.9131     59.5484
05900     0.2289      0.9200     0.9131     57.6954
06000     0.2402      0.9100     0.9131     57.6456
06100     0.2620      0.9100     0.9131     58.3382
06200     0.3621      0.9200     0.9131     57.9373
06300     0.2570      0.9200     0.9131     57.5012
06400     0.2010      0.9600     0.9131     58.2304
06500     0.2344      0.9200     0.9131     57.9243
06600     0.1990      0.9300     0.9131     61.7692
06700     0.2274      0.9300     0.9131     58.2458
06800     0.3208      0.8900     0.9131     60.3708
06900     0.4458      0.8600     0.9131     58.5150
07000     0.2601      0.9000     0.9131     58.3780
07100     0.2676      0.9100     0.9131     57.4319
07200     0.2096      0.9500     0.9131     58.5600
07300     0.2865      0.9000     0.9131     58.1475
07400     0.4526      0.8600     0.9131     57.6403
07500     0.3882      0.8800     0.9131     57.4663
07600     0.3453      0.8900     0.9131     57.7362
07700     0.1035      0.9800     0.9131     58.0135
07800     0.3106      0.9200     0.9131     57.7980
07900     0.2138      0.9300     0.9131     57.7815
08000     0.2427      0.9500     0.9136     58.7443
08100     0.2885      0.9200     0.9136     58.4362
08200     0.1962      0.9600     0.9136     57.6861
08300     0.2352      0.9200     0.9136     59.5845
08400     0.1757      0.9500     0.9136     60.2100
08500     0.2177      0.9200     0.9136     58.6692
08600     0.3994      0.8500     0.9136     59.4722
08700     0.2002      0.9400     0.9136     61.8095
08800     0.1684      0.9600     0.9136     58.5205
08900     0.3859      0.8700     0.9136     58.3685
09000     0.3051      0.9000     0.9136     58.0764
09100     0.2169      0.9200     0.9136     59.1954
09200     0.3308      0.8900     0.9136     59.8846
09300     0.3507      0.8600     0.9136     61.4276
09400     0.2649      0.9300     0.9136     57.8414
09500     0.2837      0.9300     0.9136     57.4640
09600     0.2104      0.9400     0.9143     59.2284
09700     0.3488      0.9200     0.9143     58.1697
09800     0.2158      0.9100     0.9143     57.8530
09900     0.2824      0.9100     0.9143     58.1063
Start testing:
Test Accuracy: 0.8965
