Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=294, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=8627169, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
f827ff67-b9bd-45da-bbdc-0ee4010f89a0
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 147, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 290, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 213, in forward
    gates = quant_pass(pact_a_bmm( quant_pass(pact_a_bmm(part1, self.a12), self.abMVM, self.a12) + quant_pass(pact_a_bmm(part2, self.a13), self.abMVM, self.a13), self.a14), self.abNM, self.a14)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 87, in forward
    x01 = torch.clamp(x_scaled,-1+(1./step_d),1-(1./step_d))
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 11.78 GiB total capacity; 10.48 GiB already allocated; 21.38 MiB free; 10.60 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=294, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=8627169, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
4d98d2f7-fbf2-48d1-ac8f-e30c73c93b06
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     2.7601      0.1000     0.1099     16.4128
00100     1.4763      0.5000     0.5323     68.8110
00200     1.0945      0.6300     0.6743     68.1863
00300     1.0192      0.7300     0.7298     67.1402
00400     0.9972      0.7100     0.7480     67.3568
00500     0.9825      0.6800     0.7600     67.8390
00600     0.7003      0.7600     0.7722     70.3632
00700     0.8441      0.7300     0.7722     69.0545
00800     1.1106      0.6400     0.7861     73.4531
00900     0.8982      0.7400     0.7929     75.6537
01000     0.7932      0.7700     0.7981     67.3729
01100     0.8236      0.7600     0.7981     71.1299
01200     0.8138      0.7400     0.8169     71.5756
01300     0.7229      0.7900     0.8174     71.8639
01400     0.7489      0.7800     0.8174     68.7531
01500     0.7365      0.7600     0.8174     69.9320
01600     0.9271      0.7000     0.8174     66.5847
01700     0.8285      0.6900     0.8276     71.7248
01800     0.6859      0.7700     0.8276     72.6238
01900     0.6464      0.7800     0.8276     68.4848
02000     0.7525      0.7900     0.8276     69.8223
02100     0.6143      0.8300     0.8287     69.8043
02200     0.8753      0.7200     0.8287     69.3108
02300     0.7060      0.7700     0.8319     75.1441
02400     0.7664      0.7700     0.8319     68.8962
02500     0.7155      0.7600     0.8433     69.8774
02600     0.6972      0.8000     0.8462     75.4147
02700     0.7442      0.8300     0.8462     73.6222
02800     0.5904      0.7900     0.8462     69.8433
02900     0.7516      0.8200     0.8462     72.5374
03000     0.7418      0.7700     0.8462     75.0561
03100     0.8455      0.7400     0.8502     71.8975
03200     0.6042      0.8300     0.8502     70.0748
03300     0.5991      0.8600     0.8527     72.0332
03400     0.5742      0.8000     0.8618     73.2181
03500     0.4285      0.8800     0.8618     69.3736
03600     0.8461      0.7300     0.8618     70.5251
03700     0.5760      0.8900     0.8618     72.9842
03800     0.6376      0.7600     0.8618     69.7636
03900     0.6047      0.8000     0.8618     74.4762
04000     0.5820      0.8400     0.8618     69.9210
04100     0.5658      0.8500     0.8618     72.2311
04200     0.5514      0.8400     0.8618     70.2239
04300     0.6642      0.7800     0.8618     71.8482
04400     0.3433      0.9100     0.8618     67.9505
04500     0.5381      0.8300     0.8618     72.1536
04600     0.4492      0.8700     0.8618     71.6074
04700     0.3959      0.8900     0.8618     70.8373
04800     0.5310      0.8600     0.8618     73.1000
04900     0.5119      0.8700     0.8619     67.0138
05000     0.8071      0.7500     0.8619     70.1201
05100     0.4581      0.8500     0.8624     68.3322
05200     0.8118      0.7500     0.8624     67.7139
05300     0.6441      0.8100     0.8644     73.5594
05400     0.4751      0.8800     0.8644     72.9112
05500     0.6046      0.8100     0.8644     69.7132
05600     0.6436      0.7900     0.8644     70.7005
05700     0.6212      0.8100     0.8675     69.5854
05800     0.4255      0.8700     0.8675     73.3717
05900     0.6343      0.8100     0.8676     73.4657
06000     0.6186      0.8200     0.8676     70.5825
06100     0.6444      0.7700     0.8676     70.7207
06200     0.4530      0.8600     0.8676     70.8720
06300     0.5110      0.8300     0.8735     70.8618
06400     0.4818      0.8800     0.8735     74.4032
06500     0.4964      0.8800     0.8735     71.8472
06600     0.6592      0.8200     0.8735     74.0765
06700     0.4634      0.8700     0.8735     70.7642
06800     0.6526      0.8200     0.8735     69.2091
06900     0.5168      0.8600     0.8735     70.2040
07000     0.5136      0.8500     0.8735     69.7426
07100     0.5748      0.8700     0.8735     74.0142
07200     0.4311      0.8900     0.8735     69.1843
07300     0.6169      0.7800     0.8735     71.6738
07400     0.4043      0.8500     0.8735     73.3528
07500     0.5892      0.8500     0.8735     70.5953
07600     0.3977      0.8500     0.8735     73.3971
07700     0.6736      0.7700     0.8769     75.5715
07800     0.5643      0.8200     0.8769     71.0548
07900     0.3940      0.8500     0.8769     69.6318
08000     0.3969      0.8700     0.8769     70.2460
08100     0.5785      0.7800     0.8769     73.8209
08200     0.5175      0.8400     0.8769     71.9319
08300     0.3236      0.9000     0.8769     71.2828
08400     0.4793      0.8500     0.8769     72.4410
08500     0.3392      0.9100     0.8769     71.8816
08600     0.6109      0.8000     0.8769     74.7841
08700     0.5176      0.8600     0.8769     72.8918
08800     0.4602      0.8600     0.8769     69.8243
08900     0.3859      0.8800     0.8769     71.6575
09000     0.5479      0.8600     0.8769     74.0115
09100     0.4326      0.8700     0.8805     72.1699
09200     0.4800      0.8300     0.8805     69.2621
09300     0.3466      0.9000     0.8805     73.3321
09400     0.4603      0.8600     0.8805     68.0452
09500     0.4831      0.8600     0.8805     74.3524
09600     0.5595      0.8000     0.8805     73.7274
09700     0.5323      0.8300     0.8805     69.5179
09800     0.5255      0.8300     0.8805     71.1615
09900     0.3860      0.8500     0.8805     70.6049
10000     0.7188      0.7900     0.8805     71.7452
10100     0.5971      0.8500     0.8842     71.4422
10200     0.4083      0.8900     0.8842     68.9799
10300     0.5950      0.8500     0.8842     73.6654
10400     0.5463      0.8500     0.8842     70.1456
10500     0.6236      0.7800     0.8842     70.5501
10600     0.4907      0.8600     0.8842     71.7978
10700     0.4878      0.8200     0.8842     71.8970
10800     0.5275      0.8500     0.8842     69.3177
10900     0.4289      0.8900     0.8842     69.3005
11000     0.4180      0.8800     0.8842     73.1644
11100     0.4710      0.8800     0.8842     69.5714
11200     0.5724      0.8300     0.8842     69.7273
11300     0.3780      0.8800     0.8842     71.8645
11400     0.4487      0.8700     0.8842     73.4845
11500     0.4280      0.8500     0.8842     73.0468
11600     0.4290      0.8800     0.8842     69.7764
11700     0.2740      0.9400     0.8842     71.4213
11800     0.4255      0.8700     0.8842     68.4250
11900     0.2087      0.9600     0.8842     67.8875
12000     0.3422      0.9300     0.8842     68.7749
12100     0.4224      0.8800     0.8842     71.8217
12200     0.3453      0.9100     0.8842     70.2612
12300     0.5143      0.8500     0.8842     74.2522
12400     0.4492      0.8700     0.8842     73.8670
12500     0.2558      0.9400     0.8842     68.9066
12600     0.5052      0.8300     0.8842     69.2123
12700     0.4791      0.8500     0.8842     76.2100
12800     0.4592      0.8600     0.8842     73.4121
12900     0.3501      0.9200     0.8842     68.6797
13000     0.4922      0.8400     0.8842     68.8906
13100     0.4485      0.8700     0.8842     70.9670
13200     0.3371      0.8900     0.8842     70.0771
13300     0.4054      0.9000     0.8842     71.3040
13400     0.3508      0.8800     0.8842     70.6741
13500     0.5954      0.8300     0.8842     72.0421
13600     0.2914      0.9000     0.8842     69.7007
13700     0.4476      0.8600     0.8842     74.6622
13800     0.5250      0.8500     0.8842     70.6697
13900     0.3504      0.8800     0.8842     71.9691
14000     0.4898      0.8600     0.8898     69.6722
14100     0.4233      0.8600     0.8898     71.3466
14200     0.4495      0.8600     0.8898     67.9310
14300     0.4600      0.8500     0.8898     70.7000
14400     0.4215      0.8700     0.8898     76.0864
14500     0.3298      0.8800     0.8898     67.8037
14600     0.3395      0.9100     0.8898     69.5845
14700     0.3146      0.9300     0.8972     71.8537
14800     0.3607      0.8900     0.8972     71.5725
14900     0.3896      0.8700     0.8972     73.2392
15000     0.4447      0.8700     0.8972     70.7422
15100     0.3570      0.8900     0.8972     69.7011
15200     0.4769      0.8700     0.8972     70.4722
15300     0.3230      0.8900     0.8972     70.1720
15400     0.2827      0.9400     0.8972     73.0629
15500     0.3212      0.8900     0.8972     70.7662
15600     0.4915      0.8800     0.8972     70.5323
15700     0.3573      0.9200     0.8972     73.5409
15800     0.3818      0.8900     0.8972     69.4000
15900     0.3761      0.9000     0.8972     68.8197
16000     0.4131      0.8700     0.8972     73.6382
16100     0.5217      0.8500     0.8972     71.8286
16200     0.3220      0.9100     0.8972     71.6322
16300     0.2329      0.9500     0.8972     69.7456
16400     0.4224      0.8800     0.8972     74.5097
16500     0.3365      0.9200     0.8972     73.1032
16600     0.3109      0.8800     0.8972     73.0527
16700     0.4016      0.8900     0.8972     69.7026
16800     0.4530      0.8800     0.8972     69.3740
16900     0.5540      0.8100     0.8972     70.4816
17000     0.3799      0.8800     0.8972     75.2329
17100     0.5164      0.8500     0.8972     67.5240
17200     0.4274      0.8900     0.8972     73.5382
17300     0.3495      0.9100     0.8972     73.4266
17400     0.2203      0.9600     0.8972     73.9420
17500     0.3090      0.9200     0.8972     68.5017
17600     0.5140      0.8500     0.8972     71.6147
17700     0.6556      0.8000     0.8972     69.0432
17800     0.3529      0.8700     0.8972     70.9304
17900     0.3058      0.9200     0.8972     68.1493
18000     0.4959      0.9100     0.8972     73.8533
18100     0.2935      0.9000     0.8972     68.7212
18200     0.3363      0.8800     0.8972     75.2682
18300     0.3718      0.8600     0.8972     72.5012
18400     0.4582      0.8300     0.8972     70.4032
18500     0.3028      0.9200     0.8972     74.9956
18600     0.4908      0.8700     0.8972     70.8835
18700     0.3161      0.9000     0.8972     69.5318
18800     0.2767      0.9300     0.8972     72.1094
18900     0.2846      0.9300     0.8972     71.9567
19000     0.2870      0.9200     0.8972     68.9797
19100     0.3349      0.9300     0.8972     70.9797
19200     0.3824      0.8400     0.8972     73.8664
19300     0.4360      0.9000     0.8972     68.8572
19400     0.5082      0.8800     0.8972     74.1532
19500     0.4423      0.8800     0.8972     73.9174
19600     0.2064      0.9700     0.8972     69.1340
19700     0.3404      0.8800     0.8972     71.7793
19800     0.2746      0.9500     0.8972     72.0006
19900     0.5606      0.8300     0.8972     71.0350
20000     0.3123      0.9200     0.8972     69.0090
20100     0.3769      0.8500     0.8972     69.2189
20199     0.2433      0.9200     0.8972     72.5621
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     0.5576      0.8300     0.8152     17.1489
00100     0.4346      0.8800     0.9055     72.0028
00200     0.4330      0.8600     0.9055     72.5842
00300     0.2559      0.9500     0.9055     72.3441
00400     0.4475      0.8700     0.9074     75.1743
00500     0.4317      0.8300     0.9074     71.3039
00600     0.5152      0.8400     0.9074     70.7727
00700     0.2431      0.9200     0.9074     72.7968
00800     0.3282      0.8900     0.9074     68.2875
00900     0.4659      0.8700     0.9074     68.6838
01000     0.4035      0.8800     0.9095     70.1853
01100     0.3846      0.9200     0.9095     69.8255
01200     0.4905      0.8700     0.9095     71.1370
01300     0.3814      0.9000     0.9095     71.1210
01400     0.2887      0.9200     0.9095     74.9850
01500     0.4095      0.8900     0.9095     74.4332
01600     0.4673      0.8400     0.9095     69.3484
01700     0.3350      0.9200     0.9095     73.6859
01800     0.3676      0.8800     0.9095     71.2026
01900     0.4283      0.8800     0.9095     75.4976
02000     0.3841      0.8900     0.9095     68.1827
02100     0.3499      0.8900     0.9095     69.5150
02200     0.4535      0.8700     0.9095     74.5221
02300     0.3239      0.9000     0.9095     70.2479
02400     0.5659      0.8300     0.9095     71.7290
02500     0.2811      0.9300     0.9095     76.7413
02600     0.4073      0.8800     0.9095     70.3464
02700     0.5505      0.8500     0.9095     73.4431
02800     0.3741      0.9000     0.9101     74.8962
02900     0.4641      0.8700     0.9101     69.9618
03000     0.3066      0.8700     0.9101     69.9229
03100     0.3501      0.8900     0.9103     73.5162
03200     0.4597      0.8600     0.9103     73.5743
03300     0.3888      0.8900     0.9109     71.5565
03400     0.2694      0.9400     0.9109     68.5713
03500     0.3908      0.8500     0.9109     71.6564
03600     0.3908      0.8800     0.9109     71.8645
03700     0.3767      0.9000     0.9109     68.7726
03800     0.3461      0.9100     0.9109     69.2885
03900     0.3731      0.8800     0.9109     72.5714
04000     0.3799      0.8900     0.9109     72.2279
04100     0.3800      0.8700     0.9109     72.5980
04200     0.3526      0.9100     0.9109     71.7246
04300     0.2785      0.9300     0.9109     71.9947
04400     0.4508      0.8700     0.9109     70.0991
04500     0.2613      0.9500     0.9109     67.5233
04600     0.2883      0.9200     0.9109     71.5715
04700     0.2870      0.9100     0.9109     69.1431
04800     0.2965      0.9100     0.9109     73.9482
04900     0.4533      0.8700     0.9109     70.6387
05000     0.2934      0.9200     0.9109     73.6732
05100     0.3302      0.9000     0.9109     70.6325
05200     0.1622      0.9500     0.9109     72.0068
05300     0.3736      0.9000     0.9109     72.6291
05400     0.2491      0.9200     0.9109     70.4215
05500     0.3471      0.8600     0.9109     72.2353
05600     0.5145      0.8400     0.9109     72.4998
05700     0.4289      0.8800     0.9109     74.3331
05800     0.3295      0.8900     0.9151     69.8322
05900     0.2822      0.9300     0.9151     72.8708
06000     0.3750      0.9000     0.9151     73.8464
06100     0.5669      0.8200     0.9151     69.1228
06200     0.3924      0.8900     0.9151     71.7776
06300     0.3938      0.8800     0.9151     74.1349
06400     0.3731      0.9000     0.9151     73.6337
06500     0.2997      0.9100     0.9151     73.4350
06600     0.2308      0.9300     0.9151     70.9251
06700     0.3538      0.8800     0.9151     71.1533
06800     0.3605      0.8800     0.9151     71.8691
06900     0.2642      0.9100     0.9151     69.8685
07000     0.2920      0.9200     0.9151     73.0187
07100     0.3176      0.8900     0.9151     71.0814
07200     0.3871      0.8700     0.9151     72.7279
07300     0.3719      0.9000     0.9151     69.5674
07400     0.3321      0.8900     0.9151     74.5615
07500     0.4888      0.8600     0.9151     72.5984
07600     0.5259      0.8500     0.9151     72.4653
07700     0.3757      0.8900     0.9151     70.6111
07800     0.2551      0.9300     0.9151     68.2424
07900     0.2301      0.9400     0.9151     74.3566
08000     0.4306      0.8700     0.9151     68.5165
08100     0.2600      0.9100     0.9151     74.8612
08200     0.3158      0.9000     0.9151     72.7913
08300     0.2305      0.9300     0.9151     72.9748
08400     0.4769      0.8200     0.9151     70.2920
08500     0.2503      0.9200     0.9151     75.4226
08600     0.4520      0.9000     0.9151     72.8480
08700     0.4027      0.9000     0.9151     72.5854
08800     0.2766      0.9300     0.9151     72.0944
08900     0.3539      0.8500     0.9151     73.1426
09000     0.3798      0.8900     0.9151     69.9388
09100     0.2699      0.9300     0.9151     69.2728
09200     0.3144      0.9100     0.9151     70.7070
09300     0.3117      0.9300     0.9151     74.0149
09400     0.3072      0.8900     0.9151     76.5027
09500     0.2919      0.9200     0.9151     73.0862
09600     0.3395      0.8900     0.9151     74.1155
09700     0.2988      0.9200     0.9151     75.9661
09800     0.3146      0.9100     0.9151     76.8514
09900     0.2442      0.9500     0.9151     76.0622
Start testing:
Test Accuracy: 0.8973
