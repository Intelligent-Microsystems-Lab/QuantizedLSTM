Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=294, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=193012823, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
b2b033d0-e706-4121-9592-2f4faff28c30
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 167, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 374, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 211, in forward
    part2 = CustomMM_bmm.apply(quant_pass(pact_a_bmm(hx, self.a11), self.ib, self.a11), self.weight_hh * w_mask, self.bias_hh, self.noise_level, self.wb, self.bias_r)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 150, in forward
    output = input.bmm(wq + noise_w) + bq + bias_w
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 22.17 GiB total capacity; 20.97 GiB already allocated; 10.50 MiB free; 21.19 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=294, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=193012823, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
a9ba060c-ee18-4729-8a44-1f9e08d032d9
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     3.0406      0.1000     0.0833     15.4710
00100     1.6482      0.4800     0.4588     56.3040
00200     1.4954      0.5200     0.6082     56.7397
00300     1.2098      0.5500     0.6719     57.0752
00400     1.0884      0.6800     0.7038     57.6163
00500     0.8621      0.7400     0.7343     56.6376
00600     0.8162      0.7200     0.7498     57.7264
00700     0.8752      0.7000     0.7502     57.3630
00800     0.9271      0.7100     0.7797     56.1678
00900     0.7776      0.7800     0.7797     55.9527
01000     0.9672      0.7400     0.7797     56.9520
01100     0.8966      0.7200     0.7891     56.5968
01200     0.8946      0.7200     0.7969     56.4769
01300     0.8520      0.7300     0.7969     56.4693
01400     0.6316      0.7900     0.7969     55.7497
01500     0.9226      0.7200     0.7969     56.0875
01600     0.5835      0.8100     0.8071     56.1837
01700     0.9406      0.6900     0.8121     56.7207
01800     0.9094      0.7100     0.8186     56.5913
01900     0.7805      0.7100     0.8186     57.2309
02000     0.5583      0.8200     0.8189     56.1625
02100     0.7637      0.7600     0.8194     56.9466
02200     0.5585      0.8000     0.8315     57.2150
02300     0.6298      0.8500     0.8315     56.7706
02400     0.9365      0.6700     0.8315     57.1169
02500     0.6540      0.7700     0.8315     55.9777
02600     0.5591      0.8100     0.8352     56.9089
02700     0.6063      0.7800     0.8352     55.8307
02800     0.5972      0.8500     0.8352     56.1837
02900     0.8160      0.7200     0.8352     56.3042
03000     0.8101      0.7700     0.8352     57.1977
03100     0.6808      0.7600     0.8352     56.6864
03200     0.6417      0.7700     0.8352     58.1676
03300     0.6873      0.7600     0.8352     59.7574
03400     0.6407      0.8200     0.8443     58.6252
03500     0.5987      0.8200     0.8493     58.9305
03600     0.5597      0.8000     0.8493     59.0617
03700     0.5736      0.8400     0.8493     60.4559
03800     0.5981      0.8200     0.8493     59.8842
03900     0.6150      0.7700     0.8493     59.2323
04000     0.5552      0.8000     0.8542     57.8903
04100     0.7312      0.7700     0.8542     58.2735
04200     0.5707      0.8500     0.8542     58.5707
04300     0.5065      0.8400     0.8542     57.9958
04400     0.6131      0.8100     0.8542     59.3896
04500     0.5988      0.8100     0.8542     57.3614
04600     0.5704      0.8300     0.8564     56.4183
04700     0.4954      0.8300     0.8564     59.0738
04800     0.7276      0.8000     0.8564     58.5298
04900     0.7242      0.7800     0.8575     56.8951
05000     0.4809      0.8500     0.8575     57.0322
05100     0.5750      0.8400     0.8575     57.9208
05200     0.7328      0.7800     0.8575     59.1585
05300     0.4066      0.8900     0.8575     57.1125
05400     0.3785      0.8700     0.8575     57.0165
05500     0.4978      0.8200     0.8575     56.6986
05600     0.5206      0.8700     0.8575     56.5369
05700     0.4946      0.8600     0.8575     56.4722
05800     0.5380      0.8500     0.8575     57.3086
05900     0.4809      0.8600     0.8575     57.8750
06000     0.5644      0.8700     0.8575     59.4202
06100     0.3730      0.8800     0.8575     59.3025
06200     0.6600      0.7600     0.8603     59.6874
06300     0.3619      0.9000     0.8603     58.2574
06400     0.3067      0.8900     0.8626     58.4366
06500     0.5899      0.8400     0.8626     57.2277
06600     0.5049      0.8200     0.8626     56.1940
06700     0.5603      0.7900     0.8626     55.8940
06800     0.5501      0.8200     0.8626     56.0005
06900     0.5143      0.8500     0.8626     56.3638
07000     0.4343      0.8400     0.8626     55.9409
07100     0.5219      0.8600     0.8626     56.2085
07200     0.4452      0.8900     0.8626     56.3744
07300     0.4577      0.9000     0.8636     58.2028
07400     0.5550      0.7800     0.8636     56.2397
07500     0.2772      0.9200     0.8636     57.1316
07600     0.6008      0.8100     0.8662     59.5893
07700     0.4929      0.8300     0.8662     58.8412
07800     0.6278      0.8000     0.8662     59.1455
07900     0.4546      0.8600     0.8662     57.5485
08000     0.4869      0.8300     0.8687     58.0984
08100     0.6656      0.8200     0.8687     56.9808
08200     0.4443      0.8600     0.8687     58.1419
08300     0.6770      0.7700     0.8687     59.0065
08400     0.6590      0.8200     0.8687     57.8079
08500     0.4118      0.8700     0.8687     56.6162
08600     0.5929      0.8300     0.8687     57.8862
08700     0.4128      0.8700     0.8687     57.4981
08800     0.6082      0.8500     0.8687     56.0841
08900     0.4595      0.8700     0.8687     56.3771
09000     0.5071      0.8600     0.8687     56.2840
09100     0.4906      0.8300     0.8687     57.2023
09200     0.4619      0.8700     0.8714     56.8078
09300     0.4967      0.8500     0.8714     56.0136
09400     0.4735      0.8200     0.8714     56.1139
09500     0.4039      0.8500     0.8714     55.6814
09600     0.4467      0.8600     0.8714     55.8072
09700     0.4148      0.8700     0.8714     58.7074
09800     0.5144      0.8500     0.8714     57.9122
09900     0.4011      0.8600     0.8714     59.6064
10000     0.5586      0.8300     0.8714     56.9465
10100     0.3288      0.8900     0.8714     57.0397
10200     0.3856      0.8900     0.8714     56.3944
10300     0.4968      0.8600     0.8714     56.9863
10400     0.5276      0.8300     0.8714     56.4412
10500     0.2619      0.9300     0.8807     59.6186
10600     0.4646      0.8500     0.8807     56.6686
10700     0.3953      0.8800     0.8807     58.8875
10800     0.3319      0.8800     0.8807     58.3860
10900     0.4232      0.8600     0.8807     57.4127
11000     0.3806      0.8800     0.8807     57.1896
11100     0.4470      0.8700     0.8807     57.9904
11200     0.3913      0.8700     0.8813     56.5640
11300     0.4458      0.8400     0.8813     58.3698
11400     0.3478      0.8900     0.8813     57.5598
11500     0.5109      0.8200     0.8813     57.0658
11600     0.4498      0.8300     0.8813     60.6825
11700     0.5371      0.8100     0.8813     56.8736
11800     0.5714      0.8600     0.8813     58.3002
11900     0.3836      0.8600     0.8813     57.3138
12000     0.3941      0.8900     0.8813     57.1853
12100     0.3398      0.8900     0.8813     56.4877
12200     0.2723      0.9200     0.8813     56.3597
12300     0.3318      0.8900     0.8813     56.7386
12400     0.3600      0.8600     0.8813     56.1917
12500     0.3992      0.8500     0.8813     56.0443
12600     0.4426      0.8500     0.8813     56.6569
12700     0.3963      0.8700     0.8813     57.3898
12800     0.5804      0.7900     0.8813     57.5070
12900     0.4347      0.8400     0.8813     56.7128
13000     0.3118      0.9100     0.8813     56.4788
13100     0.4088      0.8600     0.8813     57.4066
13200     0.3209      0.9000     0.8813     59.0088
13300     0.5195      0.7800     0.8813     57.9267
13400     0.3474      0.9100     0.8813     56.6840
13500     0.3170      0.9000     0.8813     56.5647
13600     0.4364      0.8500     0.8813     57.9152
13700     0.4686      0.8800     0.8813     56.4253
13800     0.3498      0.8900     0.8813     57.8486
13900     0.3766      0.8700     0.8819     56.6447
14000     0.2709      0.9100     0.8819     57.0239
14100     0.3301      0.9000     0.8819     56.4785
14200     0.3411      0.8700     0.8819     55.6863
14300     0.4453      0.9100     0.8819     56.7841
14400     0.1896      0.9500     0.8819     55.8084
14500     0.4418      0.8700     0.8819     56.2107
14600     0.3314      0.8900     0.8819     56.6550
14700     0.3408      0.9000     0.8819     55.7383
14800     0.4629      0.8600     0.8819     56.3307
14900     0.3980      0.8600     0.8819     56.6831
15000     0.3871      0.9100     0.8819     56.9683
15100     0.3086      0.9100     0.8819     57.2254
15200     0.3593      0.8600     0.8819     56.7995
15300     0.3870      0.8700     0.8819     56.2912
15400     0.4744      0.8700     0.8819     57.0255
15500     0.4670      0.8600     0.8819     55.9461
15600     0.4726      0.8500     0.8819     56.5216
15700     0.3663      0.8900     0.8819     56.1454
15800     0.3529      0.8700     0.8819     56.1246
15900     0.3607      0.9100     0.8819     55.6134
16000     0.4606      0.8300     0.8819     55.8986
16100     0.4002      0.8500     0.8819     56.6272
16200     0.5400      0.8000     0.8819     57.2655
16300     0.3518      0.8800     0.8819     59.3532
16400     0.3762      0.8800     0.8819     59.8912
16500     0.2673      0.9300     0.8819     58.9118
16600     0.6064      0.8100     0.8819     56.8188
16700     0.2891      0.9200     0.8819     58.1598
16800     0.4868      0.8200     0.8838     58.7579
16900     0.3870      0.8400     0.8838     56.9126
17000     0.3929      0.8900     0.8838     56.7597
17100     0.4063      0.8600     0.8838     56.7867
17200     0.2840      0.9200     0.8838     57.2017
17300     0.3726      0.8800     0.8838     57.9794
17400     0.3386      0.8900     0.8838     57.7614
17500     0.2770      0.9300     0.8838     57.6321
17600     0.3479      0.8700     0.8838     59.2232
17700     0.4605      0.8800     0.8838     58.3880
17800     0.3504      0.8800     0.8838     57.4933
17900     0.3958      0.8500     0.8838     58.3828
18000     0.3076      0.9000     0.8838     59.8604
18100     0.4037      0.8500     0.8838     58.1670
18200     0.3098      0.9000     0.8881     58.5816
18300     0.5058      0.8100     0.8881     58.6778
18400     0.4896      0.8800     0.8881     58.3669
18500     0.2336      0.9300     0.8881     58.8826
18600     0.2606      0.9300     0.8881     57.9763
18700     0.2974      0.9000     0.8881     56.2751
18800     0.3141      0.8800     0.8881     58.1362
18900     0.3273      0.9000     0.8881     58.4637
19000     0.2803      0.9200     0.8881     56.5064
19100     0.2868      0.8900     0.8881     58.6391
19200     0.2737      0.9200     0.8881     57.4619
19300     0.3385      0.9100     0.8881     58.5680
19400     0.3369      0.8700     0.8881     56.5073
19500     0.3934      0.8900     0.8881     56.5540
19600     0.2406      0.9400     0.8881     55.8746
19700     0.3334      0.8900     0.8881     56.6588
19800     0.3138      0.9300     0.8881     56.6228
19900     0.3519      0.8800     0.8881     58.0187
20000     0.2910      0.9200     0.8881     57.3809
20100     0.3333      0.9200     0.8881     58.5145
20199     0.3784      0.8800     0.8881     57.7029
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     0.6550      0.7800     0.8006     15.4272
00100     0.3422      0.8700     0.8925     56.9940
00200     0.4019      0.9000     0.8925     56.9886
00300     0.3074      0.8900     0.8931     56.2368
00400     0.4014      0.8600     0.8943     56.5519
00500     0.5503      0.8400     0.8943     56.2452
00600     0.3173      0.9100     0.8949     56.4664
00700     0.4164      0.8900     0.8961     56.4764
00800     0.2383      0.9300     0.8985     56.7580
00900     0.4687      0.8500     0.8985     55.9559
01000     0.2795      0.9100     0.8990     56.4279
01100     0.3354      0.9000     0.8990     56.3279
01200     0.2709      0.9000     0.8990     56.1270
01300     0.3679      0.8600     0.8990     56.8683
01400     0.2764      0.9100     0.8990     56.3813
01500     0.3678      0.8800     0.8990     56.5400
01600     0.2930      0.9100     0.8990     57.3972
01700     0.4849      0.8800     0.8990     56.2112
01800     0.3050      0.9100     0.8990     57.0051
01900     0.3887      0.8800     0.8990     57.0043
02000     0.3149      0.8800     0.8990     56.5320
02100     0.2501      0.9100     0.8990     56.6627
02200     0.4057      0.8400     0.8990     56.2933
02300     0.3333      0.8600     0.8990     57.2990
02400     0.3745      0.8700     0.8990     56.4456
02500     0.3482      0.9100     0.8990     56.0765
02600     0.2469      0.9300     0.8990     56.9363
02700     0.3177      0.9200     0.8990     56.2795
02800     0.2970      0.9100     0.8990     56.3798
02900     0.2810      0.9400     0.8990     55.5095
03000     0.4275      0.8800     0.8990     56.3558
03100     0.3300      0.8900     0.8990     57.1633
03200     0.2049      0.9300     0.8990     57.4387
03300     0.2422      0.9500     0.8990     56.9433
03400     0.3134      0.8800     0.8990     56.6575
03500     0.3941      0.8600     0.8990     56.6922
03600     0.3987      0.8800     0.8990     56.8053
03700     0.4033      0.8800     0.8996     56.6571
03800     0.2979      0.8900     0.8996     55.7700
03900     0.3953      0.8700     0.8996     56.3368
04000     0.2508      0.9500     0.8996     55.5005
04100     0.3119      0.8900     0.8996     56.3477
04200     0.3889      0.8700     0.8996     56.7889
04300     0.2664      0.9100     0.8996     57.0517
04400     0.4124      0.8700     0.8996     57.0276
04500     0.3220      0.8900     0.8996     56.7709
04600     0.3039      0.9000     0.8996     57.7689
04700     0.3898      0.9100     0.8996     57.9191
04800     0.4162      0.9000     0.8996     57.3861
04900     0.3071      0.9300     0.8996     56.1964
05000     0.2694      0.9100     0.8996     56.3803
05100     0.1824      0.9600     0.8996     57.5465
05200     0.4220      0.8600     0.8996     58.9605
05300     0.4970      0.8100     0.8996     56.5793
05400     0.4045      0.8800     0.8996     57.4201
05500     0.3171      0.9200     0.8996     57.9439
05600     0.3178      0.9200     0.9001     58.3749
05700     0.4021      0.8800     0.9001     57.4525
05800     0.3702      0.8800     0.9001     57.6828
05900     0.2680      0.9200     0.9001     58.0031
06000     0.2718      0.9200     0.9014     58.1607
06100     0.3295      0.9000     0.9014     58.4760
06200     0.3294      0.9200     0.9014     56.7996
06300     0.4375      0.9200     0.9014     56.0825
06400     0.3840      0.8700     0.9014     55.9597
06500     0.3882      0.9100     0.9014     56.5178
06600     0.2721      0.9300     0.9014     56.4434
06700     0.2737      0.9000     0.9014     56.0250
06800     0.2100      0.9100     0.9014     56.3566
06900     0.4056      0.8700     0.9014     56.3631
07000     0.3791      0.8900     0.9014     56.3390
07100     0.3057      0.9300     0.9014     55.9953
07200     0.3186      0.9000     0.9014     56.6676
07300     0.1907      0.9200     0.9014     56.3708
07400     0.2022      0.9400     0.9014     58.1968
07500     0.2380      0.9400     0.9014     57.1101
07600     0.2529      0.9000     0.9014     58.8432
07700     0.1753      0.9300     0.9019     58.2497
07800     0.3643      0.8900     0.9019     57.4481
07900     0.2690      0.9400     0.9019     57.7423
08000     0.3625      0.8800     0.9019     57.5091
08100     0.3020      0.9200     0.9019     58.3579
08200     0.2361      0.9100     0.9019     57.0621
08300     0.3465      0.9100     0.9019     57.5863
08400     0.4179      0.8900     0.9019     57.5158
08500     0.2842      0.8900     0.9019     56.1757
08600     0.2916      0.8900     0.9019     58.1239
08700     0.2809      0.9200     0.9031     58.6167
08800     0.3850      0.8700     0.9031     57.5168
08900     0.3623      0.8900     0.9031     57.8147
09000     0.3147      0.9000     0.9031     58.4876
09100     0.3078      0.8900     0.9031     57.7601
09200     0.4361      0.8500     0.9031     56.4194
09300     0.3573      0.8900     0.9031     56.1500
09400     0.2598      0.9300     0.9031     56.9181
09500     0.3246      0.8900     0.9031     56.9911
09600     0.3552      0.8500     0.9031     57.3209
09700     0.3365      0.8800     0.9031     57.8780
09800     0.2617      0.9100     0.9031     57.1800
09900     0.4367      0.8800     0.9031     57.5551
Start testing:
Test Accuracy: 0.8892
