Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=512, canonical_testing=False, cs=0.5, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, hidden=111, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=235899598, rows_bias=3, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=640, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
11fd718c-6af1-4a5b-b20f-558858779e75
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 161, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 289, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 228, in forward
    activated_input = quant_pass(pact_a_bmm(input_gate_out * activation_out, self.a8), self.abNM, self.a8)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 89, in forward
    x01q =  torch.round(x01 * step_d ) / step_d
RuntimeError: CUDA out of memory. Tried to allocate 2.00 MiB (GPU 0; 10.76 GiB total capacity; 8.54 GiB already allocated; 3.12 MiB free; 9.80 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=512, canonical_testing=False, cs=0.5, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, hidden=111, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=235899598, rows_bias=3, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=640, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
b0e3ebe4-5bf5-4ad5-b4b4-34867804c309
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     2.7026      0.0781     0.0792     11.0727
00100     1.5624      0.4746     0.5080     54.2884
00200     1.2400      0.6074     0.6375     54.5238
00300     1.0604      0.6836     0.7275     54.2852
00400     0.9097      0.7227     0.7525     55.4126
00500     0.7669      0.7559     0.7591     55.3388
00600     0.8391      0.7402     0.7933     56.2409
00700     0.8478      0.7168     0.8097     56.3995
00800     0.8255      0.7246     0.8097     55.4898
00900     0.7646      0.7754     0.8097     55.1671
01000     0.7794      0.7441     0.8097     53.3537
01100     0.7513      0.7578     0.8207     53.9775
01200     0.7800      0.7539     0.8207     55.1028
01300     0.7441      0.7715     0.8207     56.3236
01400     0.6685      0.7871     0.8255     55.0034
01500     0.7115      0.7754     0.8255     55.9552
01600     0.6913      0.7812     0.8255     56.4257
01700     0.6427      0.8125     0.8255     54.9832
01800     0.6630      0.8066     0.8255     54.8642
01900     0.7044      0.7949     0.8339     55.4671
02000     0.6981      0.7793     0.8339     54.6307
02100     0.6924      0.7949     0.8347     55.7945
02200     0.7356      0.7559     0.8347     54.9106
02300     0.7259      0.7910     0.8347     55.3039
02400     0.6549      0.7910     0.8347     55.3598
02500     0.5887      0.8359     0.8347     54.3959
02600     0.6468      0.8086     0.8347     54.2425
02700     0.6569      0.7910     0.8366     55.3701
02800     0.6604      0.8125     0.8366     54.5847
02900     0.6508      0.8047     0.8366     56.1989
03000     0.5914      0.8242     0.8542     55.8699
03100     0.6143      0.8086     0.8542     54.5582
03200     0.6578      0.8125     0.8577     54.9107
03300     0.7030      0.7695     0.8577     54.7881
03400     0.6387      0.8262     0.8577     55.8435
03500     0.6632      0.8008     0.8577     56.5100
03600     0.6409      0.8125     0.8577     54.7748
03700     0.6239      0.8027     0.8577     55.5211
03800     0.5765      0.8359     0.8577     54.9214
03900     0.5626      0.8281     0.8577     56.5884
04000     0.6334      0.8066     0.8577     55.2012
04100     0.6047      0.8164     0.8577     54.7773
04200     0.5220      0.8438     0.8577     55.2545
04300     0.5577      0.8359     0.8577     55.8599
04400     0.5843      0.8281     0.8577     54.3215
04500     0.6098      0.8164     0.8577     55.3147
04600     0.6101      0.8262     0.8577     54.0960
04700     0.6213      0.8086     0.8577     54.5867
04800     0.5461      0.8359     0.8577     54.5632
04900     0.5788      0.8281     0.8577     55.3178
05000     0.5251      0.8457     0.8577     56.6358
05100     0.5861      0.8242     0.8577     55.8970
05200     0.5389      0.8359     0.8577     56.4164
05300     0.6371      0.8027     0.8577     54.2664
05400     0.5612      0.8262     0.8577     54.9117
05500     0.5089      0.8691     0.8577     55.1150
05600     0.5119      0.8438     0.8577     53.9345
05700     0.5670      0.8320     0.8577     55.4474
05800     0.5416      0.8438     0.8577     54.9587
05900     0.6183      0.8320     0.8577     55.2405
06000     0.5931      0.8359     0.8577     54.3218
06100     0.6265      0.8066     0.8577     55.5118
06200     0.5028      0.8594     0.8577     56.9681
06300     0.5329      0.8379     0.8577     56.2466
06400     0.6223      0.8145     0.8577     55.1636
06500     0.6650      0.8086     0.8605     55.1484
06600     0.5668      0.8281     0.8605     55.5410
06700     0.4956      0.8516     0.8605     54.9802
06800     0.6087      0.8105     0.8605     55.0625
06900     0.5588      0.8262     0.8605     55.1558
07000     0.5144      0.8477     0.8605     55.4613
07100     0.5095      0.8613     0.8605     56.9664
07200     0.5231      0.8164     0.8605     55.6447
07300     0.5639      0.8398     0.8605     56.2790
07400     0.5402      0.8301     0.8605     55.1622
07500     0.5434      0.8574     0.8605     56.1375
07600     0.5743      0.8203     0.8605     56.6022
07700     0.5606      0.8242     0.8605     54.0906
07800     0.5521      0.8301     0.8605     56.1263
07900     0.5631      0.8223     0.8605     55.4962
08000     0.5690      0.8477     0.8605     54.8584
08100     0.4569      0.8711     0.8605     57.0514
08200     0.5263      0.8379     0.8605     54.4305
08300     0.5068      0.8457     0.8605     55.0581
08400     0.5235      0.8535     0.8605     56.1692
08500     0.5534      0.8262     0.8605     56.1684
08600     0.5685      0.8379     0.8605     55.3405
08700     0.5101      0.8418     0.8605     55.7215
08800     0.5781      0.8320     0.8605     55.9729
08900     0.5497      0.8496     0.8605     55.7786
09000     0.4507      0.8672     0.8605     57.0444
09100     0.4713      0.8672     0.8605     55.9339
09200     0.4964      0.8633     0.8605     55.4345
09300     0.5705      0.8301     0.8605     54.5933
09400     0.5113      0.8418     0.8605     55.1635
09500     0.5379      0.8359     0.8605     55.7601
09600     0.5100      0.8457     0.8605     54.4751
09700     0.5236      0.8555     0.8605     55.4332
09800     0.5979      0.8145     0.8605     54.9037
09900     0.5384      0.8340     0.8673     55.3280
10000     0.5245      0.8457     0.8673     55.4791
10100     0.4289      0.8789     0.8673     54.6880
10200     0.4647      0.8730     0.8673     55.4633
10300     0.5034      0.8555     0.8673     54.7286
10400     0.5834      0.8320     0.8673     54.3205
10500     0.4231      0.8809     0.8673     54.7134
10600     0.5010      0.8633     0.8673     54.7907
10700     0.4786      0.8652     0.8673     54.5866
10800     0.4311      0.8555     0.8673     55.4447
10900     0.4383      0.8672     0.8673     54.4409
11000     0.4253      0.8613     0.8673     55.1167
11100     0.4763      0.8711     0.8673     55.0740
11200     0.4504      0.8711     0.8673     55.4064
11300     0.4038      0.8906     0.8673     56.0254
11400     0.4255      0.8633     0.8673     55.6302
11500     0.4834      0.8672     0.8673     54.8042
11600     0.4673      0.8633     0.8673     55.1096
11700     0.5091      0.8457     0.8673     54.8691
11800     0.4804      0.8594     0.8673     55.6866
11900     0.4704      0.8398     0.8673     54.8206
12000     0.3819      0.8848     0.8673     54.7258
12100     0.4444      0.8809     0.8673     55.3066
12200     0.4236      0.8887     0.8673     55.2677
12300     0.4778      0.8535     0.8673     55.4624
12400     0.4268      0.8711     0.8673     55.2204
12500     0.4616      0.8672     0.8673     56.2283
12600     0.4579      0.8535     0.8673     55.9692
12700     0.4416      0.8867     0.8673     54.7117
12800     0.4239      0.8711     0.8673     55.9738
12900     0.4034      0.8867     0.8673     56.0440
13000     0.4577      0.8594     0.8673     55.6855
13100     0.4135      0.8809     0.8673     55.5733
13200     0.4264      0.8730     0.8673     56.3736
13300     0.5402      0.8359     0.8673     54.9521
13400     0.4301      0.8633     0.8673     55.7238
13500     0.4136      0.8789     0.8673     55.4707
13600     0.4970      0.8691     0.8673     55.6018
13700     0.4620      0.8594     0.8673     56.5630
13800     0.4614      0.8477     0.8673     54.5263
13900     0.4064      0.8984     0.8673     54.9669
14000     0.4398      0.8652     0.8673     56.2561
14100     0.4490      0.8711     0.8673     54.5589
14200     0.4380      0.8633     0.8673     55.7210
14300     0.3805      0.8926     0.8673     55.7568
14400     0.4331      0.8594     0.8673     55.4083
14500     0.4446      0.8711     0.8673     57.0174
14600     0.4021      0.8809     0.8673     54.5251
14700     0.3610      0.9004     0.8673     54.6890
14800     0.4059      0.8750     0.8673     55.6855
14900     0.4426      0.8691     0.8673     54.2330
15000     0.4636      0.8672     0.8673     55.8527
15100     0.4742      0.8594     0.8673     54.4853
15200     0.4148      0.8691     0.8673     54.0981
15300     0.4170      0.8809     0.8673     54.5133
15400     0.5232      0.8535     0.8673     56.3283
15500     0.4316      0.8770     0.8673     55.1429
15600     0.4571      0.8672     0.8673     55.7172
15700     0.4935      0.8418     0.8673     54.9318
15800     0.4443      0.8691     0.8673     55.5787
15900     0.4446      0.8535     0.8673     54.9514
16000     0.4426      0.8770     0.8673     54.9686
16100     0.4239      0.8711     0.8673     56.0400
16200     0.4601      0.8652     0.8673     55.1724
16300     0.3844      0.8984     0.8673     54.4995
16400     0.4272      0.8789     0.8673     54.6264
16500     0.4913      0.8496     0.8673     54.5886
16600     0.4412      0.8750     0.8673     55.6655
16700     0.5041      0.8555     0.8673     54.7498
16800     0.4129      0.8789     0.8673     55.3150
16900     0.4186      0.8906     0.8673     55.3118
17000     0.4628      0.8652     0.8673     54.4638
17100     0.4702      0.8633     0.8673     54.8526
17200     0.4230      0.8711     0.8673     55.3751
17300     0.3956      0.8867     0.8673     53.9254
17400     0.3909      0.8906     0.8673     55.0193
17500     0.4677      0.8516     0.8673     54.7338
17600     0.4268      0.8633     0.8673     55.6046
17700     0.4271      0.8652     0.8673     55.5217
17800     0.4194      0.8906     0.8673     54.4874
17900     0.4062      0.8809     0.8673     56.3298
18000     0.3560      0.9023     0.8673     56.1359
18100     0.4942      0.8438     0.8673     55.6626
18200     0.4718      0.8633     0.8673     57.2782
18300     0.4734      0.8477     0.8673     54.8154
18400     0.3417      0.8984     0.8673     54.3551
18500     0.4176      0.8848     0.8673     54.8567
18600     0.3876      0.8887     0.8673     55.3653
18700     0.4015      0.8887     0.8673     54.7215
18800     0.4289      0.8730     0.8673     55.9236
18900     0.4084      0.8730     0.8673     55.5855
19000     0.4476      0.8770     0.8673     57.0242
19100     0.4312      0.8672     0.8673     54.5677
19200     0.4482      0.8711     0.8673     55.0417
19300     0.4333      0.8789     0.8673     55.2340
19400     0.3559      0.9004     0.8673     56.6468
19500     0.4639      0.8613     0.8673     55.5245
19600     0.4654      0.8672     0.8673     54.7371
19700     0.4413      0.8672     0.8673     55.3367
19800     0.4864      0.8477     0.8673     56.2156
19900     0.4020      0.8789     0.8673     54.3563
20000     0.4069      0.8828     0.8673     55.2978
20100     0.4035      0.8789     0.8673     55.2530
20199     0.4454      0.8516     0.8673     53.9522
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     0.7983      0.7852     0.8195     8.9322
00100     0.4734      0.8691     0.8836     55.1399
00200     0.4245      0.8730     0.8859     54.3635
00300     0.5193      0.8457     0.8859     55.0684
00400     0.4499      0.8672     0.8859     54.9835
00500     0.4349      0.8730     0.8859     54.1105
00600     0.4075      0.8809     0.8859     55.5688
00700     0.3565      0.8867     0.8921     54.6551
00800     0.4704      0.8633     0.8921     53.8379
00900     0.4698      0.8652     0.8925     54.3790
01000     0.4272      0.8828     0.8925     54.9303
01100     0.4217      0.8535     0.8925     54.6039
01200     0.4854      0.8477     0.8925     55.3223
01300     0.4686      0.8594     0.8925     54.2668
01400     0.4482      0.8770     0.8925     53.7508
01500     0.4744      0.8633     0.8925     53.5746
01600     0.4502      0.8711     0.8925     54.7625
01700     0.4868      0.8477     0.8925     55.0964
01800     0.4580      0.8770     0.9008     54.8996
01900     0.4447      0.8555     0.9008     54.4978
02000     0.3250      0.9121     0.9008     55.8688
02100     0.4460      0.8691     0.9008     54.7656
02200     0.3961      0.8750     0.9008     54.4747
02300     0.4124      0.8770     0.9008     55.7519
02400     0.4540      0.8613     0.9008     55.2818
02500     0.4459      0.8672     0.9008     56.7149
02600     0.4485      0.8691     0.9008     54.7497
02700     0.4322      0.8730     0.9008     56.7467
02800     0.4694      0.8691     0.9008     54.3082
02900     0.4177      0.8730     0.9008     53.8189
03000     0.4408      0.8770     0.9008     55.2406
03100     0.4361      0.8789     0.9008     54.3533
03200     0.4568      0.8691     0.9008     54.9237
03300     0.4601      0.8633     0.9008     54.8616
03400     0.3801      0.8887     0.9008     54.5627
03500     0.3979      0.8965     0.9008     55.7605
03600     0.3950      0.8828     0.9008     54.8489
03700     0.4596      0.8750     0.9008     54.0230
03800     0.4285      0.8770     0.9008     54.5432
03900     0.4153      0.8828     0.9008     54.4592
04000     0.4592      0.8613     0.9008     55.2127
04100     0.4266      0.8789     0.9008     55.2483
04200     0.4277      0.8711     0.9008     54.2077
04300     0.3995      0.8809     0.9008     54.6438
04400     0.4825      0.8555     0.9008     54.1674
04500     0.4262      0.8770     0.9008     54.3723
04600     0.4402      0.8711     0.9008     54.0816
04700     0.4157      0.8828     0.9008     54.1524
04800     0.5279      0.8301     0.9012     55.2678
04900     0.4773      0.8535     0.9012     55.0724
05000     0.4646      0.8555     0.9012     54.5991
05100     0.3819      0.8867     0.9012     55.0359
05200     0.4163      0.8770     0.9012     55.1266
05300     0.4495      0.8770     0.9012     54.3869
05400     0.3817      0.8887     0.9012     54.3964
05500     0.4244      0.8770     0.9012     55.2795
05600     0.4017      0.8965     0.9012     53.9883
05700     0.4492      0.8633     0.9012     54.2445
05800     0.5043      0.8418     0.9012     54.9971
05900     0.4817      0.8613     0.9012     54.7551
06000     0.4018      0.8730     0.9012     54.1707
06100     0.4645      0.8594     0.9012     56.7208
06200     0.4693      0.8672     0.9012     54.2831
06300     0.4366      0.8574     0.9012     53.7169
06400     0.4236      0.8691     0.9012     54.8989
06500     0.4273      0.8594     0.9012     54.1985
06600     0.4467      0.8770     0.9012     54.6825
06700     0.4038      0.8711     0.9012     55.9972
06800     0.3764      0.8867     0.9012     54.9132
06900     0.4283      0.8770     0.9012     54.5056
07000     0.4392      0.8730     0.9012     54.8254
07100     0.4106      0.8613     0.9012     54.3490
07200     0.4800      0.8516     0.9012     55.2064
07300     0.4171      0.8809     0.9012     54.1010
07400     0.4011      0.8711     0.9012     55.4360
07500     0.3399      0.9141     0.9012     54.6486
07600     0.4741      0.8594     0.9012     54.2768
07700     0.4875      0.8613     0.9012     55.1133
07800     0.3958      0.8848     0.9012     55.5911
07900     0.4651      0.8633     0.9012     55.6057
08000     0.3980      0.8809     0.9012     54.6390
08100     0.4145      0.8848     0.9012     55.0126
08200     0.3538      0.8965     0.9012     56.1327
08300     0.4887      0.8457     0.9012     54.7032
08400     0.3990      0.8906     0.9012     55.8356
08500     0.3765      0.8809     0.9012     53.7003
08600     0.4221      0.8828     0.9012     54.0058
08700     0.5165      0.8457     0.9021     55.0559
08800     0.4333      0.8730     0.9021     54.0633
08900     0.3820      0.8926     0.9021     54.0016
09000     0.4277      0.8672     0.9021     56.3396
09100     0.4290      0.8691     0.9021     58.5199
09200     0.3900      0.8867     0.9021     58.7487
09300     0.3810      0.8711     0.9021     59.8196
09400     0.4362      0.8770     0.9021     58.9416
09500     0.4173      0.8750     0.9021     58.6543
09600     0.4549      0.8535     0.9021     57.3760
09700     0.4342      0.8633     0.9021     57.6392
09800     0.4491      0.8672     0.9021     58.7446
09900     0.4720      0.8633     0.9021     57.4497
Start testing:
Test Accuracy: 0.8841
