Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=14, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.0, noise_injectionT=0.0, pact_a=True, quant_actMVM=9, quant_actNM=9, quant_inp=9, quant_w=9, random_seed=235899598, rows_bias=100, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
76e1ad5e-2362-403f-ad1c-0b9254080793
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 147, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 373, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 209, in forward
    part1 = CustomMM_bmm.apply(quant_pass(pact_a_bmm(input.repeat(self.n_blocks, 1, 1), self.a1), self.ib, self.a1), self.weight_ih, self.bias_ih, self.noise_level, self.wb, self.bias_r)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 145, in forward
    wq = quant_pass(weight, wb, 1.)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 82, in forward
    if len(x_range) > 1:
TypeError: object of type 'float' has no len()
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=14, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.0, noise_injectionT=0.0, pact_a=True, quant_actMVM=9, quant_actNM=9, quant_inp=9, quant_w=9, random_seed=235899598, rows_bias=100, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
810d0464-68a9-4f85-9bef-334d182362c8
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 147, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 373, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 209, in forward
    part1 = CustomMM_bmm.apply(quant_pass(pact_a_bmm(input.repeat(self.n_blocks, 1, 1), self.a1), self.ib, self.a1), self.weight_ih, self.bias_ih, self.noise_level, self.wb, self.bias_r)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 145, in forward
    wq = quant_pass(weight, wb, torch.tensor([1.]).device(input.device))
TypeError: 'torch.device' object is not callable
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=14, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.0, noise_injectionT=0.0, pact_a=True, quant_actMVM=9, quant_actNM=9, quant_inp=9, quant_w=9, random_seed=235899598, rows_bias=100, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
828701ad-a0a6-4fb4-b341-229ae9491280
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     3.4560      0.1076     0.1304     10.1135
00100     2.2092      0.2468     0.2936     56.6535
00200     1.6459      0.4451     0.4845     55.8127
00300     1.4062      0.5506     0.5765     55.9770
00400     1.2745      0.5612     0.6306     55.8228
00500     1.1187      0.6498     0.6704     56.7447
00600     1.1003      0.6456     0.7079     55.6460
00700     0.9041      0.7131     0.7199     56.6206
00800     0.9334      0.6962     0.7329     57.7599
00900     0.9484      0.6646     0.7420     56.5231
01000     0.9207      0.6878     0.7517     55.5984
01100     0.8747      0.7321     0.7568     55.6906
01200     0.8629      0.7257     0.7705     56.0991
01300     0.8958      0.7004     0.7705     56.3014
01400     0.8158      0.7363     0.7805     55.6986
01500     0.7329      0.7722     0.7852     55.7951
01600     0.7371      0.7806     0.7944     56.4737
01700     0.7847      0.7489     0.7971     56.0173
01800     0.7202      0.7658     0.7971     56.5198
01900     0.6714      0.8017     0.8029     56.3428
02000     0.7386      0.7658     0.8039     56.3612
02100     0.7921      0.7405     0.8070     55.9922
02200     0.7694      0.7574     0.8094     56.5520
02300     0.7620      0.7426     0.8094     56.8862
02400     0.6690      0.7911     0.8094     56.6588
02500     0.6930      0.7806     0.8114     56.5383
02600     0.6197      0.7869     0.8114     55.8648
02700     0.6942      0.7806     0.8205     57.3976
02800     0.5666      0.8523     0.8205     55.3366
02900     0.6920      0.7553     0.8205     56.3319
03000     0.6663      0.7954     0.8205     56.6461
03100     0.6674      0.7764     0.8205     55.6881
03200     0.6861      0.7764     0.8205     56.7774
03300     0.7086      0.7637     0.8205     56.1963
03400     0.6724      0.7785     0.8205     55.8965
03500     0.6411      0.7890     0.8205     56.5815
03600     0.6284      0.8143     0.8253     55.7554
03700     0.6121      0.8249     0.8253     55.7175
03800     0.6536      0.7764     0.8287     55.9198
03900     0.5542      0.8397     0.8287     55.6710
04000     0.6279      0.7869     0.8287     56.2772
04100     0.6487      0.8122     0.8287     55.1053
04200     0.6717      0.7764     0.8287     54.7221
04300     0.5927      0.8186     0.8287     55.1745
04400     0.5789      0.8249     0.8339     54.7714
04500     0.5953      0.8143     0.8339     54.9257
04600     0.5686      0.8101     0.8339     55.1783
04700     0.5845      0.8165     0.8339     55.3705
04800     0.6231      0.8059     0.8339     57.1965
04900     0.6244      0.8038     0.8339     54.7537
05000     0.5605      0.8207     0.8339     55.1416
05100     0.5621      0.8186     0.8339     55.9860
05200     0.6017      0.8080     0.8339     55.3984
05300     0.5271      0.8333     0.8378     54.6827
05400     0.5389      0.8270     0.8378     55.6044
05500     0.5514      0.8376     0.8378     55.9780
05600     0.5500      0.8439     0.8378     55.6284
05700     0.5538      0.8207     0.8378     55.4547
05800     0.5494      0.8439     0.8378     55.4477
05900     0.4977      0.8354     0.8378     56.8375
06000     0.5484      0.8186     0.8378     57.0333
06100     0.6103      0.8080     0.8378     55.8245
06200     0.6114      0.8122     0.8378     56.4406
06300     0.5379      0.8291     0.8378     55.0883
06400     0.6792      0.7848     0.8378     56.4560
06500     0.5566      0.8397     0.8378     56.2852
06600     0.5195      0.8312     0.8378     57.9556
06700     0.5575      0.8502     0.8396     56.6637
06800     0.5641      0.8186     0.8396     55.9934
06900     0.5916      0.8207     0.8396     55.5674
07000     0.5416      0.8228     0.8396     55.5287
07100     0.5165      0.8291     0.8396     55.3436
07200     0.5457      0.8122     0.8396     55.4948
07300     0.5931      0.8080     0.8396     57.4490
07400     0.5040      0.8228     0.8396     55.6194
07500     0.5862      0.8122     0.8396     55.8975
07600     0.5295      0.8523     0.8396     55.3245
07700     0.5624      0.8207     0.8396     55.6537
07800     0.5423      0.8228     0.8396     55.5951
07900     0.4895      0.8544     0.8416     54.7137
08000     0.5799      0.8101     0.8416     55.5151
08100     0.5434      0.8228     0.8416     55.8969
08200     0.5042      0.8186     0.8416     56.0573
08300     0.5968      0.8333     0.8416     56.0085
08400     0.5794      0.8080     0.8424     54.8242
08500     0.5830      0.8186     0.8424     56.2145
08600     0.5391      0.8460     0.8424     55.7258
08700     0.5137      0.8270     0.8424     55.1457
08800     0.5312      0.8333     0.8424     56.2319
08900     0.5119      0.8354     0.8424     54.8431
09000     0.5253      0.8418     0.8424     55.9455
09100     0.5698      0.8143     0.8479     56.0209
09200     0.5484      0.8249     0.8479     54.5368
09300     0.6124      0.7996     0.8479     56.4063
09400     0.5348      0.8270     0.8479     54.6947
09500     0.6122      0.7975     0.8479     56.3180
09600     0.5409      0.8038     0.8479     55.5797
09700     0.4822      0.8523     0.8479     55.5146
09800     0.4566      0.8565     0.8479     56.3262
09900     0.5458      0.7954     0.8511     55.9848
10000     0.5620      0.8291     0.8511     55.0133
10100     0.5317      0.8376     0.8511     55.9538
10200     0.4556      0.8629     0.8511     56.0507
10300     0.4892      0.8544     0.8511     55.3977
10400     0.4984      0.8523     0.8511     56.3101
10500     0.5060      0.8439     0.8511     56.5455
10600     0.5721      0.8186     0.8511     56.5368
10700     0.5084      0.8439     0.8511     56.0142
10800     0.5119      0.8291     0.8511     56.4423
10900     0.5298      0.8207     0.8511     56.1782
11000     0.5271      0.8376     0.8511     55.4693
11100     0.5194      0.8354     0.8522     57.3056
11200     0.5837      0.8101     0.8522     57.2090
11300     0.4999      0.8418     0.8522     55.4213
11400     0.4452      0.8439     0.8522     56.3591
11500     0.4819      0.8523     0.8522     56.7396
11600     0.4638      0.8460     0.8522     57.2404
11700     0.4232      0.8692     0.8522     56.7029
11800     0.4392      0.8629     0.8522     55.2936
11900     0.5306      0.8333     0.8527     56.4720
12000     0.5117      0.8291     0.8527     56.4025
12100     0.5537      0.8270     0.8527     56.4919
12200     0.4958      0.8565     0.8527     55.2796
12300     0.5691      0.8291     0.8527     57.1547
12400     0.5040      0.8418     0.8527     55.3143
12500     0.4987      0.8608     0.8527     55.6449
12600     0.4548      0.8565     0.8527     54.7370
12700     0.5010      0.8376     0.8527     55.2007
12800     0.5181      0.8439     0.8527     56.1695
12900     0.4123      0.8734     0.8527     56.3495
13000     0.5000      0.8523     0.8527     57.4104
13100     0.4904      0.8270     0.8527     56.7646
13200     0.4375      0.8502     0.8527     56.2632
13300     0.4831      0.8608     0.8527     57.5915
13400     0.5060      0.8502     0.8554     57.7304
13500     0.5499      0.8228     0.8554     57.5506
13600     0.5045      0.8228     0.8554     58.5834
13700     0.4576      0.8692     0.8566     56.5168
13800     0.4818      0.8565     0.8566     55.2018
13900     0.5003      0.8523     0.8566     57.1124
14000     0.5274      0.8291     0.8566     55.6310
14100     0.4756      0.8376     0.8566     57.0790
14200     0.4057      0.8776     0.8566     53.8444
14300     0.5431      0.8165     0.8566     55.2772
14400     0.4800      0.8439     0.8566     56.9228
14500     0.4218      0.8734     0.8566     56.5524
14600     0.5129      0.8481     0.8566     56.1006
14700     0.5489      0.8186     0.8566     56.2605
14800     0.4251      0.8650     0.8566     56.4489
14900     0.5486      0.8312     0.8566     56.1939
15000     0.5038      0.8333     0.8566     55.6801
15100     0.5479      0.8270     0.8566     54.6985
15200     0.5281      0.8270     0.8566     56.7690
15300     0.5050      0.8354     0.8585     55.9391
15400     0.5345      0.8565     0.8585     56.4667
15500     0.5752      0.8207     0.8585     55.6072
15600     0.4476      0.8671     0.8585     56.2980
15700     0.4735      0.8565     0.8585     56.7369
15800     0.4666      0.8544     0.8585     55.4834
15900     0.5799      0.8143     0.8585     55.1121
16000     0.4492      0.8544     0.8585     55.5258
16100     0.4046      0.8882     0.8585     55.3152
16200     0.4458      0.8608     0.8585     55.7383
16300     0.5169      0.8207     0.8585     55.6954
16400     0.4799      0.8312     0.8585     57.0478
16500     0.5777      0.8101     0.8585     55.5479
16600     0.4048      0.8692     0.8585     55.6640
16700     0.4118      0.8629     0.8585     56.0503
16800     0.4596      0.8502     0.8585     56.5238
16900     0.4884      0.8439     0.8585     55.5447
17000     0.4845      0.8544     0.8585     55.6843
17100     0.4970      0.8397     0.8585     55.7865
17200     0.4700      0.8713     0.8585     55.4899
17300     0.5610      0.8291     0.8585     56.1383
17400     0.4752      0.8608     0.8585     55.6861
17500     0.4898      0.8418     0.8585     55.9699
17600     0.4587      0.8565     0.8585     56.3518
17700     0.4370      0.8439     0.8585     57.9413
17800     0.4616      0.8502     0.8585     55.3025
17900     0.4864      0.8502     0.8585     55.9785
18000     0.4519      0.8819     0.8585     55.6279
18100     0.4239      0.8819     0.8585     57.3626
18200     0.4988      0.8376     0.8585     55.9548
18300     0.5082      0.8291     0.8585     57.8740
18400     0.4288      0.8734     0.8585     57.8760
18500     0.5139      0.8481     0.8585     55.3832
18600     0.5078      0.8439     0.8585     55.4031
18700     0.4649      0.8439     0.8585     55.2441
18800     0.4909      0.8397     0.8585     55.9290
18900     0.4794      0.8460     0.8585     55.9631
19000     0.4331      0.8523     0.8585     55.1713
19100     0.4491      0.8565     0.8585     55.5832
19200     0.5156      0.8397     0.8585     57.0224
19300     0.4672      0.8523     0.8585     56.3617
19400     0.5082      0.8397     0.8585     56.4303
19500     0.4978      0.8439     0.8585     55.9481
19600     0.5171      0.8354     0.8585     57.7038
19700     0.4187      0.8671     0.8585     56.3793
19800     0.5168      0.8376     0.8600     56.0569
19900     0.4373      0.8565     0.8600     55.6482
20000     0.4810      0.8523     0.8600     56.1495
20100     0.4509      0.8586     0.8600     57.2413
20199     0.4631      0.8586     0.8600     54.9546
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     0.3943      0.8840     0.8522     8.7167
00100     0.4552      0.8608     0.8581     55.2401
00200     0.4848      0.8544     0.8609     56.9653
00300     0.4147      0.8797     0.8639     55.9062
00400     0.4187      0.8502     0.8639     55.6968
00500     0.3839      0.8861     0.8639     56.3753
00600     0.3983      0.8713     0.8639     56.2058
00700     0.3756      0.8734     0.8639     55.9278
00800     0.3525      0.8924     0.8639     55.6748
00900     0.3440      0.8966     0.8639     56.1037
01000     0.3566      0.9008     0.8639     56.3179
01100     0.3810      0.8819     0.8639     56.9971
01200     0.3533      0.8882     0.8639     56.4985
01300     0.4223      0.8608     0.8639     56.6611
01400     0.3588      0.8861     0.8639     55.2319
01500     0.3688      0.8797     0.8639     55.3303
01600     0.3970      0.8755     0.8639     56.3881
01700     0.4327      0.8544     0.8639     55.5634
01800     0.3930      0.8797     0.8639     55.3198
01900     0.4720      0.8608     0.8639     56.1651
02000     0.3233      0.9093     0.8639     56.9671
02100     0.3706      0.8924     0.8639     55.8374
02200     0.3568      0.8882     0.8639     54.9099
02300     0.4253      0.8650     0.8639     56.0934
02400     0.3896      0.8776     0.8639     56.6973
02500     0.3860      0.8734     0.8639     56.5634
02600     0.4604      0.8354     0.8639     57.6534
02700     0.4537      0.8460     0.8639     55.8138
02800     0.4012      0.8924     0.8655     55.4756
02900     0.4057      0.8713     0.8655     55.7235
03000     0.4164      0.8755     0.8655     55.1286
03100     0.4403      0.8586     0.8655     56.0657
03200     0.3914      0.8861     0.8655     55.8107
03300     0.3283      0.8987     0.8655     56.5010
03400     0.4078      0.8819     0.8655     56.0550
03500     0.3485      0.8734     0.8655     55.6169
03600     0.3975      0.8671     0.8655     55.6107
03700     0.4338      0.8460     0.8655     55.1101
03800     0.4414      0.8840     0.8655     54.5992
03900     0.4103      0.8608     0.8655     55.5919
04000     0.4485      0.8544     0.8655     54.7489
04100     0.3599      0.8903     0.8655     55.2380
04200     0.3961      0.8755     0.8655     55.4021
04300     0.3768      0.8734     0.8655     55.5794
04400     0.3836      0.8797     0.8655     56.1421
04500     0.3829      0.8819     0.8655     55.6349
04600     0.4267      0.8650     0.8655     54.8866
04700     0.4439      0.8713     0.8655     54.8166
04800     0.3386      0.9030     0.8655     56.5277
04900     0.3948      0.8776     0.8655     55.3694
05000     0.4208      0.8776     0.8655     54.3687
05100     0.4200      0.8650     0.8655     55.7122
05200     0.3627      0.8987     0.8655     55.8746
05300     0.3893      0.8840     0.8655     56.6506
05400     0.4271      0.8650     0.8655     54.8310
05500     0.4527      0.8523     0.8655     54.7332
05600     0.3734      0.8882     0.8655     55.9708
05700     0.4016      0.8734     0.8655     55.8792
05800     0.3267      0.9051     0.8655     55.2091
05900     0.4020      0.8797     0.8655     56.0700
06000     0.3589      0.8734     0.8655     55.6971
06100     0.3660      0.8882     0.8655     56.7278
06200     0.3544      0.8987     0.8655     56.1546
06300     0.3588      0.8945     0.8655     55.6009
06400     0.3641      0.8945     0.8655     57.5572
06500     0.3264      0.9114     0.8655     55.8100
06600     0.3851      0.8797     0.8655     56.4529
06700     0.3866      0.9030     0.8655     56.8634
06800     0.4603      0.8671     0.8655     54.7653
06900     0.3845      0.8882     0.8655     56.6148
07000     0.3146      0.8966     0.8655     55.6849
07100     0.4852      0.8376     0.8655     55.7187
07200     0.4589      0.8608     0.8655     55.4328
07300     0.4674      0.8586     0.8655     55.1818
07400     0.4034      0.8924     0.8655     56.2454
07500     0.3930      0.8797     0.8655     57.0452
07600     0.3411      0.8819     0.8655     55.5714
07700     0.3897      0.8861     0.8655     56.4507
07800     0.3433      0.8987     0.8655     55.5357
07900     0.3957      0.8797     0.8655     54.9559
08000     0.4043      0.8776     0.8655     56.0426
08100     0.4263      0.8776     0.8655     55.4028
08200     0.3692      0.8819     0.8655     55.8613
08300     0.4511      0.8502     0.8655     55.3953
08400     0.3722      0.8882     0.8655     54.6442
08500     0.4285      0.8776     0.8655     56.5162
08600     0.4692      0.8544     0.8655     55.3550
08700     0.3837      0.8819     0.8655     55.2302
08800     0.4106      0.8776     0.8655     55.2124
08900     0.3921      0.8903     0.8655     55.1096
09000     0.3944      0.8713     0.8655     56.1514
09100     0.4081      0.8734     0.8655     56.0915
09200     0.4197      0.8797     0.8655     54.9372
09300     0.4188      0.8671     0.8655     56.1660
09400     0.3956      0.8776     0.8655     55.7833
09500     0.4257      0.8840     0.8655     55.8161
09600     0.3688      0.8776     0.8655     57.5016
09700     0.3299      0.9008     0.8655     56.9531
09800     0.4277      0.8861     0.8655     56.0405
09900     0.4099      0.8586     0.8655     56.1974
Start testing:
Test Accuracy: 0.8443
