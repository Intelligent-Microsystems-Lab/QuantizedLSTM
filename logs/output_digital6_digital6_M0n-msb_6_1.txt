Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=108, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=0, n_mfcc=40, n_msb=6, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=235899598, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
8580133c-b963-4106-8183-e3dba7dbc472
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 167, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 290, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 213, in forward
    gates = quant_pass(pact_a_bmm( quant_pass(pact_a_bmm(part1, self.a12), self.abMVM, self.a12) + quant_pass(pact_a_bmm(part2, self.a13), self.abMVM, self.a13), self.a14), self.abNM, self.a14)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 89, in forward
    x01q =  torch.round(x01 * step_d ) / step_d
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 10.76 GiB total capacity; 9.70 GiB already allocated; 13.12 MiB free; 9.79 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=108, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=0, n_mfcc=40, n_msb=6, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=235899598, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
0e04bb1f-0412-4cfe-ad42-d24be28fd5ce
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     2.6337      0.0949     0.0860     10.1688
00100     1.4319      0.5506     0.0962     53.4562
00200     0.9059      0.7194     0.1026     55.4317
00300     0.7227      0.7700     0.1026     55.4398
00400     0.5721      0.8059     0.1026     54.0528
00500     0.6144      0.8017     0.1184     55.1157
00600     0.5970      0.8038     0.1184     54.5344
00700     0.4509      0.8544     0.1184     54.7055
00800     0.5063      0.8502     0.1184     54.6732
00900     0.4848      0.8397     0.1184     53.4950
01000     0.4146      0.8671     0.1184     53.9018
01100     0.3920      0.8734     0.1184     54.6071
01200     0.4484      0.8797     0.1225     53.7346
01300     0.3684      0.8861     0.1225     53.7393
01400     0.3543      0.8776     0.1225     54.1728
01500     0.3126      0.9114     0.1240     54.3712
01600     0.3730      0.8924     0.1240     54.0585
01700     0.3095      0.9008     0.1240     53.3029
01800     0.3435      0.8966     0.1269     53.8369
01900     0.3832      0.8882     0.1301     53.7115
02000     0.3532      0.8945     0.1301     53.5609
02100     0.4168      0.8713     0.1301     53.2192
02200     0.3154      0.9135     0.1301     54.0030
02300     0.3187      0.9072     0.1301     54.4452
02400     0.2725      0.9135     0.1465     54.9033
02500     0.2834      0.9177     0.1491     54.6057
02600     0.3188      0.9156     0.1491     54.0121
02700     0.2701      0.9135     0.1491     54.5255
02800     0.3328      0.9072     0.1491     54.4388
02900     0.3062      0.9114     0.1491     54.5866
03000     0.3306      0.9030     0.1491     54.7780
03100     0.3391      0.9093     0.1491     54.4918
03200     0.3032      0.9135     0.1491     54.4440
03300     0.2956      0.9135     0.1491     54.4462
03400     0.2933      0.9198     0.1491     54.4109
03500     0.2289      0.9367     0.1491     54.5253
03600     0.3487      0.9072     0.1491     54.5284
03700     0.2482      0.9135     0.1491     53.8342
03800     0.3492      0.8966     0.1562     54.2131
03900     0.1999      0.9451     0.1562     54.1390
04000     0.2252      0.9262     0.1562     54.3238
04100     0.2125      0.9346     0.1562     54.0221
04200     0.2768      0.9177     0.1562     54.3167
04300     0.2580      0.9283     0.1587     54.4211
04400     0.2684      0.9051     0.1587     54.0310
04500     0.2299      0.9262     0.1587     54.0785
04600     0.2091      0.9494     0.1611     54.4695
04700     0.2720      0.9177     0.1611     53.9847
04800     0.2646      0.9430     0.1611     54.8356
04900     0.2084      0.9388     0.1611     54.3679
05000     0.2390      0.9241     0.1643     54.3631
05100     0.2246      0.9283     0.1751     54.7497
05200     0.2524      0.9262     0.1787     54.7180
05300     0.2303      0.9219     0.1798     53.9150
05400     0.2503      0.9283     0.1798     54.4882
05500     0.2177      0.9388     0.1798     54.0329
05600     0.2326      0.9325     0.1798     54.2969
05700     0.2495      0.9325     0.1810     54.2650
05800     0.2056      0.9346     0.1892     54.4402
05900     0.2452      0.9304     0.1932     54.6673
06000     0.1834      0.9494     0.1932     54.5982
06100     0.2423      0.9304     0.2020     54.9026
06200     0.2110      0.9388     0.2162     54.9566
06300     0.2138      0.9304     0.2162     53.9627
06400     0.2549      0.9262     0.2162     54.6546
06500     0.2397      0.9367     0.2162     53.7386
06600     0.2089      0.9388     0.2162     53.8376
06700     0.2852      0.9262     0.2162     54.9445
06800     0.2773      0.9177     0.2162     54.4676
06900     0.2326      0.9430     0.2162     54.6888
07000     0.2635      0.9241     0.2162     54.3365
07100     0.2259      0.9536     0.2172     54.6892
07200     0.1756      0.9409     0.2172     54.8743
07300     0.2530      0.9304     0.2199     54.4114
07400     0.2222      0.9346     0.2270     54.6987
07500     0.1964      0.9473     0.2282     54.3235
07600     0.2111      0.9388     0.2282     54.9938
07700     0.1513      0.9620     0.2282     54.4378
07800     0.2335      0.9304     0.2343     55.0278
07900     0.1893      0.9536     0.2416     54.1072
08000     0.2152      0.9409     0.2416     55.1026
08100     0.2103      0.9388     0.2416     54.0500
08200     0.1758      0.9536     0.2416     53.8786
08300     0.2288      0.9304     0.2416     54.1564
08400     0.2097      0.9494     0.2416     54.0403
08500     0.1719      0.9494     0.2439     53.9268
08600     0.2117      0.9430     0.2536     55.2982
08700     0.1766      0.9494     0.2536     55.8029
08800     0.1585      0.9557     0.2536     54.8061
08900     0.2036      0.9409     0.2635     54.7225
09000     0.1612      0.9536     0.2698     53.9193
09100     0.1685      0.9536     0.2732     54.1793
09200     0.1782      0.9473     0.2732     53.7745
09300     0.2514      0.9325     0.2732     54.2423
09400     0.1901      0.9578     0.2732     54.3126
09500     0.1627      0.9578     0.2834     54.5808
09600     0.1456      0.9662     0.2834     54.1959
09700     0.1677      0.9557     0.2834     54.3286
09800     0.1638      0.9599     0.2834     54.2301
09900     0.1172      0.9684     0.2917     54.7950
10000     0.2037      0.9367     0.2917     54.4512
10100     0.1715      0.9536     0.2917     54.3940
10200     0.1944      0.9451     0.2917     54.2895
10300     0.1628      0.9578     0.2917     54.6437
10400     0.1710      0.9536     0.2917     54.1564
10500     0.1808      0.9451     0.2917     54.1251
10600     0.2002      0.9304     0.2917     53.8251
10700     0.1486      0.9620     0.2917     54.4626
10800     0.1809      0.9409     0.2917     53.4951
10900     0.1289      0.9599     0.2917     54.1162
11000     0.1451      0.9620     0.2917     55.6628
11100     0.1949      0.9367     0.2917     54.6938
11200     0.1209      0.9705     0.2917     54.1360
11300     0.1569      0.9557     0.2917     53.9931
11400     0.1768      0.9515     0.2917     53.7619
11500     0.1415      0.9684     0.2917     54.2545
11600     0.1038      0.9831     0.2917     55.0317
11700     0.1217      0.9705     0.2917     54.6375
11800     0.1322      0.9599     0.2917     55.8138
11900     0.1437      0.9557     0.2917     54.3686
12000     0.1415      0.9705     0.2917     55.3367
12100     0.1556      0.9557     0.2917     53.9776
12200     0.1463      0.9578     0.2917     55.0420
12300     0.1544      0.9578     0.2917     55.1218
12400     0.1456      0.9662     0.2917     53.9441
12500     0.1916      0.9473     0.2917     54.3693
12600     0.1385      0.9599     0.2917     54.7439
12700     0.1276      0.9641     0.2917     54.2708
12800     0.1088      0.9810     0.2917     54.6260
12900     0.1234      0.9726     0.2917     54.2959
13000     0.1415      0.9662     0.2917     55.1139
13100     0.1700      0.9620     0.2917     55.5761
13200     0.1319      0.9684     0.2917     53.9829
13300     0.1773      0.9494     0.2917     53.7020
13400     0.1320      0.9641     0.2917     54.2007
13500     0.1627      0.9557     0.2917     54.1898
13600     0.1364      0.9705     0.2917     54.0748
13700     0.1092      0.9705     0.2917     54.2088
13800     0.1764      0.9494     0.2917     54.1504
13900     0.1958      0.9430     0.2917     54.4802
14000     0.1546      0.9578     0.3075     55.4215
14100     0.1311      0.9599     0.3075     53.9198
14200     0.1478      0.9684     0.3075     54.4851
14300     0.1424      0.9641     0.3075     53.7410
14400     0.1510      0.9536     0.3075     54.8894
14500     0.1424      0.9684     0.3075     54.3935
14600     0.1622      0.9599     0.3075     53.7653
14700     0.1304      0.9726     0.3075     54.9637
14800     0.1547      0.9536     0.3075     54.5095
14900     0.1261      0.9768     0.3075     54.4413
15000     0.1357      0.9641     0.3075     55.1289
15100     0.1563      0.9599     0.3075     54.4205
15200     0.1566      0.9557     0.3075     54.5316
15300     0.1544      0.9578     0.3075     54.7846
15400     0.1233      0.9705     0.3075     54.2328
15500     0.1044      0.9789     0.3075     54.9477
15600     0.1261      0.9641     0.3075     53.7999
15700     0.1381      0.9620     0.3075     53.7608
15800     0.1269      0.9662     0.3075     54.5844
15900     0.1582      0.9620     0.3075     54.7632
16000     0.1122      0.9662     0.3075     54.6703
16100     0.1104      0.9726     0.3075     53.9984
16200     0.1393      0.9641     0.3075     54.1051
16300     0.1226      0.9768     0.3075     54.2197
16400     0.1333      0.9662     0.3075     54.0941
16500     0.1425      0.9641     0.3075     54.3794
16600     0.1267      0.9662     0.3075     55.1885
16700     0.1329      0.9662     0.3075     53.6393
16800     0.0948      0.9747     0.3075     55.8024
16900     0.1540      0.9641     0.3075     55.0063
17000     0.1269      0.9705     0.3075     54.2683
17100     0.1098      0.9705     0.3075     54.7677
17200     0.1468      0.9599     0.3075     54.2536
17300     0.1339      0.9641     0.3075     54.1555
17400     0.1505      0.9641     0.3075     54.9468
17500     0.1021      0.9726     0.3075     53.7512
17600     0.1104      0.9705     0.3075     54.1317
17700     0.1228      0.9705     0.3075     53.7885
17800     0.1350      0.9726     0.3075     54.1241
17900     0.1180      0.9789     0.3075     55.0777
18000     0.1573      0.9620     0.3075     54.2436
18100     0.0950      0.9789     0.3075     53.9706
18200     0.1850      0.9557     0.3075     54.4899
18300     0.1259      0.9747     0.3075     54.7451
18400     0.1207      0.9684     0.3075     54.6380
18500     0.1285      0.9578     0.3075     54.1803
18600     0.1441      0.9578     0.3075     54.8146
18700     0.1171      0.9684     0.3075     55.0375
18800     0.1346      0.9599     0.3075     54.1160
18900     0.1126      0.9684     0.3075     53.7246
19000     0.0977      0.9705     0.3075     54.8435
19100     0.1332      0.9705     0.3075     53.6477
19200     0.1336      0.9662     0.3075     54.4873
19300     0.1397      0.9747     0.3075     53.7850
19400     0.1694      0.9599     0.3075     54.4575
19500     0.1095      0.9684     0.3075     54.5317
19600     0.2008      0.9451     0.3075     53.6658
19700     0.1296      0.9599     0.3075     54.1321
19800     0.1292      0.9662     0.3075     54.4900
19900     0.1294      0.9726     0.3075     54.4903
20000     0.0976      0.9768     0.3075     55.0897
20100     0.1377      0.9620     0.3075     53.9968
20199     0.1285      0.9641     0.3075     53.6854
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     3.8444      0.3038     0.2657     8.7808
00100     1.7883      0.5000     0.4775     54.5541
00200     1.3522      0.6350     0.5806     54.0730
00300     1.2478      0.6392     0.6218     55.2659
00400     1.1853      0.6519     0.6232     53.8654
00500     1.3588      0.6414     0.6851     53.7607
00600     1.1247      0.6962     0.7087     54.3928
00700     0.9563      0.7363     0.7186     53.8058
00800     0.9526      0.7300     0.7186     54.6782
00900     1.0708      0.7068     0.7188     54.1632
01000     1.1344      0.6983     0.7492     54.8727
01100     0.8541      0.7616     0.7492     54.1643
01200     0.8899      0.7532     0.7492     53.5456
01300     0.8051      0.7658     0.7492     53.8698
01400     0.9648      0.7595     0.7492     54.0232
01500     0.8092      0.7764     0.7492     53.4373
01600     0.9615      0.7342     0.7608     54.0176
01700     0.9371      0.7321     0.7648     54.1560
01800     0.9247      0.7700     0.7697     53.6289
01900     0.8491      0.7679     0.7751     53.7516
02000     1.0409      0.7046     0.7751     53.7633
02100     0.6622      0.8143     0.7798     54.4597
02200     0.7687      0.7869     0.7798     54.4045
02300     0.7832      0.7785     0.7827     54.4362
02400     0.8607      0.7532     0.7827     53.9933
02500     0.8373      0.7679     0.7871     54.1643
02600     0.8484      0.7574     0.7871     54.0437
02700     0.8638      0.7553     0.7871     54.4288
02800     0.6476      0.8270     0.7871     54.8552
02900     0.9632      0.7489     0.8009     53.9365
03000     0.7902      0.7722     0.8009     54.2030
03100     0.7372      0.7848     0.8037     54.0113
03200     0.8644      0.7658     0.8037     53.9307
03300     0.6354      0.8207     0.8037     53.9007
03400     0.8026      0.8101     0.8037     53.9734
03500     0.7687      0.7975     0.8037     54.0996
03600     0.6810      0.8228     0.8037     54.1414
03700     0.6094      0.8143     0.8037     53.7851
03800     0.6717      0.8080     0.8037     54.7765
03900     0.6438      0.8143     0.8037     54.5658
04000     0.6968      0.7996     0.8037     54.2309
04100     0.6482      0.8312     0.8037     54.0291
04200     0.8281      0.7722     0.8037     53.8878
04300     0.6401      0.8249     0.8053     54.1568
04400     0.6150      0.8122     0.8105     54.1756
04500     0.6763      0.8397     0.8105     53.7320
04600     0.7112      0.8165     0.8105     55.4248
04700     0.5974      0.8333     0.8209     53.8795
04800     0.6219      0.8249     0.8209     54.2110
04900     0.6717      0.8080     0.8209     54.6205
05000     0.6544      0.8418     0.8209     54.3496
05100     0.5891      0.8228     0.8209     54.4878
05200     0.6980      0.8080     0.8209     53.7291
05300     0.6487      0.7932     0.8215     54.0583
05400     0.8100      0.7975     0.8215     54.3608
05500     0.5482      0.8502     0.8215     53.7663
05600     0.5435      0.8502     0.8215     53.9801
05700     0.5789      0.8312     0.8215     54.3642
05800     0.6923      0.7890     0.8215     54.4871
05900     0.5799      0.8143     0.8215     54.8836
06000     0.7222      0.8059     0.8215     53.8011
06100     0.6243      0.8017     0.8215     54.5897
06200     0.5170      0.8502     0.8215     54.5460
06300     0.5751      0.8354     0.8359     54.3502
06400     0.6596      0.8270     0.8359     54.4951
06500     0.6465      0.8059     0.8359     54.1011
06600     0.6196      0.8186     0.8359     53.7624
06700     0.4885      0.8460     0.8359     54.2613
06800     0.6917      0.7954     0.8359     54.3028
06900     0.5634      0.8439     0.8359     55.4357
07000     0.7817      0.7911     0.8359     54.5538
07100     0.5870      0.8460     0.8359     53.8635
07200     0.6075      0.8312     0.8359     53.9952
07300     0.6325      0.8397     0.8359     54.0414
07400     0.5200      0.8544     0.8359     54.0240
07500     0.5736      0.8165     0.8359     54.6830
07600     0.5958      0.8418     0.8359     54.2751
07700     0.6351      0.8502     0.8359     54.5420
07800     0.5812      0.8376     0.8359     54.2415
07900     0.6698      0.8101     0.8359     53.9438
08000     0.5358      0.8333     0.8364     53.7539
08100     0.5932      0.8439     0.8364     54.4652
08200     0.6368      0.7954     0.8396     54.1993
08300     0.6069      0.8186     0.8396     54.1302
08400     0.5363      0.8186     0.8396     54.7818
08500     0.4941      0.8629     0.8396     53.9733
08600     0.7207      0.7806     0.8396     54.2836
08700     0.5830      0.8439     0.8396     53.7537
08800     0.5833      0.8122     0.8396     54.2624
08900     0.6254      0.8017     0.8396     54.0339
09000     0.5913      0.8122     0.8396     53.6731
09100     0.5535      0.8502     0.8396     54.1009
09200     0.5525      0.8333     0.8396     53.5526
09300     0.7037      0.8228     0.8396     53.5455
09400     0.4846      0.8544     0.8396     54.2285
09500     0.6477      0.8101     0.8468     54.8446
09600     0.7508      0.7848     0.8468     54.0583
09700     0.5976      0.8228     0.8468     53.6184
09800     0.6129      0.8333     0.8468     54.6546
09900     0.5289      0.8460     0.8468     55.3848
Start testing:
Test Accuracy: 0.8739
