Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=394, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=193012823, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
35cc4c5c-6867-45d4-84bf-eb690a408d08
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 147, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 374, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 213, in forward
    gates = quant_pass(pact_a_bmm( quant_pass(pact_a_bmm(part1, self.a12), self.abMVM, self.a12) + quant_pass(pact_a_bmm(part2, self.a13), self.abMVM, self.a13), self.a14), self.abNM, self.a14)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 124, in pact_a_bmm
    return torch.sign(x) * .5 * (torch.abs(x) - torch.abs(torch.abs(x) - a) + a)
RuntimeError: CUDA out of memory. Tried to allocate 12.00 MiB (GPU 0; 11.78 GiB total capacity; 10.49 GiB already allocated; 7.38 MiB free; 10.61 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=394, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=193012823, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
f564e527-0514-41cb-a302-f55b64bf6e1d
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     3.4486      0.1000     0.0953     16.1161
00100     1.7976      0.5000     0.4755     59.2742
00200     1.4836      0.4900     0.6258     59.1550
00300     1.0452      0.6500     0.6992     56.0009
00400     1.1799      0.6300     0.6992     55.7675
00500     0.9570      0.7300     0.7422     58.8194
00600     0.8754      0.7000     0.7740     58.9062
00700     0.7829      0.7700     0.7813     57.8223
00800     0.9022      0.7300     0.7813     56.5709
00900     0.7546      0.7500     0.7832     56.3864
01000     1.1048      0.6700     0.7832     58.4428
01100     0.8196      0.7400     0.7876     61.4293
01200     0.7394      0.7100     0.8019     57.0670
01300     0.7559      0.7600     0.8138     60.4187
01400     0.6130      0.8000     0.8250     58.6355
01500     0.7201      0.8000     0.8250     58.5173
01600     0.5464      0.8300     0.8250     60.4351
01700     0.7659      0.7600     0.8250     59.1262
01800     0.7959      0.7500     0.8250     60.4610
01900     0.6326      0.7700     0.8250     59.2435
02000     0.5252      0.8100     0.8280     56.1443
02100     0.7506      0.7800     0.8424     55.4293
02200     0.5411      0.8400     0.8424     56.1035
02300     0.6266      0.8100     0.8424     56.1917
02400     0.7264      0.7900     0.8424     59.8171
02500     0.7409      0.8000     0.8424     57.0976
02600     0.6456      0.7500     0.8424     61.6057
02700     0.7009      0.8100     0.8519     60.8347
02800     0.8916      0.7200     0.8519     58.9284
02900     0.4564      0.8800     0.8519     59.6995
03000     0.7574      0.7500     0.8519     58.2268
03100     0.7603      0.7500     0.8519     57.4069
03200     0.8323      0.7400     0.8519     57.9630
03300     0.6917      0.8200     0.8519     54.8935
03400     0.6531      0.7800     0.8519     55.3385
03500     0.7718      0.7600     0.8519     56.8571
03600     0.4722      0.8700     0.8519     56.1775
03700     0.7069      0.7700     0.8519     59.5798
03800     0.6700      0.7900     0.8519     59.7869
03900     0.5349      0.8200     0.8519     54.7653
04000     0.4457      0.8900     0.8519     58.9577
04100     0.4320      0.8300     0.8519     56.9003
04200     0.5590      0.8200     0.8519     58.8490
04300     0.6080      0.8000     0.8519     57.9945
04400     0.5144      0.8400     0.8519     56.0940
04500     0.5921      0.8200     0.8583     58.8265
04600     0.7402      0.7700     0.8583     60.5790
04700     0.4823      0.8500     0.8583     58.0032
04800     0.6747      0.8100     0.8583     58.6866
04900     0.6359      0.8100     0.8583     60.3768
05000     0.8729      0.7400     0.8583     55.3294
05100     0.4550      0.8600     0.8583     60.1193
05200     0.6567      0.8300     0.8583     60.1258
05300     0.5338      0.8000     0.8583     56.7157
05400     0.3878      0.8300     0.8583     59.6316
05500     0.4449      0.8700     0.8583     56.4944
05600     0.4865      0.8200     0.8583     57.1365
05700     0.4416      0.8700     0.8583     56.8285
05800     0.4941      0.8900     0.8637     56.2488
05900     0.4800      0.9100     0.8637     57.2913
06000     0.5772      0.8100     0.8637     56.0313
06100     0.4974      0.8700     0.8653     57.8643
06200     0.5343      0.8400     0.8662     61.1262
06300     0.4566      0.8300     0.8662     58.6490
06400     0.5578      0.8300     0.8662     59.7724
06500     0.4590      0.8500     0.8662     55.8945
06600     0.5340      0.8500     0.8687     56.5783
06700     0.4790      0.8600     0.8687     57.2219
06800     0.4120      0.8700     0.8687     59.1715
06900     0.3795      0.8500     0.8687     59.5434
07000     0.5835      0.8200     0.8687     59.7376
07100     0.6444      0.8300     0.8687     59.1718
07200     0.4424      0.8700     0.8710     57.9485
07300     0.5486      0.8300     0.8710     57.9516
07400     0.5426      0.8200     0.8710     58.9358
07500     0.5252      0.8300     0.8710     59.0153
07600     0.5357      0.8200     0.8710     55.7267
07700     0.6340      0.7800     0.8710     55.7338
07800     0.4257      0.8700     0.8710     57.0911
07900     0.4397      0.8600     0.8710     56.4719
08000     0.3864      0.8800     0.8710     59.3506
08100     0.3865      0.8700     0.8710     61.6648
08200     0.4836      0.8600     0.8710     57.4466
08300     0.5383      0.8200     0.8710     55.1001
08400     0.5405      0.8200     0.8710     56.8194
08500     0.4522      0.8800     0.8782     57.5871
08600     0.6301      0.8400     0.8782     55.9424
08700     0.4652      0.8600     0.8782     63.0782
08800     0.5880      0.7800     0.8782     56.7139
08900     0.4665      0.8800     0.8835     55.2201
09000     0.3501      0.9100     0.8835     58.6214
09100     0.4610      0.8600     0.8835     62.3215
09200     0.4964      0.8500     0.8835     56.2917
09300     0.3752      0.8900     0.8835     58.8147
09400     0.4639      0.8700     0.8835     57.0327
09500     0.5445      0.8400     0.8835     58.3648
09600     0.4910      0.8200     0.8835     57.0838
09700     0.4021      0.9000     0.8835     59.9123
09800     0.6990      0.7900     0.8835     57.1084
09900     0.4162      0.8800     0.8835     59.5902
10000     0.5492      0.8300     0.8835     56.6743
10100     0.3239      0.8800     0.8835     56.5466
10200     0.4284      0.9000     0.8835     59.4872
10300     0.5888      0.8300     0.8835     57.9473
10400     0.3616      0.8900     0.8835     60.5479
10500     0.2823      0.9300     0.8835     56.6729
10600     0.4345      0.8500     0.8835     56.1523
10700     0.3689      0.8800     0.8856     59.7547
10800     0.4627      0.8300     0.8856     57.8669
10900     0.3208      0.8900     0.8856     56.9211
11000     0.3228      0.9100     0.8856     57.5484
11100     0.4428      0.8800     0.8856     56.6170
11200     0.3011      0.9100     0.8856     59.6129
11300     0.2809      0.9000     0.8856     57.0379
11400     0.3235      0.8900     0.8856     56.4366
11500     0.3088      0.9300     0.8856     54.9026
11600     0.3698      0.9000     0.8856     55.2802
11700     0.4893      0.8600     0.8856     55.4784
11800     0.3363      0.8900     0.8856     56.3256
11900     0.4161      0.8400     0.8856     56.4595
12000     0.3833      0.9200     0.8856     57.5231
12100     0.3692      0.9000     0.8856     55.8149
12200     0.2305      0.9300     0.8856     56.3406
12300     0.3113      0.8900     0.8856     57.7831
12400     0.4760      0.8700     0.8945     61.5670
12500     0.4846      0.8800     0.8945     59.4882
12600     0.3790      0.8700     0.8945     56.1081
12700     0.3375      0.9000     0.8945     56.3050
12800     0.3180      0.8900     0.8945     59.6001
12900     0.5034      0.8400     0.8945     56.1151
13000     0.4130      0.9000     0.8945     61.0974
13100     0.3989      0.9000     0.8945     60.5496
13200     0.3903      0.8800     0.8945     63.0875
13300     0.4106      0.8600     0.8945     58.7221
13400     0.3640      0.8800     0.8955     60.1479
13500     0.3099      0.9100     0.8955     61.4611
13600     0.3409      0.9200     0.8955     57.9426
13700     0.3030      0.9000     0.8955     60.7078
13800     0.3812      0.8700     0.8955     57.4512
13900     0.4788      0.8400     0.8955     58.0606
14000     0.2570      0.9300     0.8955     56.6132
14100     0.4479      0.8700     0.8955     57.3421
14200     0.2148      0.9500     0.8955     59.1624
14300     0.2857      0.9000     0.8955     57.9545
14400     0.3340      0.8800     0.8955     57.8479
14500     0.3682      0.8600     0.8955     59.0340
14600     0.3631      0.8700     0.8955     56.0949
14700     0.3674      0.8700     0.8955     56.5108
14800     0.3719      0.8900     0.8955     60.5801
14900     0.2846      0.9000     0.8955     56.4034
15000     0.4235      0.8600     0.8955     58.8461
15100     0.3429      0.8700     0.8955     58.1305
15200     0.4211      0.8800     0.8955     56.7865
15300     0.4038      0.8800     0.8955     57.6317
15400     0.3855      0.8600     0.8955     58.0003
15500     0.3262      0.9100     0.8955     60.7619
15600     0.2294      0.9100     0.8955     56.9488
15700     0.3031      0.8800     0.8955     56.0044
15800     0.2859      0.8800     0.8955     55.6063
15900     0.4588      0.8700     0.8955     55.6607
16000     0.3196      0.9400     0.8955     58.9685
16100     0.3557      0.8800     0.8955     57.6722
16200     0.3866      0.8500     0.8955     59.0177
16300     0.2848      0.9000     0.8955     56.9962
16400     0.3512      0.8900     0.8955     57.6666
16500     0.2541      0.9300     0.8955     59.2836
16600     0.1670      0.9600     0.8955     61.3997
16700     0.3365      0.8800     0.8955     60.3694
16800     0.4260      0.8600     0.8955     57.7597
16900     0.3040      0.9000     0.8955     56.8698
17000     0.2584      0.9000     0.8955     59.2038
17100     0.2209      0.9200     0.8955     55.7124
17200     0.2631      0.9100     0.8955     60.8795
17300     0.1569      0.9600     0.8955     59.9837
17400     0.3623      0.8700     0.8955     59.8694
17500     0.2635      0.8900     0.8955     61.9557
17600     0.2129      0.9400     0.8955     59.1333
17700     0.3426      0.9100     0.8955     61.3167
17800     0.2779      0.8900     0.8955     56.3232
17900     0.2524      0.9300     0.8955     58.0861
18000     0.2885      0.9100     0.8955     57.3460
18100     0.2602      0.9200     0.8955     56.2794
18200     0.2406      0.9300     0.8955     56.1292
18300     0.2561      0.9000     0.8955     60.5203
18400     0.3028      0.9100     0.8955     57.4636
18500     0.2834      0.9000     0.8955     56.8177
18600     0.2934      0.9100     0.8955     55.4246
18700     0.4509      0.8500     0.8955     56.8556
18800     0.3635      0.9000     0.8955     57.4287
18900     0.2897      0.9300     0.8955     55.9422
19000     0.1836      0.9400     0.8955     58.8740
19100     0.3559      0.9000     0.8955     62.2488
19200     0.2742      0.9200     0.8955     55.9944
19300     0.2341      0.9300     0.8955     58.4427
19400     0.2806      0.8700     0.8955     56.1730
19500     0.2665      0.9300     0.8955     56.2571
19600     0.2576      0.9200     0.8955     57.6495
19700     0.2402      0.9300     0.8955     59.6620
19800     0.2212      0.9100     0.8955     55.0662
19900     0.4974      0.8600     0.8955     57.1945
20000     0.2957      0.8900     0.8955     58.1564
20100     0.3837      0.8900     0.8955     59.8511
20199     0.3960      0.8900     0.8955     56.8779
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     0.4695      0.8800     0.8021     14.7790
00100     0.2339      0.9300     0.9045     61.4362
00200     0.3930      0.8600     0.9071     56.6189
00300     0.3245      0.8800     0.9071     63.6045
00400     0.2802      0.9100     0.9071     60.1521
00500     0.3756      0.8800     0.9071     57.6150
00600     0.3271      0.9300     0.9071     58.4344
00700     0.1727      0.9500     0.9071     57.6645
00800     0.3545      0.8800     0.9071     59.9501
00900     0.2968      0.9300     0.9071     59.3212
01000     0.1687      0.9600     0.9071     61.9304
01100     0.3780      0.8300     0.9071     58.9817
01200     0.3253      0.9000     0.9071     58.8217
01300     0.3325      0.9100     0.9071     55.4472
01400     0.2201      0.9300     0.9071     60.0635
01500     0.4432      0.8700     0.9071     58.3867
01600     0.2784      0.9100     0.9071     58.5066
01700     0.2808      0.9000     0.9071     54.9254
01800     0.2091      0.9300     0.9090     61.8104
01900     0.2581      0.9300     0.9090     60.4188
02000     0.2184      0.9500     0.9090     56.1065
02100     0.4772      0.8400     0.9090     54.9406
02200     0.3751      0.9200     0.9090     59.3400
02300     0.4171      0.9000     0.9090     56.3362
02400     0.3307      0.9000     0.9090     59.2010
02500     0.2479      0.9300     0.9090     59.8141
02600     0.3520      0.8800     0.9090     59.0464
02700     0.2241      0.9300     0.9090     62.2067
02800     0.1918      0.9400     0.9090     55.2064
02900     0.3159      0.9000     0.9090     62.7659
03000     0.2774      0.9200     0.9090     60.5667
03100     0.2890      0.9200     0.9090     55.6899
03200     0.2683      0.9200     0.9090     56.1029
03300     0.3804      0.8500     0.9090     58.1925
03400     0.2277      0.9200     0.9090     58.6122
03500     0.3263      0.9100     0.9090     60.3997
03600     0.2880      0.9400     0.9090     57.2974
03700     0.3401      0.8700     0.9090     58.5171
03800     0.2333      0.9200     0.9090     57.6038
03900     0.2614      0.9300     0.9090     55.4127
04000     0.2488      0.9300     0.9090     56.5975
04100     0.2345      0.9100     0.9090     59.5021
04200     0.2699      0.9100     0.9090     58.2087
04300     0.2165      0.9600     0.9090     56.7782
04400     0.2307      0.9100     0.9090     58.5301
04500     0.1986      0.9300     0.9090     58.4082
04600     0.2135      0.9400     0.9090     55.4717
04700     0.2468      0.9300     0.9090     56.9916
04800     0.2772      0.9100     0.9090     55.4182
04900     0.3250      0.8700     0.9090     57.7884
05000     0.2822      0.9200     0.9090     59.2848
05100     0.3073      0.9000     0.9090     61.9361
05200     0.2786      0.9100     0.9090     60.9088
05300     0.2446      0.9100     0.9090     59.8391
05400     0.2427      0.9300     0.9090     56.8949
05500     0.2505      0.9000     0.9090     58.2887
05600     0.4297      0.8800     0.9090     58.7206
05700     0.4597      0.8800     0.9090     62.8980
05800     0.2558      0.9300     0.9090     57.6959
05900     0.2475      0.8800     0.9090     57.9254
06000     0.4267      0.8700     0.9090     58.9289
06100     0.2317      0.9100     0.9090     62.7964
06200     0.3698      0.8900     0.9090     56.8676
06300     0.3131      0.8900     0.9090     61.0911
06400     0.1839      0.9500     0.9090     61.7620
06500     0.4172      0.8700     0.9090     57.8058
06600     0.4263      0.8700     0.9090     60.6947
06700     0.2624      0.9300     0.9090     55.7780
06800     0.2940      0.9300     0.9090     59.9246
06900     0.2410      0.9200     0.9090     57.8976
07000     0.4015      0.8700     0.9090     56.4089
07100     0.1232      0.9700     0.9094     58.5672
07200     0.3097      0.8700     0.9094     57.5074
07300     0.2577      0.9000     0.9094     58.8720
07400     0.2914      0.9200     0.9094     59.3879
07500     0.3130      0.8900     0.9094     58.1507
07600     0.2203      0.9300     0.9094     56.7533
07700     0.4478      0.8200     0.9094     58.4551
07800     0.2445      0.9400     0.9094     55.6315
07900     0.2462      0.9400     0.9094     58.3069
08000     0.2152      0.9200     0.9094     57.2858
08100     0.3086      0.9000     0.9094     59.6494
08200     0.2309      0.9300     0.9094     56.4640
08300     0.2417      0.9200     0.9094     60.5460
08400     0.2392      0.9300     0.9094     59.4636
08500     0.4012      0.8800     0.9094     58.9007
08600     0.2480      0.9400     0.9094     58.8690
08700     0.1813      0.9700     0.9097     64.2626
08800     0.2591      0.8900     0.9097     60.3880
08900     0.2336      0.9200     0.9097     56.1309
09000     0.2667      0.9300     0.9097     56.2195
09100     0.3172      0.8700     0.9097     58.5838
09200     0.2009      0.9300     0.9097     60.0233
09300     0.3138      0.8800     0.9097     63.3052
09400     0.2013      0.9400     0.9097     59.8911
09500     0.3552      0.8500     0.9097     61.3649
09600     0.2037      0.9500     0.9097     55.6670
09700     0.2264      0.9400     0.9097     56.9118
09800     0.2179      0.9400     0.9097     56.6468
09900     0.1418      0.9800     0.9097     56.7373
Start testing:
Test Accuracy: 0.9061
