Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=194, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=8627169, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
04c4cd4f-5d22-4b5e-a9fa-1b5482d5066c
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 167, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 374, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 210, in forward
    part1 = CustomMM_bmm.apply(quant_pass(pact_a_bmm(input.repeat(self.n_blocks, 1, 1), self.a1), self.ib, self.a1), self.weight_ih, self.bias_ih, self.noise_level, self.wb, self.bias_r)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 150, in forward
    output = input.bmm(wq + noise_w) + bq + bias_w
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 10.76 GiB total capacity; 9.63 GiB already allocated; 3.12 MiB free; 9.80 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=194, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=8627169, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
4b32f828-f6e9-45e1-be17-31c270049957
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     2.8402      0.0800     0.0917     17.9483
00100     1.8007      0.3700     0.3961     56.5855
00200     1.4800      0.5400     0.5612     57.1290
00300     1.2051      0.6500     0.6404     55.2425
00400     1.2675      0.5700     0.6803     56.8471
00500     1.0074      0.6800     0.7173     58.4445
00600     0.9463      0.7500     0.7391     56.5150
00700     0.7868      0.7000     0.7391     55.9067
00800     1.0319      0.5800     0.7468     60.6742
00900     0.8166      0.7400     0.7682     55.3793
01000     1.1640      0.6000     0.7682     56.7539
01100     0.7350      0.7900     0.7872     57.3583
01200     0.7043      0.7800     0.7872     55.1440
01300     0.9680      0.6700     0.7872     57.9499
01400     1.0655      0.6800     0.7872     57.0734
01500     0.8680      0.7600     0.7872     54.4916
01600     0.7661      0.7600     0.7872     55.8613
01700     0.6711      0.7600     0.8043     56.3545
01800     0.7678      0.8000     0.8043     59.2335
01900     0.7863      0.7200     0.8122     56.3665
02000     0.7053      0.7600     0.8122     57.4443
02100     0.5815      0.8200     0.8122     57.6635
02200     0.8303      0.7500     0.8122     56.2631
02300     0.4716      0.8600     0.8122     59.4981
02400     0.8574      0.7200     0.8169     57.2833
02500     0.9420      0.6600     0.8179     58.7313
02600     0.5094      0.8000     0.8179     60.1179
02700     0.7802      0.7400     0.8179     55.8430
02800     0.6433      0.8100     0.8179     57.2790
02900     0.5864      0.8600     0.8188     59.4207
03000     0.7797      0.7700     0.8188     56.1197
03100     0.6799      0.7700     0.8188     59.4736
03200     0.6583      0.7900     0.8285     58.5127
03300     0.6476      0.8000     0.8285     56.9328
03400     0.6513      0.8200     0.8323     56.5911
03500     0.8323      0.7500     0.8323     57.7078
03600     0.6841      0.7900     0.8342     59.0759
03700     0.6479      0.8000     0.8342     58.1651
03800     0.6333      0.8300     0.8342     55.9142
03900     0.8289      0.7100     0.8342     58.1297
04000     0.6849      0.8100     0.8342     58.0602
04100     0.7502      0.7300     0.8342     55.7533
04200     0.7701      0.7800     0.8342     59.0256
04300     0.7807      0.7700     0.8342     58.7354
04400     0.7414      0.7400     0.8428     60.6739
04500     0.5743      0.8100     0.8428     58.0348
04600     0.6153      0.7900     0.8428     55.6766
04700     0.6185      0.8300     0.8428     56.3543
04800     0.5246      0.8800     0.8428     55.7519
04900     0.7231      0.7200     0.8428     57.5187
05000     0.6627      0.7800     0.8428     58.8130
05100     0.4871      0.8500     0.8428     59.9056
05200     0.6009      0.7800     0.8428     57.9201
05300     0.8530      0.7900     0.8428     54.9096
05400     0.5183      0.8200     0.8428     60.3558
05500     0.5782      0.7900     0.8428     58.4408
05600     0.6731      0.8000     0.8428     58.3438
05700     0.4899      0.8300     0.8428     62.0205
05800     0.5776      0.7800     0.8428     55.4942
05900     0.5225      0.7600     0.8428     55.0010
06000     0.6829      0.8400     0.8428     57.3764
06100     0.7015      0.8100     0.8440     59.7339
06200     0.5948      0.8000     0.8522     55.1609
06300     0.7297      0.7700     0.8522     55.2758
06400     0.4793      0.8100     0.8522     58.5227
06500     0.6577      0.8100     0.8522     54.8784
06600     0.5840      0.7800     0.8522     54.1820
06700     0.7888      0.7500     0.8522     58.0463
06800     0.5880      0.8000     0.8522     58.9642
06900     0.5927      0.8000     0.8522     57.7237
07000     0.7724      0.7700     0.8522     55.3948
07100     0.6131      0.8300     0.8522     55.3496
07200     0.6164      0.8000     0.8522     58.0245
07300     0.5780      0.8100     0.8522     56.8527
07400     0.5716      0.7900     0.8522     58.3594
07500     0.4019      0.8600     0.8522     55.4180
07600     0.6117      0.8200     0.8522     54.4338
07700     0.6320      0.8100     0.8522     59.4777
07800     0.6006      0.8300     0.8522     60.0887
07900     0.6273      0.7800     0.8522     55.4800
08000     0.5321      0.8500     0.8522     60.0920
08100     0.5547      0.8500     0.8522     57.7475
08200     0.6650      0.8200     0.8522     57.7015
08300     0.5485      0.7900     0.8560     55.8427
08400     0.5685      0.8000     0.8560     60.0703
08500     0.6285      0.8200     0.8560     58.4874
08600     0.5410      0.8600     0.8560     56.3984
08700     0.6526      0.7700     0.8560     54.9619
08800     0.5836      0.8000     0.8560     54.5949
08900     0.4658      0.8700     0.8560     54.4986
09000     0.6546      0.8200     0.8560     58.4099
09100     0.5587      0.8000     0.8592     59.2841
09200     0.5215      0.8200     0.8592     62.2480
09300     0.7229      0.8200     0.8592     60.6389
09400     0.4978      0.8500     0.8600     55.4669
09500     0.5351      0.8100     0.8600     56.4894
09600     0.3540      0.9200     0.8600     57.6471
09700     0.5121      0.8400     0.8600     59.9310
09800     0.5934      0.8100     0.8600     55.4276
09900     0.5683      0.7900     0.8600     57.3310
10000     0.5177      0.8400     0.8600     57.5544
10100     0.4180      0.8900     0.8600     55.2878
10200     0.4482      0.8600     0.8600     56.2395
10300     0.3327      0.9200     0.8600     58.3686
10400     0.5347      0.7800     0.8600     56.4819
10500     0.5257      0.8200     0.8600     54.7651
10600     0.5454      0.8200     0.8600     61.7673
10700     0.3714      0.8600     0.8602     56.1370
10800     0.5984      0.8200     0.8602     54.0324
10900     0.4209      0.8500     0.8602     59.2048
11000     0.5403      0.8000     0.8643     56.1859
11100     0.4320      0.8800     0.8643     56.8899
11200     0.4585      0.8300     0.8643     56.6869
11300     0.5509      0.8600     0.8731     55.5949
11400     0.3337      0.9300     0.8731     56.2692
11500     0.6206      0.7600     0.8731     56.9873
11600     0.5908      0.8200     0.8731     58.9350
11700     0.4642      0.8100     0.8731     60.3501
11800     0.4802      0.8500     0.8731     56.7386
11900     0.5905      0.8200     0.8731     55.1885
12000     0.3124      0.9100     0.8731     62.3856
12100     0.3226      0.8700     0.8731     55.2625
12200     0.3979      0.8200     0.8731     58.0198
12300     0.5007      0.8100     0.8731     56.8110
12400     0.4270      0.8600     0.8731     58.5083
12500     0.5842      0.8100     0.8731     55.7341
12600     0.4210      0.8600     0.8731     56.9985
12700     0.4088      0.8900     0.8731     56.9011
12800     0.4140      0.8800     0.8731     59.0431
12900     0.3593      0.9100     0.8731     60.2082
13000     0.5254      0.8000     0.8731     55.6677
13100     0.6271      0.8100     0.8731     54.9632
13200     0.6200      0.8000     0.8731     58.7059
13300     0.6101      0.8300     0.8731     59.2879
13400     0.6022      0.7700     0.8747     57.9740
13500     0.4605      0.8600     0.8809     54.6812
13600     0.3896      0.8300     0.8809     56.0667
13700     0.4092      0.8700     0.8809     58.8893
13800     0.3589      0.9000     0.8809     54.7715
13900     0.3799      0.8800     0.8811     54.5139
14000     0.2816      0.9200     0.8811     60.0212
14100     0.5332      0.8500     0.8811     56.8842
14200     0.3962      0.8500     0.8811     55.7002
14300     0.4352      0.8700     0.8811     57.7018
14400     0.4029      0.8700     0.8811     55.8852
14500     0.5183      0.8200     0.8811     57.7882
14600     0.4567      0.8600     0.8811     59.5062
14700     0.3880      0.8900     0.8811     60.8542
14800     0.3517      0.8900     0.8811     56.7786
14900     0.3684      0.9100     0.8811     55.7504
15000     0.4152      0.8700     0.8811     57.4360
15100     0.3337      0.9200     0.8811     58.9736
15200     0.2838      0.9500     0.8811     59.1198
15300     0.5820      0.8500     0.8811     56.0083
15400     0.4534      0.8700     0.8811     56.8831
15500     0.4566      0.8400     0.8811     57.1143
15600     0.3968      0.9000     0.8811     62.0092
15700     0.3783      0.8900     0.8811     56.1020
15800     0.5106      0.8500     0.8811     56.6019
15900     0.4301      0.9000     0.8811     56.4323
16000     0.5805      0.8300     0.8811     57.4313
16100     0.3986      0.8500     0.8811     55.7765
16200     0.4655      0.8400     0.8811     54.7281
16300     0.6383      0.7700     0.8811     55.3572
16400     0.4986      0.8600     0.8811     56.4084
16500     0.4719      0.8300     0.8811     60.1913
16600     0.6305      0.8500     0.8811     54.5148
16700     0.3047      0.9600     0.8811     58.2505
16800     0.4601      0.8700     0.8811     58.1204
16900     0.3365      0.9200     0.8811     57.3738
17000     0.3760      0.9100     0.8811     58.8286
17100     0.4057      0.9000     0.8811     55.7198
17200     0.5268      0.8300     0.8811     58.3446
17300     0.2487      0.9500     0.8811     56.4352
17400     0.4456      0.8600     0.8811     54.6499
17500     0.3784      0.8800     0.8811     59.4265
17600     0.3713      0.9000     0.8811     56.1449
17700     0.3358      0.8800     0.8862     55.5693
17800     0.4915      0.8500     0.8862     59.6949
17900     0.3766      0.8900     0.8862     57.1451
18000     0.3315      0.9100     0.8862     56.4110
18100     0.3704      0.8800     0.8862     58.2650
18200     0.5242      0.8600     0.8862     56.5978
18300     0.5597      0.8100     0.8862     58.1794
18400     0.3670      0.8900     0.8862     57.7811
18500     0.5545      0.7500     0.8862     59.2814
18600     0.2654      0.9300     0.8862     55.1045
18700     0.3581      0.8900     0.8862     55.4068
18800     0.3259      0.9100     0.8862     57.2815
18900     0.4068      0.8500     0.8862     59.0944
19000     0.3751      0.9000     0.8862     58.0699
19100     0.4626      0.8800     0.8862     57.3625
19200     0.4344      0.8400     0.8862     57.0994
19300     0.2796      0.9100     0.8862     58.1111
19400     0.3506      0.8900     0.8862     56.2035
19500     0.2549      0.9200     0.8862     57.3173
19600     0.4378      0.8900     0.8862     59.0667
19700     0.4870      0.8600     0.8862     58.2367
19800     0.4653      0.8600     0.8862     56.9963
19900     0.4598      0.8500     0.8862     56.0901
20000     0.2878      0.9000     0.8862     55.5635
20100     0.2694      0.9200     0.8862     58.8607
20199     0.3139      0.8900     0.8862     59.5430
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     0.6341      0.7600     0.8384     15.0491
00100     0.4492      0.9000     0.8923     56.0130
00200     0.2769      0.9000     0.8943     59.0437
00300     0.4175      0.8600     0.8943     54.7426
00400     0.3866      0.8900     0.8970     54.8967
00500     0.5350      0.8300     0.8970     57.2687
00600     0.4442      0.8600     0.8970     58.1468
00700     0.3650      0.9100     0.8972     58.6418
00800     0.3998      0.8700     0.8987     58.9249
00900     0.4129      0.8700     0.8987     54.3667
01000     0.3411      0.8500     0.8987     59.5543
01100     0.2033      0.9700     0.8987     57.8435
01200     0.3865      0.8700     0.8987     57.6204
01300     0.3963      0.8500     0.8987     54.6574
01400     0.4794      0.8300     0.8988     61.2912
01500     0.3925      0.9200     0.8988     55.1801
01600     0.4217      0.8500     0.8988     57.6128
01700     0.5436      0.8200     0.8988     58.1024
01800     0.2941      0.9200     0.8988     55.8152
01900     0.3833      0.8800     0.8988     61.0458
02000     0.3476      0.8900     0.8988     59.3393
02100     0.3916      0.8900     0.8988     56.7102
02200     0.5372      0.8200     0.8988     55.6898
02300     0.3202      0.9000     0.8988     58.2681
02400     0.3409      0.8500     0.8988     58.3939
02500     0.4732      0.8500     0.8988     57.2756
02600     0.3754      0.8800     0.8988     56.2291
02700     0.5969      0.8700     0.8988     55.6372
02800     0.6372      0.7700     0.8988     56.8647
02900     0.4259      0.8600     0.9003     59.6387
03000     0.4547      0.8600     0.9003     54.3688
03100     0.3141      0.8700     0.9003     59.5429
03200     0.4871      0.8400     0.9003     61.2032
03300     0.3682      0.9100     0.9003     55.9121
03400     0.2852      0.9000     0.9003     58.1051
03500     0.5020      0.8500     0.9003     57.4584
03600     0.5203      0.8500     0.9003     59.7689
03700     0.4482      0.8600     0.9003     55.3977
03800     0.3786      0.8900     0.9003     58.0804
03900     0.2876      0.9100     0.9003     55.7757
04000     0.4065      0.8500     0.9003     57.3411
04100     0.4311      0.8800     0.9003     59.6287
04200     0.3150      0.9000     0.9003     55.8180
04300     0.2933      0.9500     0.9003     57.4320
04400     0.3019      0.9100     0.9003     58.4010
04500     0.4154      0.8900     0.9003     57.3414
04600     0.4265      0.9000     0.9003     55.7955
04700     0.4132      0.8700     0.9003     55.9805
04800     0.4468      0.8100     0.9003     57.5539
04900     0.3983      0.8800     0.9003     55.1565
05000     0.3946      0.8700     0.9029     55.1042
05100     0.3315      0.8900     0.9029     57.1266
05200     0.3979      0.8700     0.9029     58.4207
05300     0.4862      0.8400     0.9029     55.2263
05400     0.5584      0.8400     0.9029     54.9282
05500     0.5011      0.8500     0.9029     57.0448
05600     0.3540      0.9000     0.9029     58.2520
05700     0.3193      0.8900     0.9029     59.2628
05800     0.4525      0.8300     0.9029     58.0504
05900     0.4381      0.8500     0.9029     56.8869
06000     0.3407      0.9000     0.9029     57.3123
06100     0.3366      0.9200     0.9029     57.1028
06200     0.4795      0.8100     0.9029     57.1814
06300     0.4367      0.8700     0.9029     59.7547
06400     0.3206      0.9300     0.9029     55.2240
06500     0.2667      0.9100     0.9029     54.5684
06600     0.4145      0.8800     0.9029     58.0364
06700     0.2907      0.9000     0.9029     57.4188
06800     0.3062      0.8800     0.9029     56.8478
06900     0.4728      0.8400     0.9029     64.0739
07000     0.2206      0.9200     0.9029     62.0834
07100     0.3913      0.8700     0.9029     56.1761
07200     0.2725      0.9200     0.9029     56.2664
07300     0.3888      0.8600     0.9029     59.2259
07400     0.3023      0.8900     0.9029     59.1189
07500     0.3744      0.8900     0.9029     57.9172
07600     0.4581      0.8400     0.9029     61.1472
07700     0.4210      0.8600     0.9029     58.1810
07800     0.4731      0.8600     0.9029     55.8280
07900     0.4604      0.8200     0.9029     55.4192
08000     0.3449      0.8700     0.9029     54.8873
08100     0.3560      0.9000     0.9029     60.2455
08200     0.4469      0.8800     0.9029     55.4205
08300     0.3563      0.8800     0.9029     57.1430
08400     0.4615      0.8400     0.9029     56.2749
08500     0.3644      0.8700     0.9029     56.7601
08600     0.4819      0.8600     0.9029     56.3713
08700     0.3383      0.8700     0.9029     56.4560
08800     0.4916      0.8300     0.9029     56.9481
08900     0.2764      0.8900     0.9029     57.3801
09000     0.2644      0.9000     0.9029     57.0800
09100     0.4898      0.8600     0.9029     57.8201
09200     0.3523      0.8800     0.9029     58.3773
09300     0.3319      0.9100     0.9029     56.8319
09400     0.3369      0.8800     0.9029     53.0629
09500     0.4022      0.8600     0.9029     57.5923
09600     0.5088      0.8400     0.9029     57.2458
09700     0.2917      0.8600     0.9029     55.5703
09800     0.4389      0.8400     0.9029     54.1309
09900     0.2578      0.9300     0.9029     52.9193
Start testing:
Test Accuracy: 0.8920
