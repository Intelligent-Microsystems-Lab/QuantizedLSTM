Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=294, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=8627169, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
30901f31-d64f-4dd9-8dcb-6e8024f41dfa
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 147, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 374, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 213, in forward
    gates = quant_pass(pact_a_bmm( quant_pass(pact_a_bmm(part1, self.a12), self.abMVM, self.a12) + quant_pass(pact_a_bmm(part2, self.a13), self.abMVM, self.a13), self.a14), self.abNM, self.a14)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 87, in forward
    x01 = torch.clamp(x_scaled,-1+(1./step_d),1-(1./step_d))
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 11.78 GiB total capacity; 10.48 GiB already allocated; 21.38 MiB free; 10.60 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=294, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=1, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=8627169, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
debb6bdc-be5c-4957-b401-83e1ea7cd448
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     3.4459      0.1100     0.1022     17.3884
00100     1.8628      0.4800     0.4851     69.4563
00200     1.3237      0.6200     0.6035     68.7003
00300     1.1168      0.6500     0.6574     69.4657
00400     0.9804      0.6800     0.6985     68.3339
00500     1.1107      0.6300     0.7226     72.0669
00600     0.8438      0.7300     0.7490     68.8551
00700     1.0041      0.6700     0.7604     69.0956
00800     0.7847      0.7500     0.7604     71.8445
00900     0.9194      0.6900     0.7777     69.2155
01000     0.9882      0.6900     0.7873     69.4751
01100     0.9181      0.7200     0.7892     70.2608
01200     0.7877      0.7500     0.7908     69.5845
01300     0.9788      0.7000     0.8098     68.3556
01400     0.7768      0.7600     0.8098     65.3819
01500     0.5736      0.8200     0.8153     63.8803
01600     0.8027      0.7600     0.8153     63.7228
01700     0.7226      0.7500     0.8175     64.5696
01800     0.7494      0.7600     0.8175     63.5665
01900     0.7007      0.7600     0.8175     64.5427
02000     0.6220      0.7700     0.8232     64.3891
02100     0.5808      0.8300     0.8232     63.6359
02200     0.8318      0.7400     0.8261     64.7517
02300     0.5506      0.8500     0.8261     64.2584
02400     0.7129      0.7900     0.8262     65.1267
02500     0.6716      0.8100     0.8262     63.7720
02600     0.5843      0.8100     0.8271     65.5125
02700     0.5754      0.7900     0.8357     64.7655
02800     0.4831      0.8300     0.8357     65.7650
02900     0.6775      0.8300     0.8357     63.6011
03000     0.7416      0.7400     0.8428     64.6913
03100     0.6384      0.8600     0.8429     64.2206
03200     0.5930      0.8000     0.8429     63.3712
03300     0.6269      0.8000     0.8429     64.2820
03400     0.6128      0.7900     0.8429     63.9906
03500     0.6441      0.7900     0.8429     63.7347
03600     0.6339      0.7700     0.8429     63.8364
03700     0.5590      0.8200     0.8429     64.4803
03800     0.5096      0.8200     0.8429     64.8793
03900     0.5642      0.8500     0.8487     64.8275
04000     0.8638      0.6900     0.8487     67.7218
04100     0.7329      0.7500     0.8487     75.8153
04200     0.5338      0.8300     0.8487     72.5227
04300     0.4502      0.8500     0.8529     72.5849
04400     0.5220      0.8000     0.8529     70.4994
04500     0.4544      0.8400     0.8529     71.5097
04600     0.5003      0.8300     0.8529     74.3099
04700     0.7217      0.8000     0.8529     73.7461
04800     0.6279      0.8000     0.8624     71.8916
04900     0.5284      0.8100     0.8624     71.9173
05000     0.4501      0.8800     0.8624     75.9509
05100     0.5516      0.7900     0.8624     70.3385
05200     0.5578      0.8000     0.8624     71.6503
05300     0.7400      0.7500     0.8624     71.8089
05400     0.4703      0.8500     0.8624     72.4722
05500     0.4596      0.8500     0.8624     67.8813
05600     0.5649      0.8300     0.8624     68.0957
05700     0.7244      0.7800     0.8624     68.0921
05800     0.5234      0.8000     0.8624     70.7437
05900     0.6026      0.8200     0.8624     73.0415
06000     0.6927      0.7700     0.8624     69.8309
06100     0.6773      0.8100     0.8624     72.6505
06200     0.4213      0.8400     0.8624     72.7164
06300     0.5267      0.8200     0.8624     73.6787
06400     0.3685      0.9000     0.8624     70.4483
06500     0.5801      0.8200     0.8624     71.8912
06600     0.4770      0.8600     0.8624     69.9325
06700     0.4419      0.8200     0.8637     70.6009
06800     0.4741      0.8500     0.8645     71.7167
06900     0.3664      0.9000     0.8645     68.9887
07000     0.5449      0.8100     0.8698     75.3227
07100     0.4115      0.8600     0.8698     72.7019
07200     0.4898      0.8200     0.8698     68.8102
07300     0.6218      0.7700     0.8698     69.5909
07400     0.5772      0.8200     0.8741     70.3379
07500     0.5767      0.8300     0.8741     69.0790
07600     0.4665      0.8200     0.8741     71.7865
07700     0.5222      0.8700     0.8743     74.5950
07800     0.3728      0.8700     0.8743     73.2439
07900     0.3482      0.9100     0.8753     71.0573
08000     0.4627      0.9000     0.8753     70.9902
08100     0.3070      0.9100     0.8784     73.4432
08200     0.5257      0.8400     0.8784     71.3033
08300     0.4334      0.8800     0.8784     72.7828
08400     0.4489      0.8300     0.8784     72.6993
08500     0.6840      0.7900     0.8784     68.5896
08600     0.5285      0.8300     0.8784     73.8521
08700     0.5239      0.7700     0.8831     70.3691
08800     0.5382      0.8400     0.8831     77.4357
08900     0.5925      0.8000     0.8831     75.7815
09000     0.4270      0.8500     0.8831     74.7938
09100     0.5182      0.7900     0.8831     68.0092
09200     0.5757      0.7900     0.8831     69.3839
09300     0.3970      0.8500     0.8831     66.6473
09400     0.4776      0.8400     0.8831     70.1214
09500     0.5487      0.8000     0.8831     70.7801
09600     0.4851      0.8500     0.8831     67.2437
09700     0.4414      0.8700     0.8831     69.6011
09800     0.4924      0.8200     0.8831     68.2941
09900     0.4723      0.8000     0.8831     71.5415
10000     0.4548      0.8600     0.8831     69.0413
10100     0.3968      0.8800     0.8831     71.0132
10200     0.3705      0.8800     0.8831     70.7140
10300     0.4055      0.8900     0.8885     70.0569
10400     0.4699      0.8800     0.8885     69.4784
10500     0.4251      0.8600     0.8885     72.2123
10600     0.5425      0.8300     0.8885     69.8371
10700     0.4922      0.8300     0.8885     68.6252
10800     0.4563      0.8500     0.8885     71.9462
10900     0.3847      0.8900     0.8885     68.3063
11000     0.4735      0.8500     0.8885     72.2162
11100     0.3260      0.8500     0.8885     68.8965
11200     0.3204      0.8500     0.8885     68.3922
11300     0.3039      0.9300     0.8889     68.0649
11400     0.3768      0.8900     0.8889     71.2964
11500     0.3390      0.9000     0.8889     74.6502
11600     0.3599      0.9000     0.8889     74.6771
11700     0.2728      0.9100     0.8889     71.6291
11800     0.2855      0.9100     0.8889     75.1561
11900     0.4375      0.8700     0.8889     70.3978
12000     0.3946      0.8900     0.8941     70.8292
12100     0.3608      0.8900     0.8941     71.9646
12200     0.3589      0.8900     0.8941     70.2975
12300     0.3890      0.8800     0.8941     67.9864
12400     0.3332      0.9200     0.8941     67.2241
12500     0.6397      0.7700     0.8941     71.2051
12600     0.4224      0.8500     0.8941     69.4597
12700     0.4375      0.8900     0.8941     71.6610
12800     0.3458      0.8800     0.8941     68.1685
12900     0.4383      0.8700     0.8941     68.8504
13000     0.3814      0.8800     0.8941     68.7447
13100     0.3981      0.8800     0.8941     71.0476
13200     0.4220      0.8800     0.8941     69.9124
13300     0.4548      0.8600     0.8941     67.7335
13400     0.3691      0.9000     0.8941     67.9237
13500     0.3349      0.9000     0.8941     70.9960
13600     0.4013      0.8800     0.8941     68.8862
13700     0.6115      0.8100     0.8941     72.2529
13800     0.3829      0.8700     0.8941     75.8416
13900     0.3661      0.8700     0.8941     68.4591
14000     0.4416      0.8700     0.8941     75.7401
14100     0.4732      0.8200     0.8941     70.3331
14200     0.4415      0.8400     0.8941     68.6204
14300     0.3558      0.9000     0.8941     67.9275
14400     0.3096      0.8700     0.8941     70.7384
14500     0.3280      0.9000     0.8941     67.9580
14600     0.3067      0.9000     0.8941     72.7692
14700     0.3947      0.9000     0.8941     70.2278
14800     0.4013      0.8200     0.8941     71.3073
14900     0.3085      0.9200     0.8941     70.4823
15000     0.2871      0.9300     0.8941     74.4718
15100     0.3445      0.9000     0.8941     69.1061
15200     0.3342      0.8600     0.8941     69.5383
15300     0.3780      0.8500     0.8941     69.0273
15400     0.3055      0.9000     0.8941     70.7510
15500     0.4502      0.8700     0.8941     68.1989
15600     0.3409      0.8500     0.8941     69.1651
15700     0.4526      0.8800     0.8941     72.7265
15800     0.2991      0.9000     0.8941     70.9610
15900     0.2882      0.9000     0.8941     72.8597
16000     0.2575      0.9100     0.8941     67.8605
16100     0.3134      0.8900     0.8941     68.4509
16200     0.3116      0.9000     0.8941     66.6790
16300     0.4342      0.8800     0.8941     66.9396
16400     0.2446      0.9400     0.8941     69.6823
16500     0.3408      0.8800     0.8941     70.6644
16600     0.4638      0.8900     0.8941     67.0895
16700     0.4080      0.8800     0.8941     67.2147
16800     0.3351      0.8900     0.8941     69.0438
16900     0.4461      0.8600     0.8941     75.4104
17000     0.2979      0.9100     0.8941     72.1766
17100     0.2867      0.9300     0.8941     70.3667
17200     0.3047      0.9400     0.8941     69.6430
17300     0.2830      0.9200     0.8941     72.2939
17400     0.3480      0.8700     0.8941     72.9217
17500     0.5245      0.8800     0.8941     68.7219
17600     0.2975      0.9100     0.8941     69.4218
17700     0.2580      0.9400     0.8941     68.0367
17800     0.2853      0.9000     0.8941     70.5213
17900     0.4407      0.8700     0.8941     68.2071
18000     0.4188      0.8700     0.8941     75.6842
18100     0.4861      0.8100     0.8941     77.1908
18200     0.4108      0.8500     0.8941     77.4470
18300     0.3449      0.9000     0.8941     75.7237
18400     0.2792      0.8900     0.8941     75.4128
18500     0.3756      0.8700     0.8941     72.8070
18600     0.3981      0.8900     0.8941     70.8056
18700     0.2869      0.9200     0.8941     67.7563
18800     0.3672      0.8900     0.8941     68.2624
18900     0.3230      0.8700     0.8948     68.1805
19000     0.3706      0.8800     0.8948     68.1987
19100     0.4189      0.8800     0.8948     68.9381
19200     0.3868      0.8900     0.8948     65.2166
19300     0.2813      0.9200     0.8948     66.2876
19400     0.3032      0.8700     0.8993     67.5519
19500     0.2258      0.9400     0.8993     67.1451
19600     0.3101      0.8500     0.8993     66.4180
19700     0.3104      0.8900     0.8993     67.5609
19800     0.3428      0.8500     0.8993     66.0412
19900     0.1720      0.9400     0.8993     67.9245
20000     0.3175      0.9200     0.8993     74.8125
20100     0.3135      0.9000     0.8993     69.2942
20199     0.2024      0.9500     0.8993     67.2508
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     0.5653      0.8400     0.8190     18.0836
00100     0.4571      0.8400     0.8956     69.4519
00200     0.2268      0.9600     0.9028     69.3073
00300     0.4314      0.9000     0.9028     67.6724
00400     0.3172      0.9000     0.9028     68.2117
00500     0.1933      0.9500     0.9028     68.3913
00600     0.2212      0.9400     0.9028     71.7986
00700     0.4745      0.8600     0.9028     71.1010
00800     0.4438      0.8600     0.9028     69.5664
00900     0.2290      0.9100     0.9028     71.4101
01000     0.4012      0.8800     0.9028     69.0452
01100     0.2471      0.9100     0.9028     68.2945
01200     0.2866      0.9100     0.9028     69.6540
01300     0.4087      0.8700     0.9032     76.1975
01400     0.3397      0.9000     0.9032     66.0261
01500     0.3567      0.8900     0.9032     70.6496
01600     0.3109      0.8800     0.9034     72.8531
01700     0.2346      0.9000     0.9057     74.6332
01800     0.3474      0.8500     0.9057     71.4563
01900     0.2042      0.9200     0.9057     73.1110
02000     0.3506      0.8800     0.9057     72.4290
02100     0.3477      0.9100     0.9057     71.5047
02200     0.3588      0.8900     0.9057     69.5337
02300     0.3695      0.8900     0.9057     71.6752
02400     0.4919      0.8600     0.9057     68.4845
02500     0.3566      0.9100     0.9064     70.0268
02600     0.1958      0.9400     0.9064     69.0772
02700     0.4077      0.8700     0.9064     69.6815
02800     0.3566      0.9100     0.9064     71.6754
02900     0.4189      0.8600     0.9064     72.8848
03000     0.3976      0.8900     0.9064     71.9732
03100     0.3176      0.8800     0.9068     70.3926
03200     0.2868      0.9000     0.9068     72.4407
03300     0.2148      0.9200     0.9068     73.7761
03400     0.2901      0.9200     0.9068     68.3014
03500     0.2221      0.9300     0.9068     71.5317
03600     0.3096      0.9200     0.9068     71.7343
03700     0.4023      0.8900     0.9068     73.5894
03800     0.2097      0.9400     0.9068     77.4025
03900     0.3832      0.8600     0.9068     73.9656
04000     0.2922      0.9000     0.9068     73.0945
04100     0.4125      0.8800     0.9068     71.2595
04200     0.3517      0.8900     0.9068     71.7566
04300     0.3465      0.8900     0.9068     71.7948
04400     0.3556      0.9000     0.9068     73.5127
04500     0.3418      0.9000     0.9077     76.9387
04600     0.3571      0.8900     0.9077     71.6589
04700     0.4147      0.8600     0.9077     71.7194
04800     0.3108      0.9100     0.9077     71.9690
04900     0.3394      0.9100     0.9077     73.1954
05000     0.1622      0.9500     0.9077     71.8776
05100     0.2132      0.9500     0.9077     73.6152
05200     0.3823      0.9000     0.9077     73.6324
05300     0.2744      0.9200     0.9077     74.1832
05400     0.3106      0.9100     0.9077     76.2427
05500     0.3123      0.9200     0.9077     73.8077
05600     0.3225      0.9300     0.9077     73.5374
05700     0.3840      0.8300     0.9077     72.9047
05800     0.2327      0.9300     0.9077     74.2666
05900     0.3818      0.8900     0.9077     74.1355
06000     0.4504      0.8300     0.9077     72.8022
06100     0.2262      0.9400     0.9077     72.7241
06200     0.2543      0.9300     0.9077     72.7197
06300     0.3848      0.9000     0.9077     72.5454
06400     0.3353      0.8600     0.9077     72.1939
06500     0.4123      0.8900     0.9084     73.4647
06600     0.2541      0.9200     0.9084     73.7467
06700     0.3560      0.8700     0.9084     72.9830
06800     0.1978      0.9300     0.9084     73.4826
06900     0.3885      0.8800     0.9084     73.2974
07000     0.1450      0.9500     0.9084     73.7272
07100     0.3446      0.8900     0.9084     73.4835
07200     0.3057      0.9200     0.9084     72.0504
07300     0.2668      0.9000     0.9084     72.8132
07400     0.3115      0.8900     0.9084     73.2301
07500     0.4439      0.8900     0.9084     73.7101
07600     0.3342      0.9000     0.9084     73.5531
07700     0.4391      0.8600     0.9084     72.6323
07800     0.4067      0.8700     0.9084     72.5479
07900     0.1931      0.9400     0.9084     73.6565
08000     0.2858      0.9100     0.9084     74.2276
08100     0.2509      0.9000     0.9084     72.9719
08200     0.2631      0.9300     0.9084     72.7894
08300     0.2663      0.9200     0.9084     73.2278
08400     0.3761      0.9000     0.9084     73.8371
08500     0.3945      0.9100     0.9084     75.0343
08600     0.2363      0.9300     0.9085     73.2560
08700     0.3680      0.8900     0.9085     73.6952
08800     0.2080      0.9300     0.9085     73.3402
08900     0.2356      0.9200     0.9085     73.4842
09000     0.2398      0.9100     0.9085     73.7333
09100     0.2802      0.9100     0.9085     74.6461
09200     0.3287      0.9300     0.9085     73.4048
09300     0.4349      0.8800     0.9085     73.5900
09400     0.3347      0.8900     0.9085     73.9995
09500     0.3331      0.8600     0.9085     73.5611
09600     0.2463      0.9000     0.9085     72.8211
09700     0.2954      0.9100     0.9085     72.5939
09800     0.4241      0.8800     0.9085     73.4024
09900     0.2245      0.9400     0.9085     73.3937
Start testing:
Test Accuracy: 0.9036
