Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=294, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=193012823, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
7b885a34-ec88-41b1-ab8c-7ec85c39cb5d
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 167, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 290, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 213, in forward
    gates = quant_pass(pact_a_bmm( quant_pass(pact_a_bmm(part1, self.a12), self.abMVM, self.a12) + quant_pass(pact_a_bmm(part2, self.a13), self.abMVM, self.a13), self.a14), self.abNM, self.a14)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 87, in forward
    x01 = torch.clamp(x_scaled,-1+(1./step_d),1-(1./step_d))
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 22.17 GiB total capacity; 20.85 GiB already allocated; 4.50 MiB free; 21.19 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=294, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=1.0, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=6, quant_inp=6, quant_w=6, random_seed=193012823, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
d5451379-b88c-4eef-8ca6-c86f33a8078f
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     2.7213      0.0500     0.0833     16.8632
00100     1.5342      0.4900     0.1004     59.5819
00200     1.1887      0.6100     0.1051     59.2729
00300     0.9059      0.6900     0.1051     60.8736
00400     0.9195      0.6900     0.1051     61.9699
00500     0.6734      0.7700     0.1051     61.3367
00600     0.6446      0.8400     0.1054     61.5996
00700     0.6583      0.7800     0.1129     59.3523
00800     0.7131      0.7600     0.1129     58.8984
00900     0.6296      0.8200     0.1129     58.1812
01000     0.5131      0.8400     0.1129     59.5174
01100     0.5637      0.8100     0.1203     58.6101
01200     0.4280      0.8700     0.1271     59.1965
01300     0.6368      0.8100     0.1271     58.9475
01400     0.3796      0.8800     0.1271     61.3948
01500     0.6264      0.8100     0.1271     58.9414
01600     0.4295      0.8800     0.1271     58.8148
01700     0.5510      0.7900     0.1281     59.7799
01800     0.4489      0.8700     0.1281     58.4949
01900     0.3722      0.8900     0.1281     58.4317
02000     0.4679      0.8300     0.1352     60.3319
02100     0.4993      0.8800     0.1352     59.9046
02200     0.4978      0.8300     0.1352     60.1174
02300     0.5066      0.8600     0.1522     62.8196
02400     0.5683      0.8500     0.1522     62.6194
02500     0.3910      0.8600     0.1522     59.1010
02600     0.5655      0.8300     0.1522     58.8632
02700     0.5871      0.7900     0.1522     58.8297
02800     0.4670      0.8900     0.1522     62.7157
02900     0.3972      0.9000     0.1522     60.3821
03000     0.4767      0.8500     0.1522     62.9749
03100     0.3942      0.8800     0.1522     58.2572
03200     0.6691      0.8000     0.1522     61.7781
03300     0.2280      0.9600     0.1578     59.1748
03400     0.5001      0.8100     0.1588     59.9826
03500     0.2535      0.9300     0.1615     58.5317
03600     0.2867      0.8900     0.1710     58.7796
03700     0.3858      0.9000     0.1710     58.8292
03800     0.4515      0.8400     0.1744     63.4258
03900     0.3013      0.9100     0.1768     58.3862
04000     0.4592      0.8400     0.1768     58.4729
04100     0.3792      0.8700     0.1768     59.9480
04200     0.3370      0.9300     0.1768     58.9716
04300     0.3165      0.9100     0.1768     58.5958
04400     0.2268      0.9500     0.1768     62.2915
04500     0.5253      0.8300     0.1774     60.7001
04600     0.4949      0.8500     0.1806     59.8193
04700     0.3226      0.8600     0.1806     60.3964
04800     0.3601      0.9100     0.1832     63.5537
04900     0.3768      0.9000     0.1832     60.1215
05000     0.3555      0.8900     0.1866     59.2335
05100     0.3624      0.9200     0.1938     61.9039
05200     0.4035      0.8900     0.1938     62.8869
05300     0.3847      0.8900     0.1938     59.1374
05400     0.4100      0.9000     0.1938     60.3083
05500     0.2672      0.9100     0.1938     60.6590
05600     0.3516      0.8800     0.2008     63.3141
05700     0.2732      0.9200     0.2022     59.2352
05800     0.3026      0.9100     0.2120     63.4331
05900     0.4703      0.8800     0.2260     60.8998
06000     0.2267      0.9400     0.2267     60.1023
06100     0.2461      0.9200     0.2267     61.8532
06200     0.3138      0.9300     0.2267     62.5484
06300     0.3709      0.8800     0.2267     59.5448
06400     0.3870      0.8800     0.2486     60.8757
06500     0.2088      0.9500     0.2486     61.7869
06600     0.4098      0.8900     0.2486     61.7281
06700     0.1915      0.9700     0.2486     61.0917
06800     0.2481      0.9300     0.2486     58.7710
06900     0.2729      0.9200     0.2692     64.0734
07000     0.4257      0.8300     0.2692     59.0045
07100     0.2513      0.9100     0.2692     63.3393
07200     0.3332      0.8800     0.2743     60.0931
07300     0.3454      0.8900     0.2743     59.1954
07400     0.4239      0.8600     0.2743     59.5315
07500     0.1978      0.9500     0.2743     60.2079
07600     0.3504      0.8600     0.2815     63.0232
07700     0.2938      0.9300     0.2815     61.6513
07800     0.2194      0.9100     0.2967     62.9454
07900     0.2261      0.9300     0.2967     62.5474
08000     0.2468      0.9600     0.2967     58.5835
08100     0.2711      0.9200     0.2967     62.6370
08200     0.3514      0.8900     0.3213     61.4882
08300     0.2137      0.9300     0.3221     61.7332
08400     0.2437      0.9500     0.3228     64.9354
08500     0.2504      0.8900     0.3429     61.8635
08600     0.2224      0.9200     0.3429     59.4808
08700     0.3687      0.8800     0.3802     62.5359
08800     0.1558      0.9600     0.3802     58.5811
08900     0.2041      0.9600     0.3802     60.6477
09000     0.2609      0.9600     0.3802     63.1197
09100     0.1825      0.9600     0.3802     60.7242
09200     0.3387      0.8900     0.3802     61.4784
09300     0.3304      0.9100     0.3802     59.7104
09400     0.2145      0.9300     0.3802     58.6765
09500     0.1600      0.9600     0.3802     60.4337
09600     0.1399      0.9800     0.3802     58.7119
09700     0.4244      0.8700     0.4060     61.0312
09800     0.2534      0.9300     0.4060     62.6089
09900     0.3910      0.9100     0.4060     59.5513
10000     0.2620      0.9300     0.4060     61.8639
10100     0.1988      0.9700     0.4060     59.6286
10200     0.2649      0.9200     0.4076     58.5601
10300     0.1562      0.9800     0.4076     61.0324
10400     0.2512      0.9000     0.4076     62.1329
10500     0.2226      0.9400     0.4076     60.7070
10600     0.3364      0.9100     0.4076     58.3509
10700     0.2703      0.9400     0.4076     60.5468
10800     0.1670      0.9500     0.4076     60.2743
10900     0.1524      0.9600     0.4076     62.9531
11000     0.2160      0.9500     0.4076     60.2161
11100     0.1094      0.9700     0.4076     61.7522
11200     0.2194      0.9400     0.4076     59.7779
11300     0.2322      0.9400     0.4076     59.5930
11400     0.1261      0.9700     0.4076     63.3754
11500     0.3298      0.9200     0.4076     59.5254
11600     0.1281      0.9800     0.4076     58.7812
11700     0.2459      0.9400     0.4076     58.4480
11800     0.2102      0.9500     0.4076     58.7671
11900     0.2051      0.9300     0.4076     66.0747
12000     0.2920      0.9100     0.4076     59.4081
12100     0.1832      0.9400     0.4076     62.2221
12200     0.2012      0.9700     0.4076     60.4022
12300     0.2460      0.9200     0.4076     61.8705
12400     0.3333      0.9100     0.4076     60.9316
12500     0.0924      0.9900     0.4076     62.7097
12600     0.2109      0.9400     0.4076     61.2697
12700     0.1831      0.9500     0.4076     60.5979
12800     0.1727      0.9600     0.4076     61.6555
12900     0.3048      0.9100     0.4076     59.1637
13000     0.3095      0.9300     0.4076     59.3594
13100     0.2598      0.9400     0.4076     58.8521
13200     0.2346      0.9400     0.4076     65.0566
13300     0.1308      0.9700     0.4076     58.7547
13400     0.1370      0.9600     0.4076     58.9333
13500     0.1552      0.9500     0.4076     60.6536
13600     0.1952      0.9500     0.4076     62.4868
13700     0.1595      0.9700     0.4076     58.4997
13800     0.1751      0.9600     0.4076     58.2384
13900     0.1043      0.9800     0.4076     59.2832
14000     0.1248      0.9600     0.4076     63.8638
14100     0.1425      0.9600     0.4076     60.0036
14200     0.2527      0.9400     0.4076     58.6759
14300     0.2441      0.9400     0.4076     59.7836
14400     0.1338      0.9800     0.4076     61.0078
14500     0.1544      0.9600     0.4076     60.3118
14600     0.2481      0.9300     0.4076     63.6740
14700     0.2287      0.9600     0.4076     62.4071
14800     0.1478      0.9600     0.4076     62.9636
14900     0.2003      0.9500     0.4076     63.0611
15000     0.1067      0.9800     0.4076     61.5547
15100     0.0913      0.9800     0.4076     61.2740
15200     0.2147      0.9500     0.4076     58.2489
15300     0.1289      0.9700     0.4076     63.6294
15400     0.0724      0.9900     0.4076     59.3834
15500     0.1724      0.9500     0.4076     61.0415
15600     0.1579      0.9600     0.4076     58.9758
15700     0.1711      0.9600     0.4076     59.8509
15800     0.1727      0.9400     0.4076     58.3447
15900     0.1905      0.9600     0.4076     66.1999
16000     0.1345      0.9700     0.4076     59.1959
16100     0.2316      0.9400     0.4076     60.2034
16200     0.1699      0.9600     0.4076     65.7993
16300     0.1962      0.9500     0.4076     59.1387
16400     0.2885      0.9200     0.4076     59.4030
16500     0.1548      0.9600     0.4076     59.6737
16600     0.1335      0.9600     0.4076     60.9981
16700     0.1514      0.9800     0.4076     60.6191
16800     0.2176      0.9300     0.4076     59.5373
16900     0.1605      0.9700     0.4076     60.7863
17000     0.1080      0.9800     0.4076     63.2028
17100     0.1710      0.9500     0.4076     62.5060
17200     0.2006      0.9200     0.4076     61.8503
17300     0.2207      0.9400     0.4076     63.6086
17400     0.1574      0.9700     0.4076     62.6175
17500     0.3090      0.9100     0.4076     60.4608
17600     0.1509      0.9700     0.4076     62.0007
17700     0.2168      0.9400     0.4076     60.9458
17800     0.1708      0.9800     0.4076     59.6545
17900     0.1622      0.9700     0.4076     61.3286
18000     0.1015      0.9700     0.4076     59.9565
18100     0.1642      0.9500     0.4076     58.2433
18200     0.1403      0.9500     0.4076     61.1232
18300     0.1384      0.9800     0.4076     61.7370
18400     0.1976      0.9500     0.4076     59.0700
18500     0.0793      0.9800     0.4076     58.7880
18600     0.1747      0.9700     0.4076     58.5157
18700     0.1052      0.9800     0.4076     62.1792
18800     0.2320      0.9300     0.4076     60.4342
18900     0.1561      0.9500     0.4102     59.7824
19000     0.1668      0.9700     0.4102     64.4763
19100     0.2136      0.9400     0.4102     62.3875
19200     0.1375      0.9500     0.4102     59.0505
19300     0.0801      0.9800     0.4102     58.6486
19400     0.1222      0.9500     0.4102     59.2561
19500     0.1064      0.9700     0.4102     59.4535
19600     0.1595      0.9700     0.4102     58.4185
19700     0.2234      0.9100     0.4102     58.7782
19800     0.1877      0.9400     0.4102     59.6603
19900     0.2392      0.9500     0.4102     66.1213
20000     0.1346      0.9600     0.4102     63.1040
20100     0.2003      0.9600     0.4102     61.9139
20199     0.2171      0.9400     0.4102     64.3283
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     3.0853      0.4700     0.3639     18.7320
00100     1.2085      0.7000     0.6078     62.7291
00200     1.0542      0.7100     0.6801     63.7070
00300     0.9618      0.7200     0.7420     60.5414
00400     0.9757      0.7600     0.7463     61.7684
00500     0.7505      0.7700     0.7578     60.3647
00600     0.6261      0.8100     0.7594     60.6964
00700     1.2381      0.7200     0.7717     59.8515
00800     0.6307      0.8100     0.7836     59.0014
00900     0.8170      0.7900     0.7836     60.0213
01000     0.9469      0.7500     0.7842     59.0251
01100     0.6898      0.8000     0.7842     63.4202
01200     0.7171      0.8300     0.7978     64.4669
01300     0.9678      0.7300     0.7978     59.2766
01400     0.4532      0.8700     0.8038     62.1360
01500     0.6508      0.8700     0.8038     59.6129
01600     0.7456      0.7600     0.8053     59.4935
01700     0.6251      0.8200     0.8122     60.7089
01800     0.8626      0.7400     0.8122     63.0097
01900     0.7972      0.8000     0.8122     59.3022
02000     0.8763      0.7400     0.8122     58.6193
02100     0.7736      0.7800     0.8122     63.3036
02200     0.3746      0.8700     0.8122     60.1622
02300     0.6416      0.8100     0.8122     59.2757
02400     0.7478      0.8300     0.8159     59.3412
02500     0.5382      0.8400     0.8160     62.0641
02600     0.8064      0.7800     0.8160     60.3507
02700     0.5174      0.8400     0.8160     59.4024
02800     0.7965      0.7900     0.8160     59.8975
02900     0.7672      0.7900     0.8160     59.2273
03000     0.7220      0.7600     0.8253     60.6708
03100     0.8061      0.7900     0.8253     59.5930
03200     0.6604      0.8500     0.8253     58.2390
03300     0.7145      0.8000     0.8253     58.9710
03400     0.4989      0.8300     0.8253     58.9599
03500     0.7732      0.8000     0.8253     59.2415
03600     0.4905      0.8000     0.8253     60.8152
03700     0.7269      0.7900     0.8253     62.4399
03800     0.6440      0.8500     0.8273     59.1562
03900     0.5587      0.8400     0.8294     59.0817
04000     0.5364      0.8400     0.8327     64.4550
04100     0.3567      0.9100     0.8327     61.1560
04200     0.4464      0.8300     0.8327     63.1971
04300     1.0390      0.7400     0.8327     58.4887
04400     0.7944      0.8000     0.8360     58.6217
04500     0.3688      0.8800     0.8360     58.5189
04600     0.6932      0.8100     0.8360     58.3582
04700     0.5149      0.8400     0.8360     63.3968
04800     0.4070      0.9000     0.8395     58.7903
04900     0.4729      0.8800     0.8395     59.2680
05000     0.7064      0.8100     0.8395     61.8481
05100     0.4639      0.8800     0.8395     62.9166
05200     0.4025      0.9100     0.8395     58.4123
05300     0.5789      0.8500     0.8395     59.6872
05400     0.4019      0.8900     0.8395     58.2951
05500     0.6025      0.8300     0.8395     60.2888
05600     0.6082      0.8300     0.8395     59.7254
05700     0.6476      0.8600     0.8395     60.9900
05800     0.7937      0.7900     0.8398     58.7157
05900     0.5781      0.8200     0.8398     58.4101
06000     0.7169      0.8200     0.8398     59.9954
06100     0.6875      0.8400     0.8426     59.8423
06200     0.5232      0.8600     0.8426     59.7690
06300     0.5673      0.8400     0.8487     60.8894
06400     0.5994      0.8300     0.8487     58.1826
06500     0.4336      0.8600     0.8487     63.1073
06600     0.6141      0.8300     0.8487     59.8142
06700     0.6660      0.8000     0.8487     58.7342
06800     0.4868      0.8900     0.8487     62.0704
06900     0.6391      0.8900     0.8487     59.6651
07000     0.4517      0.8500     0.8487     63.8406
07100     0.6975      0.8200     0.8487     61.8136
07200     0.5940      0.8200     0.8487     59.1085
07300     0.4199      0.8600     0.8525     63.0458
07400     0.6098      0.8300     0.8525     61.4039
07500     0.5883      0.8500     0.8525     64.3210
07600     0.3375      0.9200     0.8525     60.2250
07700     0.5145      0.8700     0.8525     60.2949
07800     0.6840      0.8200     0.8525     63.8026
07900     0.4929      0.8300     0.8525     60.5094
08000     0.5828      0.8500     0.8525     60.5459
08100     0.6526      0.8300     0.8525     59.2674
08200     0.5002      0.8400     0.8525     58.5637
08300     0.4260      0.8800     0.8525     58.9796
08400     0.3668      0.8700     0.8525     59.5570
08500     0.7011      0.7900     0.8525     58.9786
08600     0.5152      0.8600     0.8525     61.8072
08700     0.4961      0.8500     0.8525     67.3523
08800     0.9025      0.7900     0.8525     62.1088
08900     0.5468      0.8500     0.8525     60.9086
09000     0.4305      0.8800     0.8525     59.4350
09100     0.6528      0.8200     0.8525     63.0707
09200     0.6068      0.8500     0.8525     61.5931
09300     0.4023      0.9100     0.8525     61.5169
09400     0.4810      0.8600     0.8525     58.6002
09500     0.4746      0.8700     0.8525     60.5199
09600     0.3978      0.9200     0.8525     61.0357
09700     0.6632      0.8100     0.8525     62.1333
09800     0.3919      0.9000     0.8525     64.7728
09900     0.2481      0.9200     0.8525     59.0350
Start testing:
Test Accuracy: 0.8918
