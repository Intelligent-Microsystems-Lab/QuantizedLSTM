Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Traceback (most recent call last):
  File "KWS_LSTM.py", line 80, in <module>
    test_dataloader = torch.utils.data.DataLoader(speech_dataset_test, batch_size=args.batch_size, shuffle=True, num_workers=args.dataloader_num_workers)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 224, in __init__
    sampler = RandomSampler(dataset, generator=generator)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/utils/data/sampler.py", line 96, in __init__
    "value, but got num_samples={}".format(self.num_samples))
ValueError: num_samples should be a positive integer value, but got num_samples=0
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Traceback (most recent call last):
  File "KWS_LSTM.py", line 83, in <module>
    model = KWS_LSTM(input_dim = args.n_mfcc, hidden_dim = args.hidden, output_dim = len(args.word_list), batch_size = args.batch_size, device = device, quant_factor = 1, quant_beta = 1, wb = args.quant_w, abMVM = args.quant_actMVM, abNM = args.quant_actNM, ib = args.quant_inp, noise_level = args.noise_injectionT, blocks = 1, pool_method = 'Max', fc_blocks = 0, cy_div = 1, cy_scale = 1, train_a = args.train_a).to(device)
  File "/afs/crc.nd.edu/user/c/cschaef6/Qiuwen/QuantizedLSTM/model.py", line 241, in __init__
    self.lstmBlocks = LSTMLayer(LSTMCellQ, self.input_dim, self.hidden_dim, self.wb, self.ib, self.abMVM, self.abNM, self.noise_level, self.device, cy_div, cy_scale, train_a = train_a)
TypeError: __init__() got an unexpected keyword argument 'train_a'
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, dataloader_num_workers=8, dataset_path_test='../../QuantizedLSTM/data.nosync/speech_commands_test_set_v0.02', dataset_path_train='../../QuantizedLSTM/data.nosync/speech_commands_v0.02', hidden=118, hop_length=320, l2=0.01, learning_rate='0.0005,0.0001,0.00002', n_mfcc=40, noise_injectionT=0, quant_actMVM=8, quant_actNM=8, quant_inp=8, quant_w=8, random_seed=8627169, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, train_a=True, training_steps='10000,10000,10000', unknown_percentage=0.1, validation_percentage=10, win_length=640, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
4896e49d-eed6-4e82-b28c-480e5c3d5269
Start Training:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     4.1263      0.1200     0.0776     17.6192
00100     3.7046      0.2000     0.2098     42.3816
00200     3.5801      0.2000     0.2747     43.5548
00300     3.3678      0.3100     0.3511     43.0851
00400     3.0443      0.4100     0.4451     42.9736
00500     2.9259      0.4200     0.5203     43.0270
00600     2.8316      0.5100     0.5722     42.8799
00700     2.5222      0.6400     0.6255     43.1172
00800     2.4407      0.6100     0.6468     43.0846
00900     2.4580      0.6000     0.6619     43.3297
01000     2.3993      0.6100     0.6822     43.2576
01100     2.2332      0.7100     0.6999     43.3283
01200     2.2780      0.6800     0.7160     43.2637
01300     1.9943      0.7600     0.7273     42.8899
01400     2.2545      0.6700     0.7283     42.7445
01500     2.1479      0.7300     0.7471     43.2015
01600     2.0225      0.7500     0.7487     42.8300
01700     2.2716      0.6300     0.7654     42.9088
01800     2.0316      0.7400     0.7666     42.4833
01900     1.8523      0.8200     0.7675     43.2255
02000     1.9683      0.7700     0.7731     43.2894
02100     1.9705      0.7300     0.7802     42.9029
02200     2.0163      0.7300     0.7805     43.0771
02300     2.0315      0.7400     0.7966     43.1951
02400     2.0638      0.7200     0.7969     43.3020
02500     1.8698      0.7900     0.7969     43.0848
02600     1.9311      0.8300     0.8109     42.9703
02700     1.8883      0.8100     0.8116     43.1803
02800     1.7968      0.8100     0.8119     43.3574
02900     1.8972      0.7800     0.8244     43.5157
03000     1.9072      0.7900     0.8244     43.2029
03100     1.7395      0.8500     0.8244     43.4844
03200     1.8733      0.8400     0.8244     43.0081
03300     1.7562      0.8400     0.8244     43.1347
03400     1.7944      0.8400     0.8350     43.6665
03500     1.7246      0.9000     0.8350     42.9527
03600     1.8569      0.8100     0.8395     43.5840
03700     1.6565      0.9000     0.8395     43.2102
03800     1.7326      0.8300     0.8395     43.2001
03900     1.7509      0.8700     0.8395     43.7685
04000     1.6949      0.8600     0.8450     43.2148
04100     1.7490      0.8300     0.8450     43.8816
04200     1.8397      0.8100     0.8450     43.0101
04300     1.8352      0.7900     0.8461     44.0073
04400     1.6867      0.8400     0.8461     43.1242
04500     1.6808      0.8900     0.8544     43.4291
04600     1.6148      0.9200     0.8544     43.5643
04700     1.8216      0.7800     0.8577     43.5183
04800     1.8198      0.8200     0.8613     43.2327
04900     1.5703      0.9200     0.8613     43.4217
05000     1.7251      0.8500     0.8613     43.2881
05100     1.6955      0.8700     0.8702     43.4125
05200     1.7486      0.8700     0.8702     43.0769
05300     1.6586      0.9300     0.8702     43.3751
05400     1.6042      0.8800     0.8702     43.3709
05500     1.6771      0.8800     0.8702     43.5529
05600     1.7639      0.8400     0.8702     43.5787
05700     1.6720      0.8400     0.8702     43.7262
05800     1.7194      0.8700     0.8702     43.3319
05900     1.5137      0.9200     0.8702     43.4554
06000     1.6442      0.9200     0.8702     43.8931
06100     1.7007      0.8500     0.8702     43.2109
06200     1.5466      0.9100     0.8706     43.0532
06300     1.6337      0.9000     0.8706     43.5323
06400     1.8095      0.8200     0.8753     43.1217
06500     1.7571      0.8500     0.8753     43.4839
06600     1.6027      0.9000     0.8753     43.2927
06700     1.6161      0.9000     0.8753     43.9782
06800     1.5370      0.9100     0.8753     43.2360
06900     1.6568      0.8900     0.8753     43.3916
07000     1.5655      0.9100     0.8786     43.5718
07100     1.6297      0.8800     0.8786     43.4074
07200     1.5296      0.8900     0.8786     43.3305
07300     1.5439      0.8900     0.8787     43.1913
07400     1.5888      0.9000     0.8813     43.2022
07500     1.6475      0.8800     0.8813     43.1880
07600     1.6655      0.8600     0.8813     43.6797
07700     1.7839      0.8300     0.8825     44.4282
07800     1.4857      0.9100     0.8825     43.6866
07900     1.5113      0.9300     0.8825     43.6458
08000     1.5374      0.9000     0.8879     43.6845
08100     1.6763      0.8900     0.8879     43.8271
08200     1.6356      0.8800     0.8879     43.5202
08300     1.5286      0.9200     0.8898     43.0184
08400     1.5252      0.9100     0.8898     43.3303
08500     1.4485      0.9300     0.8898     43.2323
08600     1.6316      0.8700     0.8898     43.5811
08700     1.5672      0.9000     0.8898     43.4148
08800     1.4647      0.9400     0.8898     43.3275
08900     1.5289      0.9100     0.8912     43.5715
09000     1.5437      0.8700     0.8912     43.3130
09100     1.4244      0.9600     0.8939     44.0540
09200     1.7358      0.8500     0.8939     43.6091
09300     1.5020      0.9000     0.8939     43.1410
09400     1.6400      0.8800     0.9007     43.4986
09500     1.5494      0.9200     0.9007     43.2051
09600     1.6374      0.8800     0.9007     43.5149
09700     1.7142      0.8300     0.9007     44.0583
09800     1.4617      0.9100     0.9007     43.3742
09900     1.4231      0.9600     0.9007     43.4350
10000     1.4933      0.9300     0.9007     43.1275
10100     1.5315      0.8800     0.9007     43.5885
10200     1.5310      0.9000     0.9007     43.4127
10300     1.5239      0.9000     0.9007     43.3672
10400     1.4189      0.9400     0.9007     43.8859
10500     1.4710      0.9200     0.9007     43.9844
10600     1.5343      0.8900     0.9007     43.8772
10700     1.4751      0.9200     0.9007     43.8508
10800     1.5967      0.8900     0.9007     43.6839
10900     1.5172      0.9100     0.9007     43.5966
11000     1.5707      0.9000     0.9011     43.2859
11100     1.4784      0.9300     0.9011     43.7392
11200     1.4819      0.9200     0.9011     43.6233
11300     1.5135      0.9000     0.9011     43.5204
11400     1.5002      0.9500     0.9011     43.5326
11500     1.5688      0.9100     0.9011     43.5544
11600     1.4491      0.9100     0.9011     43.9223
11700     1.4620      0.9300     0.9011     43.8625
11800     1.4529      0.9500     0.9011     43.7973
11900     1.5149      0.9100     0.9011     43.2146
12000     1.4715      0.9000     0.9011     43.6688
12100     1.5455      0.9200     0.9011     43.6266
12200     1.4568      0.9400     0.9011     43.6931
12300     1.4380      0.9500     0.9011     43.6120
12400     1.5315      0.8900     0.9011     42.9534
12500     1.6376      0.8700     0.9011     43.4379
12600     1.5159      0.9000     0.9011     43.8841
12700     1.5314      0.8800     0.9012     43.8603
12800     1.5603      0.9000     0.9029     43.4555
12900     1.4092      0.9600     0.9029     43.6601
13000     1.5794      0.8700     0.9029     44.0255
13100     1.4970      0.9200     0.9029     43.8165
13200     1.4257      0.9300     0.9029     43.7983
13300     1.4022      0.9600     0.9029     43.2141
13400     1.5971      0.8700     0.9029     43.0430
13500     1.5230      0.9100     0.9029     44.0978
13600     1.4637      0.9200     0.9029     44.1423
13700     1.4502      0.9500     0.9029     43.4964
13800     1.4986      0.9500     0.9029     43.3808
13900     1.5525      0.8900     0.9047     43.5825
14000     1.5846      0.8900     0.9047     43.3435
14100     1.5030      0.9200     0.9047     43.6030
14200     1.4279      0.9400     0.9047     43.6191
14300     1.5687      0.9100     0.9047     43.3599
14400     1.3483      0.9800     0.9047     44.1822
14500     1.5107      0.9300     0.9047     43.6088
14600     1.5175      0.8900     0.9056     43.5757
14700     1.5538      0.9000     0.9056     43.5122
14800     1.5728      0.8900     0.9056     43.7083
14900     1.5467      0.9100     0.9057     43.4571
15000     1.3605      0.9500     0.9057     43.5518
15100     1.4846      0.8900     0.9057     43.3160
15200     1.4338      0.9400     0.9057     43.3996
15300     1.4643      0.9400     0.9057     43.6641
15400     1.3852      0.9600     0.9057     43.6036
15500     1.5288      0.8900     0.9057     43.2065
15600     1.4271      0.9200     0.9057     43.1624
15700     1.5434      0.8800     0.9057     42.9678
15800     1.5940      0.9000     0.9057     43.5955
15900     1.4559      0.9100     0.9057     43.6705
16000     1.4813      0.9100     0.9057     43.3505
16100     1.4098      0.9500     0.9057     43.9261
16200     1.4543      0.9200     0.9057     44.1976
16300     1.4858      0.9400     0.9057     43.6619
16400     1.4135      0.9300     0.9057     43.1730
16500     1.4691      0.9100     0.9057     43.4050
16600     1.4576      0.9300     0.9057     43.8547
16700     1.4897      0.8900     0.9057     43.2353
16800     1.5759      0.8700     0.9057     43.7502
16900     1.5256      0.9300     0.9057     43.0336
17000     1.4838      0.9300     0.9057     44.3990
17100     1.5355      0.8900     0.9057     43.7558
17200     1.5631      0.9000     0.9057     43.8866
17300     1.4155      0.9300     0.9057     43.9950
17400     1.4341      0.9400     0.9057     43.2139
17500     1.3629      0.9700     0.9057     43.5735
17600     1.4179      0.9500     0.9057     43.3836
17700     1.4943      0.9400     0.9057     43.7352
17800     1.5219      0.9100     0.9057     44.3456
17900     1.4848      0.9100     0.9057     44.0804
18000     1.4837      0.9100     0.9057     43.4673
18100     1.3990      0.9600     0.9057     43.5013
18200     1.4142      0.9500     0.9057     43.3327
18300     1.3938      0.9500     0.9057     43.3732
18400     1.4795      0.9400     0.9057     43.3572
18500     1.4707      0.9200     0.9057     43.9442
18600     1.4371      0.9100     0.9057     43.6713
18700     1.4654      0.9200     0.9057     43.4226
18800     1.4131      0.9400     0.9057     43.4693
18900     1.4825      0.9200     0.9057     43.2415
19000     1.5237      0.9100     0.9057     43.7686
19100     1.4505      0.9200     0.9057     43.5104
19200     1.4274      0.9500     0.9057     43.9687
19300     1.5041      0.9000     0.9057     43.3827
19400     1.5889      0.9100     0.9057     43.7270
19500     1.5424      0.9000     0.9057     43.8931
19600     1.5167      0.9200     0.9057     43.5188
19700     1.3257      0.9700     0.9057     44.4495
19800     1.4470      0.9200     0.9057     43.2796
19900     1.4518      0.9300     0.9057     44.1288
20000     1.4908      0.9200     0.9085     43.5212
20100     1.6059      0.8800     0.9085     43.9543
20200     1.5102      0.9200     0.9085     43.5092
20300     1.7422      0.8800     0.9085     43.3065
20400     1.4484      0.9300     0.9085     43.7862
20500     1.5692      0.8600     0.9085     43.6065
20600     1.5182      0.8900     0.9085     44.3723
20700     1.4061      0.9500     0.9085     43.3825
20800     1.4750      0.9300     0.9085     43.2104
20900     1.5417      0.8900     0.9085     43.4250
21000     1.3422      0.9700     0.9085     43.9674
21100     1.4123      0.9400     0.9085     43.4786
21200     1.4262      0.9400     0.9085     42.7669
21300     1.4024      0.9500     0.9085     43.7850
21400     1.7263      0.8600     0.9085     43.5651
21500     1.4542      0.9200     0.9085     43.3943
21600     1.4520      0.9200     0.9085     43.7433
21700     1.5581      0.8800     0.9085     43.8651
21800     1.4146      0.9300     0.9085     43.7277
21900     1.3506      0.9800     0.9085     42.7226
22000     1.4139      0.9300     0.9085     44.0097
22100     1.5354      0.8900     0.9085     43.9434
22200     1.3420      0.9600     0.9085     43.0916
22300     1.5337      0.9000     0.9085     43.5853
22400     1.5151      0.9000     0.9085     42.8249
22500     1.4611      0.9500     0.9085     43.1251
22600     1.4873      0.9000     0.9085     43.8361
22700     1.4975      0.9500     0.9085     43.3137
22800     1.4347      0.9400     0.9085     43.4262
22900     1.5643      0.8800     0.9085     43.5301
23000     1.4905      0.9300     0.9085     43.8780
23100     1.4046      0.9400     0.9085     43.7371
23200     1.3786      0.9700     0.9085     43.5218
23300     1.5469      0.8900     0.9085     44.5491
23400     1.4849      0.9100     0.9085     43.3421
23500     1.5198      0.9000     0.9085     43.7599
23600     1.4647      0.9100     0.9085     43.2911
23700     1.5856      0.8700     0.9085     43.2348
23800     1.3849      0.9500     0.9085     43.5639
23900     1.4815      0.9400     0.9085     43.2398
24000     1.3897      0.9600     0.9085     43.6554
24100     1.4015      0.9400     0.9085     43.8296
24200     1.5857      0.8900     0.9085     43.4084
24300     1.6098      0.8900     0.9085     43.3066
24400     1.5649      0.8900     0.9085     43.3298
24500     1.4394      0.9500     0.9085     43.7166
24600     1.3687      0.9700     0.9085     43.4448
24700     1.4000      0.9300     0.9085     43.6430
24800     1.4582      0.9300     0.9085     43.6701
24900     1.4015      0.9300     0.9085     43.9466
25000     1.4300      0.9200     0.9085     43.4112
25100     1.4964      0.9000     0.9085     43.7379
25200     1.4602      0.9100     0.9085     43.5966
25300     1.3501      0.9600     0.9085     43.9544
25400     1.5942      0.8600     0.9085     43.6815
25500     1.4307      0.9400     0.9085     43.3938
25600     1.3973      0.9500     0.9085     43.7464
25700     1.3822      0.9400     0.9085     43.8667
25800     1.4686      0.9000     0.9085     43.6129
25900     1.5408      0.9000     0.9085     43.3545
26000     1.4387      0.9400     0.9085     43.1632
26100     1.4708      0.9100     0.9085     42.9530
26200     1.5380      0.9200     0.9085     43.1826
26300     1.5359      0.9100     0.9085     43.3177
26400     1.4114      0.9100     0.9085     43.1391
26500     1.4884      0.9200     0.9085     43.5655
26600     1.4054      0.9600     0.9085     43.0546
26700     1.6132      0.8700     0.9085     43.0532
26800     1.6847      0.8600     0.9085     42.9716
26900     1.4324      0.9100     0.9085     43.0298
27000     1.3753      0.9600     0.9085     42.8821
27100     1.4855      0.9000     0.9085     43.3139
27200     1.4989      0.9200     0.9085     42.9280
27300     1.5004      0.9000     0.9085     43.4661
27400     1.5591      0.9200     0.9085     44.4273
27500     1.3272      0.9800     0.9085     43.5574
27600     1.3843      0.9600     0.9085     44.4635
27700     1.4626      0.9500     0.9085     43.4193
27800     1.4543      0.9400     0.9085     43.2054
27900     1.5707      0.9000     0.9085     43.0030
28000     1.4173      0.9500     0.9085     42.8824
28100     1.5862      0.8800     0.9085     43.5643
28200     1.4643      0.9000     0.9085     43.3398
28300     1.5084      0.9200     0.9085     43.1790
28400     1.4417      0.9300     0.9085     42.9336
28500     1.4490      0.9300     0.9085     42.5672
28600     1.3748      0.9600     0.9085     42.4289
28700     1.4434      0.9200     0.9085     42.7015
28800     1.3034      0.9900     0.9085     43.9586
28900     1.3892      0.9600     0.9085     43.4624
29000     1.4270      0.9400     0.9085     43.6441
29100     1.4632      0.9000     0.9085     43.1141
29200     1.3470      0.9900     0.9085     43.0313
29300     1.5013      0.9000     0.9085     43.0976
29400     1.4260      0.9500     0.9085     43.5512
29500     1.4063      0.9400     0.9085     43.2480
29600     1.3713      0.9600     0.9085     42.6073
29700     1.5562      0.9100     0.9085     42.7712
29800     1.6318      0.8600     0.9085     43.0192
29900     1.5104      0.9200     0.9085     42.9473
29999     1.5404      0.9400     0.9085     42.9823
Start Testing:
Test Accuracy: 0.8918
