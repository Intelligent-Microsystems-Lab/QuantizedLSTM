Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=474, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=294, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=235899598, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
d912c112-7d32-46c9-bd82-b3f1c4970786
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
Traceback (most recent call last):
  File "KWS_LSTM.py", line 147, in <module>
    output = model(x_data)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 290, in forward
    lstm_out, _ = self.lstmBlocks(inputs, self.hidden_state)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 65, in forward
    out, state = self.cell(inputs[i], state, w_mask)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 213, in forward
    gates = quant_pass(pact_a_bmm( quant_pass(pact_a_bmm(part1, self.a12), self.abMVM, self.a12) + quant_pass(pact_a_bmm(part2, self.a13), self.abMVM, self.a13), self.a14), self.abNM, self.a14)
  File "/afs/crc.nd.edu/user/c/cschaef6/QuantizedLSTM/model.py", line 89, in forward
    x01q =  torch.round(x01 * step_d ) / step_d
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 10.76 GiB total capacity; 9.66 GiB already allocated; 17.12 MiB free; 9.79 GiB reserved in total by PyTorch)
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Namespace(background_frequency=0.8, background_volume=0.1, batch_size=100, canonical_testing=False, cs=0.1, dataloader_num_workers=8, dataset_path_test='data.nosync/speech_commands_test_set_v0.02', dataset_path_train='data.nosync/speech_commands_v0.02', drop_p=0.125, finetuning_epochs=10000, gain_blocks=2, hidden=294, hop_length=320, l2=0.01, learning_rate='0.002,0.0005,0.00008', max_w=0.1, method=0, n_mfcc=40, n_msb=4, noise_injectionI=0.1, noise_injectionT=0.16, pact_a=True, quant_actMVM=6, quant_actNM=8, quant_inp=4, quant_w=None, random_seed=235899598, rows_bias=6, sample_rate=16000, silence_percentage=0.1, testing_percentage=10, time_shift_ms=100.0, training_steps='10000,10000,200', unknown_percentage=0.1, validation_percentage=10, win_length=641, word_list=['yes', 'no', 'up', 'down', 'left', 'right', 'on', 'off', 'stop', 'go', 'unknown', 'silence'])
2bcc6e96-79ed-4e64-8fc9-ce8bce2e3af9
Start training with DropConnect:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     2.9195      0.0500     0.1057     21.9149
00100     1.6055      0.4200     0.5291     73.3426
00200     1.3232      0.5500     0.6361     72.5450
00300     1.0618      0.7100     0.7279     76.8815
00400     0.9909      0.6600     0.7279     70.6064
00500     0.8527      0.7000     0.7497     72.6541
00600     0.8583      0.7200     0.7889     74.0167
00700     0.8568      0.7000     0.7889     75.8759
00800     1.0873      0.7200     0.7889     72.9169
00900     0.8104      0.7300     0.7889     73.6602
01000     0.7861      0.7500     0.7991     74.8883
01100     0.7507      0.7600     0.7991     72.3353
01200     0.8365      0.7000     0.7991     74.3078
01300     0.8804      0.7300     0.8084     74.6639
01400     0.6048      0.8500     0.8133     72.7344
01500     0.5927      0.8300     0.8236     76.9030
01600     0.8508      0.6800     0.8236     73.4589
01700     0.7189      0.7600     0.8236     71.1638
01800     0.8502      0.7600     0.8236     72.0864
01900     0.9398      0.7300     0.8289     75.4067
02000     0.6982      0.8000     0.8289     75.1769
02100     0.7990      0.7400     0.8313     73.2568
02200     0.5904      0.8200     0.8313     69.8470
02300     0.6473      0.8500     0.8319     73.9914
02400     0.5721      0.8300     0.8449     72.1454
02500     0.7119      0.7700     0.8449     71.1836
02600     0.6423      0.8000     0.8455     72.6659
02700     0.5666      0.8300     0.8455     70.7806
02800     0.6451      0.7500     0.8463     70.7523
02900     0.7008      0.7500     0.8463     70.3568
03000     0.5283      0.8600     0.8463     73.2126
03100     0.6366      0.8000     0.8463     72.2176
03200     0.6848      0.7800     0.8463     73.3453
03300     0.6204      0.8000     0.8463     73.8864
03400     0.4715      0.8700     0.8463     76.0346
03500     0.6654      0.8000     0.8463     74.9514
03600     0.5785      0.8200     0.8463     70.9151
03700     0.6769      0.8200     0.8464     72.6895
03800     0.8029      0.7700     0.8541     69.9637
03900     0.4356      0.9100     0.8541     74.3618
04000     0.7293      0.7700     0.8541     76.3339
04100     0.6171      0.8300     0.8543     75.4968
04200     0.5984      0.8100     0.8552     74.7892
04300     0.6283      0.7900     0.8595     72.0470
04400     0.7530      0.7200     0.8595     74.6298
04500     0.5437      0.8500     0.8595     75.2861
04600     0.6642      0.7900     0.8595     70.9948
04700     0.4765      0.8700     0.8595     76.4196
04800     0.6549      0.7900     0.8595     76.6498
04900     0.5095      0.8600     0.8595     74.6830
05000     0.6415      0.7600     0.8605     75.3829
05100     0.4770      0.8400     0.8605     72.1068
05200     0.7839      0.7700     0.8605     72.4958
05300     0.6802      0.7600     0.8605     75.4964
05400     0.4546      0.8800     0.8605     69.3116
05500     0.6068      0.7800     0.8624     75.8344
05600     0.5810      0.8700     0.8624     71.5315
05700     0.6598      0.8000     0.8624     70.9293
05800     0.4421      0.8800     0.8624     75.7500
05900     0.3491      0.8700     0.8624     75.2744
06000     0.5353      0.8000     0.8624     75.5894
06100     0.3871      0.8700     0.8624     75.3402
06200     0.8210      0.7300     0.8624     70.7270
06300     0.5099      0.8700     0.8624     71.1322
06400     0.4382      0.8800     0.8624     70.2223
06500     0.4894      0.8800     0.8720     73.6756
06600     0.4384      0.8800     0.8720     75.9875
06700     0.5404      0.8300     0.8724     76.1289
06800     0.7717      0.7800     0.8724     73.9822
06900     0.5099      0.8700     0.8724     73.9947
07000     0.4654      0.8600     0.8724     75.1616
07100     0.4143      0.9000     0.8724     73.1796
07200     0.6226      0.8000     0.8724     73.9623
07300     0.7836      0.7700     0.8724     71.8412
07400     0.3965      0.8800     0.8724     70.1186
07500     0.5234      0.8400     0.8733     72.1635
07600     0.5468      0.8100     0.8733     73.3464
07700     0.6726      0.7900     0.8733     73.5768
07800     0.5078      0.8200     0.8733     73.1598
07900     0.5172      0.8500     0.8733     74.4979
08000     0.4830      0.8800     0.8757     71.9894
08100     0.5865      0.8400     0.8757     72.7987
08200     0.4812      0.8600     0.8757     75.1756
08300     0.4519      0.8700     0.8786     71.8208
08400     0.5300      0.8300     0.8786     71.1000
08500     0.4863      0.8300     0.8786     74.3593
08600     0.5424      0.8200     0.8786     75.5021
08700     0.4503      0.8700     0.8786     70.8474
08800     0.5633      0.8400     0.8786     71.5367
08900     0.4276      0.8800     0.8786     72.5007
09000     0.5886      0.8000     0.8786     73.4292
09100     0.6305      0.8100     0.8786     75.7060
09200     0.3882      0.8800     0.8786     73.2813
09300     0.4564      0.8800     0.8786     72.1590
09400     0.4957      0.8800     0.8786     76.0916
09500     0.4385      0.8800     0.8786     71.4162
09600     0.4321      0.8500     0.8786     71.7204
09700     0.5209      0.8300     0.8786     72.9455
09800     0.5824      0.8600     0.8795     76.5753
09900     0.5512      0.8400     0.8795     71.1647
10000     0.4481      0.8600     0.8795     70.9661
10100     0.3874      0.9000     0.8795     73.5347
10200     0.5257      0.8900     0.8795     75.4146
10300     0.5544      0.8400     0.8795     75.8974
10400     0.3225      0.9200     0.8795     72.4376
10500     0.4474      0.8700     0.8795     75.5094
10600     0.4994      0.8300     0.8795     76.5936
10700     0.4532      0.8800     0.8795     71.8804
10800     0.5193      0.8600     0.8795     71.5391
10900     0.5823      0.8400     0.8795     75.5254
11000     0.4146      0.8700     0.8795     70.5202
11100     0.3843      0.8900     0.8867     73.6317
11200     0.4917      0.8500     0.8867     76.5512
11300     0.4317      0.8600     0.8867     78.0712
11400     0.6092      0.8000     0.8867     75.8032
11500     0.4766      0.8400     0.8867     78.3771
11600     0.2572      0.9200     0.8867     78.1326
11700     0.4459      0.8400     0.8867     74.1638
11800     0.5319      0.8200     0.8867     72.5751
11900     0.3962      0.9000     0.8867     72.1619
12000     0.4467      0.8900     0.8867     72.0585
12100     0.3458      0.8800     0.8867     77.5543
12200     0.3939      0.8700     0.8935     71.4504
12300     0.3468      0.8900     0.8935     73.4516
12400     0.2845      0.9000     0.8935     70.7550
12500     0.3826      0.9000     0.8935     77.7746
12600     0.4519      0.8700     0.8935     74.1761
12700     0.5447      0.8600     0.8935     75.3454
12800     0.4051      0.8900     0.8935     72.2137
12900     0.4856      0.8500     0.8935     74.8263
13000     0.5135      0.8300     0.8935     74.4340
13100     0.4460      0.8600     0.8935     75.2732
13200     0.3466      0.8800     0.8935     74.7517
13300     0.3630      0.8800     0.8935     71.1290
13400     0.4301      0.8800     0.8935     72.2180
13500     0.2988      0.8900     0.8935     75.2289
13600     0.3919      0.8900     0.8935     74.8824
13700     0.4598      0.8800     0.8935     78.4823
13800     0.3878      0.8700     0.8935     73.3893
13900     0.3459      0.9000     0.8935     72.3455
14000     0.3146      0.9000     0.8935     72.8543
14100     0.4309      0.9100     0.8935     75.8491
14200     0.4597      0.8500     0.8935     72.3782
14300     0.3004      0.9200     0.8935     72.1182
14400     0.3062      0.9500     0.8935     71.5305
14500     0.2839      0.9100     0.8935     71.6562
14600     0.3212      0.9200     0.8935     71.5704
14700     0.4991      0.8500     0.8935     70.8960
14800     0.3191      0.9100     0.8935     75.7615
14900     0.3576      0.9200     0.8935     74.7495
15000     0.3677      0.9100     0.8935     75.1462
15100     0.3684      0.8900     0.8935     71.9562
15200     0.4864      0.8200     0.8935     73.8671
15300     0.4016      0.8900     0.8935     74.4327
15400     0.4165      0.8600     0.8935     77.0668
15500     0.3540      0.8900     0.8935     76.2544
15600     0.3868      0.8800     0.8935     75.2483
15700     0.3371      0.8800     0.8935     76.1291
15800     0.5116      0.8800     0.8935     71.4902
15900     0.4290      0.8600     0.8966     71.0816
16000     0.4175      0.8600     0.8966     74.3313
16100     0.3319      0.9000     0.8966     73.6731
16200     0.3181      0.9000     0.8966     75.1564
16300     0.4083      0.8800     0.8966     72.3527
16400     0.2819      0.9200     0.8966     72.9223
16500     0.3395      0.9000     0.8966     74.4589
16600     0.4446      0.8800     0.8966     73.1520
16700     0.3706      0.9000     0.8966     70.2188
16800     0.2718      0.9200     0.8966     70.1761
16900     0.2879      0.9300     0.8966     71.2038
17000     0.4628      0.8500     0.8966     75.4978
17100     0.4290      0.8800     0.8966     75.0030
17200     0.2208      0.9600     0.8966     74.2201
17300     0.4011      0.8800     0.8966     74.7715
17400     0.3208      0.9100     0.8966     73.5817
17500     0.3851      0.9300     0.8966     73.2981
17600     0.3757      0.9000     0.8966     70.7236
17700     0.3494      0.9100     0.8966     70.9390
17800     0.3953      0.8900     0.8966     75.4136
17900     0.2903      0.9400     0.8966     71.0558
18000     0.2121      0.9400     0.8966     73.8137
18100     0.3407      0.8900     0.8966     74.4931
18200     0.4687      0.8600     0.8966     73.4968
18300     0.3014      0.9200     0.8966     75.5511
18400     0.3994      0.8900     0.8966     74.5014
18500     0.3674      0.9000     0.8966     74.5444
18600     0.3790      0.8700     0.8966     74.6898
18700     0.4972      0.8500     0.8966     77.1133
18800     0.4536      0.8300     0.8966     72.1201
18900     0.2437      0.9100     0.8966     75.7929
19000     0.4180      0.8700     0.8966     74.1256
19100     0.2857      0.9000     0.8966     73.3192
19200     0.3609      0.8700     0.8966     72.8529
19300     0.4262      0.8800     0.8966     76.8668
19400     0.4678      0.8500     0.8966     77.9899
19500     0.3413      0.8700     0.8966     72.6791
19600     0.4020      0.8600     0.8966     76.4107
19700     0.2970      0.9200     0.8966     75.9450
19800     0.3998      0.8900     0.8966     70.6019
19900     0.3657      0.8900     0.8966     73.3369
20000     0.3329      0.8900     0.8966     70.3987
20100     0.3619      0.8900     0.8966     76.2673
20199     0.2902      0.9100     0.8966     71.5732
Start finetuning with noise:
Epoch     Train Loss  Train Acc  Vali. Acc  Time (s)
00000     0.5058      0.8300     0.8259     17.2135
00100     0.3090      0.9100     0.8996     74.9902
00200     0.4457      0.8600     0.9013     75.1118
00300     0.2816      0.9300     0.9019     76.5746
00400     0.3339      0.9300     0.9019     70.9148
00500     0.2635      0.9200     0.9026     75.2563
00600     0.4984      0.8600     0.9026     70.8638
00700     0.3499      0.8900     0.9026     70.4254
00800     0.4303      0.8600     0.9026     70.9426
00900     0.3721      0.8700     0.9026     73.1701
01000     0.3869      0.9000     0.9026     71.5255
01100     0.4130      0.8700     0.9026     72.6887
01200     0.4719      0.8500     0.9026     70.6366
01300     0.3126      0.9100     0.9045     77.5873
01400     0.4121      0.8800     0.9045     72.0038
01500     0.3814      0.9300     0.9048     74.1641
01600     0.4327      0.8800     0.9048     73.9622
01700     0.3750      0.8800     0.9048     72.2965
01800     0.4327      0.8700     0.9058     71.7261
01900     0.3731      0.8700     0.9060     78.5451
02000     0.3316      0.9100     0.9060     70.9397
02100     0.2799      0.9200     0.9060     70.8447
02200     0.4606      0.8900     0.9060     74.6027
02300     0.4441      0.8500     0.9060     71.6625
02400     0.4188      0.8800     0.9060     71.5400
02500     0.3200      0.9400     0.9082     72.4294
02600     0.3584      0.8800     0.9082     76.3626
02700     0.3331      0.8900     0.9082     73.4763
02800     0.3998      0.8700     0.9082     77.2482
02900     0.4561      0.8600     0.9082     74.4040
03000     0.3254      0.9300     0.9082     76.1992
03100     0.3657      0.9000     0.9082     73.4288
03200     0.2958      0.9000     0.9082     72.6452
03300     0.3462      0.9200     0.9082     70.2274
03400     0.4066      0.8700     0.9082     70.5261
03500     0.2747      0.9200     0.9082     71.8360
03600     0.3756      0.8800     0.9082     75.8628
03700     0.4481      0.8500     0.9082     74.7533
03800     0.2768      0.8800     0.9082     75.0188
03900     0.2403      0.9600     0.9082     75.2561
04000     0.3355      0.9200     0.9082     71.4415
04100     0.3697      0.8900     0.9082     74.6643
04200     0.2996      0.9200     0.9082     70.6293
04300     0.3844      0.9000     0.9082     74.8646
04400     0.3709      0.8600     0.9082     72.8989
04500     0.3390      0.9000     0.9082     73.4223
04600     0.4964      0.8700     0.9082     76.1069
04700     0.4011      0.8700     0.9082     72.6672
04800     0.3359      0.9000     0.9082     73.2157
04900     0.2450      0.9300     0.9082     72.8700
05000     0.3967      0.9000     0.9082     71.5983
05100     0.1953      0.9600     0.9082     70.3803
05200     0.4721      0.8700     0.9082     71.6705
05300     0.2394      0.9700     0.9082     73.0326
05400     0.3467      0.8800     0.9082     72.7181
05500     0.2620      0.9400     0.9082     71.4177
05600     0.3907      0.8800     0.9082     72.7611
05700     0.3518      0.8900     0.9082     72.4332
05800     0.2574      0.9100     0.9082     71.3547
05900     0.3443      0.8900     0.9082     72.3085
06000     0.3716      0.9200     0.9082     76.0935
06100     0.2684      0.9400     0.9082     73.5728
06200     0.2072      0.9500     0.9082     74.8566
06300     0.4194      0.8700     0.9082     71.8677
06400     0.3691      0.8600     0.9082     70.4362
06500     0.5045      0.8700     0.9088     73.5430
06600     0.3502      0.9100     0.9088     70.7194
06700     0.3053      0.9100     0.9088     72.6221
06800     0.2297      0.9300     0.9088     72.7630
06900     0.2965      0.9100     0.9088     74.7260
07000     0.4266      0.8800     0.9088     74.7174
07100     0.2685      0.9100     0.9088     76.7958
07200     0.4140      0.8900     0.9088     71.6914
07300     0.2704      0.9300     0.9088     75.8569
07400     0.4094      0.8800     0.9088     72.6467
07500     0.3257      0.9200     0.9088     72.6969
07600     0.3939      0.9000     0.9088     73.7247
07700     0.4513      0.8400     0.9088     75.2314
07800     0.3751      0.9100     0.9088     73.4939
07900     0.4201      0.9000     0.9088     72.8783
08000     0.2531      0.9400     0.9088     72.1114
08100     0.3236      0.9000     0.9088     74.0803
08200     0.3960      0.8900     0.9088     73.4968
08300     0.3654      0.8500     0.9088     78.3306
08400     0.4308      0.8900     0.9088     81.1339
08500     0.4301      0.8300     0.9088     73.8789
08600     0.3999      0.8800     0.9088     75.2596
08700     0.3591      0.9000     0.9088     73.8914
08800     0.1615      0.9600     0.9088     73.5853
08900     0.4088      0.8800     0.9088     68.1292
09000     0.3452      0.9000     0.9088     72.3340
09100     0.4278      0.8500     0.9088     71.7310
09200     0.3746      0.8700     0.9088     70.2665
09300     0.3812      0.8700     0.9088     70.9922
09400     0.3562      0.8700     0.9088     69.8119
09500     0.3974      0.8500     0.9088     73.6416
09600     0.4562      0.8600     0.9088     72.5316
09700     0.4425      0.8700     0.9088     69.8107
09800     0.3054      0.8700     0.9088     66.0096
09900     0.2729      0.9100     0.9088     68.4775
Start testing:
Test Accuracy: 0.9004
